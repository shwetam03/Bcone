<style>
    .stiled {
        width: 150px;
        height: 150px;
        margin: 0 4px 0px 3px;
        position: relative;
        font-family: "Segoe UI" !important;
        font-size: 14px;
        display: inline-block;
        overflow: hidden;
    }

    .innerShiled {
        top: 100px;
        padding: 10px;
        width: 100%;
        height: 150px;
    }

    .stiled:hover .ms-tileview-tile-detailsBox {
        top: 0;
        transition: all 150ms ease;
        cursor: pointer;
    }

    .titlefontstyle {
        font-family: "Segoe UI Semilight","Segoe UI","Segoe",Tahoma,Helvetica,Arial,sans-serif;
        color: #7695a3;
        overflow: hidden;
        text-align: justify;
        text-overflow: ellipsis;
        white-space: nowrap;
        font-weight: normal;
        font-size: 1.46em;
        padding-bottom: 11px;
    }
</style>

<div>
    <div class="titlefontstyle">
        Track Your Timesheet
    </div>
    <div>
        <div class="stiled ms-tileview-tile-content" id="divCreateTimeSheet">
            <img src="/sites/pwa/SiteAssets/BconeExpenseImg/timesheet.png" style="left: 0px; top: 0px; position: absolute;" />
            <a href="https://bristleconeonline.sharepoint.com/sites/pwa/SitePages/TeamMemberSummaryPage.aspx?status=0">
                <div class="ms-tileview-tile-detailsBox innerShiled">
                    Create Timesheet
                </div>
            </a>
        </div>

        <div class="stiled ms-tileview-tile-content" id="divMyTimeSheet">
            <img src="/sites/pwa/SiteAssets/BconeExpenseImg/timesheetCheckStatus.png" style="left: 0px; top: 0px; position: absolute;" />
            <a href="https://bristleconeonline.sharepoint.com/sites/pwa/SitePages/TeamMemberSummaryPage.aspx">
                <div class="ms-tileview-tile-detailsBox innerShiled">
                    Check Timesheet 
		   <div>Status</div>
                </div>
            </a>
        </div>

        <div class="stiled ms-tileview-tile-content" id="divTimeSheetAppr" style="display: none">
            <img src="/sites/pwa/SiteAssets/BconeExpenseImg/timesheetApproval.png" style="left: 0px; top: 0px; position: absolute;" />
            <a href="https://bristleconeonline.sharepoint.com/sites/pwa/SitePages/ApproveSummaryPage.aspx">
                <div class="ms-tileview-tile-detailsBox innerShiled">
                    Timesheet Approval: 
                    <div>
                        <span
                            id="timeSheetApprovalCount"></span> Pending
                    </div>
                </div>
            </a>
        </div>

        <div>
            <div class="titlefontstyle" style="padding: 20px 0px 10px 0px;">Track Your Expenses</div>
            <div class="stiled ms-tileview-tile-content ">
                <img src="/sites/pwa/SiteAssets/BconeExpenseImg/Programming-Add-Property-icon.png" style="left: 0; top: 0px; position: absolute;" />
                <a href="/sites/pwa/SitePages/MyExpense.aspx?Default=Open">
                    <div class="innerShiled ms-tileview-tile-detailsBox">
                        Create Expense<span></span>
                    </div>
                </a>
            </div>
            <div class="stiled ms-tileview-tile-content">
                <img src="/sites/pwa/SiteAssets/BconeExpenseImg/approvedicon.png" style="left: 0px; top: 0px; position: absolute;" />
                <a href="/sites/pwa/SitePages/MyExpense.aspx">
                    <div class="ms-tileview-tile-detailsBox innerShiled">
                        Check Expense Status<span></span><div>Approved: <span id="ApprovedCount"></span></div>
                        <div>Open: <span id="OpenCount"></span></div>
                        <div>
                            Submitted: <span
                                id="SubmittedCount"></span>
                        </div>
                        <div>Rejected: <span id="RejectedCount"></span></div>
                        <div>Reimbursed: <span id="ReimbursedCount"></span></div>
                    </div>
                </a>
            </div>
            <div class="stiled ms-tileview-tile-content" id="expenseapproval" style="display: none">
                <img src="/sites/pwa/SiteAssets/BconeExpenseImg/Check_Status.png" style="left: 0px; top: 0px; position: absolute;" />
                <a href="/sites/pwa/SitePages/ExpenseApproval.aspx">
                    <div class="ms-tileview-tile-detailsBox innerShiled">
                        Expense Approval: <span
                            id="expenseCount"></span>
                        <div>Pending</div>
                    </div>
                </a>
            </div>
            <div class="stiled ms-tileview-tile-content" id="financeapproval" style="display: none">
                <img src="/sites/pwa/SiteAssets/BconeExpenseImg/Check_Status.png" style="left: 0px; top: 0px; position: absolute;" />
                <a href="/sites/pwa/SiteAssets/FinanceApproval.aspx">
                    <div class="ms-tileview-tile-detailsBox innerShiled">
                        Finance Approval: <span
                            id="financeCount"></span>
                        <div>Pending</div>
                    </div>
                </a>
            </div>

            <div class="stiled ms-tileview-tile-content" id="financeRemapproval" style="display: none">
                <img src="/sites/pwa/SiteAssets/BconeExpenseImg/Reimbursement.png" style="left: 0px; top: 0px; position: absolute;" />
                <a href="/sites/pwa/SitePages/FinanceReimburse.aspx">
                    <div class="ms-tileview-tile-detailsBox innerShiled">
                        Reimbursement: <span
                            id="financeRemCount"></span>
                        <div>Pending</div>
                    </div>
                </a>
            </div>


            <div id="dashboard" style="display: none">
                <div class="stiled ms-tileview-tile-content">
                    <img src="/sites/pwa/SiteAssets/BconeExpenseImg/chart-icon.png" style="left: 0px; top: 0px; position: absolute;" />
                    <a href="/sites/pwa/SitePages/ExpenseDashboard.aspx">
                        <div class="ms-tileview-tile-detailsBox innerShiled">
                            Expense Dashboard
            
                        </div>
                    </a>
                </div>
            </div>

            <div id="financedashboard" style="display: none">
                <div class="stiled ms-tileview-tile-content">
                    <img src="/sites/pwa/SiteAssets/BconeExpenseImg/chart-icon.png" style="left: 0px; top: 0px; position: absolute;" />
                    <a href="/sites/pwa/Sitepages/ExpenseDetailReport.aspx">
                        <div class="ms-tileview-tile-detailsBox innerShiled">
                            Finance Reports
            
                        </div>
                    </a>
                </div>
            </div>

            <br />

            <div id="admin" style="display: none">
                <div class="titlefontstyle" style="padding: 20px 0px 0px 0px;">
                    Manage Timesheet & Expense Administration
                </div>

                <div style="margin-top: 10px;">
                    <div class="stiled ms-tileview-tile-content" id="orgExpense" style="display: none">
                        <img src="/sites/pwa/SiteAssets/BconeExpenseImg/view-all.png" style="left: 0px; top: 0px; position: absolute;" />
                        <a href="/sites/pwa/SitePages/ViewAllExpenses.aspx">
                            <div class="ms-tileview-tile-detailsBox innerShiled">
                                View All Expense 
                            </div>
                        </a>
                    </div>

                    <div class="stiled ms-tileview-tile-content" id="ManageExp" style="display: none">
                        <img src="/sites/pwa/SiteAssets/BconeExpenseImg/setting.png" style="left: 0px; top: 0px; position: absolute;" />
                        <a href="/sites/pwa/SitePages/Manage%20Admin%20List.aspx">
                            <div class="ms-tileview-tile-detailsBox innerShiled">
                                Manage Expense Administration
                            </div>
                        </a>
                    </div>

                    <div class="stiled ms-tileview-tile-content" id="ExpDelegation" style="display: none">
                        <img src="/sites/pwa/SiteAssets/BconeExpenseImg/Delegation.png" style="left: 0px; top: 0px; position: absolute;" />
                        <a href="/sites/pwa/SitePages/ProjectDelegates.aspx">
                            <div class="ms-tileview-tile-detailsBox innerShiled">
                                Manage Expense Delegation 
                            </div>
                        </a>
                    </div>

                    <div class="stiled ms-tileview-tile-content" id="TimDelegation" style="display: none">
                        <img src="/sites/pwa/SiteAssets/BconeExpenseImg/Delegation.png" style="left: 0px; top: 0px; position: absolute;" />
                        <a href="">
                            <div class="ms-tileview-tile-detailsBox innerShiled">
                                Manage Timesheet Delegation 
                            </div>
                        </a>
                    </div>



                </div>

                <script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseJs/jquery.min.js"></script>
                <script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseJs/jquery.SPServices.min.js"></script>



                <script>
                    var userid = "";
                    var NewloginName = "";
                    var displayName = "";
                    var resGuid = "";
                    var ResourceGuid = ""
                    var EmployeeID = "";
                    var EmployeeUserID = "";
                    var FinalShow = "";
                    //Code to Get Current login user ID
                    $(document).ready(function () {
                        userid = _spPageContextInfo.userId;
                        EmployeeUserID = userid;
                        GetUserId(userid);  //Get User Id
                    });


                    function GetUserId(userid) {

                        jQuery.ajax({
                            url: "/sites/pwa/_api/Web/GetUserById(" + userid + ")",
                            type: "GET",
                            headers: { "Accept": "application/json;odata=verbose" },
                            success: function (data) {
                                var dataResults = data.d;
                                displayName = dataResults.Title;
                                NewloginName = encodeURIComponent(dataResults.LoginName); //encoding loginName from special charater to normal text
                                console.log()
                            },
                            complete: function () {
                                resGuid = getResourcesGuid(NewloginName); //Code to get login user GUID

                            },
                        });
                    }

                    function getResourcesGuid(NewloginName) {
                        jQuery.ajax({

                            url: "/sites/pwa/_api/ProjectData/Resources?$select=ResourceNTAccount,ResourceId,EmployeeID&$filter=ResourceNTAccount eq('" + NewloginName + "')",
                            type: "GET",
                            async: false,
                            headers: { "Accept": "application/json;odata=verbose" },
                            success: function (data) {
                                setTimeout(function () {
                                    ResourceGuid = data.d.results[0].ResourceId;
                                    EmployeeID = data.d.results[0].EmployeeID;
                                    CheckLoginUserRole(ResourceGuid);
                                    checkFinanceTeam(EmployeeUserID, ResourceGuid);
                                    countTotalApprovedStatus(ResourceGuid);
                                    countTotalOpenStatus(ResourceGuid);
                                    countTotalSubmittedStatus(ResourceGuid);
                                    countTotalRejectedStatus(ResourceGuid);
                                    countTotalRemStatus(ResourceGuid);
                                    ExpenseCount(ResourceGuid);
                                    PendingRemCount(ResourceGuid);
                                    ShowExpenseAdminisatrationTile(EmployeeUserID);
                                    ShowHideExpenseTile();
                                    countTotalTimeSheetApprovalStatus(ResourceGuid);
                                }, 200);
                            }
                        });
                        return ResourceGuid;

                    }

                    function CheckLoginUserRole(ResourceGuid) {
                        $.ajax
                        ({
                            url: "https://ppmprod.bcone.com/api/BCONE/GetLoginUserRole",
                            method: "POST",
                            headers: { "Accept": "application/json; odata=verbose" },
                            //data: { "ResourceUID":"467B2620-D6B2-E611-BEF9-E50A825364A1" },
                            data: { "ResGUID": ResourceGuid },
                            success: function (data) {
                                data.SubOptions[0].LoginUserRole.filter
                                (
                                 function (CheckRole) {
                                     if (CheckRole.ROLE == "CP") {
                                         document.getElementById("expenseapproval").style.display = "inline-block";
                                         document.getElementById("divTimeSheetAppr").style.display = "inline-block";
                                         document.getElementById("dashboard").style.display = "inline-block";
                                         document.getElementById("divTimeSheetAppr").style.display = "inline-block";
                                     }
                                     if (CheckRole.ROLE == "PM") {
                                         document.getElementById("expenseapproval").style.display = "inline-block";
                                         document.getElementById("divTimeSheetAppr").style.display = "inline-block";
                                         document.getElementById("dashboard").style.display = "inline-block";
                                         document.getElementById("divTimeSheetAppr").style.display = "inline-block";
                                     }
                                     if (CheckRole.ROLE == "RM") {
                                         document.getElementById("expenseapproval").style.display = "inline-block";
                                         document.getElementById("divTimeSheetAppr").style.display = "inline-block";
                                     }
                                 }
                             )
                            },
                            complete: function () {

                            },
                            error: function (data) {
                                //alert("failed");
                            }
                        });
                    }



                    function countTotalTimeSheetApprovalStatus(ResourceGuid) {
                        var TSCount = "";
                        $.ajax
                        ({
                            url: "https://ppmprod.bcone.com/api/Timesheet/GetTimesheetApproverSummary",
                            method: "POST",
                            headers: { "Accept": "application/json; odata=verbose" },
                            //data: { "ResourceUID":"467B2620-D6B2-E611-BEF9-E50A825364A1" },
                            data: { "ResourceUID": ResourceGuid },
                            success: function (data) {
                                if (data.Data.length != "0") {
                                    TSCount = data.Data[0].Projects.length;
                                }
                            },
                            complete: function () {
                                if (TSCount > 0) {
                                    document.getElementById("timeSheetApprovalCount").innerHTML = TSCount;
                                }
                                else {
                                    document.getElementById("timeSheetApprovalCount").innerHTML = "0";
                                }
                            },
                            error: function (data) {
                                //alert("failed");
                            }
                        });
                    }

                    //Code to check finance from finance Team 
                    function checkFinanceTeam(EmployeeUserID, ResourceGuid) {
                        var FinanceTeamCount = "";
                        jQuery.ajax({

                            url: "/sites/pwa/_api/Web/GetUserById('" + EmployeeUserID + "')/Groups?$select=Id,Title&$filter=Title eq 'Finance%20Team'",
                            type: "GET",
                            async: false,
                            headers: { "Accept": "application/json;odata=verbose" },
                            success: function (data) {
                                FinanceTeamCount = data.d.results.length;
                            },
                            complete: function () {
                                if (FinanceTeamCount > 0) {
                                    document.getElementById("financeapproval").style.display = "inline-block";
                                    document.getElementById("financeRemapproval").style.display = "inline-block";
                                    document.getElementById("divTimeSheetAppr").style.display = "inline-block";
                                    document.getElementById("financedashboard").style.display = "inline-block";
                                } else {
                                    document.getElementById('financeapproval').style.display = "none";
                                    document.getElementById("financeRemapproval").style.display = "none";
                                    document.getElementById("divTimeSheetAppr").style.display = "none";
                                    document.getElementById("financedashboard").style.display = "none";
                                }
                            }

                        });

                        var FinDataCount = "";

                        var query_cmlNew = '<View><Query><Where><And><Eq><FieldRef Name="FinanceId" /><Value Type="Text">' + ResourceGuid + '</Value></Eq><Or><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Manager Approved</Value></Eq><Or><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Approver 1 Approved</Value></Eq><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Approver 2 Approved</Value></Eq></Or></Or></And></Where><OrderBy><FieldRef Name="EmployeeId" Ascending="False"/><Value ></Value></OrderBy></Query></View>';
                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlNew
                                }
                            }),

                            success: function (data) {
                                FinDataCount = data.d.results.length;
                            },
                            complete: function () {
                                if (FinDataCount > 0) {
                                    document.getElementById('financeCount').innerHTML = FinDataCount;
                                } else {
                                    document.getElementById('financeCount').innerHTML = "0";
                                }
                            },
                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);

                            }
                        });

                    }

                    function countTotalApprovedStatus(ResourceGuid) {
                        var AppDataCount = "";
                        var query_cmlAppStatus = '<View> <Query><Where><And><Eq><FieldRef Name="EmployeeId" /><Value Type="Text">' + ResourceGuid + '</Value></Eq> <Contains><FieldRef Name="ReportStatus" /><Value Type="Text">Approved</Value></Contains></And></Where></Query></view>';

                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlAppStatus
                                }
                            }),


                            success: function (data) {
                                AppDataCount = data.d.results.length;
                            },
                            complete: function () {
                                if (AppDataCount > 0) {
                                    document.getElementById('ApprovedCount').innerHTML = AppDataCount;
                                }
                                else {
                                    document.getElementById('ApprovedCount').innerHTML = "0";
                                }
                            },

                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);
                            }
                        });

                    }

                    function countTotalOpenStatus(ResourceGuid) {

                        var query_cmlOpenStatus = '<View> <Query><Where><And><Eq><FieldRef Name="EmployeeId" /><Value Type="Text">' + ResourceGuid + '</Value></Eq><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Open</Value></Eq></And></Where></Query></view>';

                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlOpenStatus
                                }
                            }),


                            success: function (data) {
                                datacount = data.d.results.length;
                            },
                            complete: function () {
                                if (datacount > 0) {
                                    document.getElementById('OpenCount').innerHTML = datacount;
                                }
                                else {
                                    document.getElementById('OpenCount').innerHTML = "0";
                                }
                            },
                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);
                            }
                        });

                    }

                    function countTotalSubmittedStatus(resGuid) {

                        var SubmittedCount = "";


                        var query_cmlSubStatus = '<View> <Query><Where><And><Eq><FieldRef Name="EmployeeId" /><Value Type="Text">' + resGuid + '</Value></Eq><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Submitted</Value></Eq></And></Where></Query></view>';

                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlSubStatus
                                }
                            }),

                            success: function (data) {
                                SubmittedCount = data.d.results.length;


                            },
                            complete: function () {
                                if (SubmittedCount > 0) {
                                    document.getElementById('SubmittedCount').innerHTML = SubmittedCount;
                                }
                                else {
                                    document.getElementById('SubmittedCount').innerHTML = "0";
                                }
                            },
                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);
                            }
                        });

                    }

                    function countTotalRejectedStatus(resGuid) {
                        var RejDataCount = "";
                        var query_cmlRejStatus = '<View> <Query><Where><And><Eq><FieldRef Name="EmployeeId" /><Value Type="Text">' + resGuid + '</Value></Eq><Contains><FieldRef Name="ReportStatus" /><Value Type="Text">Rejected</Value></Contains></And></Where></Query></view>';

                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlRejStatus
                                }
                            }),
                            success: function (data) {
                                RejDataCount = data.d.results.length;

                            },
                            complete: function () {
                                if (RejDataCount > 0) {
                                    document.getElementById('RejectedCount').innerHTML = RejDataCount;
                                }
                                else {
                                    document.getElementById('RejectedCount').innerHTML = "0";
                                }
                            },
                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);
                            }
                        });

                    }

                    function countTotalRemStatus(resGuid) {


                        var RemDatacount = "";
                        var query_cmlREMStatus = '<View> <Query><Where><And><Eq><FieldRef Name="EmployeeId" /><Value Type="Text">' + resGuid + '</Value></Eq><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Reimbursed</Value></Eq></And></Where></Query></view>';

                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlREMStatus
                                }
                            }),


                            success: function (data) {
                                $.each(data.d.results, function (key, value) {
                                    RemDatacount = data.d.results.length;

                                });

                            },
                            complete: function () {
                                if (RemDatacount > 0) {
                                    document.getElementById('ReimbursedCount').innerHTML = RemDatacount;
                                    //document.getElementById('financeRemCount').innerHTML=RemDatacount;
                                }
                                else {
                                    document.getElementById('ReimbursedCount').innerHTML = "0";
                                    //document.getElementById('financeRemCount').innerHTML="0";
                                }
                            },
                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);
                            }
                        });

                    }
                    function ExpenseCount(ResourceGuid) {
                        var ExpenseCount = "";
                        var query_cmlNew = '<View><Query><Where><And><Eq><FieldRef Name="PendingWithId" /><Value Type="Text">' + ResourceGuid + '</Value></Eq><Or><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Approver 1 Approved</Value></Eq><Or><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Approver 2 Approved</Value></Eq><Or><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Manager Approved</Value></Eq><And><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Submitted</Value></Eq><Neq><FieldRef Name="ReportStatus" /><Value Type="Text">Approved</Value></Neq></And></Or></Or></Or></And></Where></Query></View>';
                        //var query_cmlNew = '<View><Query><Where><And><Eq><FieldRef Name="PendingWithId" /><Value Type="Text">' + ResourceGuid + '</Value></Eq><Or><Contains> <FieldRef Name="ReportStatus"/><Value Type="Text" >Approved</Value></Contains><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Submitted</Value></Eq></Or></And></Where></Query></View>';
                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlNew
                                }
                            }),

                            success: function (data) {
                                ExpenseCount = data.d.results.length;


                            },
                            complete: function () {
                                if (ExpenseCount > 0) {

                                    document.getElementById('expenseCount').innerHTML = ExpenseCount;

                                } else {

                                    document.getElementById('expenseCount').innerHTML = "0";
                                }
                            },
                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);

                            }
                        });
                    }


                    //Code to check finance from finance Team 
                    function ShowExpenseAdminisatrationTile(EmployeeUserID) {
                        jQuery.ajax({

                            url: "/sites/pwa/_api/Web/GetUserById('" + EmployeeUserID + "')/Groups?$select=Id,Title&$filter=Title eq 'Expense Admin'",
                            type: "GET",
                            async: false,
                            headers: { "Accept": "application/json;odata=verbose" },
                            success: function (data) {
                                datacount = data.d.results.length;
                            },
                            complete: function () {
                                if (datacount > 0) {
                                    document.getElementById("admin").style.display = "inline-block";
                                    document.getElementById("orgExpense").style.display = "inline-block";
                                    document.getElementById("ManageExp").style.display = "inline-block";
                                    document.getElementById("TimDelegation").style.display = "inline-block";
                                    document.getElementById("ExpDelegation").style.display = "inline-block";
                                } else {
                                    document.getElementById('admin').style.display = "none";
                                    document.getElementById("orgExpense").style.display = "none";
                                    document.getElementById("ManageExp").style.display = "none";
                                    document.getElementById("TimDelegation").style.display = "none";
                                    document.getElementById("ExpDelegation").style.display = "none";
                                }
                            }

                        });
                    }

                    function ShowHideExpenseTile() {
                        if (FinalShow == "1") {
                            document.getElementById("expenseapproval").style.display = "inline-block";
                            document.getElementById("divTimeSheetAppr").style.display = "inline-block";
                        }
                        else {
                            document.getElementById("expenseapproval").style.display = "none";
                            document.getElementById("divTimeSheetAppr").style.display = "none";
                        }
                    }

                    function PendingRemCount(ResourceGuid) {
                        var FinRemDatacount = "";
                        var query_cmlFinREMStatus = '<View> <Query><Where><And><Eq><FieldRef Name="FinanceId" /><Value Type="Text">' + ResourceGuid + '</Value></Eq><And><Eq><FieldRef Name="ReportStatus" /><Value Type="Text">Approved</Value></Eq><Eq><FieldRef Name="FinanceExpenseStatus" /><Value Type="Text">Approved</Value></Eq></And></And></Where></Query></view>';

                        $.ajax({
                            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeExpenceMaster')/GetItems",
                            type: "POST",
                            async: false,
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "content-Type": "application/json;odata=verbose"
                            },
                            data: JSON.stringify({
                                query: {
                                    __metadata: {
                                        type: "SP.CamlQuery"
                                    },
                                    ViewXml: query_cmlFinREMStatus
                                }
                            }),


                            success: function (data) {
                                $.each(data.d.results, function (key, value) {
                                    FinRemDatacount = data.d.results.length;

                                });

                            },
                            complete: function () {
                                if (FinRemDatacount > 0) {
                                    document.getElementById('financeRemCount').innerHTML = FinRemDatacount;
                                }
                                else {

                                    document.getElementById('financeRemCount').innerHTML = "0";
                                }
                            },
                            error: function (data) {
                                alert(data.responseJSON.error.message.value);
                                failure(data);
                            }
                        });
                    }



                </script>

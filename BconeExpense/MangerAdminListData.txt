<link rel="stylesheet" href="../SiteAssets/RMO/css/style.css">
<link rel="stylesheet" href="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseCss/jquery-ui.css">
<link rel="stylesheet" href="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseCss/sumoselect.css">
<link href="../SiteAssets/BconeExpenseCss/bootstrap.min.css" rel="stylesheet">
<link href="../SiteAssets/BconeExpenseCss/stylesheet.css" rel="stylesheet">
<link href="../SiteAssets/BconeExpenseCss/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
<link href="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseCss/select2.min.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="../SiteAssets/BconeExpenseCss/jquery.dataTables.css">
<link rel="stylesheet" href="../SiteAssets/RMO/css/buttons.dataTables.min.css">

<script src="../SiteAssets/BconeExpenseJs/jquery.min.js"></script>
<script src="../SiteAssets/BconeExpenseJs/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseCss/datepicker.css"></script>
<script type="text/javascript" src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseJs/jquery.min.js"></script>
<script type="text/javascript" src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseJs/jqueryui.js"></script>
<script type="text/javascript" src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseJs/jquery.sumoselect.js"></script>
<script type="text/javascript" language="javascript" src="../SiteAssets/BconeExpenseJs/jquery.dataTables.js"></script>
<script type="text/javascript" src="../SiteAssets/BconeExpenseJs/jquery.SPServices.min.js"></script>
<script src="../SiteAssets/BconeExpenseJs/select2.min.js"></script>
<script type="text/javascript" src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/js/ClientPeoplePicker.js"></script>

<!-- Export to excel js file start -->
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/RMO/js/dataTables.buttons.min.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/RMO/js/buttons.flash.min.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/RMO/js/jszip.min.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/RMO/js/pdfmake.min.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/RMO/js/vfs_fonts.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/RMO/js/buttons.html5.min.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/RMO/js/buttons.print.min.js"></script>
<style type="text/css">

    .ms-breadcrumb-box {
        display: none;
    }

    #s4-titlerow {
        padding-bottom: 20px;
    }

    .ms-webpartPage-root {
        border-spacing: 6px 0px;
    }

    #s4-titlerow {
        height: auto;
    }

    a, a:visited, a:active, a:link {
        text-decoration: none;
    }

        a:visited {
            color: #337ab7;
        }

    .vertical-scoll {
        margin-top: 10px;
    }

        .vertical-scoll table thead tr th {
            background: #e8e8e8;
        }

    .popup-heading {
        width: 100%;
        text-align: center;
        font-size: 15px;
        color: #fff;
        padding: 8px 0;
    }

    .alert-main .popup-heading {
        background-color: #0072c6;
    }

    .success-main .popup-heading {
        background-color: #090;
    }

    .pop-mid {
        padding: 0 15px 15px 15px;
    }

    .black-bg {
        width: 100%;
        height: 100%;
        top: 0;
        position: fixed;
        background-color: rgba(22,22,22,0.5);
        z-index: 9999;
        left: 0;
    }

    .popup-main {
        background-color: #fff;
        width: 350px;
        margin: 19% auto;
        text-align: center;
    }

    .CaptionCont SelectBox search {
        width: 300px;
        height: 30px;
    }

    .SumoSelect > .optWrapper {
        width: 300px;
    }

    .options {
        width: 300px;
    }

    .Errormsg {
        color: red;
    }

    .select-active {
        background-color: red !important;
    }
	 .dt-buttons 
	 { 

		 left: 196px; 
	 } 
	 .sp-peoplepicker-topLevel
	 {
		width: 300px;

	 }
	 

</style>
<style type="text/css" class="init">
	
	
	
	tfoot input{width:100%;padding:3px;box-sizing:border-box; font-weight: normal;}
	tfoot{display:table-header-group}
	
	//.example thead th[data-orderable="false"]{background-image:none!important;cursor:auto}
	
	//.example tbody tr td:first-child{text-align:center}.example tfoot th:first-child input[type="text"]{display:none}#innertable_wrapper .dataTables_length{float:left!important;margin:0;text-align:left}#innertable_wrapper .dataTables_filter{margin-top:0}.table-bordered{border:1px solid #ddd}.table{width:100%;max-width:100%;margin-bottom:20px;background-color:transparent;border-spacing:0;border-collapse:collapse}.table>tbody>tr>td,.table>tbody>tr>th,.table>tfoot>tr>td,.table>tfoot>tr>th,.table>thead>tr>td,.table>thead>tr>th{padding:7px;line-height:1.42857143;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>td,.table>caption+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>th,.table>thead:first-child>tr:first-child>td,.table>thead:first-child>tr:first-child>th{border-top:0}.table > thead > tr > th{text-align:center}.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border-bottom-width:2px}.table-bordered>tbody>tr>td,.table-bordered>tbody>tr>th,.table-bordered>tfoot>tr>td,.table-bordered>tfoot>tr>th,.table-bordered>thead>tr>td,.table-bordered>thead>tr>th{border:1px solid #ddd}.ms-core-pageTitle,.ms-core-pageTitle a{color:#fff;display:none}.container-fluid{padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}.btn-group-vertical>.btn-group:after,.btn-group-vertical>.btn-group:before,.btn-toolbar:after,.btn-toolbar:before,.clearfix:after,.clearfix:before,.container-fluid:after,.container-fluid:before,.container:after,.container:before,.dl-horizontal dd:after,.dl-horizontal dd:before,.form-horizontal .form-group:after,.form-horizontal .form-group:before,.modal-footer:after,.modal-footer:before,.modal-header:after,.modal-header:before,.nav:after,.nav:before,.navbar-collapse:after,.navbar-collapse:before,.navbar-header:after,.navbar-header:before,.navbar:after,.navbar:before,.pager:after,.pager:before,.panel-body:after,.panel-body:before,.row:after,.row:before{display:table;content:" ";clear:both}.row{margin-right:-15px;margin-left:-15px}.pull-left{float:left!important}.pull-right{float:right!important}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}.ms-webpartPage-root{border-spacing:0}.ms-breadcrumb-box{display:none}#siteIcon{height:45px}.ms-siteicon-img{max-height:40px}#s4-titlerow{height:45px}#login_name_contain{padding:3px 32px 3px 0 !important}table.dataTable{border-collapse:collapse}.dataTables_filter{margin-bottom:15px}.example thead tr th{background:#e8e8e8;color:#333;text-align:left;font-size:12px!important;vertical-align: middle;}.breadcrumb-new a{color:#337ab7}.breadcrumb-new a:visited{color:#337ab7!important}.breadcrumb-new .ms-link:visited{color:#337ab7!important}.example{color:#333}table.dataTable thead .sorting{font-size:13px;text-align:left}table.dataTable tbody{font-size:13px}::-webkit-input-placeholder{font-size:12px}::-moz-placeholder{font-size:12px}:-ms-input-placeholder{font-size:12px}:-moz-placeholder{font-size:12px}.dataTables_length{/*float:right!important;width:50%;text-align:right;margin:-30px 0 0*/}.dataTables_filter{display:block;width:50%;margin:0px 0 10px}.top-refine ul li{float:none;margin-bottom:10px;margin-right:8px;}.top-refine ul li:last-child{margin-bottom:0}.openDetailsMain{background:rgba(255,255,255,0.57);position:fixed;top:0;left:0;z-index:999;width:100%;height:100%;display:none}.openDetailsMainInner{width:85%;margin:60px auto;border-radius:5px;border:1px solid #0072c6;background:#fff}.openDetailsMain-heading{padding:5px 8px;background:#0072c6;font-size:14px;color:#fff;line-height:1.6}.openDetailsMain-heading a{color:#fff;float:right;cursor:pointer}.openDetailsMain-mid{padding:10px}.openDetailsMain-midTop{margin-bottom:15px}.openDetailsMain-midTop table{width:100%}.openDetailsMain-midTop table tbody tr td{padding:5px}.openDetailsMain-midTop table tbody tr th{padding:5px;text-align:left;background:#efefef;color:#333;font-weight:600}.openDetailsMain-midBottom table{margin-bottom:0!important}.openDetailsMain-midBottom table thead tr th{vertical-align:middle;background:#e8e8e8}/*.dataTables_scrollHeadInner{width:98.6% !important}.dataTables_scrollHeadInner table{width:98.6%!important}*/.wordWrap{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}table{font-size:13px!important;text-align:left!important;}label{font-weight:normal;}.innertable td{overflow:hidden;text-overflow: ellipsis;}/*.blue-btn{float: left;margin-right: 4px !important;padding: 3px 6px 3px 6px;}*/.wordellipsis{display: inline-block; cursor: pointer; text-decoration: none; display: inline-block; text-overflow: ellipsis; white-space: nowrap; max-width: 100%; overflow: hidden;}.paid{padding: 3px 5px; border-radius: 5px; margin-bottom: 0px;text-align: center; display: inline-block; padding: 2px 8px 3px 8px; background: #d9534f !important;    text-decoration: none; color: #fff; font-size: 10px; text-transform: uppercase; margin-bottom: 3px; transition: all 0.2s ease-in-out;}#login_name_contain{float: right; margin: -32px 20px 0px 0px; background: url(https://bristleconeonline.sharepoint.com/sites/pwa/SiteAssets/BconeExpenseImg/user-icon.png) no-repeat right center; padding: 2px 32px 2px 0px;}.example tbody tr td:nth-child(1){text-align: center !important;}.dataTables_scrollBody table{width: 99.99% !important;}
	</style>
<section class="middle">
<div style="text-align:right;" id="login_name_contain"></div>
    <div class="breadcrumb-new">
        <div class="container-fluid">
            <ul>
                <li>
                    <a href="https://bristleconeonline.sharepoint.com/sites/pwa/default.aspx">Home</a>
                </li>
                <li>
                    <a href="javascript:void(0)" style="cursor: default; color: black;"><span id="">Manage Expense Administration</span></a>

                </li>

            </ul>
            <div class="clearfix"></div>
        </div>
    </div>
	<div id="alertmain" class="alert-main" style="display:none" >
    <div class="black-bg" id="backcolor">
        <div class="popup-main">
            <div class="popup-heading"><span id="Alert_msg"></span></div>
            <div class="pop-mid">
                <p id="submitValue"></p>
                <input type='Button' class="divnewbtn" value="OK" onclick="close_div()" />               
            </div>
        </div>
    </div>
</div>
    <div class="container-fluid">
        <div class="row">
            <div class="top-refine" style="margin-top:5px;">
                <ul class="pull-left">
                    <li style="display:inline-block;">Select List Name
                    </li>
                    <li style="display:inline-block;">
                        <select class="resource-view" id="ddllistsName">
                            <option value="--Select--">--Select--</option>
                            <option value="BconeCurrency">Expense Currency</option>
                            <option value="BconeItemMaster">Expense Item Master</option>
                            <option value="BconeExceptionalProjects">Expense Exceptional Projects</option>
                            <option value="BconeExceptionalApprovals">Exceptional Approval and Delegation</option>
							 <option value="BconeFinanceApproverMatrix">Expense Finance Global Matrix</option>
							  <option value="BconeFinanceApproverLocationMatrix">Expense Finance India Matrix</option>
                               <option  value="BconeProxyMaster">Expense Proxy Submission</option>
							    <option  value="BconeProxyApprover">Expense Proxy Approval</option>
							  
                        </select>
                    </li>
					</ul>
					<ul class="pull-right top-refine1">
                    <li style="display:inline-block;">
                    <a href="javascript:void(0)" class="green-btn" style="display:none"  id="BtnException" onclick="Refine('Exception',this.id,'click')"><span  class="red-count"id="ExceptionCount">0</span><i class="fa fa-check" aria-hidden="true"></i>Exception</a>
					<a href="javascript:void(0)" class="blue-btn" style="display:none"  id="BtnDelegation" onclick="Refine('Delegation',this.id,'click')"><span class="red-count" id="DelegationCount">0</span><i class="fa fa-check"></i>Delegation</a>
				   
					</li>
					
					
                </ul>
					   <ul class="pull-right top-refine">
                    <li style="display:inline-block;">
                        <a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" class="Add-more mouseover_date" onclick="clearItem(this)"><i class="fa fa-plus" style="margin-right: 5px; padding: 4px 4px 3px 4px;"></i>Add New Item</a>
                   
					</li>
					
					
                </ul>
                <div class="clearfix"></div>
            </div>
            <div >

                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" style="display:none" id="tblbconeCurrency" >
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;" data-orderable="false" class="">Action</th>
                            <th style="width: 60px;">S.No</th>
                            <th>Currency</th>
                            <th style="width: 123px;">Is Active</th>
                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
                            <th>Currency</th>
                            <th >Is Active</th>
					</tfoot>
                    <tbody>
                    </tbody>
                </table>

            </div>

            <div class="">
                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" style="display:none" id="tblbconitem">
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;" data-orderable="false" class="">Action</th>
                            <th style="width: 60px;">S.No</th>
                            <th style="width: 200px;">Item Type</th>
                            <th style="width: 200px;">Item Name</th>
                            <th style="width: 123px;">SAP Account No</th>
							  <th style="width: 123px;">Is Price Quantity Dependent</th>
							  <th style="width: 123px;">Currency</th>
							    <th style="width: 123px;">Price</th>
								  <th style="width: 123px;">Quantity</th>
                            <th style="width: 123px;">Is Active</th>

                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
                          <th style="width: 200px;">Item Type</th>
                            <th style="width: 200px;">Item Name</th>
                            <th style="width: 123px;">SAP Account No</th>
							<th style="width: 123px;">Is Price Quantity Dependent</th>
							<th style="width: 123px;">Currency</th>
							    <th style="width: 123px;">Price</th>
								  <th style="width: 123px;">Quantity</th>
                            <th style="width: 123px;">Is Active</th>
					</tfoot> 
                    <tbody>
                    </tbody>
                </table>
            </div>



            <div class="">
                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" id="tblBconeExceptionalProjects" style="display:none">
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;"  data-orderable="false" class="">Action</th>
                            <th style="width: 60px;">S.No</th>
                            <th style="width: 200px;">Resource Name</th>
                            <th style="width: 200px;">Project Name</th>
							 <th style="width: 200px;">Approver</th>
							
                            <th style="width: 150px;">Start Date</th>
                            <th style="width: 150px;">Finish Date</th>
                            <th style="width: 123px;">Is Active</th>


                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
                        <th style="width: 200px;">Resource Name</th>
                            <th style="width: 200px;">Project Name</th>
							<th style="width: 123px;">Approver</th>
                            <th style="width: 150px;">Start Date</th>
                            <th style="width: 150px;">Finish Date</th>
                            <th style="width: 123px;">Is Active</th>
					</tfoot> 
                    <tbody>
                    </tbody>
                </table>
            </div>
   <div class="">
                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" id="tblbconeexeceptionalApprovals" style="display:none">
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;" >Action</th>
                            <th style="width: 60px;">S.No</th>
                            <th style="width: 400px;">Project Name</th>
                            <th style="width: 91px;">Action Type</th>
							<th style="width: 91px;">Resource Name</th>
							<th style="width: 91px;">Approver1 Name</th>
							<th style="width: 91px;">Approver2 Name</th>
							<th style="width: 91px;">Delegation From</th>
							<th style="width: 91px;">Delegation To</th>
                            <th style="width: 91px;">Applicable For Expense</th>
                            <th style="width: 91;">Applicable For TimeSheet</th>
							<th style="width: 160px;">Start Date</th>
							<th style="width: 160px;">Finish Date</th>
                            <th style="width: 91px;">Is Active</th>
							<th style="width: 91px;">Delegation Status</th>
							<th style="width: 91px;">Delegation Date</th>
							

                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
                       <th style="width: 400px;">Project Name</th>
                            <th style="width: 91px;">Action Type</th>
							<th style="width: 91px;">Resource Name</th>
							<th style="width: 91px;">Approver1 Name</th>
							<th style="width: 91px;">Approver2 Name</th>
							<th style="width: 91px;">Delegation From</th>
							<th style="width: 91px;">Delegation To</th>
                            <th style="width: 91px;">Applicable For Expense</th>
                            <th style="width: 91px;">Applicable For TimeSheet</th>
							<th style="width: 160px;">Start Date</th>
							<th style="width: 160px;">Finish Date</th>
                            <th style="width: 91px;">Is Active</th>
							<th style="width: 91px;">Delegation Status</th>
							<th style="width: 91px;">Delegation Date</th>
					</tfoot> 
                    <tbody>
                    </tbody>
                </table>
            </div>
            <div class="">
                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" id="tblBconeExpenseFinanceGlobalMatrix" style="display:none">
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;" data-orderable="false" class="" >Action</th>
                            <th style="width: 60px;">S.No</th>
                            <th style="width: 400px;">CountryLegal</th>
                            <th style="width: 91px;">FinanceApproverName</th>
                            <th style="width: 91px;">FinanceApproverName2</th>
                            

                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
                              <th style="width: 400px;">CountryLegal</th>
                            <th style="width: 91px;">FinanceApproverName</th>
                            <th style="width: 91px;">FinanceApproverName2</th>
					</tfoot> 
                    <tbody>
                    </tbody>
                </table>
            </div>
			   <div class="">
                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" id="tblBconeExpenseFinanceIndiaMatrix" style="display:none">
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;" data-orderable="false" class="" >Action</th>
                            <th style="width: 60px;">S.No</th>
                            <th style="width: 400px;">Employee Base Location</th>
                            <th style="width: 91px;">FinanceApproverName</th>
                            <th style="width: 91px;">FinanceApproverName2</th>
							 <th style="width: 91px;">Currency</th>
                            

                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
                              <th style="width: 400px;">Employee Base Location</th>
                            <th style="width: 91px;">FinanceApproverName</th>
                            <th style="width: 91px;">FinanceApproverName2</th>
							<th style="width: 91px;">Currency</th>
					</tfoot> 
                    <tbody>
                    </tbody>
                </table>
            </div>
          <div >

                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" style="display:none" id="tblBconeProxyMaster" >
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;" data-orderable="false" class="">Action</th>
                            <th style="width: 60px;">S.No</th>
							<th>Proxy Submitter Name</th>
                            <th>Original Submitter Name</th>							
							
                            <th style="width: 123px;">Is Active</th>
                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
							<th>Proxy Submitter Name</th>
                            <th>Original Submitter Name</th>						
						
                            <th >Is Active</th>
					</tfoot>
                    <tbody>
                    </tbody>
                </table>

            </div>
 <div >

                <table class="table table-striped table-bordered dataTable no-footer bgcolorrow" style="display:none" id="tblBconeProxyMasterApproval" >
                    <thead>
                        <tr>
                            <th style="width: 84px;text-align:left;" data-orderable="false" class="">Action</th>
                            <th style="width: 60px;">S.No</th>
							<th>Proxy Approver Name</th>
                            <th>Original Approver Name</th>	
                            						
						
                            <th style="width: 123px;">Is Active</th>
                        </tr>
                    </thead>
					<tfoot>
					<th ></th>
                            <th >S.No</th>
							<th>Proxy Approver Name</th>
                            <th>Original Approver Name</th>
                           								
                           								
							
                            <th >Is Active</th>
					</tfoot>
                    <tbody>
                    </tbody>
                </table>

            </div>

        </div>
    </div>
</section>


<div id="myModal" class="modal fade textwidth in" role="dialog" data-backdrop="static" data-keyboard="false" aria-hidden="true" style="display: none; padding-left: 17px;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"  value=""><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title" id="hheader">Add New Item</h4>
            </div>
            <div class="modal-body">
                <table id="tblbconeCurrency123">
                    <tbody>
                        <tr id="tr1">
                            <td>Currency <sup id="Sup1" style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="divbcCurrency" class="Amount-right-side">
                                    <input type="text" id="bccurrency" class="form-control ClearMsg" onkeyup="hideerror('Txtamttaken')">
                                    <span class="amt-right-text" style="color: #ababab;" id="Span2"></span>
                                </div>
                            </td>
                        </tr>
                        <tr style="display: none;" class="subRow">

                            <td style="width: 195px;">Currency<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span1"></span></sup></td>
                            <td>

                                <input type="text" id="bccurrencys" class="form-control">

                                <select class="form-control" style="display: none;" id="Select1" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>

                        <tr>
                            <td>IsActive<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="radiobuttons" class="radio-main ClearMsg">

                                    <input type="radio" id="rdactiveyes" name="Actives" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="rdactiveno" name="Actives" value="No" style="cursor: pointer">No
                                    
                                </div>

                            </td>
                        </tr>
                        <tr style="display: none;" class="subRow">
                            <td style="vertical-align: top;">Select Project<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>


                                <select class="form-control" id="ddlProjects" onchange="hideerror(this.id); setProjectManager(this.id)">
                                    <option value="0">Select Project</option>
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">9112-Expense Workflow Testing</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">Test Project Flow</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">436 - Srikanta Expense test</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">21122016 - Expense flow Test</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">Demo Project</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">Test Integration phase 2</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">PPM Implementation Plan</option>
                                </select>


                            </td>
                        </tr>

                        <tr style="display: none;" class="subRow">

                            <td style="width: 195px;">Expense Approver Name<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Role_assign"></span></sup></td>
                            <td>

                                <input type="text" id="txtProManager" class="form-control" readonly="readonly">

                                <select class="form-control" style="display: none;" id="ddlProjectsmanager" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>

                        <tr id="trreporter" style="display: none;" class="subRow">

                            <td style="width: 195px;">Expense Report Name<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;">(Max 256 character allowed)</sup></td>
                            <td>
                                <input type="text" id="Txtexpensereport" onkeyup="hideerror('Txtexpensereport')" class="form-control">
                            </td>
                        </tr>
                        <tr id="trdescription" style="display: none;" class="subRow">
                            <td style="vertical-align: top;">Description<!--<sup style="color: #f00; font-size: 14px;">*</sup>--><br>
                                <sup style="color: #ababab; font-size: 12px;">(Max 1000 character allowed)</sup></td>
                            <td>


                                <textarea rows="4" cols="45" id="TxtDescription" onkeyup="hideerror('TxtDescription')"></textarea>



                            </td>
                        </tr>



                        <tr id="trradio" style="display: none;" class="subRow">
                            <td>Have you taken Advance<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="advance" class="radio-main">
                                    <!-- <select class="form-control" id="ddladvancetaken" onchange="hideerror1(this.id)">
									<option value="No">No</option>
                                        <option value="Yes">Yes</option>
                                    </select> -->


                                    <input type="radio" name="advance" value="Yes">
                                    Yes
									<input type="radio" name="advance" value="No">
                                    No
                                    
                                </div>

                            </td>
                        </tr>



                        <tr id="trcurrency" style="display: none;" class="subRow">
                            <td>Currency<sup id="currency_validation_star" style="color: #f00; font-size: 14px; display: none;">*</sup></td>
                            <td>
                                <select class="form-control" id="currency" onchange="hideerror1(this.id)" disabled="disabled">
                                    <option>Select</option>

                                    <option value="1">INR - Indian Rupee</option>
                                    <option value="3">USD - US Dollar</option>
                                    <option value="4">EUR - Euro</option>
                                    <option value="5">AUD - Australian Dollar</option>
                                    <option value="6">BDT - Bangladeshi Taka</option>
                                    <option value="7">GBP - British Pound</option>
                                    <option value="8">CAD - Canadian Dollar</option>
                                    <option value="29">YNR</option>
                                </select>
                            </td>
                        </tr>

                        <tr id="trAdvance" style="display: none;" class="subRow">
                            <td>Advance Amount Taken <sup id="amount_validation_star" style="color: #f00; font-size: 14px; display: none;">*</sup></td>
                            <td>
                                <div class="Amount-right-side">
                                    <input type="text" id="Txtamttaken" class="form-control" onkeyup="hideerror('Txtamttaken')" readonly="readonly">
                                    <span class="amt-right-text" style="color: #ababab;" id="currencyspan"></span>
                                </div>
                            </td>
                        </tr>

                        <tr id="tralert" style="display: none;" class="subRow">
                            <td></td>
                            <td>
                                <span id="AlertMsg" style="color: red;"></span>
                                <span id="user_id" style="display: none;">18</span>
                                <span id="user_name" style="display: none;">SPDevAdmin</span>
                                <span id="resourse_id" style="display: none;">3254a933-ed7b-e611-80cd-00155d044114</span>
                                <span id="ClientPartnerEmployeeId" style="display: none;"></span>
                                <span id="ClientPartnerEmployeeName" style="display: none;"></span>
                                <span id="Span3"></span>

                                <span id="ReportingManager" style="display: none;"></span>
                                <span id="ReportingManagerGuid" style="display: none;"></span>
                                <span id="ReportingManagerName" style="display: none;"></span>
                                <span id="EmpBaseLocation" style="display: none;">Pune</span>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg"></span></td>
                        </tr>
                        <tr id="add_tr">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="btnSubmit" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
                </table>

                <table id="tblbconitemmaster">
                    <tbody>

                        <tr>
                            <td style="vertical-align: top;">ItemType<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <select class="form-control ClearMsg" id="ddlItemtype" onchange="hideerror(this.id); ChangeItemtype()">
                                    <option value="Expense Item">Expense Item</option>
                                    <option value="payment type">Payment Type</option>
                                </select>
                                <!--<option value="0219e8ba-57c0-e611-80d1-00155d003b1b">9112-Expense Workflow Testing</option><option value="17f6132d-50c8-e611-80d4-00155d00c616">Test Project Flow</option><option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">436 - Srikanta Expense test</option><option value="a94ee96a-d0bd-e611-80d9-00155d047620">21122016 - Expense flow Test</option><option value="dc1d9a49-6485-e611-80d1-00155d049e22">Demo Project</option><option value="72eb9451-65c0-438a-9c00-0ed404e144b8">Test Integration phase 2</option><option value="ced28286-c399-e611-a918-8086f26f95d1">PPM Implementation Plan</option></select>	-->


                            </td>
                        </tr>

                        <tr>
                            <td style="width: 195px;">Item<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span5"></span></sup></td>
                            <td>

                                <input type="text" id="tbitem" class="form-control ClearMsg">

                                <select class="form-control" style="display: none;" id="Select2" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>
                         <tr id="IsPriceQuantDependent">
                            <td>Is Price Quantity Dependent<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="itemIsPQDependant" class="radio-main">

                                    <input type="radio" id="divitemIsPQDependantyes" name="itemIsPQDependant" style="cursor: pointer" value="Yes" >Yes
									<input type="radio" id="divitemIsPQDependantno" name="itemIsPQDependant" value="No" style="cursor: pointer">No
                                    
                                </div>

                            </td>
                        </tr>
						
						 <tr id="Tr_Price" style="display:none">
                            <td style="width: 195px;">Price<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span5"></span></sup></td>
                            <td>

                                <input type="text" id="tbitemPrice"  onkeypress="return fun_AllowOnlyAmountAndDot(this.id,event)"  class="form-control ClearMsg">

                            </td>
                        </tr>
						 <tr id="Tr_ItemCurrencydd" style="display:none">
                            <td style="width: 195px;">Currency<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span5"></span></sup></td>
                            <td>
                                  <select class="form-control ClearMsg" id="DDItemCurrency" onchange="hideerror(this.id)"  >
                                  </select>
                            </td>
                        </tr>
						 <tr id="Tr_Quantity" style="display:none">
                            <td style="width: 195px;">Quantity<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span5"></span></sup></td>
                            <td>

                                <input type="text" id="tbitemQuantity"  onkeypress="return isNumber(event)"  maxlength="4" class="form-control ClearMsg">

                            </td>
                        </tr>
                       

                        <tr>

                            <td style="width: 195px;">SAPAccNO<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span20"></span></sup></td>
                            <td>

                                <input type="text" id="tbitemAccno" class="form-control ClearMsg">

                                <select class="form-control" style="display: none;" id="Select7" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>
						 <tr>
                            <td>IsActive<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="divitemisactive" class="radio-main ClearMsg">

                                    <input type="radio" id="tbitemactiveyes" name="itemActives" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="tbitemactiveno" name="itemActives" value="No" style="cursor: pointer">No
                                    
                                </div>

                            </td>
                        </tr>
                        <tr style="display: none;" class="subRow">
                            <td style="vertical-align: top;">Select Project<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>


                                <select class="form-control" id="Select3" onchange="hideerror(this.id); setProjectManager(this.id)">
                                    <option value="0">Select Project</option>
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">9112-Expense Workflow Testing</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">Test Project Flow</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">436 - Srikanta Expense test</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">21122016 - Expense flow Test</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">Demo Project</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">Test Integration phase 2</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">PPM Implementation Plan</option>
                                </select>


                            </td>
                        </tr>

                        <tr style="display: none;" class="subRow">

                            <td style="width: 195px;">Expense Approver Name<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span6"></span></sup></td>
                            <td>

                                <input type="text" id="Text3" class="form-control" readonly="readonly">

                                <select class="form-control" style="display: none;" id="Select4" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>

                        <tr id="tr3" style="display: none;" class="subRow">

                            <td style="width: 195px;">Expense Report Name<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;">(Max 256 character allowed)</sup></td>
                            <td>
                                <input type="text" id="Text4" onkeyup="hideerror('Txtexpensereport')" class="form-control">
                            </td>
                        </tr>
                        <tr id="tr4" style="display: none;" class="subRow">
                            <td style="vertical-align: top;">Description<!--<sup style="color: #f00; font-size: 14px;">*</sup>--><br>
                                <sup style="color: #ababab; font-size: 12px;">(Max 1000 character allowed)</sup></td>
                            <td>


                                <textarea rows="4" cols="45" id="Textarea1" onkeyup="hideerror('TxtDescription')"></textarea>



                            </td>
                        </tr>



                        <tr id="tr5" style="display: none;" class="subRow">
                            <td>Have you taken Advance<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="Div2" class="radio-main">
                                    <!-- <select class="form-control" id="ddladvancetaken" onchange="hideerror1(this.id)">
									<option value="No">No</option>
                                        <option value="Yes">Yes</option>
                                    </select> -->


                                    <input type="radio" name="advance" value="Yes">
                                    Yes
									<input type="radio" name="advance" value="No">
                                    No
                                    
                                </div>

                            </td>
                        </tr>



                        <tr id="tr6" style="display: none;" class="subRow">
                            <td>Currency<sup id="Sup3" style="color: #f00; font-size: 14px; display: none;">*</sup></td>
                            <td>
                                <select class="form-control" id="Select5" onchange="hideerror1(this.id)" disabled="disabled">
                                    <option>Select</option>

                                    <option value="1">INR - Indian Rupee</option>
                                    <option value="3">USD - US Dollar</option>
                                    <option value="4">EUR - Euro</option>
                                    <option value="5">AUD - Australian Dollar</option>
                                    <option value="6">BDT - Bangladeshi Taka</option>
                                    <option value="7">GBP - British Pound</option>
                                    <option value="8">CAD - Canadian Dollar</option>
                                    <option value="29">YNR</option>
                                </select>
                            </td>
                        </tr>

                        <tr id="tr7" style="display: none;" class="subRow">
                            <td>Advance Amount Taken <sup id="Sup4" style="color: #f00; font-size: 14px; display: none;">*</sup></td>
                            <td>
                                <div class="Amount-right-side">
                                    <input type="text" id="Text5" class="form-control" onkeyup="hideerror('Txtamttaken')" readonly="readonly">
                                    <span class="amt-right-text" style="color: #ababab;" id="Span7"></span>
                                </div>
                            </td>
                        </tr>

                        <tr id="tr8" style="display: none;" class="subRow">
                            <td></td>
                            <td>
                                <span id="Span8" style="color: red;"></span>
                                <span id="Span9" style="display: none;">18</span>
                                <span id="Span10" style="display: none;">SPDevAdmin</span>
                                <span id="Span11" style="display: none;">3254a933-ed7b-e611-80cd-00155d044114</span>
                                <span id="Span12" style="display: none;"></span>
                                <span id="Span13" style="display: none;"></span>
                                <span id="Span14"></span>

                                <span id="Span15" style="display: none;"></span>
                                <span id="Span16" style="display: none;"></span>
                                <span id="Span17" style="display: none;"></span>
                                <span id="Span18" style="display: none;">Pune</span>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg"></span></td>
                        </tr>
                        <tr id="Tr9">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="A1" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
                </table>

                <table id="tblbconeexceptional">
                    <tbody>
                        <tr>
                            <td>Resource Name <sup id="Sup18" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side bgclr">
                                    <select class="search-box resourceColor ClearMsg testSelAll" id="ddlexceresourcename" style="padding-bottom: 0px; padding-top: 0px; width: 300px;" multiple>
                                    </select>
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <td>Project Name <sup id="Sup19" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side" id="ddlexceprojectname_div">
                                    <select class="search-box ClearMsg testSelAll" id="ddlexceprojectname" style="padding-bottom: 0px; padding-top: 0px; width: 300px;" multiple>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Approver<sup id="Sup20" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <select class="form-control ClearMsg" id="ddlProjectApprover" onchange="getapprover()" style="padding-bottom: 0px; padding-top: 0px; width: 300px;">
                                    <option value="0">--Select--</option>
                                    <option value="1">Project Manager</option>
                                    <option value="2">Reporting Manager</option>
									<option value="3">Other</option>
                                </select>
                            </td>
                        </tr>
                       <tr id="ExpApprover" style="display:none">
                            <td> Approver Name<sup id="Sup19" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side" id="ddlExpApprover_div">
                           <select class="form-control ClearMsg" id="ddlExpApprover" style="padding-bottom: 0px; padding-top: 0px; width: 300px;">
                                 <div>  
                                </select>
                            </td>
                        </tr>
                        <tr>

                            <td style="width: 195px;">Start Date <sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span4"></span></sup></td>
                            <td>

                                <input type="text" id="Tbexcestartdate" class="form-control ClearMsg" readonly="true">

                                <select class="form-control" style="display: none;" id="Select8" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>
                        <tr>

                            <td style="width: 195px;">End Date <sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span22"></span></sup></td>
                            <td>

                                <input type="text" id="Tbexcdate" class="form-control ClearMsg" readonly="true">

                                <select class="form-control" style="display: none;" id="Select24" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>
                        <tr>
                            <td>IsActive<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="Div1" class="radio-main ClearMsg">

                                    <input type="radio" id="Radio1" name="ExActives" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="Radio2" name="ExActives" value="No" style="cursor: pointer">No
                                    
                                </div>

                            </td>
                        </tr>
                        <tr style="display: none;" class="subRow">

                            <td style="width: 195px;">Allocatedprojectcode<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span21"></span></sup></td>
                            <td>

                                <input type="text" id="tbExallocated" class="form-control">

                                <select class="form-control" style="display: none;" id="Select6" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>


                        <tr style="display: none;" class="subRow">

                            <td style="width: 195px;">Start Date Time<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span36"></span></sup></td>
                            <td>

                                <input type="text" id="tbexstrdate" class="form-control" readonly="true">

                                <select class="form-control" style="display: none;" id="Select12" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>

                        <tr style="display: none;" class="subRow">

                            <td style="width: 195px;">Finish Date Time<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span37"></span></sup></td>
                            <td>

                                <input type="text" id="tbexfnsdate" class="form-control" readonly="true">

                                <select class="form-control" style="display: none;" id="Select13" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>

                            </td>
                        </tr>
                        <tr style="display: none;" class="subRow">
                            <td style="vertical-align: top;">Select Project<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>


                                <select class="form-control" id="Select9" onchange="hideerror(this.id); setProjectManager(this.id)">
                                    <option value="0">Select Project</option>
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">9112-Expense Workflow Testing</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">Test Project Flow</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">436 - Srikanta Expense test</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">21122016 - Expense flow Test</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">Demo Project</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">Test Integration phase 2</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">PPM Implementation Plan</option>
                                </select>


                            </td>
                        </tr>

                        <tr style="display: none;" class="subRow">

                            <td style="width: 195px;">Expense Approver Name<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span23"></span></sup></td>
                            <td>

                                <input type="text" id="Text7" class="form-control" readonly="readonly">

                                <select class="form-control" style="display: none;" id="Select10" onchange="hideerror1(this.id)">
                                    <option value="0219e8ba-57c0-e611-80d1-00155d003b1b">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="17f6132d-50c8-e611-80d4-00155d00c616">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="7a9b8fbd-f2b5-e611-80d0-00155d042916">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="a94ee96a-d0bd-e611-80d9-00155d047620">ProjectManager PPM|d8221044-ed7b-e611-80ce-00155d04851d|43176db1-ba83-e611-80d1-00155d04851d|Executive PPM</option>
                                    <option value="dc1d9a49-6485-e611-80d1-00155d049e22">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="72eb9451-65c0-438a-9c00-0ed404e144b8">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                    <option value="ced28286-c399-e611-a918-8086f26f95d1">SPDevAdmin|3254a933-ed7b-e611-80cd-00155d044114|d8221044-ed7b-e611-80ce-00155d04851d|ProjectManager PPM</option>
                                </select>


                            </td>
                        </tr>

                        <tr id="tr10" style="display: none;" class="subRow">

                            <td style="width: 195px;">Expense Report Name<sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;">(Max 256 character allowed)</sup></td>
                            <td>
                                <input type="text" id="Text8" onkeyup="hideerror('Txtexpensereport')" class="form-control">
                            </td>
                        </tr>
                        <tr id="tr11" style="display: none;" class="subRow">
                            <td style="vertical-align: top;">Description<!--<sup style="color: #f00; font-size: 14px;">*</sup>--><br>
                                <sup style="color: #ababab; font-size: 12px;">(Max 1000 character allowed)</sup></td>
                            <td>


                                <textarea rows="4" cols="45" id="Textarea2" onkeyup="hideerror('TxtDescription')"></textarea>



                            </td>
                        </tr>



                        <tr id="tr12" style="display: none;" class="subRow">
                            <td>Have you taken Advance<sup style="color: #f00; font-size: 14px;">*</sup></td>
                            <td>
                                <div id="Div3" class="radio-main">
                                    <!-- <select class="form-control" id="ddladvancetaken" onchange="hideerror1(this.id)">
									<option value="No">No</option>
                                        <option value="Yes">Yes</option>
                                    </select> -->


                                    <input type="radio" name="advance" value="Yes">
                                    Yes
									<input type="radio" name="advance" value="No">
                                    No
                                    
                                </div>

                            </td>
                        </tr>



                        <tr id="tr13" style="display: none;" class="subRow">
                            <td>Currency<sup id="Sup5" style="color: #f00; font-size: 14px; display: none;">*</sup></td>
                            <td>
                                <select class="form-control" id="Select11" onchange="hideerror1(this.id)" disabled="disabled">
                                    <option>Select</option>

                                    <option value="1">INR - Indian Rupee</option>
                                    <option value="3">USD - US Dollar</option>
                                    <option value="4">EUR - Euro</option>
                                    <option value="5">AUD - Australian Dollar</option>
                                    <option value="6">BDT - Bangladeshi Taka</option>
                                    <option value="7">GBP - British Pound</option>
                                    <option value="8">CAD - Canadian Dollar</option>
                                    <option value="29">YNR</option>
                                </select>
                            </td>
                        </tr>

                        <tr id="tr14" style="display: none;" class="subRow">
                            <td>Advance Amount Taken <sup id="Sup6" style="color: #f00; font-size: 14px; display: none;">*</sup></td>
                            <td>
                                <div class="Amount-right-side">
                                    <input type="text" id="Text9" class="form-control" onkeyup="hideerror('Txtamttaken')" readonly="readonly">
                                    <span class="amt-right-text" style="color: #ababab;" id="Span24"></span>
                                </div>
                            </td>
                        </tr>

                        <tr id="tr15" style="display: none;" class="subRow">
                            <td></td>
                            <td>
                                <span id="Span25" style="color: red;"></span>
                                <span id="Span26" style="display: none;">18</span>
                                <span id="Span27" style="display: none;">SPDevAdmin</span>
                                <span id="Span28" style="display: none;">3254a933-ed7b-e611-80cd-00155d044114</span>
                                <span id="Span29" style="display: none;"></span>
                                <span id="Span30" style="display: none;"></span>
                                <span id="Span31"></span>

                                <span id="Span32" style="display: none;"></span>
                                <span id="Span33" style="display: none;"></span>
                                <span id="Span34" style="display: none;"></span>
                                <span id="Span35" style="display: none;">Pune</span>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg"></span></td>
                        </tr>
                        <tr id="Tr16">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="A2" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
                </table>

                <table id="tblexceptionalapprovals">
                    <tbody>


                        <tr>
                            <td>Action Type <sup id="Sup2" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                    <select class="form-control ClearMsg" style="width: 300px" id="ddlactiontypeEA" onchange="changeactiontype()">
                                        <option value="0">--Select--</option>
                                        <option value="0">Delegation</option>
                                        <option value="0">Exception</option>

                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr id="gen1">
                            <td>Project Name <sup id="Sup7" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side" id="ddlprojectnameEA_div">
                                    <select class="search-box form-control ClearMsg testSelAll1" id="ddlprojectnameEA" style="padding-bottom: 0px; padding-top: 0px; width: 300px;" multiple>
                                    </select>
                                </div>
                            </td>
                        </tr>

                        <tr id="Ex1">
                            <td>Resource Name <sup id="Sup8" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                    <select class="search-box form-control ClearMsg testSelAll1" id="ddlresourcenameEA" style="padding-bottom: 0px; padding-top: 0px; width: 300px;" multiple>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr id="Del1">
                            <td>Deligate From Name <sup id="Sup9" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side" id="ddldeligatefromnameEA_div">
                                    <select class="form-control ClearMsg" id="ddldeligatefromnameEA" style="padding-bottom: 0px; padding-top: 0px; width: 300px;">
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr id="Del2">
                            <td>Deligate To Name <sup id="Sup10" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side" id="ddldeligatetonameEA_div">
                                    <select class="form-control ClearMsg" id="ddldeligatetonameEA" style="padding-bottom: 0px; padding-top: 0px; width: 300px;">
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr id="Ex2">
                            <td>Approver 1 Name <sup id="Sup11" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side" id="ddlapprover1nameEA_div" >
                                    <select class="form-control ClearMsg" id="ddlapprover1nameEA" style="padding-bottom: 0px; padding-top: 0px; width: 300px;">
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr id="Ex3">
                            <td>Approver 2 Name <sup id="Sup12" style="color: #f00; font-size: 14px;"></sup>
                            </td>
                            <td>
                                <div  class="Amount-right-side" id="ddlapprover2nameEA_div">
                                    <select class="form-control ClearMsg" id="ddlapprover2nameEA" style="padding-bottom: 0px; padding-top: 0px; width: 300px;">
                                    </select>
									
                                </div>
                            </td>
                        </tr>
                        <tr id="gen2">
                            <td>Applicable for Expense <sup id="Sup13" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div id="exceptionappExp" class="radio-main ClearMsg">
                                    <input type="radio" id="rdexpenseyesEA" name="forexpensemodule" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="rdexpensenoEA" name="forexpensemodule" value="No" style="cursor: pointer">No
                                </div>
                            </td>
                        </tr>
                        <tr id="gen3">
                            <td>Applicable for Time Sheet <sup id="Sup14" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div id="exceptioappTMSheet" class="radio-main ClearMsg">
                                    <input type="radio" id="rdtimesheetyesEA" name="forexpensemodule1" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="rdtimesheetnoEA" name="forexpensemodule1" value="No" style="cursor: pointer">No
                                </div>
                            </td>
                        </tr>
                        <tr id="Del3">
                            <td>Start Date <sup id="Sup15" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                    <input type="text" id="txtstartdateEA" class="form-control ClearMsg" readonly="true">
                                </div>
                            </td>
                        </tr>
                        <tr id="Del4">
                            <td>Finish Date <sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                    <input type="text" id="txtfinishdateEA" class="form-control ClearMsg" readonly="true">
                                </div>
                            </td>
                        </tr>

                        <tr id="gen4">
                            <td>IsActive <sup id="Sup17" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div id="exceptionappIsActive" class="radio-main ClearMsg">
                                    <input type="radio" id="rdisactiveyesEA" name="forexpensemodule2" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="rdisactiveenoEA" name="forexpensemodule2" value="No" style="cursor: pointer">No
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg"></span></td>
                        </tr>
                        <tr id="gen5">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="A3" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
                </table>
				<table id="tblBconeExpenseFinanceGlobalMatrix123">
                    <tbody>

                        
						<tr >
                            <td>Country Legal<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <input type="text" id="txtcountrylegal" class="form-control ClearMsg" > 
                                </div>
								 
                            </td>
                        </tr>
                        <tr id="Del4">
                            <td>Approver Name<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="peoplePickerDiv"></div>
                            </td>
                        </tr>
						<tr id="Del4">
                            <td>Approver Name2<sup id="Sup16" style="color: #f00; font-size: 14px;"></sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="FinancepeoplePickerDiv"></div>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg" ></span></td>
                        </tr>
                        <tr id="gen5">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="A3" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
					<table id="tblBconeExpenseFinanceIndiaMatrix123">
                    <tbody>

                        
						<tr >
                            <td>Employee Base Location<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <input type="text" id="txtEmpBaseLocation" class="form-control ClearMsg" style="width: 280px" > 
                                </div>
								 
                            </td>
                        </tr>
                        <tr id="Del4">
                            <td>Approver Name<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="peoplePickerDiv1"></div>
                            </td>
                        </tr>
						 <tr>
                            <td>Currency<sup id="Sup2" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                    <select class="form-control ClearMsg" style="width: 280px;margin: 0px 0px -1px 0px " id="ddlCurrency" >
                                       
                                        <option value="Other">Other</option>
                                        <option value="INR">INR</option>

                                    </select>
                                </div>
                            </td>
                        </tr>
						 <tr id="Del4">
                            <td>Approver Name2<sup id="Sup16" style="color: #f00; font-size: 14px;"></sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="peoplePickerDiv10"></div>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg" ></span></td>
                        </tr>
                        <tr id="gen5">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="A3" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
					
                </table>
				<table id="tblBconeProxyMaster123">
                    <tbody>

                        
						
                        <tr id="Del4">
                            <td>Proxy Submitter Name<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="peoplePickerDiv2"></div>
                            </td>
                        </tr>
						 <tr id="Del4">
                            <td>Original Submitter Name<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="peoplePickerDiv3"></div>
                            </td>
                        </tr>
						 <tr style="display:none;">

                            <td style="width: 195px;">Proxy Till Date <sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span4"></span></sup></td>
                            <td>

                                <input type="text" id="TBProxyDate" class="form-control ClearMsg" readonly="true">
                            </td>
                        </tr>
						<tr id="gen4">
                            <td>IsActive <sup id="Sup17" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div id="proxyIsActive" class="radio-main ClearMsg">
                                    <input type="radio" id="proxyyesEA" name="forexpensemodule2proxy" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="proxynoEA" name="forexpensemodule2proxy" value="No" style="cursor: pointer">No
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg" ></span></td>
                        </tr>
                        <tr id="gen5">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="A3" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
					</table>
					<table id="tblBconeProxyMasterApproval123">
                    <tbody>

                        
						
                        <tr id="Del4">
                            <td>Proxy Approver Name<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="peoplePickerDiv4"></div>
                            </td>
                        </tr>
						 <tr id="Del4">
                            <td>Original Approver Name<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div class="Amount-right-side">
                                  <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > -->
                                </div>
								 <div id="peoplePickerDiv5"></div>
                            </td>
                        </tr>
						<!-- <tr id="Del4"> -->
                            <!-- <td>Approval Type<sup id="Sup16" style="color: #f00; font-size: 14px;">*</sup> -->
                            <!-- </td> -->
                            <!-- <td> -->
                                <!-- <div class="Amount-right-side"> -->
                                  <!-- <!--   <input type="text" id="txtApproverNameMatrix" class="form-control ClearMsg" > --> 
                                <!-- </div> -->
								 <!-- <select class="form-control ClearMsg" style="width: 300px" id="ddlApproval" > -->
                                        <!-- <option value="0">Select Approval </option> -->
                                        <!-- <option value="Manager Approval">Manager Approval</option> -->
                                        <!-- <option value="Finance Approval">Finance Approval</option> -->

                                    <!-- </select> -->
                            <!-- </td> -->
                        <!-- </tr> -->
						 <tr style="display:none;">

                            <td style="width: 195px;">Proxy Till Date <sup style="color: #f00; font-size: 14px;">*</sup><br>
                                <sup style="color: #ababab; font-size: 12px;"><span id="Span4"></span></sup></td>
                            <td>

                                <input type="text" id="TBProxyDateApproval" class="form-control ClearMsg" readonly="true">
                            </td>
                        </tr>
						<tr id="gen4">
                            <td>IsActive <sup id="Sup17" style="color: #f00; font-size: 14px;">*</sup>
                            </td>
                            <td>
                                <div id="proxyApprovalIsActive" class="radio-main ClearMsg">
                                    <input type="radio" id="proxyApprovalyesEA" name="forexpensemodule2proxy" style="cursor: pointer" value="Yes">Yes
									<input type="radio" id="proxyApprovalnoEA" name="forexpensemodule2proxy" value="No" style="cursor: pointer">No
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><span class="Errormsg" ></span></td>
                        </tr>
                        <tr id="gen5">
                            <td></td>
                            <td>
                                <a href="javascript:void(0)" class="blue-btn" id="A3" onclick="CheckStatus();"><span class="in-stock">Save</span></a>

                                <a href="javascript:void(0)" class="gray-btn" data-dismiss="modal">Cancel</a>

                            </td>
                        </tr>

                    </tbody>
					</table>
            </div>

        </div>
    </div>
</div>

<div id="Confirmation_alert" class="alert-main" style="display: none;">
    <div class="black-bg" id="backcolor">
        <div class="popup-main">
            <div class="popup-heading"><span id="Confirmation_msg">Are you sure you want To Delete item ?</span></div>
            <div class="pop-mid">
                <br>
                <input type="Button" class="divnewbtn" value="OK" id="ok_click" onclick="hidealert();">
                <input type="Button" class="divnewbtn" value="Cancel" onclick="hidealert();">
            </div>
        </div>
    </div>
</div>
 <div class="loader"></div>

<style type="text/css">
    .ms-breadcrumb-box {
        display: none;
    }

    #s4-titlerow {
        padding-bottom: 20px;
    }

    .ms-webpartPage-root {
        border-spacing: 6px 0px;
    }

    #s4-titlerow {
        height: auto;
    }

    a, a:visited, a:active, a:link {
        text-decoration: none;
    }

        a:visited {
            color: #337ab7;
        }

    .vertical-scoll {
        margin-top: 10px;
    }

        .vertical-scoll table thead tr th {
            background: #e8e8e8;
        }

    .popup-heading {
        width: 100%;
        text-align: center;
        font-size: 15px;
        color: #fff;
        padding: 8px 0;
    }

    .alert-main .popup-heading {
        background-color: #0072c6;
    }

    .success-main .popup-heading {
        background-color: #090;
    }

    .pop-mid {
        padding: 0 15px 15px 15px;
    }

    .black-bg {
        width: 100%;
        height: 100%;
        top: 0;
        position: fixed;
        background-color: rgba(22,22,22,0.5);
        z-index: 9999;
        left: 0;
    }

    .popup-main {
        background-color: #fff;
        width: 350px;
        margin: 19% auto;
        text-align: center;
    }

    .CaptionCont SelectBox search {
        width: 300px;
        height: 30px;
    }

    .SumoSelect > .optWrapper {
        width: 300px;
    }

    .options {
        width: 300px;
    }
</style>






<script>
    $(function () {
        $("#tbtimesheetstartdate").datepicker(
        {
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
        $("#Tbexcdate").datepicker({
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
        $("#Tbexcestartdate").datepicker({
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
        $("#tbtimesheetfinishdate").datepicker({
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
        $("#txtstartdateEA").datepicker({
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
        $("#txtfinishdateEA").datepicker({
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
		 $("#TBProxyDate").datepicker({
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
		$("#TBProxyDateApproval").datepicker({
            dateFormat: "dd-M-yy",
            changeMonth: true,
            changeYear: true,
        });
        //Tbexcestartdate
        //Tbexcdate
    });

    function showalert() {
        $('#Confirmation_alert').show();

    }
    function hidealert() {
        $('#Confirmation_alert').hide();
    }

    function showalert1() {
        $('#Confirmation_alert1').show();
    }
    function hidealert1() {
        $('#Confirmation_alert1').hide();
    }
	
	function isNumber(evt) 
	{
    evt = (evt) ? evt : window.event;
    var charCode = (evt.which) ? evt.which : evt.keyCode;
    if (charCode > 31 && (charCode < 48 || charCode > 57)) {
        
		$('#tbitemQuantity').css({

              "border": "1px solid red",
                "background": "#FFCECE"
            });

             $('.Errormsg').text("Enter No's Only");
			 return false;
    }
	else
	{
	$('#tbitemQuantity').css({

              "border": "",
                "background": ""
            });
          	$('.Errormsg').text("");
	}
	
    return true;
}
function fun_AllowOnlyAmountAndDot(txt,evt)
        {
		
		 var theEvent = evt || window.event;
          var key = theEvent.keyCode || theEvent.which;
          key = String.fromCharCode(key);
          if (key.length == 0) return;
          var regex = /^[0-9.\b]+$/;
          if (!regex.test(key)) {
             
              if (theEvent.preventDefault) theEvent.preventDefault();
			  
			   $('#tbitemPrice').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });

            $('.Errormsg').text("Enter No.s Only");
			   theEvent.returnValue = false;
          }
		  else
		  {
		   $('#tbitemPrice').css({

                "border": "",
                "background": ""
            });
		  $('.Errormsg').text("");
		  }
		 return true;
		  

        }
</script>

<script type="text/javascript">

    //$(document).ready(function () {
    //    window.Search = $('.search-box').SumoSelect({ csvDispCount: 3, search: true, searchText: 'Type Name', placeholder: 'Type Name'  });
    //});
    var Checktype = "";
	var table;
	$(".loader").show();
    $(document).ready(function () {

	  $("#peoplePickerDiv").spPeoplePicker();
	  $("#FinancepeoplePickerDiv").spPeoplePicker();
 
  $("#peoplePickerDiv1").spPeoplePicker();
  $("#peoplePickerDiv10").spPeoplePicker();
  
	$("#peoplePickerDiv2").spPeoplePicker();
	$("#peoplePickerDiv3").spPeoplePicker();
	$("#peoplePickerDiv4").spPeoplePicker();
	$("#peoplePickerDiv5").spPeoplePicker();
	
	//$("#ddlexceprojectname").select2();
	//$("#ddlprojectnameEA").select2();
	$("#ddldeligatefromnameEA").select2();
	$("#ddldeligatetonameEA").select2();
	$("#ddlapprover1nameEA").select2();
	$("#ddlapprover2nameEA").select2();
	
	    $('#ddlExpApprover').select2();
	
$("#ddllistsName").prop('selectedIndex', 0);
	
	
	$("#tblbconeCurrency_wrapper").hide();
	$("#tblbconitem_wrapper").hide();
	$("#tblBconeExceptionalProjects_wrapper").hide();
	$("#tblbconeexeceptionalApprovals_wrapper").hide();
	
	$("#tblBconeExpenseFinanceGlobalMatrix_wrapper").hide();
	$("#tblBconeExpenseFinanceIndiaMatrix_wrapper").hide();
	$("#tblBconeProxyMaster_wrapper").hide();
	$("#tblBconeProxyMasterApproval_wrapper").hide();
	
	 var userid = _spPageContextInfo.userId;
 GetUserId_load(userid);

	  $('input:radio[name=itemIsPQDependant]').change(function () {
	  
	  $('#itemIsPQDependant').css({

                "border": "",
                "background": ""
            });

            $('.Errormsg').text("");
	  
	     var radioIsPQDependant = ($('input[name=itemIsPQDependant]:checked', '#itemIsPQDependant').val());
	  
	   if(radioIsPQDependant=="Yes")
	   {
	  $("#Tr_Price").show();
	  $("#Tr_ItemCurrencydd").show();
	  
	   $("#Tr_Quantity").show();
	  
	   }
	   else
	   {
	  $("#Tr_Price").hide();
	   $("#Tr_ItemCurrencydd").hide();
	   $("#Tr_Quantity").hide();
	   }
	  });
			$('#tblbconeCurrency tfoot th').each( function () {
			var title = $('#tblbconeCurrency thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );

		 table = $('#tblbconeCurrency').DataTable();
		table.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );
		
			$('#tblbconitem tfoot th').each( function () {
			var title = $('#tblbconitem thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );

		var table_item = $('#tblbconitem').DataTable();
		table_item.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );
		
		$('#tblBconeExceptionalProjects tfoot th').each( function () {
			var title = $('#tblbconitem thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );

		var table_tblBconeExceptionalProjects = $('#tblBconeExceptionalProjects').DataTable();
		table_tblBconeExceptionalProjects.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );
		
			$('#tblbconeexeceptionalApprovals tfoot th').each( function () {
			var title = $('#tblbconeexeceptionalApprovals thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );

		var table_execeptionalApprovals = $('#tblbconeexeceptionalApprovals').DataTable();
		table_execeptionalApprovals.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );
		
			$('#tblBconeExpenseFinanceGlobalMatrix tfoot th').each( function () {
			var title = $('#tblBconeExpenseFinanceGlobalMatrix thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );

		var table_ExpenseFinanceGlobalMatrix = $('#tblBconeExpenseFinanceGlobalMatrix').DataTable();
		table_ExpenseFinanceGlobalMatrix.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );
		
		$('#tblBconeExpenseFinanceIndiaMatrix tfoot th').each( function () {
			var title = $('#tblBconeExpenseFinanceIndiaMatrix thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );

		var table_BconeExpenseFinanceIndiaMatrix = $('#tblBconeExpenseFinanceIndiaMatrix').DataTable();
		table_BconeExpenseFinanceIndiaMatrix.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );
		$('#tblBconeProxyMaster tfoot th').each( function () {
			var title = $('#tblBconeProxyMaster thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );
		var table_tblBconeProxyMaster = $('#tblBconeProxyMaster').DataTable();
		table_tblBconeProxyMaster.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );

			$('#tblBconeProxyMasterApproval tfoot th').each( function () {
			var title = $('#tblBconeProxyMasterApproval thead th').eq( $(this).index() ).text();
			if(title=='Action')
			{
			}
			else
			{
			$(this).html( '<input type="text" placeholder="Search" />' );
			}
			
		} );
		var table_tblBconeProxyMasterApproval = $('#tblBconeProxyMasterApproval').DataTable();
		table_tblBconeProxyMasterApproval.columns().every( function () {
			var that = this;
			$( 'input', this.footer() ).on( 'keyup change', function () {
				that
					.search( this.value )
					.draw();
			} );
		} );
        $('.ClearMsg').on('Change', function()
        {
            $('.Errormsg').text("");
            
        });
		
		
	
	
	
	
	
        $(".pull-right").hide();
        $("#tblbconeCurrency").hide(); 
		$("#tblbconitem").hide();
		$("#tblBconeExceptionalProjects").hide();
        $("#tblbconeexeceptionalApprovals").hide();
      $('#tblBconeExpenseFinanceGlobalMatrix').hide();
	    $('#tblBconeExpenseFinanceIndiaMatrix').hide();
		$('#tblBconeProxyMaster').hide();
		
	  
	  
        $("#ddllistsName").change(function () {
		
	
            var listname = ($(this).val());
            plotlistdata(listname);
            if (listname == "--Select--") {
                $('#tblbconeCurrency').hide();
                $('#tblbconitem').hide();
                $('#tblBconeExceptionalProjects').hide();
                $('#tblbconeexeceptionalApprovals').hide();
				$('#tblBconeExpenseFinanceGlobalMatrix').hide();
			    $('#tblBconeExpenseFinanceIndiaMatrix').hide();
					$('#tblBconeProxyMaster').hide();
                  
                //$('#tblbconeCurrency tbody').hide();
                //$('#tblbconitem tbody').hide();
                //$('#tblBconeExceptionalProjects tbody').hide();
                //$('#tblbconeexeceptionalApprovals tbody').hide();
            }
			if(listname=='BconeExceptionalApprovals')
			{
			
			$('#BtnException').show();
		    $('#BtnDelegation').show();
			}else
			{
			
			$('#BtnException').hide();
		    $('#BtnDelegation').hide();
			}


        });
        BindResourcedata();
        Bindprojectdata();
        BindCurrency();


        if ($('#ddlactiontypeEA option:selected').text() == '--Select--') {
            $('#Del1').hide();
            $('#Del2').hide();
            $('#Del3').hide();
            $('#Del4').hide();
            $('#Ex1').hide();
            $('#Ex2').hide();
            $('#Ex3').hide();
            $('#gen1').hide();
            $('#gen2').hide();
            $('#gen3').hide();
            $('#gen4').hide();
            $('#gen5').hide();

        }
        window.Search = $('.testSelAll').SumoSelect({ search: true, searchText: 'Type Name', placeholder: 'Type Name',csvDispCount: 3,selectAll:true});
		
	window.Search = $('.testSelAll1').SumoSelect({ search: true, searchText: 'Type Name', placeholder: 'Type Name',csvDispCount: 3,selectAll:true});

	window.Search = $('.search-box').SumoSelect({ search: true, searchText: 'Type Name', placeholder: 'Type Name',csvDispCount: 3});
        $('.gray-btn').on('click', function () {

            ClearBackGroundColour();
        });
        $('.close').on('click', function () {

            ClearBackGroundColour();
        });
    });
function initializePeoplePicker(peoplePickerElementId) {

    // Create a schema to store picker properties, and set the properties.
    var schema = {};
    schema['PrincipalAccountType'] = 'User,DL,SecGroup,SPGroup';
    schema['SearchPrincipalSource'] = 15;
    schema['ResolvePrincipalSource'] = 15;
    schema['AllowMultipleValues'] = true;
    schema['MaximumEntitySuggestions'] = 50;
    schema['Width'] = '280px';

    // Render and initialize the picker. 
    // Pass the ID of the DOM element that contains the picker, an array of initial
    // PickerEntity objects to set the picker value, and a schema that defines
    // picker properties.
    this.SPClientPeoplePicker_InitStandaloneControlWrapper(peoplePickerElementId, null, schema);
}
    function changeactiontype() {
        if ($('#ddlactiontypeEA option:selected').text() == 'Delegation') {
		

            $('#Ex1').hide();
            $('#Ex2').hide();
            $('#Ex3').hide();
            $('#Del1').show();
            $('#Del2').show();
            $('#Del3').show();
            $('#Del4').show();
            $('#gen1').show();
            $('#gen2').show();
            $('#gen3').show();
            $('#gen4').show();
            $('#gen5').show();


        }
        else
            if ($('#ddlactiontypeEA option:selected').text() == 'Exception') {
			
                $('#Del1').hide();
                $('#Del2').hide();
                $('#Del3').hide();
                $('#Del4').hide();
                $('#Ex1').show();
                $('#Ex2').show();
                $('#Ex3').show();
                $('#gen1').show();
                $('#gen2').show();
                $('#gen3').show();
                $('#gen4').show();
                $('#gen5').show();
            }
            else if ($('#ddlactiontypeEA option:selected').text() == '--Select--') {
                $('#Del1').hide();
                $('#Del2').hide();
                $('#Del3').hide();
                $('#Del4').hide();
                $('#Ex1').hide();
                $('#Ex2').hide();
                $('#Ex3').hide();
                $('#gen1').hide();
                $('#gen2').hide();
                $('#gen3').hide();
                $('#gen4').hide();
                $('#gen5').hide();
            }
    }
    function BindResourcedata_main11(url) {
        //var url = _spPageContextInfo.webAbsoluteUrl + //"/_api/ProjectData/Resources?$Select=ResourceName,EmployeeID,ResourceId&$filter=ResourceType eq //2&$orderby=ResourceName asc";//
		//var url = _spPageContextInfo.webAbsoluteUrl + "/_api/ProjectData/Resources?$filter=ResourceType eq 2";
        
        //var requestData = { "UserRole": groupName };
        $.ajax({
            url: url,
            async: false,
            type: "GET",
            dataType: "json",
            success: function (res) {
                console.log(res);
                if (res.value.length > 0) {
                    //$('#ddlexceresourcename').append(new Option("--Select--", 0));
                    $('#ddldeligatefromnameEA').append(new Option("--Select--", 0));
                    $('#ddldeligatetonameEA').append(new Option("--Select--", 0));
                    //$('#ddlresourcenameEA').append(new Option("--Select--", 0));
                    $('#ddlapprover1nameEA').append(new Option("--Select--", 0));
                    $('#ddlapprover2nameEA').append(new Option("--Select--", 0));
                   // for (var i = 0; i < res.value.length; i++) {
                        //$('#ddlexceresourcename').append(new Option("", 0));
                        //   $.each(res.SubOptions[0].Resources, function (index, value) {
                        //    //var empid = res.d.EmployeeID;
                        //    //var resourcename = res.d.ResourceName;
                        // $('#ddlexceresourcename').append(new Option("", 0));
						//console.log(res);
						
						var i=0;
						 $.each(res.value, function (key, value) {
						 
						
                        var getval = res.value[i]["EmployeeID"] == null ? "" : res.value[i]["EmployeeID"];
                        getval = getval + "&" + res.value[i].ResourceId;
                        $('#ddlexceresourcename').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddldeligatefromnameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddldeligatetonameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddlresourcenameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddlapprover1nameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddlapprover2nameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
						i++;
						 });
						 console.log(i);
											  
                   // }
                }
                // });
            },
            error: function (jqXHR, textStatus, errorThrown) {
                ////alert("ResourcesFailed");
            },
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
            }
        });
    }
	 function BindResourcedata()
	{

        $.ajax({
            url: "https://ppmprod.bcone.com/api/BCONE/GetResourceNames",
			
            method: "POST",
            headers: { "Accept": "application/json; odata=verbose" },
         
			data: { 
		
			},
            success: function (res) {
				//console.log(res)
				//console.log(res.Resources.length);
				  if (res.Resources.length > 0) {
				  
				   $('#ddldeligatefromnameEA').append(new Option("--Select--", 0));
                    $('#ddldeligatetonameEA').append(new Option("--Select--", 0));
                    //$('#ddlresourcenameEA').append(new Option("--Select--", 0));
                    $('#ddlapprover1nameEA').append(new Option("--Select--", 0));
                    $('#ddlapprover2nameEA').append(new Option("--Select--", 0));
					$('#ddlExpApprover').append(new Option("--Select--", 0));
				  
				  var i=0;
				  $.each(res.Resources, function (key, value) {
				  
				 // var  getval1 = res.Resources[i].ResourceName;
				  
				   var getval = res.Resources[i]["EmployeeID"] == null ? "" : res.Resources[i]["EmployeeID"];
                        getval = getval + "&" + res.Resources[i].ResourceID;
				 var getval1 = res.Resources[i]["ResourceName"] == null ? "" : res.Resources[i]["ResourceName"];
                        //getval1 = getval1 + "&" + res.Resources[i].ResourceName;
						
                        $('#ddlexceresourcename').append("<option value = '" + getval + "'>" + getval1 + "</option>");
                        $('#ddldeligatefromnameEA').append("<option value = '" + getval + "'>" + getval1 + "</option>");
                        $('#ddldeligatetonameEA').append("<option value = '" + getval + "'>" + getval1 + "</option>");
                        $('#ddlresourcenameEA').append("<option value = '" + getval + "'>" + getval1+ "</option>");
                        $('#ddlapprover1nameEA').append("<option value = '" + getval + "'>" + getval1 + "</option>");
                        $('#ddlapprover2nameEA').append("<option value = '" + getval + "'>" + getval1 + "</option>");
						$('#ddlExpApprover').append("<option value = '" + getval + "'>" + getval1 + "</option>");
						
					i++;
					});
				  
				  }
				
				

            },
            error: function (data) {
                alert("failed");
				//$('#loading-image').hide();
            }
        });
}

function BindResourcedata1() {
        //var url = _spPageContextInfo.webAbsoluteUrl + //"/_api/ProjectData/Resources?$Select=ResourceName,EmployeeID,ResourceId&$filter=ResourceType eq //2&$orderby=ResourceName asc";//
	
		var url = _spPageContextInfo.webAbsoluteUrl + "/_api/ProjectData/Resources?$filter=ResourceType eq 2";
        
        //var requestData = { "UserRole": groupName };
        $.ajax({
            url: url,
            async: false,
            type: "GET",
            dataType: "json",
            success: function (res) {
                console.log(res);
                if (res.value.length > 0) {
                    //$('#ddlexceresourcename').append(new Option("--Select--", 0));
                    $('#ddldeligatefromnameEA').append(new Option("--Select--", 0));
                    $('#ddldeligatetonameEA').append(new Option("--Select--", 0));
                    //$('#ddlresourcenameEA').append(new Option("--Select--", 0));
                    $('#ddlapprover1nameEA').append(new Option("--Select--", 0));
                    $('#ddlapprover2nameEA').append(new Option("--Select--", 0));
                   // for (var i = 0; i < res.value.length; i++) {
                        //$('#ddlexceresourcename').append(new Option("", 0));
                        //   $.each(res.SubOptions[0].Resources, function (index, value) {
                        //    //var empid = res.d.EmployeeID;
                        //    //var resourcename = res.d.ResourceName;
                        // $('#ddlexceresourcename').append(new Option("", 0));
						//console.log(res);
						
						var i=0;
						var dynamicid="";
						 $.each(res.value, function (key, value) {
						 dynamicid=res.value[i].ResourceId;
						
                        var getval = res.value[i]["EmployeeID"] == null ? "" : res.value[i]["EmployeeID"];
                        getval = getval + "&" + res.value[i].ResourceId;
                        $('#ddlexceresourcename').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddldeligatefromnameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddldeligatetonameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddlresourcenameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddlapprover1nameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
                        $('#ddlapprover2nameEA').append("<option value = '" + getval + "'>" + res.value[i].ResourceName + "</option>");
						
						i++;
						 });
					BindResourcedata_main(_spPageContextInfo.webAbsoluteUrl + "/_api/ProjectData/Resources?$top=1000&$skiptoken=guid'"+dynamicid+"'");
						 
											  
                   // }
                }
                // });
            },
            error: function (jqXHR, textStatus, errorThrown) {
                ////alert("ResourcesFailed");
            },
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
            }
        });
    }

    function Bindprojectdata1() {

        var url = _spPageContextInfo.webAbsoluteUrl + "/_api/ProjectData/Projects?$select=ProjectCode,ProjectId,ProjectName&$orderby=ProjectName asc";
        //var requestData = { "UserRole": groupName };
        $.ajax({
            url: url,
            async: false,
            type: "GET",
            dataType: "json",
            success: function (res) {
                //console.log(res);
                if (res.value.length > 0) {
                    //$('#ddlexceprojectname').append(new Option("--Select--", 0));
                    $('#ddlprojectnameEA').append(new Option("--Select--", 0));

                    for (var i = 0; i < res.value.length; i++) {
                        //$('#ddlexceresourcename').append(new Option("", 0));
                        //   $.each(res.SubOptions[0].Resources, function (index, value) {
                        //    //var empid = res.d.EmployeeID;
                        //    //var resourcename = res.d.ResourceName;
                        // $('#ddlexceresourcename').append(new Option("", 0));
                        var getval = res.value[i]["ProjectCode"] == null ? "" : res.value[i]["ProjectCode"];
                        getval = getval + "&" + res.value[i].ProjectId;
                        $('#ddlexceprojectname').append("<option value = '" + getval + "'>" + res.value[i].ProjectName + "</option>");
                        //getval = getval + "&" + res.value[i].ProjectId;
                        $('#ddlprojectnameEA').append("<option value = '" + getval + "'>" + res.value[i].ProjectName + "</option>");

                    }
                }
                // });
            },
            error: function (jqXHR, textStatus, errorThrown) {
                ////alert("ResourcesFailed");
            },
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
            }
        });
    }
	
	 function BindCurrency() 
        {
            var query_cml = '<View><Query><Where><Eq><FieldRef Name="IsActive" /><Value Type="Boolean">1</Value></Eq></Where><OrderBy><FieldRef Name="Item" Ascending="True"/><Value Type="Text" ></Value></OrderBy></Query></View>';
    
         $("#DDItemCurrency").append($("<option></option>").val('0').html('Select Currency'));
            $.ajax({
                url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('BconeCurrency')/GetItems",
                type: "POST",
				async:false,
                headers: {
                    "accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                    "content-Type": "application/json;odata=verbose"
                },
                data: JSON.stringify({
                    query: {
                        __metadata: {
                            type: "SP.CamlQuery"
                        },
                        ViewXml: query_cml
                    }
                }),
                success: function (data) {
				
                
                    $.each(data.d.results, function (key, value) {

                            $("#DDItemCurrency").append($("<option></option>").val(value.ID).html(value.Currency));
                        
                    });

                },
                error: function (data) {
                    failure(data);
                }
            });
        }
	function Refine(searchcolumn,id,type)
		{
		
		

		if(type=='')
		{
		var ddltype=$('#ddlactiontypeEA option:selected').text();
		
		if(ddltype!='--Select--')
		{
		searchcolumn=ddltype;
		
		if(ddltype=='Delegation')
		{
		id='BtnDelegation';
		}
		else
		{
		
		id='BtnException';
		}
		
		}
		}
		
		 setTimeout(function(){ 
			$('[data-toggle="tooltip"]').tooltip();  
		}, 1000);
		 $('.top-refine1').find('a').each(function () {

                $(this).removeClass('green-btn').addClass('blue-btn');


            })

         var a = $('#' + id).hasClass('blue-btn');

         a ? $('#' + id).removeClass('blue-btn').addClass('green-btn') : $('#' + id).removeClass('blue-btn').addClass('green-btn');
		var table = $('#tblbconeexeceptionalApprovals').DataTable();
		table
 .search( '' )
 .columns().search( '' )
 .draw();
		table
        .columns(3)
        .search(searchcolumn)
        .draw();
		
  table.columns( [3] ).visible( false );
	if(searchcolumn=='')
	{
	table.columns( [0,1,2,4,5,6,7,8,9,10,11,12,13,14,15] ).visible( true );
	
	}
	else if(searchcolumn=='Exception')
	{
	table.columns( [0,1,2,4,5,6,9,10,13] ).visible( true );
	table.columns( [7,8,11,12,14,15] ).visible( false );
	}
	else if(searchcolumn=='Delegation')
	{
     table.columns( [0,1,2,7,8,9,10,11,12,13,14,15] ).visible( true );
	table.columns( [4,5,6] ).visible( false );
	}
	
		
 }
 
 
	
  function Bindprojectdata() {

        $.ajax({
            url: "https://ppmprod.bcone.com/api/BCONE/GetAllProjectsName",
			
            method: "POST",
            headers: { "Accept": "application/json; odata=verbose" },
         
			data: { 
		
			},
            success: function (data) {
				console.log(data)
				console.log(data.Projects.length);
				if(data.Projects.length>0)
				{
				 //$('#ddlexceprojectname').append(new Option("--Select--", 0));
                   // $('#ddlprojectnameEA').append(new Option("--Select--", 0));
				var i=0;
				 $.each(data.Projects, function (key, value) {
				 
				   var getval = data.Projects[i]["ProjectCode"] == null ? "" : data.Projects[i]["ProjectCode"];
                        getval = getval + "&" + data.Projects[i].ProjectID;
                        $('#ddlexceprojectname').append("<option value = '" + getval + "'>" + data.Projects[i].ProjectName + "</option>");
                        //getval = getval + "&" + res.value[i].ProjectId;
                        $('#ddlprojectnameEA').append("<option value = '" + getval + "'>" + data.Projects[i].ProjectName + "</option>");
				i++;
						 
						 });
                }
				
			//	$("#ddlexceprojectname").select2({
				//  data: data
				//});
				//$("#ddlprojectnameEA").select2({
				//  data: data
				//});
            },
            error: function (data) {
                alert("failed");
				//$('#loading-image').hide();
            }
        });
    }

		var table_Currency = $('#tblbconeCurrency').dataTable({ 
		"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Expense Currency',
			exportOptions: {
                      columns: [1, 2, 3]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ],
		'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
		},
			
});
var table_tblbconitem = $('#tblbconitem').dataTable({ 
"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Expense Item Master',
			exportOptions: {
                      columns: [1, 2, 3, 4,5,6,7,8,9]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ],
    'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
    },   
});
var table_ExceptionalProjects = $('#tblBconeExceptionalProjects').dataTable({
"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Expense Exceptional Projects',
			exportOptions: {
                      columns: [1, 2, 3, 4,5,6,7]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ], 
    'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
    },   
});
var table_execeptionalApprovals = $('#tblbconeexeceptionalApprovals').dataTable({ 
"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Exceptional Approval and Delegation',
			exportOptions: {
                      columns: [1, 2, 3, 4,5,6,7,8]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ],
    'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
    },   
});
var table_BconeExpenseFinanceGlobalMatrix = $('#tblBconeExpenseFinanceGlobalMatrix').dataTable({ 
"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Expense Finance Global Matrix',
			exportOptions: {
                      columns: [1, 2, 3]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ],
    'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
    },   
	
});
var table_BconeExpenseFinanceIndiaMatrix = $('#tblBconeExpenseFinanceIndiaMatrix').dataTable({ 
"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Expense Finance India Matrix',
			exportOptions: {
                      columns: [1, 2, 3, 4]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ],
    'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
    },   
});
var table_tblBconeProxyMaster = $('#tblBconeProxyMaster').dataTable({
"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Expense Proxy Submission',
			exportOptions: {
                      columns: [1, 2, 3, 4]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ],
    'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
    },   
});
var table_tblBconeProxyMasterApproval = $('#tblBconeProxyMasterApproval').dataTable({ 
"oLanguage": { 			"sEmptyTable":     "No Records found." 		},
	    "order": [],
	    //dom: 'Bfrtip',
	    dom: 'Blfrtip',
		
	    buttons: [ {
	        extend: 'excelHtml5',
			title: 'Expense Proxy Approval',
			exportOptions: {
                      columns: [1, 2, 3, 4]
                  },
	        customize: function( xlsx ) {
	            var sheet = xlsx.xl.worksheets['sheet1.xml'];
 
	            $('row c[r^="C"]', sheet).attr( 's', '2' );
	        },
	        text: 'Excel'
			
	    } ],
    'fnCreatedRow': function (nRow, aData, iDataIndex) {
        $(nRow).attr('id', 'my'+iDataIndex); // or whatever you choose to set as the id
    },   
});

    function plotlistdata(listname) {
        //$('#tblbconeCurrency tbody').remove();
		$("#tblbconeCurrency_wrapper").hide();		
		$("#tblbconitem_wrapper").hide();
	    $("#tblBconeExceptionalProjects_wrapper").hide();
		$("#tblbconeexeceptionalApprovals_wrapper").hide();
		$("#tblBconeExpenseFinanceGlobalMatrix_wrapper").hide();
	 $("#tblBconeExpenseFinanceIndiaMatrix_wrapper").hide();
	 
	  $("#tblBconeProxyMaster_wrapper").hide();
	 $("#tblBconeProxyMasterApproval_wrapper").hide();
		
        //$('#tblbconitem tbody').remove();
        //$('#tblBconeExceptionalProjects tbody').remove();
       // $('#tblbconeexeceptionalApprovals tbody').remove();
	
   $('#tblbconeCurrency').dataTable().fnClearTable();
    $('#tblbconitem').dataTable().fnClearTable();
	$('#tblBconeExceptionalProjects').dataTable().fnClearTable();
	$('#tblbconeexeceptionalApprovals').dataTable().fnClearTable();
	$('#tblBconeExpenseFinanceGlobalMatrix').dataTable().fnClearTable();
	$('#tblBconeExpenseFinanceIndiaMatrix').dataTable().fnClearTable();
	$('#tblBconeProxyMaster').dataTable().fnClearTable();
	$('#tblBconeProxyMasterApproval').dataTable().fnClearTable();

        var currency = "";
        var title = "";
        var active = "";
        var data = "";
        var activeststus = "";
        var counter = "";
        var siteUrl = "";
        var CurrentItemID = "";
		
		var Delegation_count=0;
		var Exception_count=0;

        var url = _spPageContextInfo.webAbsoluteUrl + "/_api/web/lists/GetByTitle('" + listname + "')/Items?$orderby=Created desc&$top=1000000";
        var result;
        $.ajax({
            url: url,
            async: false,
            type: "GET",
            headers: {
                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                "Accept": "application/json; odata=verbose",
                "Content-Type": "application/json; odata=verbose"
            },
            success: function (res) {
                var ListData = res.d.results;

				
			//console.log(ListData);
                for (var i = 0; i < ListData.length; i++) {
                    counter++;
					
						
					
					if(listname!='BconeFinanceApproverMatrix' && listname!='BconeFinanceApproverLocationMatrix')
					{
                    if (ListData[i].IsActive == true) {
                        activeststus = "Yes";

                    }
                    else {
                        activeststus = "No";

                    }
                    if (ListData[i].ForExpenseModule == true) {
                        forexpensemodu = "Yes";

                    }
                    else {
                        forexpensemodu = "No";

                    }
                    if (ListData[i].ForTimeSheetModule == true) {
                        fortimemodu = "Yes";

                    }
                    else {
                        fortimemodu = "No";

                    }
                    }

                    if (listname == "BconeCurrency") {
					$("#tblbconeCurrency_wrapper").show();
                        //data = data + '<tr><td style=\"Width:10px;height:20px;\">' + ListData[i].Currency + '</td><td style=\"Width:10px;height:20px;\">' + ListData[i].Title + '</td><td style=\"Width:10px;height:20px;\">' + activeststus + '</td></tr>';
                       // data = data + '<tr><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert();" style="margin-left:5px; display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td>' +
						table_Currency.fnAddData([
						'<div style="text-align:center;"><td ><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert();" style="margin-left:5px; display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>',
						'<td>' + counter + '</td>',
							'<td>' + ListData[i].Currency + '</td>',
							'<td>' + activeststus + '</td>'
						
						]);	
							
						

                    }
                    else if (listname == "BconeItemMaster") {
					$("#tblbconitem_wrapper").show();
                        //data = data + '<tr><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconitemid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert1()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td>' +
						//d	'+<td>' + counter + '</td>' +
						//d	'+<td>' + ListData[i].ItemType + '</td>' +
						//d	'+<td>' + ListData[i].Item + '</td>' +
                        //d   '+<td>' + ListData[i].SAPAccNo + ' </td>' +
                        //d   '+<td>' + activeststus + ' </td>' +
						//d    '+</tr> ';
						
						var price="-";
						var quantity="-";
						var Currency="-";
						var IsPQDependant="_";
						//alert(ListData[i].IsPQDependant);
						if(ListData[i].ItemType=="Expense Item")
						{
						if(ListData[i].IsPQDependant==true)
						{
						IsPQDependant="Yes";
						price=ListData[i].Price;
						quantity=ListData[i].Quantity;
						if(ListData[i].ItemCurrencyText!=null && ListData[i].ItemCurrencyText!='')
						{
						Currency=ListData[i].ItemCurrencyText;
						}
						}else
						{
						IsPQDependant="No";
						}
						}
							 
				 table_tblbconitem.fnAddData([
							'<div style="text-align:center;"><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconitemid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert1()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>',
							'<td>' + counter + '</td>',
							'<td>' + ListData[i].ItemType + '</td>',
							'<td>' + ListData[i].Item + '</td>',
                            '<td>' + ListData[i].SAPAccNo + ' </td>',
							'<td>' + IsPQDependant + ' </td>',
							'<td>' + Currency + ' </td>',
							'<td>' + price + ' </td>',
							'<td>' + quantity + ' </td>',
							
                            '<td>' + activeststus + ' </td>'
							 ]);
                    }
                    else if (listname == "BconeExceptionalProjects") {
 
                       $("#tblBconeExceptionalProjects_wrapper").show();
                        //var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                        ////var StartDate=result[0].Startdatetime;
                        //var StartDate=ListData[i].Startdatetime.split('T')[0];




                        //var EndDate=.split('T')[0];
                        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                        var StartDate = new Date(ListData[i].Startdatetime);

                        var startDay = new Date(StartDate).getDate();
                        var startMonth = new Date(StartDate).getMonth();
                        var startYear = new Date(StartDate).getFullYear();

                        StartDate = startDay + "-" + months[startMonth] + "-" + startYear;

                        var EndDate = new Date(ListData[i].Finishdatetime);

                        var EndDay = new Date(EndDate).getDate();
                        var EndMonth = new Date(EndDate).getMonth();
                        var EndYear = new Date(EndDate).getFullYear();

                        EndDate = EndDay + "-" + months[EndMonth] + "-" + EndYear;


                        //var Edt=new Date(EndDate);
                        //var EndDateDay=new Date(Edt).getDate();
                        //var EndDateMonth=new Date(Edt).getMonth();
                        //var EndDateYear=new Date(Edt).getFullYear();
                        // var SD = ListData[i].Startdatetime.split('T')[0];

                        //Edt=EndDateDay + "-" + months[EndDateMonth] + "-" + EndDateYear;

                       //data = data + '<tr><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconexceid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td>' +
						//	'+<td>' + counter + '</td>' +
						//	'+<td>' + ListData[i].EmployeeName + '</td>' +
                       //    '+<td>' + ListData[i].ProjectName + ' </td>' +
						//	'+<td>' + StartDate + ' </td>' +
                       //    '+<td>' + EndDate + ' </td>' +
                       //    '+<td>' + activeststus + ' </td>' +
						//     '+</tr> ';
						var approver="";
						if( ListData[i].Approver =="Other")
						{
						approver=ListData[i].Approver+"  ("+ListData[i].ApproverName+")";
						
						}
						else
						{
						approver=ListData[i].Approver;
						
						}
							 
							 table_ExceptionalProjects.fnAddData([
							 '<div style="text-align:center;"><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconexceid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>' ,
							'<td>' + counter + '</td>',
							'<td>' + ListData[i].EmployeeName + '</td>' ,
                            '<td>' + ListData[i].ProjectName + ' </td>' ,
							  '<td>' + approver + ' </td>' ,
							'<td>' + StartDate + ' </td>' ,
                            '<td>' + EndDate + ' </td>' ,
                            '<td>' + activeststus + ' </td>'
						    
							 ]);
                    }

                    else if (listname == "BconeExceptionalApprovals") {
					
					$("#tblbconeexeceptionalApprovals_wrapper").show();
					
                        //data = data + '<tr><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconapproveid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td>' +
						//d	'+<td>' + counter + '</td>' +
						//d	'+<td>' + ListData[i].ProjectName + '</td>' +
						//d	'+<td>' + ListData[i].ActionType + '</td>' +
						//d	'+<td>' + forexpensemodu + ' </td>' +
                        //d   '+<td>' + fortimemodu + ' </td>' +
                        //d   '+<td>' + activeststus + ' </td>' +

						//d    '+</tr> ';
						

		if(ListData[i].ActionType =='Delegation')
		{
		Delegation_count++;
		document.getElementById("DelegationCount").innerHTML = Delegation_count;
		}else
		{
		Exception_count++;
		document.getElementById("ExceptionCount").innerHTML = Exception_count;
		}
		
		
		var Apr2EmployeeName="-";
		
		if(ListData[i].Apr2EmployeeName!='--Select--')
		{
		
		Apr2EmployeeName=ListData[i].Apr2EmployeeName;
		
		}
		 var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                        var StartDate = new Date(ListData[i].Startdatetime);

                        var startDay = new Date(StartDate).getDate();
                        var startMonth = new Date(StartDate).getMonth();
                        var startYear = new Date(StartDate).getFullYear();

                        StartDate = startDay + "-" + months[startMonth] + "-" + startYear;

                        var EndDate = new Date(ListData[i].Finishdatetime);

                        var EndDay = new Date(EndDate).getDate();
                        var EndMonth = new Date(EndDate).getMonth();
                        var EndYear = new Date(EndDate).getFullYear();

                        EndDate = EndDay + "-" + months[EndMonth] + "-" + EndYear;
						
						var delegationdate=new Date(ListData[i].Modified);
						var delegationstartDay = new Date(delegationdate).getDate();
                        var delegationstartMonth = new Date(delegationdate).getMonth();
                        var delegationstartYear = new Date(delegationdate).getFullYear();

                        delegationdate = delegationstartDay + "-" + months[delegationstartMonth] + "-" + delegationstartYear;
							 
							 table_execeptionalApprovals.fnAddData([
							 
							'<div style="text-align:center;"><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconapproveid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>',
							'<td>' + counter + '</td>',
							'<td>' + ListData[i].ProjectName + '</td>' ,
							'<td>' + ListData[i].ActionType + '</td>' ,
							
							'<td>' + ListData[i].EmployeeName + '</td>' ,
							'<td>' + ListData[i].Apr1EmployeeName + '</td>' ,
							'<td>' + Apr2EmployeeName + '</td>' ,
							'<td>' + ListData[i].EmployeeName + '</td>' ,
							'<td>' + ListData[i].Apr1EmployeeName + '</td>' ,
							
							'<td>' + forexpensemodu + ' </td>' ,
                            '<td>' + fortimemodu + ' </td>' ,
							
							'<td>' + StartDate + '</td>' ,
							'<td>' + EndDate + '</td>' ,
							
                            '<td>' + activeststus + ' </td>' ,
							'<td>' + ListData[i].DelegationalStatus+'</td>',
							'<td>' + delegationdate + ' </td>' 
						     
							 
							 ]);
                    }
					else if (listname == "BconeFinanceApproverMatrix") {
					
				$("#tblBconeExpenseFinanceGlobalMatrix_wrapper").show();
			var resource_name=GetUserId(ListData[i].FinanceApproverNameId);
			var Finance_name="";
			if(ListData[i].FinanceApprover2Id!=undefined)
			{
				Finance_name=GetUserId(ListData[i].FinanceApprover2Id);
			}
					 table_BconeExpenseFinanceGlobalMatrix.fnAddData([
							 
							'<div style="text-align:center;"><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconapproveid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>',
							'<td>' + counter + '</td>',
							'<td>' + ListData[i].CountryLegal + '</td>' ,
							'<td>' + resource_name + '</td>' ,
							'<td>' + Finance_name + '</td>' ,

							 ]);
                       
							 
							 
                    }
					else if (listname == "BconeFinanceApproverLocationMatrix") 
					{
					
						$("#tblBconeExpenseFinanceIndiaMatrix_wrapper").show();
						var resource_name=GetUserId(ListData[i].FinanceApproverNameId);
						var Finance_name2="";
						if(ListData[i].FinanceApproverName2Id!=undefined)
						{
						Finance_name2=GetUserId(ListData[i].FinanceApproverName2Id);
						}
						table_BconeExpenseFinanceIndiaMatrix.fnAddData([
							 
							'<div style="text-align:center;"><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconapproveid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>',
							'<td>' + counter + '</td>',
							'<td>' + ListData[i].EmployeeBaseLocation + '</td>' ,
							'<td>' + resource_name + '</td>' ,
							'<td>' + Finance_name2 + '</td>' ,
								'<td>' +ListData[i].Currency + '</td>' 

							 ]);
							 
                    }
					else if (listname == "BconeProxyMaster") {
					
				$("#tblBconeProxyMaster_wrapper").show();
				//alert(ListData[i].sharepointuseridId);
			 var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                        var StartDate = new Date(ListData[i].ProxyTillDate);

                        //var startDay = new Date(StartDate).getDate();
                        //var startMonth = new Date(StartDate).getMonth();
                        //var startYear = new Date(StartDate).getFullYear();
                        //
                        //StartDate = startDay + "-" + months[startMonth] + "-" + startYear;
					 table_tblBconeProxyMaster.fnAddData([
							 
							'<div style="text-align:center;"><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconapproveid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>',
							'<td>' + counter + '</td>',
							'<td>' + ListData[i].ProxyName+ '</td>' ,
							'<td>' + ListData[i].EmpName + '</td>' ,
							
								
                                    '<td>'+activeststus+'</td>'							

							 ]);                     						 
							 
                    }
					
						else if (listname == "BconeProxyApprover") {
					
				$("#tblBconeProxyMasterApproval_wrapper").show();
				//alert(ListData[i].sharepointuseridId);
			 var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                        var StartDate = new Date(ListData[i].ProxyTillDate);

                        //var startDay = new Date(StartDate).getDate();
                        //var startMonth = new Date(StartDate).getMonth();
                        //var startYear = new Date(StartDate).getFullYear();
                        //
                        //StartDate = startDay + "-" + months[startMonth] + "-" + startYear;
					 table_tblBconeProxyMasterApproval.fnAddData([
							 
							'<div style="text-align:center;"><td><a href="javascript:void(0)" data-toggle="modal" data-target="#myModal" id="bconapproveid_' + ListData[i].ID + '" onclick="getID(this);"><i class="fa fa-pencil" style="color:#333;font-size: 16px;"></i></a><a href="javascript:void(0)" onclick="showalert()" style="margin-left:5px;display:none;"><i class="fa fa-trash-o" style="color:#333;font-size: 16px;"></i></a></td></div>',
							'<td>' + counter + '</td>',
							'<td>' + ListData[i].ProxyName+ '</td>' ,
							'<td>' + ListData[i].EmpName + '</td>' ,
						
							
                                    '<td>'+activeststus+'</td>'							

							 ]);                     						 
							 
                    }

                }
                if (listname == "BconeCurrency") {
                    //$("#tblbconeCurrency").append(data);
                    $("#tblbconeCurrency").show();
                    $("#tblbconitem").hide();
                    $("#tblBconeExceptionalProjects").hide();
                    $("#tblbconeexeceptionalApprovals").hide();
                    $(".pull-right").show();
                    $('#tblbconitemmaster').hide();
					$("#tblBconeExpenseFinanceGlobalMatrix").hide();
				   $("#tblBconeExpenseFinanceIndiaMatrix").hide();
				   $("#tblBconeProxyMaster").hide();
				    $("#tblBconeProxyMasterApproval").hide();
				   
					
					
                }
                else if (listname == "BconeItemMaster") {
                   // $("#tblbconitem").append(data);
                    $("#tblbconitem").show();
                    $("#tblbconeCurrency").hide();
                    $("#tblBconeExceptionalProjects").hide();
                    $("#tblbconeexeceptionalApprovals").hide();
                    $(".pull-right").show();
                    $('#tblbconeCurrency').hide();
					$("#tblBconeExpenseFinanceGlobalMatrix").hide();
					 $("#tblBconeExpenseFinanceIndiaMatrix").hide();
					 $("#tblBconeProxyMaster").hide();
					  $("#tblBconeProxyMasterApproval").hide();
                }
                else if (listname == "BconeExceptionalProjects") {
                    //$("#tblBconeExceptionalProjects").append(data);
                    $("#tblBconeExceptionalProjects").show();
                    $("#tblbconitem").hide();
                    $("#tblbconeCurrency").hide();
                    $("#tblbconeexeceptionalApprovals").hide();
                    $(".pull-right").show();
                    $('#tblbconitemmaster').hide();
                    $('#tblbconeCurrency').hide();
					$("#tblBconeExpenseFinanceGlobalMatrix").hide();
					 $("#tblBconeExpenseFinanceIndiaMatrix").hide();
					 
					 $("#tblBconeProxyMaster").hide();
					  $("#tblBconeProxyMasterApproval").hide();
                }
                else if (listname == "BconeExceptionalApprovals") {
                  //  $("#tblbconeexeceptionalApprovals").append(data);
                    $("#tblbconeexeceptionalApprovals").show();
                    $("#tblBconeExceptionalProjects").hide();
                    $("#tblbconitem").hide();
                    $("#tblbconeCurrency").hide();
                    $(".pull-right").show();
					$("#tblBconeExpenseFinanceGlobalMatrix").hide();
					 $("#tblBconeExpenseFinanceIndiaMatrix").hide();
					 $("#tblBconeProxyMaster").hide();
					  $("#tblBconeProxyMasterApproval").hide();
					               
                   Refine('Exception','BtnException','');


                }
				 else if (listname == "BconeFinanceApproverMatrix") {
                  //  $("#tblbconeexeceptionalApprovals").append(data);
                    $("#tblbconeexeceptionalApprovals").hide();
                    $("#tblBconeExceptionalProjects").hide();
                    $("#tblbconitem").hide();
                    $("#tblbconeCurrency").hide();
                    $(".pull-right").show();
					$("#tblBconeExpenseFinanceGlobalMatrix").show();
					 $("#tblBconeExpenseFinanceIndiaMatrix").hide();
					 $("#tblBconeProxyMaster").hide();
					  $("#tblBconeProxyMasterApproval").hide();
					

                }
				else if (listname == "BconeFinanceApproverLocationMatrix") {
                  //  $("#tblbconeexeceptionalApprovals").append(data);
                    $("#tblbconeexeceptionalApprovals").hide();
                    $("#tblBconeExceptionalProjects").hide();
                    $("#tblbconitem").hide();
                    $("#tblbconeCurrency").hide();
                    $(".pull-right").show();
					$("#tblBconeExpenseFinanceGlobalMatrix").hide();
					 $("#tblBconeExpenseFinanceIndiaMatrix").show();
					 $("#tblBconeProxyMaster").hide();
					  $("#tblBconeProxyMasterApproval").hide();
					

                }
				else if (listname == "BconeProxyMaster") {
                  //  $("#tblbconeexeceptionalApprovals").append(data);
                    $("#tblbconeexeceptionalApprovals").hide();
                    $("#tblBconeExceptionalProjects").hide();
                    $("#tblbconitem").hide();
                    $("#tblbconeCurrency").hide();
                    $(".pull-right").show();
					$("#tblBconeExpenseFinanceGlobalMatrix").hide();
					 $("#tblBconeExpenseFinanceIndiaMatrix").hide();
					 $("#tblBconeProxyMaster").show();
	              $("#tblBconeProxyMasterApproval").hide();

                }
				else if (listname == "BconeProxyApprover") {
                  //  $("#tblbconeexeceptionalApprovals").append(data);
                    $("#tblbconeexeceptionalApprovals").hide();
                    $("#tblBconeExceptionalProjects").hide();
                    $("#tblbconitem").hide();
                    $("#tblbconeCurrency").hide();
                    $(".pull-right").show();
					$("#tblBconeExpenseFinanceGlobalMatrix").hide();
					 $("#tblBconeExpenseFinanceIndiaMatrix").hide();
					 $("#tblBconeProxyMaster").hide();
					 $("#tblBconeProxyMasterApproval").show();					 				
                }

                result = res.d;
            },

            error: function (error) {

                ////alert("error");
            }

        });
    }
    var getid = "";
    function getID(object) {
	$('.in-stock').html("Update");
        ClearBackGroundColour();
        $('.Errormsg').text("");
        $('#hheader').text('Edit Item');
        getid = $(object).attr('id');
        getid = getid.split('_')[1];
        if ($('#ddllistsName option:selected').val() == 'BconeCurrency') {
            $('#tblbconeCurrency123').show();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
		  $("#tblBconeExpenseFinanceIndiaMatrix123").hide();
		  
		  $("#tblBconeProxyMaster123").hide();
		  $("#tblBconeProxyMasterApproval123").hide();
		  
            getItem(getid);
            Checktype = "Edit" + getid;
        }
        else if ($('#ddllistsName option:selected').val() == 'BconeItemMaster') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').show();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
			$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
			$("#tblBconeProxyMaster123").hide();
			 $("#tblBconeProxyMasterApproval123").hide();
            getItemmasterid(getid);
            Checktype = "Edit" + getid;
        }
        else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalProjects') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').show();
            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
		$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
		 $("#tblBconeProxyMasterApproval123").hide();
		$("#tblBconeProxyMaster123").hide();
            getExceptionalid(getid);
            Checktype = "Edit" + getid;

        }
        else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalApprovals') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').show();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
				$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
				$("#tblBconeProxyMaster123").hide();
				 $("#tblBconeProxyMasterApproval123").hide();
            getapprovalid(getid);
            changeactiontype();
            Checktype = "Edit" + getid;

        }
		  else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverMatrix') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").show();
			$("#tblBconeProxyMaster123").hide();
		 $("#tblBconeProxyMasterApproval123").hide();
			
            getfinanceApprover(getid);
            //getfinanceApprover2(getid);
            changeactiontype();
           Checktype = "Edit" + getid;

        }
		else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverLocationMatrix') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
		  $("#tblBconeExpenseFinanceGlobalMatrix123").hide();
			$("#tblBconeExpenseFinanceIndiaMatrix123").show();
			$("#tblBconeProxyMaster123").hide();
			 $("#tblBconeProxyMasterApproval123").hide();
			
            getfinanceApproverIndiaMatrix(getid);
            changeactiontype();
           Checktype = "Edit" + getid;

        }
		else if ($('#ddllistsName option:selected').val() == 'BconeProxyMaster') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
		   $("#tblBconeExpenseFinanceGlobalMatrix123").hide();
			$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
			 $("#tblBconeProxyMasterApproval123").hide();
			$("#tblBconeProxyMaster123").show();
			
            GetProxyData(getid);
            changeactiontype();
           Checktype = "Edit" + getid;

        }
		
		else if ($('#ddllistsName option:selected').val() == 'BconeProxyApprover') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
		   $("#tblBconeExpenseFinanceGlobalMatrix123").hide();
			$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
			$("#tblBconeProxyMaster123").hide();
			 $("#tblBconeProxyMasterApproval123").show();
			
            GetProxyApprovalData(getid);
            changeactiontype();
           Checktype = "Edit" + getid;

        }
		
		
		
    }
    //bcon currency getid

    function getItem(id) {
		$('.loader').show();
        try {
            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeCurrency')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {

                    var i = 0;
                    var bconCurrencyname = data.d.results[i].Currency;
                    var bconCurrencyActive = data.d.results[i].IsActive;

                    $('#bccurrency').val(bconCurrencyname);
                    if (bconCurrencyActive == true) {
                        $('#rdactiveyes').prop('checked', 'checked');
                    }
                    else if (bconCurrencyActive == false) {
                        $('#rdactiveno').prop('checked', 'checked');

                    }
                    $("#Actives").val(bconCurrencyActive);


                },
                error: function (data) {
                    alert('f');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
	$('.loader').hide();
    }
    function getfinanceApprover(id) {
		$('.loader').show();
	var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
var usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
	var Financeppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.FinancepeoplePickerDiv_TopSpan;
	var usersobject = Financeppobject.GetAllUserInfo();
	usersobject.forEach(function (index) {
	Financeppobject.DeleteProcessedUser(usersobject[index]);
  });
        try {
            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeFinanceApproverMatrix')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {
				//console.log(data);

                    var i = 0;
					//alert(data.d.results[i].LoginName);
					var name =GetUserId1(data.d.results[i].FinanceApproverNameId);
					var Financename =GetUserId1(data.d.results[i].FinanceApprover2Id);
					$("#txtcountrylegal").val(data.d.results[i].CountryLegal);
					setTimeout(setpeoplepickerval(name), 1000);
					setTimeout(setFinancepeoplepickerval(Financename), 1000);
				
					
					
					//var SalesPersonEmail=data.d.result[i].SalesPerson.Name;
					
                  // document.getElementById('peoplePickerDiv_TopSpan_InitialHelpText').innerHTML=name;
				  
				  //document.getElementById("peoplePickerDivUnitHead").value="Abhay Krishna";



                },
                error: function (data) {
                   // alert('f');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
	$('.loader').hide();
    }
	 function getfinanceApproverIndiaMatrix(id) {
	 
	
	$('.loader').show();
	var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv1_TopSpan;
var usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
  var ppobject5=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan;
var usersobject = ppobject5.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject5.DeleteProcessedUser(usersobject[index]);
  });
        try {
            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeFinanceApproverLocationMatrix')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {
				//console.log(data);

                    var i = 0;
					//alert(data.d.results[i].LoginName);
					var name =GetUserId1(data.d.results[i].FinanceApproverNameId);
					var finance2name =GetUserId1(data.d.results[i].FinanceApproverName2Id);
					$("#txtEmpBaseLocation").val(data.d.results[i].EmployeeBaseLocation);
					setTimeout(setpeoplepickerval1(name), 1000);
					setTimeout(setpeoplepickerval2(finance2name), 1000);
				
				$('#ddlCurrency option[value='+data.d.results[i].Currency+']').prop("selected", true);

                },
                error: function (data) {
                   // alert('f');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
		
		$('.loader').hide();

    }
	
	function GetProxyData(id)
	{
	$('.loader').show();
	var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv2_TopSpan;
var usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
  	var ppobject1=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv3_TopSpan;
var usersobject1 = ppobject1.GetAllUserInfo();
  usersobject1.forEach(function (index) {
   ppobject1.DeleteProcessedUser(usersobject1[index]);
  });
        try {
            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeProxyMaster')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {
				//console.log(data);
               var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    var i = 0;
					//alert(data.d.results[i].LoginName);
					var name =GetUserId1(data.d.results[i].sharepointuseridId);	
					var name2 =GetUserId1(data.d.results[i].ProxysharepointidId);	
					setTimeout(setpeoplepickervalproxy(name,'1'), 1000);
					setTimeout(setpeoplepickervalproxy(name2,'2'), 1000);
					var bconCurrencyActive = data.d.results[i].IsActive;
					
					var proxy_date='';
					if(data.d.results[i].ProxyTillDate!=null && data.d.results[i].ProxyTillDate!="")
					{
					 proxy_date = new Date(data.d.results[i].ProxyTillDate);

                    var startDay = new Date(proxy_date).getDate();
                    var startMonth = new Date(proxy_date).getMonth();
                    var startYear = new Date(proxy_date).getFullYear();
					

                    proxy_date = startDay + "-" + months[startMonth] + "-" + startYear;
					
					
					}
					
                   $("#TBProxyDate").val(proxy_date);
                  
                    if (bconCurrencyActive == true) {
                        $('#proxyyesEA').prop('checked', 'checked');
                    }
                    else if (bconCurrencyActive == false) {
                        $('#proxynoEA').prop('checked', 'checked');

                    }
                    $("#Actives").val(bconCurrencyActive);


                },
                error: function (data) {
                   // alert('f');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
		
		$('.loader').hide();
	}
	function GetProxyApprovalData(id)
	{
	$('.loader').show();
	$("#ddlApproval").prop("selectedIndex",0);
	var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv4_TopSpan;
var usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
  	var ppobject1=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv5_TopSpan;
var usersobject1 = ppobject1.GetAllUserInfo();
  usersobject1.forEach(function (index) {
   ppobject1.DeleteProcessedUser(usersobject1[index]);
  });
        try {
            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeProxyApprover')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {
				//console.log(data);
               var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                    var i = 0;
					//alert(data.d.results[i].LoginName);
					var name =GetUserId1(data.d.results[i].sharepointuseridId);	
					var name2 =GetUserId1(data.d.results[i].ProxysharepointidId);	
					setTimeout(setpeoplepickervalproxyApproval(name,'1'), 1000);
					setTimeout(setpeoplepickervalproxyApproval(name2,'2'), 1000);
					var bconCurrencyActive = data.d.results[i].IsActive;
					
					var proxy_date='';
					if(data.d.results[i].ProxyTillDate!=null && data.d.results[i].ProxyTillDate!="")
					{
					 proxy_date = new Date(data.d.results[i].ProxyTillDate);

                    var startDay = new Date(proxy_date).getDate();
                    var startMonth = new Date(proxy_date).getMonth();
                    var startYear = new Date(proxy_date).getFullYear();
					

                    proxy_date = startDay + "-" + months[startMonth] + "-" + startYear;
					
					
					}
					
                   $("#TBProxyDateApproval").val(proxy_date);
                  
                    if (bconCurrencyActive == true) {
                        $('#proxyApprovalyesEA').prop('checked', 'checked');
                    }
                    else if (bconCurrencyActive == false) {
                        $('#proxyApprovalnoEA').prop('checked', 'checked');

                    }
                    $("#Actives").val(bconCurrencyActive);
					
                   
                },
                error: function (data) {
                   // alert('f');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
		
		$('.loader').hide();
	}
	function setpeoplepickerval(name){

		var SalesPerson = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan; 
		//debugger;
		SalesPerson.AddUserKeys(name);
	}
	function setFinancepeoplepickerval(name){

		var SalesPerson = this.SPClientPeoplePicker.SPClientPeoplePickerDict.FinancepeoplePickerDiv_TopSpan; 
		//debugger;
		SalesPerson.AddUserKeys(name);
	}
	function setpeoplepickervalproxy(name,type){
	if(type=='1')
	{
	var SalesPerson = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv3_TopSpan; 
	}else
	{
	var SalesPerson = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv2_TopSpan; 
	}


//debugger;
SalesPerson.AddUserKeys(name);
	}
	function setpeoplepickervalproxyApproval(name,type){
	if(type=='1')
	{
	var SalesPerson = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv5_TopSpan; 
	}else
	{
	var SalesPerson = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv4_TopSpan; 
	}


//debugger;
SalesPerson.AddUserKeys(name);
	}
	function setpeoplepickerval1(name){

var SalesPerson = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv1_TopSpan; 
//debugger;
SalesPerson.AddUserKeys(name);
	}
	function setpeoplepickerval2(fincename){

var SalesPerson1 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan; 
//debugger;
SalesPerson1.AddUserKeys(fincename);
	}
    function CheckStatus() {
        ClearBackGroundColour();
        $('.Errormsg').text("");
        if (Checktype == "Add") {
		

            if ($('#ddllistsName option:selected').val() == 'BconeCurrency') {
                BconeCurrencyInsertItem();
            }
            else if ($('#ddllistsName option:selected').val() == 'BconeItemMaster') {
                BconeItemMasterInsertItem();
            }
            else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalProjects') {
                BconeExceptionalInsertItem();
            }
            else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalApprovals') {
                BconeApprovalInsertItem();
            }
			  else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverMatrix') {
                BconeFinanceApproverMatrixInsertItem();
            }
			else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverLocationMatrix') {
                BconeFinanceApproverMatrixIndiaInsertItem();
            }
			else if ($('#ddllistsName option:selected').val() == 'BconeProxyMaster') {
                BconeProxyInsert();
            }
			else if ($('#ddllistsName option:selected').val() == 'BconeProxyApprover') {
                BconeProxyApproverInsert();
            }
        }
        else {

            if ($('#ddllistsName option:selected').val() == 'BconeCurrency') {
                bconcurrencyupdateListItem(getid);
            } else if ($('#ddllistsName option:selected').val() == 'BconeItemMaster') {
                bconitemmasterupdateListItem(getid);
            }
            else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalProjects') {
                bconExceptionalrupdateListItem(getid);
            }
            else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalApprovals') {
                BconeApprovalUpdateItem(getid);
            }
			 else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverMatrix') {
                BconeFinanceApproverMatrixUpdateItem(getid);
            }
			else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverLocationMatrix') {
                BconeFinanceApproverMatrixIndiaUpdateItem(getid);
            }
			else if ($('#ddllistsName option:selected').val() == 'BconeProxyMaster') {
                BconeProxyUpdateItem(getid);
            }
			else if ($('#ddllistsName option:selected').val() == 'BconeProxyApprover') {
                BconeProxyApproverUpdate(getid);
            }
        }

    }

    function clearItem(object) {
        //$(document).ready(function () {
        //    window.Search = $('.search-box').SumoSelect({ csvDispCount: 3, search: true, searchText: 'Type Name', placeholder: 'Type Name' });
        //});
$('.in-stock').html("Save");
        $('#hheader').text('Add New Item');
        if ($('#ddllistsName option:selected').val() == 'BconeCurrency') {
            $('#tblbconeCurrency123').show();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
				$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
				$("#tblBconeProxyMaster123").hide();
				$("#tblBconeProxyMasterApproval123").hide();
            clearBconeCurrency();
        }
        else if ($('#ddllistsName option:selected').val() == 'BconeItemMaster') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').show();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
				$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
			 $("#ddlItemtype").attr("disabled", false); 
			 $("#tblBconeProxyMaster123").hide();
			 $("#tblBconeProxyMasterApproval123").hide();

            clearItemmaster();
        }
        else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalProjects') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').show();
            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
				$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
				$("#tblBconeProxyMasterApproval123").hide();
				$("#tblBconeProxyMaster123").hide();
            clearItemExceptional();
        }
        else if ($('#ddllistsName option:selected').val() == 'BconeExceptionalApprovals') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();

            $('#tblexceptionalapprovals').show();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
				$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
				$("#ddlactiontypeEA").attr("disabled", false); 
				$("#tblBconeProxyMaster123").hide();
				$("#tblBconeProxyMasterApproval123").hide();
				
            clearItemapproval();

        }
		  else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverMatrix') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();

            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").show();
				$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
				$("#tblBconeProxyMaster123").hide();
				$("#tblBconeProxyMasterApproval123").hide();
            clearItemFinanceApproverMatrix();

        }
		else if ($('#ddllistsName option:selected').val() == 'BconeFinanceApproverLocationMatrix') {
            $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();

            $('#tblexceptionalapprovals').hide();
			$("#tblBconeExpenseFinanceGlobalMatrix123").hide();
				$("#tblBconeExpenseFinanceIndiaMatrix123").show();
				
				$("#tblBconeProxyMaster123").hide();
				$("#tblBconeProxyMasterApproval123").hide();
            clearItemFinanceApproverIndiaMatrix();

        }
else if ($('#ddllistsName option:selected').val() == 'BconeProxyMaster') {
             $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
		   $("#tblBconeExpenseFinanceGlobalMatrix123").hide();
			$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
			
			
			$("#tblBconeProxyMaster123").show();
			$("#tblBconeProxyMasterApproval123").hide();
            clearbeconeproxydata();

        }
		else if ($('#ddllistsName option:selected').val() == 'BconeProxyApprover') {
             $('#tblbconeCurrency123').hide();
            $('#tblbconitemmaster').hide();
            $('#tblbconeexceptional').hide();
            $('#tblexceptionalapprovals').hide();
		   $("#tblBconeExpenseFinanceGlobalMatrix123").hide();
			$("#tblBconeExpenseFinanceIndiaMatrix123").hide();
			
			
			$("#tblBconeProxyMaster123").hide();
			$("#tblBconeProxyMasterApproval123").show();
			
            clearbeconeproxydataApproval();

        }
        Checktype = "Add";
    }

function clearItemFinanceApproverMatrix()
{

	var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
	var usersobject = ppobject.GetAllUserInfo();
	usersobject.forEach(function (index) 
	{
		ppobject.DeleteProcessedUser(usersobject[index]);
	});
	var Financeppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.FinancepeoplePickerDiv_TopSpan;
	var Financeusersobject = Financeppobject.GetAllUserInfo();
	Financeusersobject.forEach(function (index) {
	Financeppobject.DeleteProcessedUser(Financeusersobject[index]);
  });
  $("#txtcountrylegal").val("");
   $('.Errormsg').text("");
  
}

function clearItemFinanceApproverIndiaMatrix()
{

var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv1_TopSpan;
var usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
  
  var ppobject6=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan;
var usersobject6 = ppobject6.GetAllUserInfo();
  usersobject6.forEach(function (index) {
   ppobject6.DeleteProcessedUser(usersobject6[index]);
  });
  $("#txtEmpBaseLocation").val('');
   $('.Errormsg').text("");
  
}

function clearbeconeproxydata()
{

var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv2_TopSpan;
var usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
  ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv3_TopSpan;
  usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
   $('.Errormsg').text("");
   $("#TBProxyDate").val('');
    $("input:radio").attr("checked", false);
   
  
}
function clearbeconeproxydataApproval()
{

var ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv4_TopSpan;
var usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
  ppobject=this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv5_TopSpan;
  usersobject = ppobject.GetAllUserInfo();
  usersobject.forEach(function (index) {
   ppobject.DeleteProcessedUser(usersobject[index]);
  });
   $('.Errormsg').text("");
   $("#TBProxyDateApproval").val('');
    $("input:radio").attr("checked", false);
   $("#ddlApproval").prop('selectedIndex', 0);
  
}

    //bcon currency Insertitem

    function BconeCurrencyInsertItem() {
	
        siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';

        $('.Errormsg').text("");

        var Currency = document.getElementById("bccurrency");
        var CurrencyIsActive = ($('input[name=Actives]:checked', '#radiobuttons').val());
       // var valCur = /^[A-Za-z ]+$/;
      var valExp=/^[a-zA-Z0-9 ._-]+$/;
        if (Currency.value == '' || Currency.value == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the currency name');
            //alert('Please enter the Currency Name');
            $('#divbcCurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            $('#bccurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            Currency.focus();
            // $('.Errormsg').text("");
            return false;

        }

        var match = (new RegExp('[/:;?*<>~#%&{}+\|]|\\.\\.|^\\.|\\.$')).test(Currency.value);
       if (!valExp.test(Currency.value))  {
            $('.Errormsg').text("");
            $('.Errormsg').text("You have entered an invalid following characters:.(period)/:;|?'<>*#~%&{}+");
            $('#divbcCurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            $('#bccurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            Currency.focus();
            return false;
        }
		   else {
            var validateItem = ItemValidateItem_currency(Currency.value);
            if (validateItem > 0) {
                alert('This Currency : ' + Currency.value + ' Already Exist');
                $('#bccurrency').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("bccurrency").focus();
                return false;
            }
        }
        //if (!valCur.test(Currency)) {

        //    $('.Errormsg').text("");
        //    $('.Errormsg').text('Invalid Currency Name');
        //    Currency.focus();
        //    return false;
        //}

        if (CurrencyIsActive == '' || CurrencyIsActive == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select IsActive option');

            $('#radiobuttons').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            //alert('Please select the option');
            document.getElementById("radiobuttons").focus();
            //$('.Errormsg').text("");
            return false;

        }


        else {
		
		$('.loader').show();
            var currency = document.getElementById("bccurrency").value;
            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeCurrency');
            var itemCreateInfo = new SP.ListItemCreationInformation();
            var get = $('#rdactiveyes').is(':checked');
            this.oListItem = oList.addItem(itemCreateInfo);
            oListItem.set_item('Currency', currency);
            oListItem.set_item('IsActive', get);

            oListItem.update();
            clientContext.load(oListItem);
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededInsertItem),
                Function.createDelegate(this, this.onQueryFailedInsertItem)
            );
			
			
        }
        ClearBackGroundColour();
    }

    function onQuerySucceededInsertItem() {
      //  alert('Data Saved Successfully');
		showmsg('Data Saved Successfully');
        //if (true)
		$('.loader').hide();
        //    window.location.href = window.location.href;
        plotlistdata($('#ddllistsName option:selected').val());
        $("[data-dismiss=modal]").trigger({ type: "click" });

        //if (true)
        //    window.location.href = window.location.href;
    }
    function onQueryFailedInsertItem(sender, args) {
        //alert("Currency All Ready Exist In List");
		$('.loader').hide();
    }

    function clearBconeCurrency() {
        $('#bccurrency').val("");
        $("input:radio").attr("checked", false);
        $('.Errormsg').text("");
    }

    function clearItemmaster() {
        $('#tbitemtype').val("");
        $('#tbitem').val("");
        $('#tbitemAccno').val("");
		$('#tbitemPrice').val("");
		$('#tbitemQuantity').val("");
        $("input:radio").attr("checked", false);
		$("#DDItemCurrency")[0].selectedIndex = 0;
        $('.Errormsg').text("");
    }



    function bconcurrencyupdateListItem(CurrentItemID) {
        var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';

        $('.Errormsg').text("");
        var Currency = document.getElementById("bccurrency");
        var CurrencyIsActive = ($('input[name=Actives]:checked', '#radiobuttons').val());
        //var valCur = /^[A-Za-z ]+$/;
      var valExp=/^[a-zA-Z0-9 ._-]+$/;
        if (Currency.value == '' || Currency.value == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the currency name');
            $('#divbcCurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            $('#bccurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            Currency.focus();
            return false;

        }

        var match = (new RegExp('[/:;?*<>~#%&{}+\|]|\\.\\.|^\\.|\\.$')).test(Currency.value);
     if (!valExp.test(Currency.value)){
            $('.Errormsg').text("");
            $('.Errormsg').text("You have entered an invalid following characters:.(period)/:;|?'<>*#~%&{}+");
            $('#divbcCurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            $('#bccurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            Currency.focus();
            return false;
        }

        //if (!valCur.test(Currency)) {

        //    $('.Errormsg').text("");
        //    $('.Errormsg').text('Invalid Currency Name');
        //    Currency.focus();
        //    return false;
        //}

        if (CurrencyIsActive == '' || CurrencyIsActive == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select IsActive option');
            $('#radiobuttons').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("radiobuttons").focus();
            return false;

        }
        else {
		
		$('.loader').show();
            var Updatecurrency = $('#bccurrency').val();
            var get = $('#rdactiveyes').is(':checked');
            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeCurrency');

            this.oListItem = oList.getItemById(CurrentItemID);

            oListItem.set_item('Currency', Updatecurrency);
            oListItem.set_item('IsActive', get);

            oListItem.update();

            clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));
			
			
        }
        ClearBackGroundColour();
    }

    function onQuerySucceeded() {

       // alert('Data Saved Successfully');
		showmsg('Data Updated Successfully');
		$('.loader').hide();
        //if (true)
        //    window.location.href = window.location.href;

        plotlistdata($('#ddllistsName option:selected').val());
        $("[data-dismiss=modal]").trigger({ type: "click" });
    }

    function onQueryFailed(sender, args) {
$('.loader').hide();
        alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
    }
    //delete currncy item

    function deleteCurrencyListItem(itemId) {
        var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
        var clientContext = new SP.ClientContext(siteUrl);
        var oList = clientContext.get_web().get_lists().getByTitle('BconeCurrency');
        this.oListItem = oList.getItemById(itemId);
        oListItem.deleteObject();
        clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceededcurrencyitemdelete), Function.createDelegate(this, this.onQueryFailedcurrencyitemdelete));
    }

    function onQuerySucceededcurrencyitemdelete() {

        alert('Item deleted');
        //plotlistdata($('#ddllistsName option:selected').val());
    }

    function onQueryFailedcurrencyitemdelete(sender, args) {

        alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
    }
    //BconItem insertmasteritem
    function BconeItemMasterInsertItem() {

        $('.Errormsg').text("");
        siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';

        var itemtype = $('#ddlItemtype :selected').text();
       // var valExp = /^[A-Za-z0-9 ]+$/;
				var valExp=/^[a-zA-Z0-9 ._-]+$/;
        var item = document.getElementById("tbitem").value;
        var IsActive = ($('input[name=itemActives]:checked', '#divitemisactive').val());
		
        var tbitemAccno = $('#tbitemAccno').val();
        var IsPQDependant = ($('input[name=itemIsPQDependant]:checked', '#itemIsPQDependant').val());
		
		var Currency = document.getElementById("DDItemCurrency").value;
		var Currency1 = $('#DDItemCurrency :selected').text();

		if(itemtype=="Expense Item")
		{
		     
	  
	   if(IsPQDependant=="Yes")
	   {
	  $("#Tr_Price").show();
	   $("#Tr_ItemCurrencydd").show();
	   $("#Tr_Quantity").show();
	  
	   }
	   else
	   {
	  $("#Tr_Price").hide();
	   $("#Tr_ItemCurrencydd").hide();
	   $("#Tr_Quantity").hide();
	   }
	   }
		//alert("IsPQDependant"+IsPQDependant);
		var price="0";
		var quantity="1";
		var Txtprice=document.getElementById("tbitemPrice").value;
		var Txtquantity=document.getElementById("tbitemQuantity").value;
        if (item == '' || item == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Item Name');
            $('#tbitem').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitem").focus();
            return false;

        }

        if (!valExp.test(item)) {

            $('.Errormsg').text("");
            $('.Errormsg').text("You have entered an invalid following characters:.(period)/:;|?'<>*#~%&{}+");
            $('#tbitem').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitem").focus();
            return false;
        }
        else {
            var validateItem = ItemValidateItem(itemtype, item);
            if (validateItem > 0) {
                alert('This Item : ' + item + ' Already Exist');
                $('#tbitem').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("tbitem").focus();
                return false;
            }
        }
		
		if(itemtype=="Expense Item")
		{
		
    if (IsPQDependant == '' || IsPQDependant == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select IsPQDependent option');
            $('#itemIsPQDependant').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("itemIsPQDependant").focus();
            return false;
        }
		
		else
		{
		 var radioIsPQDependant = ($('input[name=itemIsPQDependant]:checked', '#itemIsPQDependant').val());
		 
		 if(radioIsPQDependant=="Yes")
		 {
		  if (Txtprice == '' || Txtprice == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Price');
            $('#tbitemPrice').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemPrice").focus();
            return false;

        }
		else if(Currency=='0')
		{
		$('.Errormsg').text("");
            $('.Errormsg').text('Please select Currency');
            $('#DDItemCurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("DDItemCurrency").focus();
            return false;
		
		}
		
		else if (Txtquantity == '' || Txtquantity == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the quantity');
            $('#tbitemQuantity').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemQuantity").focus();
            return false;

        }
		
		else
		{
		 price=Txtprice;
		 quantity=Txtquantity;
		
		}
		 
	}

		}
	}
      

        if (tbitemAccno == '' || tbitemAccno == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the SAP acc no');
            $('#tbitemAccno').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemAccno").focus();
            return false;
        }

        if (!valExp.test(tbitemAccno)) {

            $('.Errormsg').text("");
            $('.Errormsg').text("You have entered an invalid following characters:.(period)/:;|?'<>*#~%&{}+");
            $('#tbitemAccno').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemAccno").focus();
            return false;

        }

        if (tbitemAccno.length > 10) {

            $('.Errormsg').text("");
            $('.Errormsg').text('SAP account number must contain only 10 characters');
            $('#tbitemAccno').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemAccno").focus();
            return false;

        }
		  if (IsActive == '' || IsActive == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select IsActive option');
            $('#divitemisactive').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("divitemisactive").focus();
            return false;
        }

        else {
		$('.loader').show();
            var Accno = document.getElementById("tbitemAccno").value;
            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeItemMaster');
            var itemCreateInfo = new SP.ListItemCreationInformation();
            var itemget = $('#tbitemactiveyes').is(':checked');
            this.oListItem = oList.addItem(itemCreateInfo);
            oListItem.set_item('ItemType', itemtype);
            oListItem.set_item('Item', item);
            oListItem.set_item('SAPAccNo', Accno);	
			if(itemtype=="Expense Item")
		{
			
if(IsPQDependant=="Yes")
{
oListItem.set_item('IsPQDependant', true);
oListItem.set_item('ItemCurrency', Currency);
oListItem.set_item('ItemCurrencyText', Currency1);

 }else
 {
   oListItem.set_item('IsPQDependant', false);
   oListItem.set_item('ItemCurrency', '');
   oListItem.set_item('ItemCurrencyText', '');
 }
  
 
            oListItem.set_item('Price', price);
            oListItem.set_item('Quantity', quantity);
			
			}
			
            oListItem.set_item('IsActive', itemget);
            oListItem.update();
            clientContext.load(oListItem);
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededInsertItem),
                Function.createDelegate(this, this.onQueryFailedInsertItem)
            );
			
        }
        ClearBackGroundColour();
    }

    function onQuerySucceededInsertItem() {
      
		showmsg('Data Saved Successfully');
$('.loader').hide();
        //if (true)
        //    window.location.href = window.location.href;
        plotlistdata($('#ddllistsName option:selected').val());
        $("[data-dismiss=modal]").trigger({ type: "click" });
    }
    function onQueryFailedInsertItem(sender, args) {
        $('.loader').hide();
	
        //alert("Error in MasterItem");
    }
    function ItemValidateItem(ItemType, Item) {

        var Result = 0;
        var url = "https://bristleconeonline.sharepoint.com/sites/pwa/_api/web/lists/getbytitle('BconeItemMaster')/items?$filter=(ItemType eq '" + ItemType + "') and (Item eq '" + Item + "')";
        $.ajax({
            url: url,
            type: "GET",
            async: false,
            headers: {
                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                "Accept": "application/json; odata=verbose",
                "Content-Type": "application/json; odata=verbose"
            },
            success: function (data) {
                Result = data.d.results.length;
            },
            error: function (error) {
                alert('error in ValidateItem(ItemType, Item)');
            }
        });
        return Result;
    }
	  function ItemValidateItem_currency(Currency) {

        var Result = 0;
        var url = "https://bristleconeonline.sharepoint.com/sites/pwa/_api/web/lists/getbytitle('BconeCurrency')/items?$filter=(Currency eq '" + Currency + "')";
        $.ajax({
            url: url,
            type: "GET",
            async: false,
            headers: {
                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                "Accept": "application/json; odata=verbose",
                "Content-Type": "application/json; odata=verbose"
            },
            success: function (data) {
                Result = data.d.results.length;
            },
            error: function (error) {
                alert('error in ValidateItem(ItemType, Item)');
            }
        });
        return Result;
    }
    //get id itemmaster
    function getItemmasterid(id) {
	
	
	$('#tbitemPrice').val("");
    $('#tbitemQuantity').val("");
	$('.loader').show();
        try {
	 $("#ddlItemtype").attr("disabled", "disabled"); 

            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeItemMaster')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {

                    var result = data.d.results;
                    var index = 0;
                    $("#ddlItemtype option").each(function () {
                        if (this.text == result[0].ItemType) {
                            $("#ddlItemtype").prop('selectedIndex', index);
                            return false;
                        }
                        index = index + 1;
                    });
					ChangeItemtype();
					$("#DDItemCurrency option").each(function () {
                        if (this.value == result[0].ItemCurrency) {
                            $("#DDItemCurrency").prop('selectedIndex', index);
                            return false;
                        }
                        index = index + 1;
                    });
                    var index = 0;
                    $('#tbitem').val(result[0].Item);
                    $('#tbitemAccno').val(result[0].SAPAccNo);


                    if (result[0].IsActive == true) {
                        $('#tbitemactiveyes').prop('checked', 'checked');
                    }
                    else if (result[0].IsActive == false) {
                        $('#tbitemactiveno').prop('checked', 'checked');
                    }
					
					if(result[0].ItemType=="Expense Item")
					{
					 if (result[0].IsPQDependant== true) {
					 
					  $("#Tr_Price").show();
					   $("#Tr_ItemCurrencydd").show();
	                  $("#Tr_Quantity").show();
	                  $('#tbitemPrice').val(result[0].Price);
	                  $('#tbitemQuantity').val(result[0].Quantity);
                        $('#divitemIsPQDependantyes').prop('checked', 'checked');
                    }
                    else if (result[0].IsPQDependant == false) {
                        $('#divitemIsPQDependantno').prop('checked', 'checked');
						 $("#Tr_Price").hide();
						  $("#Tr_ItemCurrencydd").hide();
	                     $("#Tr_Quantity").hide();
						 $('#tbitemPrice').val();
	                  $('#tbitemQuantity').val();
                    }
					}


                },
                error: function (data) {
                    alert('f');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
	$('.loader').hide();
    }
	
	function vlaidate()
	{
		var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;   
		var users = peoplePicker.GetAllUserInfo();
		var FinancepeoplePicker1 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.FinancepeoplePickerDiv_TopSpan;   
		var Financeusers1 = FinancepeoplePicker1.GetAllUserInfo();
		var countrylegal = document.getElementById("txtcountrylegal").value;
			
		if(countrylegal==""||countrylegal=="undefined")
		{
		//alert('more than 1');


		$('.Errormsg').text("");
				$('.Errormsg').text('Please enter country legal');
				$('#txtcountrylegal').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
				return false;
		}

		//var check=CheckDuplicate(countrylegal,'CountryLegal','Text','BconeFinanceApproverMatrix');
		else if(CheckDuplicate(countrylegal,'CountryLegal','Text','BconeFinanceApproverMatrix'))
		{
				$('.Errormsg').text("");
				$('.Errormsg').text('Country legal Already Exist');
				$('#txtcountrylegal').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
			return false;
		}

		else if(users.length==0)
		{
		//alert('0');
		$('.Errormsg').text("");
				$('.Errormsg').text('Please enter the finanace Name');
				$('#peoplePickerDiv').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
				return false;
		}
		else if(users.length>1)
		{
		//alert('more than 1');
		$('.Errormsg').text("");
				$('.Errormsg').text('Please enter the only 1 finanace Name');
				$('#peoplePickerDiv').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
				return false;
		}
		else if(Financeusers1.length>=1)
		{
			if(users[0].Key==Financeusers1[0].Key)
			{
				$('.Errormsg').text("");
				$('.Errormsg').text('Approver 1 and Approver 2 name cant be same');
				$('#peoplePickerDiv').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
				$('#FinancepeoplePickerDiv').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
				return false;
			}
			return true;
		}

	return true;
	}
	
function BconeFinanceApproverMatrixInsertItem()
{
	
		var vlaidates=vlaidate()
 if(vlaidates==true)
 {
	$('.loader').show();
	var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
	var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;   
	var users = peoplePicker.GetAllUserInfo();
	var FinancepeoplePicker1 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.FinancepeoplePickerDiv_TopSpan;   
	var Financeusers1 = FinancepeoplePicker1.GetAllUserInfo();
	var countrylegal = document.getElementById("txtcountrylegal").value;
	 $('.Errormsg').text("");
          
            $('#peoplePickerDiv').css({

                "border": "",
                "background": ""
            });
			$('#FinancepeoplePickerDiv').css({

                "border": "",
                "background": ""
            });
			
			
			var keys = peoplePicker.GetAllUserKeys();
       var finalusers = new Array();
       for (var i = 0; i < users.length; i++) {
       var arryuser = users[i];
       finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));
     }
	 if(Financeusers1.length>=1)
	 {
		var keys = FinancepeoplePicker1.GetAllUserKeys();
       var Financefinalusers1 = new Array();
       for (var i = 0; i < Financeusers1.length; i++) {
       var Financearryuser1 = Financeusers1[i];
       Financefinalusers1.push(SP.FieldUserValue.fromUser(Financearryuser1.Key));
     }
	 }
		   
            var Updateitemaccno = finalusers;
			var countrylegal=countrylegal;
			 //var Updateitemaccno = '8';

            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeFinanceApproverMatrix');
             var itemCreateInfo = new SP.ListItemCreationInformation();
            //this.oListItem = oList.getItemById(CurrentItemID);
              this.oListItem = oList.addItem(itemCreateInfo);
            oListItem.set_item('FinanceApproverName', Updateitemaccno);
			oListItem.set_item('FinanceApprover2', Financefinalusers1);
			 oListItem.set_item('CountryLegal', countrylegal);
			 //oListItem.set_item('Title', Updateitemaccno);
	

            oListItem.update();

             clientContext.load(oListItem);
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededInsertItem),
                Function.createDelegate(this, this.onQueryFailedInsertItem)
            );
			
		//alert(finalusers);
}

}


function validateinserfinance()
{
var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv1_TopSpan;   
		var users = peoplePicker.GetAllUserInfo();

		var peoplePicker10 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan;   
		var users10 = peoplePicker10.GetAllUserInfo();

		var emplocation = document.getElementById("txtEmpBaseLocation").value;
		var  currency = $("#ddlCurrency option:selected").val();
 if(emplocation==""||emplocation=="undefined")
{
//alert('more than 1');


 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter Employee Location');
            $('#txtEmpBaseLocation').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}

//var check=CheckDuplicate(countrylegal,'CountryLegal','Text','BconeFinanceApproverMatrix');
else if(CheckDuplicate(emplocation,'EmployeeBaseLocation','Text','BconeFinanceApproverLocationMatrix'))
{
            $('.Errormsg').text("");
            $('.Errormsg').text('Employee Location Already Exist');
            $('#txtEmpBaseLocation').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
	return false;
}

else if(users.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the finanace Name');
            $('#peoplePickerDiv1').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}
else if(users.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 finanace Name');
            $('#peoplePickerDiv1').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}
else if(users10.length>1)
{
//alert('more than 1');
		$('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 finanace Name2');
            $('#peoplePickerDiv1').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}


	else if(users10.length>=1)
	{
		if(users[0].Key==users10[0].Key)
		{
			$('.Errormsg').text("");
			$('.Errormsg').text("Approver 1 and Approver 2 name cant be same");
			$('#peoplePickerDiv1').css({
				"border": "1px solid red",
                "background": "#FFCECE"
			});
			$('#peoplePickerDiv10').css({
				"border": "1px solid red",
                "background": "#FFCECE"
			});
			return false;
		}
		return true;
	}
	return true;
}

function BconeFinanceApproverMatrixIndiaInsertItem()
{
	var valsidates=validateinserfinance();
	if(valsidates==true)
	{


		var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv1_TopSpan;   
		var users = peoplePicker.GetAllUserInfo();

		var peoplePicker10 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan;   
		var users10 = peoplePicker10.GetAllUserInfo();

		var emplocation = document.getElementById("txtEmpBaseLocation").value;
		var  currency = $("#ddlCurrency option:selected").val();
$('.loader').show();
 $('.Errormsg').text("");
          
            $('#peoplePickerDiv1').css({

                "border": "",
                "background": ""
            });
			
			var keys = peoplePicker.GetAllUserKeys();
       var finalusers = new Array();
       for (var i = 0; i < users.length; i++) {
       var arryuser = users[i];
       finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));
     }
	 
	 
	   
	   var keys = peoplePicker10.GetAllUserKeys();
       var finalusers10 = new Array();
       for (var i = 0; i < users10.length; i++) {
       var arryuser10 = users10[i];
       finalusers10.push(SP.FieldUserValue.fromUser(arryuser10.Key));
     }
		   
            var Updateitemaccno = finalusers;
            var Updateitemaccno10 = finalusers10;
			var emplocation=emplocation;
			 //var Updateitemaccno = '8';
			 

            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeFinanceApproverLocationMatrix');
             var itemCreateInfo = new SP.ListItemCreationInformation();
            //this.oListItem = oList.getItemById(CurrentItemID);
              this.oListItem = oList.addItem(itemCreateInfo);
            oListItem.set_item('FinanceApproverName', Updateitemaccno);
            oListItem.set_item('FinanceApproverName2', Updateitemaccno10);
			 oListItem.set_item('EmployeeBaseLocation', emplocation);
			  oListItem.set_item('Currency', currency);
			 //oListItem.set_item('Title', Updateitemaccno);
	

            oListItem.update();

             clientContext.load(oListItem);
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededInsertItem),
                Function.createDelegate(this, this.onQueryFailedInsertItem)
            );
			
		//alert(finalusers);
}

}
function BconeProxyInsert()
{
 var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv2_TopSpan;   
       var users = peoplePicker.GetAllUserInfo();
	   var peoplePicker1 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv3_TopSpan;   
       var users1 = peoplePicker1.GetAllUserInfo();
	   var IsActive = ($('input[name=forexpensemodule2proxy]:checked', '#proxyIsActive').val());
	    var ProxyDate = $('#TBProxyDate').val();
    
 
var duplicate_result=false;
var  result_return=false;
 for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    
		for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser1 = users1[i];	  
	    if(arryuser.Key==arryuser1.Key)
		
		{
		
		result_return=true;
		
		
		}
		else
		{
		 var  proxy_detail=getResourcesGuidNew(arryuser.Key);
		 var proxy_id=proxy_detail.split("_");
		 
		 var  emp_detail=getResourcesGuidNew(arryuser1.Key);
		 
		 var emp_ids=emp_detail.split("_");
		 
		 
		 var my_result=checkduplicateProxy(proxy_id[0],'Text','ProxyGuid',emp_ids[0],'Text','EmpGuid','BconeProxyMaster','','');
		 if(my_result==true)
		 {
		 duplicate_result=true;
		 
		 }
		 
		 
		 
		}
		
		}
		}
		if(users.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Proxy Name');
            $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if(users.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 Proxy Name');
            $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
 else if(users1.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Employee Name');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
		
	else if (result_return==true)
		{
		
		$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name cannot be the same');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		}
		
		else if(duplicate_result==true)
		{
			$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name already Exists.');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		
		}
//else if (ProxyDate == '') {
//
//            $('.Errormsg').text("");
//            $('.Errormsg').text('Please enter the ProxyDate ');
//            $('#TBProxyDate').css({
//
//                "border": "1px solid red",
//                "background": "#FFCECE"
//            });
//            document.getElementById("TBProxyDate").focus();
//            return false;
//
//        }
 else if (IsActive == '' || IsActive == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#proxyIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("proxyIsActive").focus();
                return false;

            }
else
{
	$('.loader').show(); 
 $('.Errormsg').text("");
          
            $('#peoplePickerDiv2').css({

                "border": "",
                "background": ""
            });
	   var finalusers_emp=new Array();
	     
	  var keys = peoplePicker.GetAllUserKeys();
       var finalusers = new Array();
	   var proxy_detail;
	   var proxy_name;
       for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    proxy_detail=getResourcesGuidNew(arryuser.Key);
		proxy_name=arryuser.DisplayText;	  
        finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));

      }	 
      var proxy_id=proxy_detail.split("_");
        var Updateitemaccno = finalusers; 
	   var emp_detail;
	   var emp_name;
	   for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser = users1[i];	      
	    emp_detail=getResourcesGuidNew(arryuser.Key);
		emp_name=arryuser.DisplayText;	  
        finalusers_emp.push(SP.FieldUserValue.fromUser(arryuser.Key));
		
		var get = $('#proxyyesEA').is(':checked');
		var exstrtdate = '';
		var emp_ids=emp_detail.split("_");
       var Updateitemaccno_emp = finalusers_emp;
	   
	   
		InsertBconeProxy(proxy_id[0],proxy_id[1],proxy_name,Updateitemaccno,emp_ids[0],emp_ids[1],emp_name,Updateitemaccno_emp[i],exstrtdate,get);
		
		
		
      }
	   
	 	  
			ClearBackGroundColour();
			
	
}
}
function BconeProxyApproverInsert()
{
 var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv4_TopSpan;   
       var users = peoplePicker.GetAllUserInfo();
	   var peoplePicker1 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv5_TopSpan;   
       var users1 = peoplePicker1.GetAllUserInfo();
	   var IsActive = ($('input[name=forexpensemodule2proxy]:checked', '#proxyApprovalIsActive').val());
	    var ProxyDate = $('#TBProxyDateApproval').val();
        var  ProxyApproverType = 'Manager Approval';
		
		
		var duplicate_result=false;
var  result_return=false;
 for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    
		for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser1 = users1[i];	  
	    if(arryuser.Key==arryuser1.Key)
		
		{
		
		result_return=true;
		
		
		}
		else
		{
		 var  proxy_detail=getResourcesGuidNew(arryuser.Key);
		 var proxy_id=proxy_detail.split("_");
		 
		 var  emp_detail=getResourcesGuidNew(arryuser1.Key);
		 
		 var emp_ids=emp_detail.split("_");
		 
		 
		 var my_result=checkduplicateProxy(proxy_id[0],'Text','ProxyGuid',emp_ids[0],'Text','EmpGuid','BconeProxyApprover','','');
		 if(my_result==true)
		 {
		 duplicate_result=true;
		 
		 }
		 
		 
		 
		}
		
		}
		}
  if(users.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Proxy Name');
            $('#peoplePickerDiv4').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if(users.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 Proxy Name');
            $('#peoplePickerDiv5').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
 else if(users1.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Employee Name');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if (ProxyApproverType == '0') {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select approval type');
            $('#ddlApproval').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("ddlApproval").focus();
            return false;

        }
		
			else if (result_return==true)
		{
		
		$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name cannot be the same');
            $('#peoplePickerDiv4').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv5').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		}
		
		else if(duplicate_result==true)
		{
			$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name already Exists.');
            $('#peoplePickerDiv4').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv5').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		
		}
//else if (ProxyDate == '') {
//
//            $('.Errormsg').text("");
//            $('.Errormsg').text('Please enter the ProxyDate ');
//            $('#TBProxyDateApproval').css({
//
//                "border": "1px solid red",
//                "background": "#FFCECE"
//            });
//            document.getElementById("TBProxyDateApproval").focus();
//            return false;
//
//        }
 else if (IsActive == '' || IsActive == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#proxyApprovalIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("proxyApprovalIsActive").focus();
                return false;

            }
else
{
	$('.loader').show(); 
 $('.Errormsg').text("");
          
            $('#peoplePickerDiv4').css({

                "border": "",
                "background": ""
            });
	   var finalusers_emp=new Array();
	     
	  var keys = peoplePicker.GetAllUserKeys();
       var finalusers = new Array();
	   var proxy_detail;
	   var proxy_name;
       for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    proxy_detail=getResourcesGuidNew(arryuser.Key);;
		proxy_name=arryuser.DisplayText;	  
        finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));

      }	 
      var proxy_id=proxy_detail.split("_");
        var Updateitemaccno = finalusers; 
	   var emp_detail;
	   var emp_name;
	   for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser = users1[i];	  
	    emp_detail=getResourcesGuidNew(arryuser.Key);;
		emp_name=arryuser.DisplayText;	  
        finalusers_emp.push(SP.FieldUserValue.fromUser(arryuser.Key));
		
		var get = $('#proxyyesEA').is(':checked');
		var exstrtdate = "";
		var emp_ids=emp_detail.split("_");
       var Updateitemaccno_emp = finalusers_emp;
		InsertBconeProxyApproval(proxy_id[0],proxy_id[1],proxy_name,Updateitemaccno,emp_ids[0],emp_ids[1],emp_name,Updateitemaccno_emp[i],exstrtdate,get,ProxyApproverType);
      }
	   
	 	  
			ClearBackGroundColour();
			
	
}
}

function InsertBconeProxy(ProxyGuid,ProxyId,ProxyName,Proxysharepointid,EmpGuid,EmpId,EmpName,sharepointuserid,ProxyTillDate,IsActive)
{
           //alert(ProxyName+" "+EmpName);
	 
            var clientContext = new SP.ClientContext.get_current();
            var oList = clientContext.get_web().get_lists().getByTitle('BconeProxyMaster');
            var itemCreateInfo = new SP.ListItemCreationInformation();
            this.oListItem = oList.addItem(itemCreateInfo);
    
            oListItem.set_item('ProxyGuid', ProxyGuid);
            oListItem.set_item('ProxyId', ProxyId);
            oListItem.set_item('ProxyName', ProxyName);
            oListItem.set_item('Proxysharepointid', Proxysharepointid);
            oListItem.set_item('EmpGuid', EmpGuid);
            oListItem.set_item('EmpId', EmpId);
            oListItem.set_item('EmpName', EmpName);
            oListItem.set_item('sharepointuserid', sharepointuserid);
           /// oListItem.set_item('ProxyTillDate', ProxyTillDate);
            oListItem.set_item('IsActive', IsActive);
			oListItem.set_item('Title', EmpName);
		
         
            oListItem.update();
            clientContext.load(oListItem);
			
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededExceptional1),
                Function.createDelegate(this, this.onQueryFailedExceptional)
            );
}

function InsertBconeProxyApproval(ProxyGuid,ProxyId,ProxyName,Proxysharepointid,EmpGuid,EmpId,EmpName,sharepointuserid,ProxyTillDate,IsActive,ProxyApproverType)
{
           //alert(ProxyName+" "+EmpName);
	 
            var clientContext = new SP.ClientContext.get_current();
            var oList = clientContext.get_web().get_lists().getByTitle('BconeProxyApprover');
            var itemCreateInfo = new SP.ListItemCreationInformation();
            this.oListItem = oList.addItem(itemCreateInfo);
    
            oListItem.set_item('ProxyGuid', ProxyGuid);
            oListItem.set_item('ProxyId', ProxyId);
            oListItem.set_item('ProxyName', ProxyName);
            oListItem.set_item('Proxysharepointid', Proxysharepointid);
            oListItem.set_item('EmpGuid', EmpGuid);
            oListItem.set_item('EmpId', EmpId);
            oListItem.set_item('EmpName', EmpName);
            oListItem.set_item('sharepointuserid', sharepointuserid);
            //oListItem.set_item('ProxyTillDate', ProxyTillDate);
            oListItem.set_item('IsActive', IsActive);
			oListItem.set_item('Title', EmpName);
			oListItem.set_item('ProxyApproverType', ProxyApproverType);
			
		
         
            oListItem.update();
            clientContext.load(oListItem);
			
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededExceptional1),
                Function.createDelegate(this, this.onQueryFailedExceptional)
            );
}
function financevalidate(CurrentItemID)
{
	var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
	var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;   
	var users = peoplePicker.GetAllUserInfo();
	var FinancepeoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.FinancepeoplePickerDiv_TopSpan;   
	var Financeusers = FinancepeoplePicker.GetAllUserInfo();
	var countrylegal = document.getElementById("txtcountrylegal").value;
if(countrylegal==""||countrylegal=="undefined")
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter country legal');
           $('#txtcountrylegal').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;

}
else if(CheckDuplicateForUpdate(countrylegal,'CountryLegal','Text','BconeFinanceApproverMatrix',CurrentItemID,'ID','COUNTER'))
{

 $('.Errormsg').text("");
            $('.Errormsg').text('Country legal Already Exist.');
            $('#txtcountrylegal').css({

                "border": "1px solid red",
                "background": "#FFCECE"
           });

return false;
}
else if(users.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the finanace Name');
            $('#peoplePickerDiv').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}
else if(users.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 finanace Name');
            $('#peoplePickerDiv').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}
else if(Financeusers.length>=1)
		{
			if(users[0].Key==Financeusers[0].Key)
			{
				$('.Errormsg').text("");
				$('.Errormsg').text('Approver 1 and Approver 2 name cant be same');
				$('#peoplePickerDiv').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
				$('#FinancepeoplePickerDiv').css({

					"border": "1px solid red",
					"background": "#FFCECE"
				});
				return false;
			}
			
		}
		return true;

}
function BconeFinanceApproverMatrixUpdateItem(CurrentItemID)
{
var vlidatefinance=financevalidate(CurrentItemID);
if(vlidatefinance== true)
{
	var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
	var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;   
	var users = peoplePicker.GetAllUserInfo();
	var FinancepeoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.FinancepeoplePickerDiv_TopSpan;   
	var Financeusers = FinancepeoplePicker.GetAllUserInfo();
	var countrylegal = document.getElementById("txtcountrylegal").value;
		

 
$('.loader').show();
 $('.Errormsg').text("");
          
            $('#peoplePickerDiv').css({

                "border": "",
                "background": ""
            });
			$('#FinancepeoplePickerDiv').css({

                "border": "",
                "background": ""
            });
			
			
			var keys = peoplePicker.GetAllUserKeys();
       var finalusers = new Array();
       for (var i = 0; i < users.length; i++) {
       var arryuser = users[i];
       finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));
     }
	 if(Financeusers.length>=1)
	 {
		var keys = FinancepeoplePicker.GetAllUserKeys();
       var Financefinalusers = new Array();
       for (var i = 0; i < Financeusers.length; i++) {
       var Financearryuser = Financeusers[i];
       Financefinalusers.push(SP.FieldUserValue.fromUser(Financearryuser.Key));
     }
	 }
		  // alert(finalusers);
            var Updateitemaccno = finalusers;
			var countrylegal=countrylegal;
			 //var Updateitemaccno = '8';

            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeFinanceApproverMatrix');

            this.oListItem = oList.getItemById(CurrentItemID);

            oListItem.set_item('FinanceApproverName', Updateitemaccno);
			oListItem.set_item('FinanceApprover2', Financefinalusers);
			 oListItem.set_item('CountryLegal', countrylegal);
			 //oListItem.set_item('Title', Updateitemaccno);
	

            oListItem.update();

            clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceededmasterupdateListItem), Function.createDelegate(this, this.onQueryFailedmasterupdateListItem));	
		
			ClearBackGroundColour();
			
		//alert(finalusers);
}
 //$('#txtcountrylegal').val("");

}



function validatefinance(CurrentItemID)
{

	var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
	var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv1_TopSpan;   
	var users = peoplePicker.GetAllUserInfo();

	var peoplePicker3 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan;   
	var users5 = peoplePicker3.GetAllUserInfo();
	var EmpBaseLocation = document.getElementById("txtEmpBaseLocation").value;
	var  currency = $("#ddlCurrency option:selected").val();
		
           //alert(currency);
if(EmpBaseLocation==""||EmpBaseLocation=="undefined")
{
	$('.Errormsg').text("");
	$('.Errormsg').text('Please enter employee base location');
	$('#txtEmpBaseLocation').css({

		"border": "1px solid red",
		"background": "#FFCECE"
	});
return false;
}
else if(CheckDuplicateForUpdate(EmpBaseLocation,'EmployeeBaseLocation','Text','BconeFinanceApproverLocationMatrix',CurrentItemID,'ID','COUNTER'))
{

	$('.Errormsg').text("");
	$('.Errormsg').text('Employee base location  already exist.');
	$('#txtEmpBaseLocation').css({

		"border": "1px solid red",
		"background": "#FFCECE"
	});

return false;
}

else if(users.length==0)
{
//alert('0');
			$('.Errormsg').text("");
            $('.Errormsg').text('Please enter the finance Name');
            $('#peoplePickerDiv1').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}

	else if(users5.length>=1)
	{
		if(users[0].Key==users5[0].Key)
		{
			$('.Errormsg').text("");
			$('.Errormsg').text("Approver 1 and Approver 2 name cant be same");
			$('#peoplePickerDiv10').css({
			"border": "1px solid red",
			"background": "#FFCECE"
			});
			$('#peoplePickerDiv1').css({
			"border": "1px solid red",
			"background": "#FFCECE"
			});
			return false;
		}
		return true;
	}

else if(users.length>1)
{
//alert('more than 1');
			$('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 finanace Name');
            $('#peoplePickerDiv1').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			return false;
}
return true;
}

function BconeFinanceApproverMatrixIndiaUpdateItem(CurrentItemID)
{
var validate=validatefinance(CurrentItemID)
	if(validate==true)
	{
		$('.loader').show(); 
		
		
		var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv1_TopSpan;   
		var users = peoplePicker.GetAllUserInfo();

		var peoplePicker3 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan;   
		var users5 = peoplePicker3.GetAllUserInfo();
		var EmpBaseLocation = document.getElementById("txtEmpBaseLocation").value;
		var  currency = $("#ddlCurrency option:selected").val();
		$('.Errormsg').text("");

		$('#peoplePickerDiv1').css({

			"border": "",
			"background": ""
		});

		var keys = peoplePicker.GetAllUserKeys();
		var finalusers = new Array();
		for (var i = 0; i < users.length; i++) {
		var arryuser = users[i];
		finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));
		}
	 
		var finalusers5 = new Array();
		var peoplePicker3 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv10_TopSpan;   
		var users5 = peoplePicker3.GetAllUserInfo();
		for (var i = 0; i < users5.length; i++) {
		var arryuser = users5[i];
		finalusers5.push(SP.FieldUserValue.fromUser(arryuser.Key));
		}
		   
            var Updateitemaccno = finalusers;
            var Updateitemaccno2 = finalusers5;
			var EmpBaseLocation=EmpBaseLocation;
			 //var Updateitemaccno = '8';
			
            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeFinanceApproverLocationMatrix');

            this.oListItem = oList.getItemById(CurrentItemID);

            oListItem.set_item('FinanceApproverName', Updateitemaccno);
            oListItem.set_item('FinanceApproverName2', Updateitemaccno2);
			 oListItem.set_item('EmployeeBaseLocation', EmpBaseLocation);
			 oListItem.set_item('Currency', currency);
			 //oListItem.set_item('Title', Updateitemaccno);
	

            oListItem.update();

            clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceededmasterupdateListItem), Function.createDelegate(this, this.onQueryFailedmasterupdateListItem));	
			ClearBackGroundColour();
		//alert(finalusers);
}
 //$('#txtcountrylegal').val("");

}

function BconeProxyApproverUpdate(CurrentItemID)
{

 var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv4_TopSpan;   
       var users = peoplePicker.GetAllUserInfo();
	   var peoplePicker1 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv5_TopSpan;   
       var users1 = peoplePicker1.GetAllUserInfo();
	   var IsActive = ($('input[name=forexpensemodule2proxy]:checked', '#proxyApprovalIsActive').val());
	    var ProxyDate = $('#TBProxyDateApproval').val();
       var  ProxyApproverType = 'Manager Approval';
	   
	   
	   var duplicate_result=false;
var  result_return=false;
 for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    
		for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser1 = users1[i];	  
	    if(arryuser.Key==arryuser1.Key)
		
		{
		
		result_return=true;
		
		
		}
		else
		{
		 var  proxy_detail=getResourcesGuidNew(arryuser.Key);
		 var proxy_id=proxy_detail.split("_");
		 
		 var  emp_detail=getResourcesGuidNew(arryuser1.Key);
		 
		 var emp_ids=emp_detail.split("_");
		 
		 
		 var my_result=checkduplicateProxy(proxy_id[0],'Text','ProxyGuid',emp_ids[0],'Text','EmpGuid','BconeProxyApprover','update',CurrentItemID);
		 if(my_result==true)
		 {
		 duplicate_result=true;
		 
		 }
		 
		 
		 
		}
		
		}
		}
  if(users.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Proxy Name');
            $('#peoplePickerDiv4').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if(users.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 Proxy Name');
            $('#peoplePickerDiv4').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
 else if(users1.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Employee Name');
            $('#peoplePickerDiv5').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if(users1.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 Employee Name');
            $('#peoplePickerDiv5').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if (ProxyApproverType == '0') {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select approval type');
            $('#ddlApproval').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("ddlApproval").focus();
            return false;

        }
//else if (ProxyDate == '') {
//
//            $('.Errormsg').text("");
//            $('.Errormsg').text('Please enter the ProxyDate ');
//            $('#TBProxyDateApproval').css({
//
//                "border": "1px solid red",
//                "background": "#FFCECE"
//            });
//            document.getElementById("TBProxyDateApproval").focus();
//            return false;
//
//        }

else if (result_return==true)
		{
		
		$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name cannot be the same');
            $('#peoplePickerDiv4').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv5').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		}
		
		else if(duplicate_result==true)
		{
			$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name already Exists.');
            $('#peoplePickerDiv4').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv5').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		
		}
 else if (IsActive == '' || IsActive == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#proxyApprovalIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("proxyApprovalIsActive").focus();
                return false;

            }
else
{
	$('.loader').show(); 
 $('.Errormsg').text("");
          
            $('#peoplePickerDiv4').css({

                "border": "",
                "background": ""
            });
			
			var keys = peoplePicker.GetAllUserKeys();
       var finalusers = new Array();
	   var proxy_detail;
	   var proxy_name;
       for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    proxy_detail=getResourcesGuidNew(arryuser.Key);;
		proxy_name=arryuser.DisplayText;	  
        finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));
      }
	  
	  
	  
	var proxy_id=proxy_detail.split("_");
    var Updateitemaccno = finalusers;
	
		var finalusers_emp=new Array();
		 var emp_detail;
	   var emp_name;
	   for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser = users1[i];	  
	    emp_detail=getResourcesGuidNew(arryuser.Key);
		emp_name=arryuser.DisplayText;	  
        finalusers_emp.push(SP.FieldUserValue.fromUser(arryuser.Key));
      }
	   var emp_ids=emp_detail.split("_");
    var Updateitemaccno_emp = finalusers_emp;
	
			 //var Updateitemaccno = '8';
            var get = $('#proxyApprovalyesEA').is(':checked');
			var exstrtdate = '';
            var clientContext = new SP.ClientContext(siteUrl);
			
            var oList = clientContext.get_web().get_lists().getByTitle('BconeProxyApprover');

            this.oListItem = oList.getItemById(CurrentItemID);
			
			

            oListItem.set_item('ProxyGuid', proxy_id[0]);
            oListItem.set_item('ProxyName',proxy_name );
			 oListItem.set_item('ProxyId',proxy_id[1]);
			  oListItem.set_item('Proxysharepointid',Updateitemaccno);
			  
			  oListItem.set_item('EmpGuid', emp_ids[0]);
            oListItem.set_item('EmpName',emp_name );
			 oListItem.set_item('EmpId',emp_ids[1]);
			  oListItem.set_item('sharepointuserid',Updateitemaccno_emp);
			oListItem.set_item('Title',emp_name );
			//oListItem.set_item('ProxyTillDate',exstrtdate );
			oListItem.set_item('ProxyApproverType', ProxyApproverType);
			
			
			oListItem.set_item('IsActive', get);

            oListItem.update();

            clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceededmasterupdateListItem), Function.createDelegate(this, this.onQueryFailedmasterupdateListItem));	
			ClearBackGroundColour();
		//alert(finalusers);
}
 //$('#txtcountrylegal').val("");

}
function BconeProxyUpdateItem(CurrentItemID)
{

 var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv2_TopSpan;   
       var users = peoplePicker.GetAllUserInfo();
	   var peoplePicker1 = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv3_TopSpan;   
       var users1 = peoplePicker1.GetAllUserInfo();
	   var IsActive = ($('input[name=forexpensemodule2proxy]:checked', '#proxyIsActive').val());
	    var ProxyDate = $('#TBProxyDate').val();
		
		
		var duplicate_result=false;
var  result_return=false;
 for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    
		for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser1 = users1[i];	  
	    if(arryuser.Key==arryuser1.Key)
		
		{
		
		result_return=true;
		
		
		}
		else
		{
		 var  proxy_detail=getResourcesGuidNew(arryuser.Key);
		 var proxy_id=proxy_detail.split("_");
		 
		 var  emp_detail=getResourcesGuidNew(arryuser1.Key);
		 
		 var emp_ids=emp_detail.split("_");
		 
		 
		 var my_result=checkduplicateProxy(proxy_id[0],'Text','ProxyGuid',emp_ids[0],'Text','EmpGuid','BconeProxyMaster','update',CurrentItemID);
		 if(my_result==true)
		 {
		 duplicate_result=true;
		 
		 }
		 
		 
		 
		}
		
		}
		}
    
  if(users.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Proxy Name');
            $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if(users.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 Proxy Name');
            $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
 else if(users1.length==0)
{
//alert('0');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Employee Name');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
else if(users1.length>1)
{
//alert('more than 1');
 $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the only 1 Employee Name');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
}
//else if (ProxyDate == '') {
//
//            $('.Errormsg').text("");
//            $('.Errormsg').text('Please enter the ProxyDate ');
//            $('#TBProxyDate').css({
//
//                "border": "1px solid red",
//                "background": "#FFCECE"
//            });
//            document.getElementById("TBProxyDate").focus();
//            return false;
//
//        }

else if (result_return==true)
		{
		
		$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name cannot be the same');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		}
		
		else if(duplicate_result==true)
		{
			$('.Errormsg').text("");
            $('.Errormsg').text('Proxy Name and  Employee Name already Exists.');
            $('#peoplePickerDiv3').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 $('#peoplePickerDiv2').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
		return false;
		
		}
 else if (IsActive == '' || IsActive == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#proxyIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("proxyIsActive").focus();
                return false;

            }
else
{
	$('.loader').show(); 
 $('.Errormsg').text("");
          
            $('#peoplePickerDiv2').css({

                "border": "",
                "background": ""
            });
			
			var keys = peoplePicker.GetAllUserKeys();
       var finalusers = new Array();
	   var proxy_detail;
	   var proxy_name;
       for (var i = 0; i < users.length; i++) 
	   {
        var arryuser = users[i];	  
	    proxy_detail=getResourcesGuidNew(arryuser.Key);;
		proxy_name=arryuser.DisplayText;	  
        finalusers.push(SP.FieldUserValue.fromUser(arryuser.Key));
      }
	  
	  
	  
	var proxy_id=proxy_detail.split("_");
    var Updateitemaccno = finalusers;
	
		var finalusers_emp=new Array();
		 var emp_detail;
	   var emp_name;
	   for (var i = 0; i < users1.length; i++) 
	   {
        var arryuser = users1[i];	  
	    emp_detail=getResourcesGuidNew(arryuser.Key);
		emp_name=arryuser.DisplayText;	  
        finalusers_emp.push(SP.FieldUserValue.fromUser(arryuser.Key));
      }
	   var emp_ids=emp_detail.split("_");
    var Updateitemaccno_emp = finalusers_emp;
	
			 //var Updateitemaccno = '8';
            var get = $('#proxyyesEA').is(':checked');
			var exstrtdate ='';
            var clientContext = new SP.ClientContext(siteUrl);
			
            var oList = clientContext.get_web().get_lists().getByTitle('BconeProxyMaster');

            this.oListItem = oList.getItemById(CurrentItemID);
			
			

            oListItem.set_item('ProxyGuid', proxy_id[0]);
            oListItem.set_item('ProxyName',proxy_name );
			 oListItem.set_item('ProxyId',proxy_id[1]);
			  oListItem.set_item('Proxysharepointid',Updateitemaccno);
			  
			  oListItem.set_item('EmpGuid', emp_ids[0]);
            oListItem.set_item('EmpName',emp_name );
			 oListItem.set_item('EmpId',emp_ids[1]);
			  oListItem.set_item('sharepointuserid',Updateitemaccno_emp);
			oListItem.set_item('Title',emp_name );
			///oListItem.set_item('ProxyTillDate',exstrtdate );
			
			
			
			oListItem.set_item('IsActive', get);

            oListItem.update();

            clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceededmasterupdateListItem), Function.createDelegate(this, this.onQueryFailedmasterupdateListItem));	
			ClearBackGroundColour();
		//alert(finalusers);
}
 //$('#txtcountrylegal').val("");

}
    //BconItemmaster update

    function bconitemmasterupdateListItem(CurrentItemID) {
	


        var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';

        $('.Errormsg').text("");

        var itemtype = $('#ddlItemtype :selected').text();
       // var valExp = /^[A-Za-z0-9 ]+$/;
		var valExp=/^[a-zA-Z0-9 ._-]+$/;
        var item = document.getElementById("tbitem").value;
        var IsActive = ($('input[name=itemActives]:checked', '#divitemisactive').val());
		
	   var IsPQDependant = ($('input[name=itemIsPQDependant]:checked', '#itemIsPQDependant').val());
        var tbitemAccno = $('#tbitemAccno').val();
		var Currency = document.getElementById("DDItemCurrency").value;
		var Currency1 = $('#DDItemCurrency :selected').text();
		if(itemtype=="Expense Item")
		{
		
		if(IsPQDependant=="Yes")
{
 $("#Tr_Price").show();
  $("#Tr_ItemCurrencydd").show();
	   $("#Tr_Quantity").show();

 }else
 {
    $("#Tr_Price").hide();
	 $("#Tr_ItemCurrencydd").hide();
	   $("#Tr_Quantity").hide();
 }
 }
var price="0";
		var quantity="1";
		var Txtprice=document.getElementById("tbitemPrice").value;
		var Txtquantity=document.getElementById("tbitemQuantity").value;
        if (item == '' || item == undefined) {


            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Item Name');
            $('#tbitem').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitem").focus();
            return false;

        }
        else
            if (!valExp.test(item)) {

                $('.Errormsg').text("");
                $('.Errormsg').text("You have entered an invalid following characters:.(period)/:;|?'<>*#~%&{}+");
                $('#tbitem').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("tbitem").focus();
                return false;
            }

			if(itemtype=="Expense Item")
		{
           if (IsPQDependant == '' || IsPQDependant == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select IsPQDependent option');
            $('#itemIsPQDependant').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("itemIsPQDependant").focus();
            return false;
        }
		
		else
		{
		 var radioIsPQDependant = ($('input[name=itemIsPQDependant]:checked', '#itemIsPQDependant').val());
		 
		 if(radioIsPQDependant=="Yes")
		 {
		  if (Txtprice == '' || Txtprice == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Price');
            $('#tbitemPrice').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemPrice").focus();
            return false;

        }
	 else if(Currency=='0')
		{
		$('.Errormsg').text("");
            $('.Errormsg').text('Please select Currency');
            $('#DDItemCurrency').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("DDItemCurrency").focus();
            return false;
		
		}
		else if (Txtquantity == '' || Txtquantity == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the quantity');
            $('#tbitemQuantity').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemQuantity").focus();
            return false;

        }
		
		else
		{
		 price=Txtprice;
		 quantity=Txtquantity;
		
		}
		 
	}

		}
		}
        

        if (tbitemAccno == '' || tbitemAccno == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the SAPAccNo');
            $('#tbitemAccno').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemAccno").focus();
            return false;
        }

        if (!valExp.test(tbitemAccno)) {

            $('.Errormsg').text("");
            $('.Errormsg').text("You have entered an invalid following characters:.(period)/:;|?'<>*#~%&{}+");
            $('#tbitemAccno').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemAccno").focus();
            return false;

        }
        if (tbitemAccno.length > 10) {

            $('.Errormsg').text("");
            $('.Errormsg').text('SAP account number must contain only 10 characters');
            $('#tbitemAccno').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("tbitemAccno").focus();
            return false;

        }
		
		if (IsActive == '' || IsActive == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the option');
            $('#divitemisactive').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("divitemisactive").focus();
            return false;
        }

        else {
		$('.loader').show();
            var Updateitemtype = $('#ddlItemtype :selected').text();
            var Updateitem = $('#tbitem').val();
            var Updateitemaccno = $('#tbitemAccno').val();


            var Updateitemget = $('#tbitemactiveyes').is(':checked');
            var clientContext = new SP.ClientContext(siteUrl);
            var oList = clientContext.get_web().get_lists().getByTitle('BconeItemMaster');

            this.oListItem = oList.getItemById(CurrentItemID);

            oListItem.set_item('ItemType', Updateitemtype);
            oListItem.set_item('Item', Updateitem);
            oListItem.set_item('SAPAccNo', Updateitemaccno);
			
			if(itemtype=="Expense Item")
		{
			if(IsPQDependant=="Yes")
{
oListItem.set_item('IsPQDependant', true);
oListItem.set_item('ItemCurrency', Currency);
oListItem.set_item('ItemCurrencyText', Currency1);

 }else
 {
   oListItem.set_item('IsPQDependant', false);
   oListItem.set_item('ItemCurrency', '');
   oListItem.set_item('ItemCurrencyText', '');
 }
 
 
  oListItem.set_item('Price', price);
   oListItem.set_item('Quantity', quantity);
   
   }
            oListItem.set_item('IsActive', Updateitemget);

            oListItem.update();

            clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceededmasterupdateListItem), Function.createDelegate(this, this.onQueryFailedmasterupdateListItem));
			
        }
        ClearBackGroundColour();
    }

    function onQuerySucceededmasterupdateListItem() {

        //alert('Data Saved Successfully');
		showmsg('Data Updated Successfully');
		
        //if (true)
		$('.loader').hide();
        //    window.location.href = window.location.href;
        plotlistdata($('#ddllistsName option:selected').val());

        $("[data-dismiss=modal]").trigger({ type: "click" });
    }

    function onQueryFailedmasterupdateListItem(sender, args) {
$('.loader').hide();
        alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
    }


    //BconeExceptional InsertItem

    function BconeExceptionalInsertItem() {

        //  siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
        // validateBconeExceptionalInsertItem();
        $('.Errormsg').text("");
        var ResourceName = $('#ddlexceresourcename option:selected').val();
		
	 
        var ProjectName = $('#ddlexceprojectname option:selected').val();
        var StartDate = $('#Tbexcestartdate').val();
        var EndDate = $('#Tbexcdate').val();
        var IsActive = ($('input[name=ExActives]:checked', '#Div1').val());
        var approver = $('#ddlProjectApprover option:selected').val();
		var Expapprover="";
		var ExpapproverGuid="";
		var ExpapproverEmpid="";

        var exstrtdate = '';
        var exfnsdate = '';


        if (ResourceName == '0' || ResourceName == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Resource Name');
            //$('#ddlexceresourcename')[0].sumo.selectItem(ResourceName).css({
            //search-box SumoUnder
            // $('#ddlexceresourcename').parents('div.SumoSelect').css({ "background-color": "#FFCECE"});
            $('#ddlexceresourcename + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlexceresourcename').click(function () {
                $('#ddlexceresourcename + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });



            document.getElementById("ddlexceresourcename").focus();
            return false;

        }

        if (ProjectName == '0' || ProjectName == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Project Name');


            //$('#ddlexceprojectname').parents('div.SumoSelect').addClass('select-active').css({


            //    "background": "#FFCECE"
            //});
            //$('#ddlexceprojectname + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            //$('#ddlexceprojectname').click(function () {
            //    $('#ddlexceprojectname + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            //});

            $('#ddlexceprojectname + p').css({ 
			"border": "1px solid red",
			"background-color": "#FFCECE" 
			});
            $('#ddlexceprojectname').click(function () {
                $('#ddlexceprojectname + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });

            document.getElementById("ddlexceprojectname").focus();
            return false;

        }
		var result_return;
		var selected = $("#ddlexceresourcename option:selected");
        var message = "";
		
		var checkduplicateforotherapproval=false;
         
        selected.each(function () {
		
            message += $(this).text() + " " + + "\n";
			var getValue = $(this).val(); 
            var getEmpInfo = getValue.split("&");
			var emp_name=$(this).text();
			
		   var getguidval = $('#ddlexceprojectname option:selected');

          if(getEmpInfo[1]==$('#ddlExpApprover option:selected').val().split("&")[1])
		  {
		  
		  checkduplicateforotherapproval=true;
		  }
		   
           getguidval.each(function () 
		    {	
			
			 var getValue = $(this).val(); 
            var getProjectInfo = getValue.split("&");
			
            var projectGuid = getProjectInfo[1];
            var projectcode = getProjectInfo[0];
		 result_return=checkduplicateException(getEmpInfo[1],'Text','EmployeeGUID',getProjectInfo[1],'Text','ProjectGUID','BconeExceptionalProjects');
		
		if(result_return==true)
		{
		return false;
		}

	
		
			
				
			});	

	
			});
			
			if(result_return==true)
		{
		
      //alert('Project is alredy assign.');
	  $('.Errormsg').text("");
       $('.Errormsg').text('Project already added.');

		$('#ddlexceprojectname + p').css({ 
			"border": "1px solid red",
			"background-color": "#FFCECE" 
			});
            $('#ddlexceprojectname').click(function () {
                $('#ddlexceprojectname + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });

            document.getElementById("ddlexceprojectname").focus();
            return false;
		//break;
		//return false;
		
		 
		 //break;
		}

        if (approver == "0" )
		{
		
		

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Approver');
            $('#ddlProjectApprover').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("ddlProjectApprover").focus();
            return false;

        }
		
	
		
		if(approver=="3")
		{
		  Expapprover = $('#ddlExpApprover option:selected').val();
		 
		// alert(Expapprover);
		 if(Expapprover=="0")
		 {
		 $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Approver Name');
            $('#ddlExpApprover_div').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 document.getElementById("ddlExpApprover").focus();
		 return false;
		 }
		 
		 if(checkduplicateforotherapproval==true)
		 {
		 $('.Errormsg').text("");
            $('.Errormsg').text('Resource Name and  Approver Name cannot be the same.');
            $('#ddlExpApprover_div').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			  $('#ddlexceresourcename + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
			 document.getElementById("ddlExpApprover").focus();
			   document.getElementById("ddlexceresourcename").focus();
		 return false;
		 
		 }
		 
		 
		
		}
		
		
		
		
		
		

        if (StartDate == '') {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Start Date');
            $('#Tbexcestartdate').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("Tbexcestartdate").focus();
            return false;

        }

        if (EndDate == '') {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the End Date');
            $('#Tbexcdate').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("Tbexcdate").focus();
            return false;

        }

        if (StartDate != '' && EndDate != '') {

            exstrtdate = $("#Tbexcestartdate").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();
            exfnsdate = $("#Tbexcdate").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();

            if (exstrtdate > exfnsdate) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Invalid Date Values');
                $('#Tbexcestartdate').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                $('#Tbexcdate').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                return false;
            }

        }

        if (IsActive == '' || IsActive == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select IsActive Option');
            $('#Div1').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("Div1").focus();
            return false;

        }
            //var exstrtdate = $("#Tbexcestartdate").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();
            //var exfnsdate = $("#Tbexcdate").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();

            //var exstrtdate = new Date($('#Tbexcestartdate').val());
            //var exfnsdate = new Date($('#Tbexcdate').val());
        else {
		var selected = $("#ddlexceresourcename option:selected");
        var message = "";
         $('.loader').show();
        selected.each(function () {
		
		
		
            message += $(this).text() + " " + + "\n";
			 var getValue = $(this).val(); 
            var getEmpInfo = getValue.split("&");
			var emp_name=$(this).text();
			
			 var getguidval = $('#ddlexceprojectname option:selected');
			
			 var message = "";
     
           getguidval.each(function () 
		    {	
			
			 var getValue = $(this).val(); 
            var getProjectInfo = getValue.split("&");
			
            var projectGuid = getProjectInfo[1];
            var projectcode = getProjectInfo[0];
			
			

	var ddlExpApproveridsarray="";
	var ddlExpApprovername="";
			if($('#ddlProjectApprover option:selected').text()=="Other")
			{
				var ddlExpApproverids=$('#ddlExpApprover option:selected').val();
 var ddlExpApproveridsarray=ddlExpApproverids.split("&");
 var ddlExpApprovername =$('#ddlExpApprover option:selected').text();
 	 ExpapproverGuid=ddlExpApproveridsarray[1];
		 ExpapproverEmpid=ddlExpApproveridsarray[0];
}

			addexceptional(getEmpInfo[0],getEmpInfo[1],emp_name, getProjectInfo[1], getProjectInfo[0],$(this).text(),ddlExpApprovername,ExpapproverEmpid,ExpapproverGuid);
			
			
			
           });
			});
			$('.loader').hide();
			//alert('Item Saved Successfully!');
			showmsg('Item Saved Successfully!');
        }
        ClearBackGroundColour();
		 
    }
	
	function addexceptional(EmployeeID,EmployeeGUID,getValue,projectGuid,projectcode,projectname,ddlExpApprovername,ddlExpApproveridsarrayempid,ddlExpApproveridsarrayguid)
	{
	//alert("addexceptional");
	
	var exstrtdate = $("#Tbexcestartdate").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();
    var  exfnsdate = $("#Tbexcdate").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();
	 var exitemget = $('#Radio1').is(':checked');
           // var getValue = $('#ddlexceresourcename option:selected').val();
		   // var getValue = $(this).val(); 
          //  var getEmpInfo = getValue.split("&");
           
		
		    
			
            var projectGuid = projectGuid;
            var projectcode = projectcode;

            var clientContext = new SP.ClientContext.get_current();
            var oList = clientContext.get_web().get_lists().getByTitle('BconeExceptionalProjects');
            var itemCreateInfo = new SP.ListItemCreationInformation();
            this.oListItem = oList.addItem(itemCreateInfo);
    
            oListItem.set_item('EmployeeID', EmployeeID);
            oListItem.set_item('AllocatedProjectCode', projectcode);// $('#ddlexceprojectname option:selected').val());
            oListItem.set_item('Approver', $('#ddlProjectApprover option:selected').text());
            oListItem.set_item('IsActive', exitemget);
            oListItem.set_item('Startdatetime', exstrtdate);
            oListItem.set_item('Finishdatetime', exfnsdate);
            oListItem.set_item('EmployeeGUID', EmployeeGUID);
            oListItem.set_item('EmployeeName', getValue);
            oListItem.set_item('ProjectGUID', projectGuid);
            oListItem.set_item('ProjectName', projectname);
			
			oListItem.set_item('ApproverName', ddlExpApprovername);
			oListItem.set_item('ApproverEmpid', ddlExpApproveridsarrayempid);
			oListItem.set_item('ApproverGuid', ddlExpApproveridsarrayguid);
            //oListItem.set_item('ProjectName', $('#ddlexceprojectname option:selected').text());
           // oListItem.set_item('EmployeeName', $("#ddlexceresourcename").find("option:selected").text());
            oListItem.update();
            clientContext.load(oListItem);
			
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededExceptional1),
                Function.createDelegate(this, this.onQueryFailedExceptional)
            );
			
			
			
		
		    
	
	
	}


    function onQuerySucceededExceptional1() {
        //alert('Item Saved Successfully!');
		//$('.loader').hide();
        //if (true)
		$('.loader').hide(); 
        //    window.location.href = window.location.href;
        plotlistdata($('#ddllistsName option:selected').val());

        $("[data-dismiss=modal]").trigger({ type: "click" });

    }
    function onQueryFailedExceptional(sender, args) {
	$('.loader').hide();
        //alert("Error");
    }
    function validateBconeExceptionalInsertItem() {
        if ($('#Tbexcestartdate').val() == "") {
            //Start Date should not be empty
            return false;
        }
        else {
            //Empty (error msg)
        }
        if ($('#Tbexcdate').val() == "") {
            //End Date should not be empty
            return false;
        }
        else {
            //Empty (error msg)
        }
        if ($('#ddlexceresourcename option:selected').val() == "--Select--") {
            //Resource should not be empty
            return false;
        }
        else {
            //Empty (error msg)
        }
        if ($('#ddlexceprojectname option:selected').val() == "--Select--") {
            //project should not be empty
            return false;
        }
        else {
            //Empty (error msg)
        }
        if ($('#rdexyes').is(':checked') == false && $('#rdexno').is(':checked') == false) {
            //active should not be empty
            return false;
        }
        else {
            //Empty (error msg)
        }



    }
    //getid Exceptional
    function getExceptionalid(id) {
	
	//$("#ddlexceresourcename option:selected").prop("selected", false);
	 // var dropDown = document.getElementById("ddlexceresourcename")[0].sumo.selectItem();
       // dropDown.selectedIndex = 0;
		
$("#ddlExpApprover").select2().select2('val','0');
		$("#ddlExpApprover").prop("selectedIndex",0);

//$('#ddlexceresourcename').removeAttr('multiple');
$('.opt').removeClass('selected');
//document.getElementById("ddlexceresourcename").selectedIndex = "-1";
//$("#ddlexceresourcename.search-box")[0].sumo.selectItem(0);
$("#ddlexceresourcename").prop("selectedIndex",-1);
$('#ddlexceresourcename')[0].sumo.reload();

$("#ddlexceprojectname").prop("selectedIndex",-1);
$('#ddlexceprojectname')[0].sumo.reload();

//$("#ddlexceprojectname").select2().select2('val','0');
	$('.loader').show();
        try {
            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeExceptionalProjects')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {


                    var result = data.d.results;
                    var index = 0;
                    $("#ddlexceresourcename option").each(function () {

                        if (this.text == result[0].EmployeeName) {
                          // $("#ddlexceresourcename").find("option:selected").text();
                           //$("#ddlexceresourcename").prop('selectedIndex', index);
                           $("#ddlexceresourcename")[0].sumo.selectItem(index);
						    
				
                            return false;
                        }
                        index = index + 1;
                    });
                    index = 0;
                    $("#ddlexceprojectname option").each(function () {

                        if ($(this).text() == result[0].ProjectName) {
                            //$("#ddlexceresourcename").find("option:selected").text();
                           // $("#ddlexceprojectname").prop('selectedIndex', index);
							//$('#ddlexceprojectname').select2('data', {id: index, text:  result[0].ProjectName});
							var getval =  result[0]["AllocatedProjectCode"] == null ? "" :  result[0]["AllocatedProjectCode"];
                        getval = getval + "&" +  result[0].ProjectGUID;
							 //$("#ddlexceprojectname").select2().select2('val',getval);
							 
							  $("#ddlexceprojectname")[0].sumo.selectItem(index);
                           // $("#ddlexceprojectname.search-box")[0].sumo.selectItem(index);
                            return false;
                        }
                        index = index + 1;
                    });
                    index = 0;

                    var i = 0;

                    var bconexceactive = data.d.results[i].IsActive;
                    var bconexcesartdate = data.d.results[i].Startdatetime;
                    var bconexcefinishdate = data.d.results[i].Finishdatetime;


                    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                    var StartDate = new Date(bconexcesartdate);

                    var startDay = new Date(StartDate).getDate();
                    var startMonth = new Date(StartDate).getMonth();
                    var startYear = new Date(StartDate).getFullYear();

                    StartDate = startDay + "-" + months[startMonth] + "-" + startYear;


                    var EndDate = new Date(bconexcefinishdate);

                    var endDay = new Date(EndDate).getDate();
                    var endMonth = new Date(EndDate).getMonth();
                    var endYear = new Date(EndDate).getFullYear();

                    EndDate = endDay + "-" + months[endMonth] + "-" + endYear;

                    var Approver = data.d.results[i].Approver;

                    //$('#ddlProjectApprover option:selected').text(Approver);
                    index = 0;
                    $("#ddlProjectApprover option").each(function () {

                        if (this.text == Approver) {
                            //$("#ddlProjectApprover").find("option:selected").text();
                            $("#ddlProjectApprover").prop('selectedIndex', index);
                           
                            return false;
                        }
                        index = index + 1;
                    });
					
					getapprover();
					
					index = 0;
                        $("#ddlExpApprover option").each(function () {

                            if (this.text == result[0].ApproverName) {
                                //$("#ddlapprover2nameEA").prop('selectedIndex', index);
                                //$("#ddlexceresourcename")[0][0].innerText = result[0].Apr2EmployeeName;
                                //$("#ddlapprover2nameEA.search-box")[0].sumo.selectItem(index);
								if(this.text!='--Select--')
								{
								var getval =  result[0]["ApproverEmpid"] == null ? "" :  result[0]["ApproverEmpid"];
                        getval = getval + "&" +  result[0].ApproverGuid;
							 $("#ddlExpApprover").select2().select2('val',getval);
								}
								else
								{
								
								$("#ddlExpApprover").select2().select2('val','0');
								}
                                return false;
                            }
                            index = index + 1;
                        });

                    $('#Tbexcestartdate').val(StartDate);

                    $('#Tbexcdate').val(EndDate);

                    if (bconexceactive == true) {
                        $('#Radio1').prop('checked', 'checked');
                    }
                    else if (bconexceactive == false) {
                        $('#Radio2').prop('checked', 'checked');

                    }
                    //  $("#ExActives").val(bconitemActive);


                },
                error: function (data) {
                    alert('f');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
	$('.loader').hide();
    }

    //BconExceptional update
    function bconExceptionalrupdateListItem(CurrentItemID) {

        //  siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
        $('.Errormsg').text("");
        var ResourceName = $('#ddlexceresourcename :selected').val();
        var ProjectName = $('#ddlexceprojectname :selected').val();
        var StartDate = $('#Tbexcestartdate').val();
        var EndDate = $('#Tbexcdate').val();
        var IsActive = ($('input[name=ExActives]:checked', '#Div1').val());
        var approver = $('#ddlProjectApprover option:selected').val();
var Expapprover="";
		var ExpapproverGuid="";
		var ExpapproverEmpid="";
        var esdate = '';
        var exstrtdate = '';
        var eedate = '';
        var exfnsdate = '';
		
		 var brands = $('#ddlexceresourcename option:selected');
        var selected = [];
        $(brands).each(function(index, brand){
            selected.push([$(this).val()]);
        });
var brands_project = $('#ddlexceprojectname option:selected');
        var selected_project = [];
        $(brands_project).each(function(index, brand){
            selected_project.push([$(this).val()]);
        });

        if (ResourceName == '0' || ResourceName == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Resource Name');
            //$('#ddlexceresourcename :selected').css({

            //    "border": "1px solid red",
            //    "background": "#FFCECE"
            //});
            //$('#ddlexceresourcename').parents('div.SumoSelect').css({

            //    "border": "1px solid red",
            //    "background-color": "#FFCECE"
            //});
            //$('#ddlexceresourcename + p').css({ "background-color": "#FFCECE" });
            //$('#ddlexceresourcename').click(function () {
            //    $('#ddlexceresourcename + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            //});

            $('#ddlexceresourcename + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlexceresourcename').click(function () {
                $('#ddlexceresourcename + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });

            document.getElementById("ddlexceresourcename").focus();
            return false;

        }
        else if(selected.length>1)
          {
       $('.Errormsg').text("");
            $('.Errormsg').text('Please select only one Resource Name');

            $('#ddlexceresourcename + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlexceresourcename').click(function () {
                $('#ddlexceresourcename + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });

            document.getElementById("ddlexceresourcename").focus();
            return false;


          }
        if (ProjectName == '0' || ProjectName == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Project Name');
            //$('#ddlexceprojectname :selected').css({

            //    "border": "1px solid red",
            //    "background": "#FFCECE"
            //});

            //$('#ddlexceprojectname').parents('div.SumoSelect').addClass('select-active').css({

            //    "border": "1px solid red",
            //    "background": "#FFCECE"
            //});
            //$('#ddlexceprojectname + p').css({ "background-color": "#FFCECE" });
            //$('#ddlexceprojectname').click(function () {
            //    $('#ddlexceprojectname + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            //});

            $('#ddlexceprojectname + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlexceprojectname').click(function () {
                $('#ddlexceprojectname + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });
            document.getElementById("ddlexceprojectname").focus();
            return false;

        }
    else if(selected_project.length>1)
          {
       $('.Errormsg').text("");
            $('.Errormsg').text('Please select only one Project');

           
            $('#ddlexceprojectname + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlexceprojectname').click(function () {
                $('#ddlexceprojectname + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });
            document.getElementById("ddlexceprojectname").focus();
            return false;

          }
		  
		  var getValue = $('#ddlexceresourcename option:selected').val();		
          var getEmpguid = getValue.split("&")[1]; 
		   var getguidval = $('#ddlexceprojectname option:selected').val();
            var projectGuid = getguidval.split("&")[1];
			var checkduplicateforotherapproval=false;
			var result_return=checkduplicateExceptionUpdate(getEmpguid,'Text','EmployeeGUID',projectGuid,'Text','ProjectGUID','BconeExceptionalProjects',CurrentItemID,'Counter','ID');
		 
		 
		 if(getEmpguid==$('#ddlExpApprover option:selected').val().split("&")[1])
		  {
		  
		  checkduplicateforotherapproval=true;
		  }
               if(result_return==true)
			   {
			   $('.Errormsg').text("");
            $('.Errormsg').text('Project already added.');

           
            $('#ddlexceprojectname + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlexceprojectname').click(function () {
                $('#ddlexceprojectname + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });
            document.getElementById("ddlexceprojectname").focus();
			   return false;
			   
			   }
		
		
        if (approver == "0") {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Approver');
            $('#ddlProjectApprover').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("ddlProjectApprover").focus();
            return false;
        }
   if(approver=="3")
		{
		  Expapprover = $('#ddlExpApprover option:selected').val();
		 
		// alert(Expapprover);
		 if(Expapprover=="0")
		 {
		 $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Approver Name');
            $('#ddlExpApprover_div').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			 document.getElementById("ddlExpApprover").focus();
		 return false;
		 }
		 
		 
		  if(checkduplicateforotherapproval==true)
		 {
		 $('.Errormsg').text("");
            $('.Errormsg').text('Resource Name and  Approver Name cannot be the same.');
            $('#ddlExpApprover_div').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
			  $('#ddlexceresourcename + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
			 document.getElementById("ddlExpApprover").focus();
			   document.getElementById("ddlexceresourcename").focus();
		 return false;
		 
		 }
		
		}
        if (StartDate == '') {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the Start Date');
            $('#Tbexcestartdate').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("Tbexcestartdate").focus();
            return false;

        }

        if (EndDate == '') {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please enter the End Date');
            $('#Tbexcdate').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("Tbexcdate").focus();
            return false;

        }

        if (StartDate != '' && EndDate != '') {

            esdate = $('#Tbexcestartdate').val().split('-');
            exstrtdate = new Date(esdate[2], $.inArray(esdate[1].toUpperCase(), ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"]), esdate[0]);
            eedate = $("#Tbexcdate").val().split('-');
            exfnsdate = new Date(eedate[2], $.inArray(eedate[1].toUpperCase(), ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"]), eedate[0]);


            if (exstrtdate > exfnsdate) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Invalid Date Values');
                $('#Tbexcestartdate').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                $('#Tbexcdate').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                return false;
            }
        }

        if (IsActive == '' || IsActive == undefined) {


            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Option');
            $('#Div1').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });
            document.getElementById("Div1").focus();
            return false;

        }


            //var esdate = $('#Tbexcestartdate').val().split('-');
            //var exstrtdate = new Date(esdate[2], $.inArray(esdate[1].toUpperCase(), ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"]), esdate[0]);
            //var eedate = $("#Tbexcdate").val().split('-');
            //var exfnsdate = new Date(eedate[2], $.inArray(eedate[1].toUpperCase(), ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"]), eedate[0]);
        else {
		$('.loader').show();
            var exitemget = $('#Radio1').is(':checked');
            var getValue = $('#ddlexceresourcename option:selected').val();
			//alert(getValue);
            var getEmpInfo = getValue.split("&");
			//alert(getEmpInfo[0]);
            var getguidval = $('#ddlexceprojectname option:selected').val();
            var projectGuid = getguidval.split("&")[1];
            var projectcode = getguidval.split("&")[0];
			var ddlExpApprovername="";
			var ddlExpApproveridsarray="";
			if($('#ddlProjectApprover option:selected').text()=="Other")
			{
				var ddlExpApproverids=$('#ddlExpApprover option:selected').val();
 var ddlExpApproveridsarray=ddlExpApproverids.split("&");
 var ddlExpApprovername =$('#ddlExpApprover option:selected').text();
 	 ExpapproverGuid=ddlExpApproveridsarray[1];
		 ExpapproverEmpid=ddlExpApproveridsarray[0];
}

            var clientContext = new SP.ClientContext.get_current();
            var oList = clientContext.get_web().get_lists().getByTitle('BconeExceptionalProjects');
            this.oListItem = oList.getItemById(CurrentItemID);

            oListItem.set_item('EmployeeID', getEmpInfo[0]);
            oListItem.set_item('AllocatedProjectCode', projectcode);// $('#ddlexceprojectname option:selected').val());
            oListItem.set_item('Approver', $('#ddlProjectApprover option:selected').text());
            oListItem.set_item('IsActive', exitemget);
            oListItem.set_item('Startdatetime', exstrtdate);
            oListItem.set_item('Finishdatetime', exfnsdate);
            oListItem.set_item('EmployeeGUID', getEmpInfo[1]);
            //oListItem.set_item('EmployeeName', getValue);
            oListItem.set_item('ProjectGUID', projectGuid);
            oListItem.set_item('ProjectName', $('#ddlexceprojectname option:selected').text());
           oListItem.set_item('EmployeeName', $('#ddlexceresourcename option:selected').text());
		   
		   
		   
		    oListItem.set_item('ApproverName', ddlExpApprovername);
			oListItem.set_item('ApproverEmpid',ExpapproverEmpid);
			oListItem.set_item('ApproverGuid', ExpapproverGuid);
			
			
            oListItem.update();
           // clientContext.load(oListItem);
			
			
			
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededExceptional1234),
                Function.createDelegate(this, this.onQueryFailedExceptional1234)
            );
			
        }
        ClearBackGroundColour();
    }


    function onQuerySucceededExceptional1234() {
       // alert('Item Saved Successfully!');
		showmsg('Item Updated Successfully!');
        //if (true)
		$('.loader').hide();
        //    window.location.href = window.location.href;
        plotlistdata($('#ddllistsName option:selected').val());
        $("[data-dismiss=modal]").trigger({ type: "click" });

    }
    function onQueryFailedExceptional1234(sender, args) {
        //alert("Error");
		$('.loader').hide();
    }
    //ClearItem Exceptionl

    function clearItemExceptional() {

        // $("#ddlexceresourcename").prop('selectedIndex', 0);
		$('.opt').removeClass('selected');
		$("#ddlexceresourcename").prop("selectedIndex",-1);
		$('#ddlexceresourcename')[0].sumo.reload();
	   $("#ddlExpApprover").prop("selectedIndex",0);
     //$("#ddlexceresourcename.search-box")[0].sumo.selectItem(0);

        //$("#ddlexceprojectname").prop('selectedIndex', 0);
        //$("#ddlexceprojectname.search-box")[0].sumo.selectItem(0);
		//$("#ddlexceprojectname").prop('selectedIndex', 0);
		
		 //$("#ddlexceprojectname").select2().select2('val','0');
		 $("#ddlexceprojectname").prop("selectedIndex",-1);
		$('#ddlexceprojectname')[0].sumo.reload();
		 
        $("#ddlProjectApprover").prop('selectedIndex', 0);

        $('.Errormsg').text("");
        $('#Tbexcestartdate').val("");
        $('#Tbexcdate').val("");
        $('#Radio1').attr('checked', false);
        $('#Radio2').attr('checked', false);
	$("#ExpApprover").hide();
		
		

// $("#ddlexceresourcename").prop("selectedIndex",-1);



    }

    //bconapprovals Insert item
    function BconeApprovalUpdateItem(id) {


        var e = document.getElementById("ddllistsName");
        var Bconelistname = e.options[e.selectedIndex].value;
        $('.Errormsg').text("");
        var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
        var clientContext = new SP.ClientContext(siteUrl);
        var oList = clientContext.get_web().get_lists().getByTitle('BconeExceptionalApprovals');
        this.oListItem = oList.getItemById(id);

        var action_type1 = $('#ddlactiontypeEA :selected').text();
        var ddlprojectnameEA = $('#ddlprojectnameEA :selected').val();
        var expenseApplicableTd = ($('input[name=forexpensemodule]:checked', '#exceptionappExp').val());
        var timesheetApplicableTd = ($('input[name=forexpensemodule1]:checked', '#exceptioappTMSheet').val());
        var isActiveTd = ($('input[name=forexpensemodule2]:checked', '#exceptionappIsActive').val());


        var sdate = '';
        var StartNewDate = '';
        var edate = '';
        var EndNewDate = '';
        var brands = $('#ddlprojectnameEA option:selected');
        var selected = [];
        $(brands).each(function(index, brand){
            selected.push([$(this).val()]);
        });
		
		
        if (ddlprojectnameEA == '0' || ddlprojectnameEA == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Project Name');
            //$('#ddlprojectnameEA').css({

            //    "border": "1px solid red",
            //    "background": "#FFCECE"
            //});

            //$('#ddlprojectnameEA').parents('div.SumoSelect').addClass('select-active').css({

            //    "border": "1px solid red",
            //    "background": "#FFCECE"
            //});
            //$('#ddlprojectnameEA + p').css({ "background-color": "#FFCECE" });
            //$('#ddlprojectnameEA').click(function () {
            //    $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            //});

            $('#ddlprojectnameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlprojectnameEA').click(function () {
                $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });
            document.getElementById("ddlprojectnameEA").focus();
            return false;

        }
      else if(selected.length>1)
          {
       $('.Errormsg').text("");
            $('.Errormsg').text('Please select only one Project');

           
            $('#ddlprojectnameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlprojectnameEA').click(function () {
                $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });
            document.getElementById("ddlprojectnameEA").focus();
            return false;

          }

        if (action_type1 == 'Delegation') {

            var ddldeligatefromnameEA = $('#ddldeligatefromnameEA :selected').val();
            var ddldeligatetonameEA = $('#ddldeligatetonameEA :selected').val();
            var txtstartdateEA = $('#txtstartdateEA').val();
            var txtfinishdateEA = $('#txtfinishdateEA').val();

            if (ddldeligatefromnameEA == '0' || ddldeligatefromnameEA==undefined) {


                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Deligate From Name');
                //$('#ddldeligatefromnameEA').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddldeligatefromnameEA').parents('div.SumoSelect').addClass('select-active').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddldeligatefromnameEA + p').css({ "background-color": "#FFCECE" });
                //$('#ddldeligatefromnameEA').click(function () {
                //    $('#ddldeligatefromnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                //});
                $('#ddldeligatefromnameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatefromnameEA').click(function () {
                    $('#ddldeligatefromnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                return false;

            }

            if (ddldeligatetonameEA == '0' || ddldeligatetonameEA==undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Deligate To Name');
                //$('#ddldeligatetonameEA').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddldeligatetonameEA').parents('div.SumoSelect').addClass('select-active').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddldeligatetonameEA + p').css({ "background-color": "#FFCECE" });
                //$('#ddldeligatetonameEA').click(function () {
                //    $('#ddldeligatetonameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                //});
                $('#ddldeligatetonameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatetonameEA').click(function () {
                    $('#ddldeligatetonameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatetonameEA").focus();
                return false;

            }
			if (ddldeligatetonameEA == ddldeligatefromnameEA) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Deligate To Name Cannot be same as Deligate From Name');

                $('#ddldeligatetonameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatetonameEA').click(function () {
                    $('#ddldeligatetonameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				$('#ddldeligatefromnameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatefromnameEA').click(function () {
                    $('#ddldeligatefromnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                document.getElementById("ddldeligatetonameEA").focus();
                return false;

            }
			var duplicate_project=false;
			var projectGuid = $('#ddlprojectnameEA option:selected').val().split('&'); 
			var getdeligatefromname = $('#ddldeligatefromnameEA option:selected').val().split('&');  
			
            var result_duplicate_project=checkduplicateForDeligationException(getdeligatefromname[1],'Text','EmployeeGUID',projectGuid[1],'Text','ProjectGUID',action_type1,'BconeExceptionalApprovals','update',id);
			if(result_duplicate_project==true)
			{
			duplicate_project=true;
			}
			
			
			if (duplicate_project == true) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Duplicate Record.');
				$('#ddlprojectnameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlprojectnameEA').click(function () {
                $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                 });
                document.getElementById("ddlprojectnameEA").focus();
                $('#ddldeligatefromnameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatefromnameEA').click(function () {
                    $('#ddldeligatefromnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                
                return false;

            }

            if (expenseApplicableTd == '' || expenseApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to expense Option');
                $('#exceptionappExp').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappExp").focus();
                return false;

            }

            if (timesheetApplicableTd == '' || timesheetApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to timesheet Option');
                $('#exceptioappTMSheet').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptioappTMSheet").focus();
                return false;

            }

            if (txtstartdateEA == '') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please enter the start date');
                $('#txtstartdateEA').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("txtstartdateEA").focus();
                return false;

            }
            if (txtfinishdateEA == '') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please enter the end date');
                $('#txtfinishdateEA').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("txtfinishdateEA").focus();
                return false;

            }

            if (txtstartdateEA != '' && txtfinishdateEA != '') {

                sdate = $("#txtstartdateEA").val().split('-');
                StartNewDate = new Date(sdate[2], $.inArray(sdate[1].toUpperCase(), ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"]), sdate[0]);
                edate = $("#txtfinishdateEA").val().split('-');
                EndNewDate = new Date(edate[2], $.inArray(edate[1].toUpperCase(), ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"]), edate[0]);

                if (StartNewDate > EndNewDate) {

                    $('.Errormsg').text("");
                    $('.Errormsg').text('Invalid Date values');
                    $('#txtstartdateEA').css({

                        "border": "1px solid red",
                        "background": "#FFCECE"
                    });
                    $('#txtfinishdateEA').css({

                        "border": "1px solid red",
                        "background": "#FFCECE"
                    });
                    return false;
                }


            }

            if (isActiveTd == '' || isActiveTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#exceptionappIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappIsActive").focus();
                return false;

            }

            else {


                if ($('#ddlactiontypeEA option:selected').text() == 'Delegation') {

                    var getdeligatefromname = $('#ddldeligatefromnameEA option:selected').val().split('&');
                    oListItem.set_item('EmployeeName', $('#ddldeligatefromnameEA option:selected').text());
                    oListItem.set_item('EmployeeID', getdeligatefromname[0]);
                    oListItem.set_item('EmployeeGUID', getdeligatefromname[1]);
                    var getdeligatetoname = $('#ddldeligatetonameEA option:selected').val().split('&');
                    oListItem.set_item('Apr1EmployeeName', $('#ddldeligatetonameEA option:selected').text());
                    oListItem.set_item('Apr1EmployeeID', getdeligatetoname[0]);
                    oListItem.set_item('Apr1GUID', getdeligatetoname[1]);
                    oListItem.set_item('Finishdatetime', EndNewDate);
                    oListItem.set_item('Startdatetime', StartNewDate);
                    oListItem.set_item('DelegationalStatus', 'Delegable');


                }

            }
        }
        if (action_type1 == 'Exception') {
		
		
            var ddlresourcenameEA = $('#ddlresourcenameEA :selected').val();
            var ddlapprover1nameEA = $('#ddlapprover1nameEA :selected').val();
			
            var ddlapprover2nameEA = $('#ddlapprover2nameEA :selected').val();
            //var txtstartdateEA = $('#txtstartdateEA').val();
            //var txtfinishdateEA = $('#txtfinishdateEA').val();
       var brands = $('#ddlresourcenameEA option:selected');
        var selected = [];
        $(brands).each(function(index, brand){
            selected.push([$(this).val()]);
        });

            if (ddlresourcenameEA == '0' || ddlresourcenameEA == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select the Resource Name');
                //$('#ddlresourcenameEA').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddlresourcenameEA').parents('div.SumoSelect').addClass('select-active').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddlresourcenameEA + p').css({ "background-color": "#FFCECE" });
                //$('#ddlresourcenameEA').click(function () {
                //    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                //});
                $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlresourcenameEA").focus();
                return false;

            }
			 else if(selected.length>1)
          {
          $('.Errormsg').text("");
            $('.Errormsg').text('Please select only one Resource Name');
 
                $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlresourcenameEA").focus();
                return false;


          }
            if (ddlapprover1nameEA == '0') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select the Approver 1 Name');
                //$('#ddlapprover1nameEA').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddlapprover1nameEA').parents('div.SumoSelect').addClass('select-active').css({

                //    "border": "1px solid red",
                //    "background": "#FFCECE"
                //});
                //$('#ddlapprover1nameEA + p').css({ "background-color": "#FFCECE" });
                //$('#ddlapprover1nameEA').click(function () {
                //    $('#ddlapprover1nameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                //});

                $('#ddlapprover1nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover1nameEA').click(function () {
                    $('#ddlapprover1nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlapprover1nameEA").focus();
                return false;

            }
            //if (ddlapprover2nameEA == '0') {

            //    $('.Errormsg').text("");
            //    $('.Errormsg').text('Please select the Approver 2 Name');
            //    //$('#ddlapprover2nameEA').css({

            //    //    "border": "1px solid red",
            //    //    "background": "#FFCECE"
            //    //});
            //    //$('#ddlapprover2nameEA').parents('div.SumoSelect').addClass('select-active').css({

            //    //    "border": "1px solid red",
            //    //    "background": "#FFCECE"
            //    //});
            //    //$('#ddlapprover2nameEA + p').css({ "background-color": "#FFCECE" });
            //    //$('#ddlapprover2nameEA').click(function () {
            //    //    $('#ddlapprover2nameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            //    //});

            //    $('#ddlapprover2nameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            //    $('#ddlapprover2nameEA').click(function () {
            //        $('#ddlapprover2nameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            //    });
            //    document.getElementById("ddlapprover2nameEA").focus();
            //    return false;

            //}
            var duplicate_project_exception=false;
			var duplicate_Resource_Approver1=false;
	        var duplicate_Resource_Approver2=false;
			
			var projectGuid = $('#ddlprojectnameEA option:selected').val().split('&'); 
			var getresourcenameEA = $('#ddlresourcenameEA option:selected').val().split('&');  
			
            var result_duplicate_project=checkduplicateForDeligationException(getresourcenameEA[1],'Text','EmployeeGUID',projectGuid[1],'Text','ProjectGUID',action_type1,'BconeExceptionalApprovals','update',id);
			if(result_duplicate_project==true)
			{
			duplicate_project_exception=true;
			
			
			}
			
			if(ddlapprover1nameEA!='0')
	  {
	  var ddlapprover1nameEA = $('#ddlapprover1nameEA option:selected').val().split('&');
	  if(ddlapprover1nameEA[1]==getresourcenameEA[1])
			{
			duplicate_Resource_Approver1=true;
			
			}
	  
	  }
	   if(ddlapprover2nameEA!='0')
	  {
	    var ddlapprover2nameEA = $('#ddlapprover2nameEA option:selected').val().split('&');
	 
	     if(ddlapprover2nameEA[1]==getresourcenameEA[1])
			{
			duplicate_Resource_Approver2=true;
			
			}
	  
	  }
			
			if (duplicate_project_exception == true) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Duplicate Record.');
				$('#ddlprojectnameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlprojectnameEA').click(function () {
                $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                 });
                document.getElementById("ddlprojectnameEA").focus();
                $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                
                return false;

            }
			
			 if (duplicate_Resource_Approver1 == true) {
               $('.Errormsg').text("");
                $('.Errormsg').text('Resource Name and Approver1 cannot be the same.');

                $('#ddlapprover1nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover1nameEA').click(function () {
                    $('#ddlapprover1nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				 $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlapprover1nameEA").focus();
                return false;
              
               

            }
			if (duplicate_Resource_Approver2 == true) {

             
				
				 $('.Errormsg').text("");
                $('.Errormsg').text('Resource Name and Approver2 cannot be the same.');

                $('#ddlapprover2nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover2nameEA').click(function () {
                    $('#ddlapprover2nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				 $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlapprover2nameEA").focus();
                return false;
                

            }
			
			
			if($('#ddlapprover1nameEA option:selected').val().split('&')[1]==$('#ddlapprover2nameEA option:selected').val().split('&')[1] && ddlapprover2nameEA != '0')		    
           {   

           
		    $('.Errormsg').text("");
                $('.Errormsg').text('Approver1 and Approver2 cannot be the same.');

                $('#ddlapprover2nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover2nameEA').click(function () {
                    $('#ddlapprover2nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				$('#ddlapprover1nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover1nameEA').click(function () {
                    $('#ddlapprover1nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				  document.getElementById("ddlapprover1nameEA").focus();
				    document.getElementById("ddlapprover2nameEA").focus();
		       return false;
           
		   
		   }
            if (expenseApplicableTd == '' || expenseApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to expense Option');
                $('#exceptionappExp').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappExp").focus();
                return false;

            }
            if (timesheetApplicableTd == '' || timesheetApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to timesheet Option');
                $('#exceptioappTMSheet').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptioappTMSheet").focus();
                return false;

            }

            if (isActiveTd == '' || isActiveTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#exceptionappIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappIsActive").focus();
                return false;

            }

            else {

                if ($('#ddlactiontypeEA option:selected').text() == 'Exception') {
                    var getresourcename = $('#ddlresourcenameEA option:selected').val().split('&');
                    oListItem.set_item('EmployeeName', $('#ddlresourcenameEA option:selected').text());
                    oListItem.set_item('EmployeeID', getresourcename[0]);
                    oListItem.set_item('EmployeeGUID', getresourcename[1]);
                    var ddlapprover1nameEA = $('#ddlapprover1nameEA option:selected').val().split('&');
                    oListItem.set_item('Apr1EmployeeName', $('#ddlapprover1nameEA option:selected').text());
                    oListItem.set_item('Apr1EmployeeID', ddlapprover1nameEA[0]);
                    oListItem.set_item('Apr1GUID', ddlapprover1nameEA[1]);
                    var ddlapprover2nameEA = $('#ddlapprover2nameEA option:selected').val().split('&');
                    oListItem.set_item('Apr2EmployeeName', $('#ddlapprover2nameEA option:selected').text());
                    oListItem.set_item('Apr2EmployeeID', ddlapprover2nameEA[0]);
                    oListItem.set_item('Apr2GUID', ddlapprover2nameEA[1]);
                }
            }
        }
        oListItem.set_item('ActionType', $('#ddlactiontypeEA option:selected').text());
        var ddlprojectnameEA = $('#ddlprojectnameEA option:selected').val().split('&');
        oListItem.set_item('ProjectName', $('#ddlprojectnameEA option:selected').text());
        oListItem.set_item('Title', ddlprojectnameEA[0]);
        oListItem.set_item('ProjectGUID', ddlprojectnameEA[1]);
        oListItem.set_item('IsActive', $('#rdisactiveyesEA').is(':checked'));
        oListItem.set_item('ForExpenseModule', $('#rdexpenseyesEA').is(':checked'));
        oListItem.set_item('ForTimeSheetModule', $('#rdtimesheetyesEA').is(':checked'));
        oListItem.update();
        clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceededexceupdateListItem123), Function.createDelegate(this, this.onQueryFailedexceupdateListItem123));
		

    }
	
	function addexceptionalApprovals(EmployeeID,EmployeeGUID,getValue,project_name,projectcode,projectGuid)
	{

            var clientContext = new SP.ClientContext.get_current();
            var oList = clientContext.get_web().get_lists().getByTitle('BconeExceptionalApprovals');
            var itemCreateInfo = new SP.ListItemCreationInformation();
            this.oListItem = oList.addItem(itemCreateInfo);
    
          // var getresourcename = $('#ddlresourcenameEA option:selected').val().split('&');
                    oListItem.set_item('EmployeeName', getValue);
                    oListItem.set_item('EmployeeID', EmployeeID);
                    oListItem.set_item('EmployeeGUID', EmployeeGUID);
					
          var ddlapprover1nameEA = $('#ddlapprover1nameEA option:selected').val().split('&');
          oListItem.set_item('Apr1EmployeeName', $('#ddlapprover1nameEA option:selected').text());
          oListItem.set_item('Apr1EmployeeID', ddlapprover1nameEA[0]);
          oListItem.set_item('Apr1GUID', ddlapprover1nameEA[1]);
          var ddlapprover2nameEA = $('#ddlapprover2nameEA option:selected').val().split('&');
          oListItem.set_item('Apr2EmployeeName', $('#ddlapprover2nameEA option:selected').text());
          oListItem.set_item('Apr2EmployeeID', ddlapprover2nameEA[0]);
          oListItem.set_item('Apr2GUID', ddlapprover2nameEA[1]);
         oListItem.set_item('ActionType', $('#ddlactiontypeEA option:selected').text());
        // var ddlprojectnameEA = $('#ddlprojectnameEA option:selected').val().split('&');
         oListItem.set_item('ProjectName',project_name);
         oListItem.set_item('Title', projectcode);
         oListItem.set_item('ProjectGUID', projectGuid);
         oListItem.set_item('IsActive', $('#rdisactiveyesEA').is(':checked'));
         oListItem.set_item('ForExpenseModule', $('#rdexpenseyesEA').is(':checked'));
         oListItem.set_item('ForTimeSheetModule', $('#rdtimesheetyesEA').is(':checked'));
  
            oListItem.update();
            clientContext.load(oListItem);
			
            clientContext.executeQueryAsync(
                Function.createDelegate(this, this.onQuerySucceededExceptional1),
                Function.createDelegate(this, this.onQueryFailedExceptional)
            );
		   
		    
	
	
	}

    function onQuerySucceededexceupdateListItem123() {

       // alert('Data Saved Successfully!');
	   showmsg('Data Updated Successfully');
        // if (true)
        //window.location.href = window.location.href;
        plotlistdata($('#ddllistsName option:selected').val());

        ClearBackGroundColour();
        $("[data-dismiss=modal]").trigger({ type: "click" });
        // plotlistdata(Bconelistname);

    }

    function onQueryFailedexceupdateListItem123(sender, args) {

        alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
    }

    function BconeApprovalInsertItem() {

        var e = document.getElementById("ddllistsName");
        var Bconelistname = e.options[e.selectedIndex].value;
        $('.Errormsg').text("");
        siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
        var clientContext = new SP.ClientContext(siteUrl);
        var oList = clientContext.get_web().get_lists().getByTitle('BconeExceptionalApprovals');
        var itemCreateInfo = new SP.ListItemCreationInformation();
        this.oListItem = oList.addItem(itemCreateInfo);


        var action_type1 = $('#ddlactiontypeEA :selected').text();
        var ddlprojectnameEA = $('#ddlprojectnameEA option:selected').val();
        var expenseApplicableTd = ($('input[name=forexpensemodule]:checked', '#exceptionappExp').val());
        var timesheetApplicableTd = ($('input[name=forexpensemodule1]:checked', '#exceptioappTMSheet').val());
        var isActiveTd = ($('input[name=forexpensemodule2]:checked', '#exceptionappIsActive').val());



        var StartDate = '';
        var EndDate = '';

        if (ddlprojectnameEA == '0' || ddlprojectnameEA == undefined) {

            $('.Errormsg').text("");
            $('.Errormsg').text('Please select the Project Name');

            $('#ddlprojectnameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            $('#ddlprojectnameEA').click(function () {
                $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            });
            document.getElementById("ddlprojectnameEA").focus();
            return false;

        }

        if (action_type1 == 'Delegation') {

            var ddldeligatefromnameEA = $('#ddldeligatefromnameEA :selected').val();
            var ddldeligatetonameEA = $('#ddldeligatetonameEA :selected').val();
            var txtstartdateEA = $('#txtstartdateEA').val();
            var txtfinishdateEA = $('#txtfinishdateEA').val();
			
			
			

            if (ddldeligatefromnameEA == '0') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Deligate From Name');

                $('#ddldeligatefromnameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatefromnameEA').click(function () {
                    $('#ddldeligatefromnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                return false;

            }

            if (ddldeligatetonameEA == '0') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Deligate To Name');

                $('#ddldeligatetonameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatetonameEA').click(function () {
                    $('#ddldeligatetonameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatetonameEA").focus();
                return false;

            }
			
			if (ddldeligatetonameEA == ddldeligatefromnameEA) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Deligate To Name Cannot be same as Deligate From Name');

                $('#ddldeligatetonameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatetonameEA').click(function () {
                    $('#ddldeligatetonameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				$('#ddldeligatefromnameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatefromnameEA').click(function () {
                    $('#ddldeligatefromnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                document.getElementById("ddldeligatetonameEA").focus();
                return false;

            }
			
			var duplicate_project=false;
			
			
			
			var getguidval = $('#ddlprojectnameEA option:selected');
			
			 var message = "";
     
           getguidval.each(function () 
		    {	
			
			var getValue = $(this).val(); 
            var getProjectInfo = getValue.split("&");			
            var projectGuid = getProjectInfo[1];
            var projectcode = getProjectInfo[0];
            var project_name=$(this).text();
			
			
			var getdeligatefromname = $('#ddldeligatefromnameEA option:selected').val().split('&');  
			
            var result_duplicate_project=checkduplicateForDeligationException(getdeligatefromname[1],'Text','EmployeeGUID',projectGuid,'Text','ProjectGUID',action_type1,'BconeExceptionalApprovals','','');
			if(result_duplicate_project==true)
			{
			duplicate_project=true;
			}
			
	});                                                          
	
	
	if (duplicate_project == true) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Duplicate Record.');
				$('#ddlprojectnameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlprojectnameEA').click(function () {
                $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                 });
                document.getElementById("ddlprojectnameEA").focus();
                $('#ddldeligatefromnameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddldeligatefromnameEA').click(function () {
                    $('#ddldeligatefromnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                
                return false;

            }
			

            if (expenseApplicableTd == '' || expenseApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to expense Option');
                $('#exceptionappExp').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappExp").focus();
                return false;

            }

            if (timesheetApplicableTd == '' || timesheetApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to timesheet Option');
                $('#exceptioappTMSheet').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptioappTMSheet").focus();
                return false;

            }

            if (txtstartdateEA == '') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please enter the start date');
                $('#txtstartdateEA').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("txtstartdateEA").focus();
                return false;

            }
            if (txtfinishdateEA == '') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please enter the end date');
                $('#txtfinishdateEA').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("txtfinishdateEA").focus();
                return false;

            }

            if (txtstartdateEA != '' && txtfinishdateEA != '') {

                StartDate = $("#txtstartdateEA").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();
                EndDate = $("#txtfinishdateEA").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();


                if (StartDate > EndDate) {

                    $('.Errormsg').text("");
                    $('.Errormsg').text('Invalid Date values');
                    $('#txtstartdateEA').css({

                        "border": "1px solid red",
                        "background": "#FFCECE"
                    });
                    $('#txtfinishdateEA').css({

                        "border": "1px solid red",
                        "background": "#FFCECE"
                    });
                    return false;
                }

            }

            if (isActiveTd == '' || isActiveTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#exceptionappIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappIsActive").focus();
                return false;

            }

            else {

                if ($('#ddlactiontypeEA option:selected').text() == 'Delegation') {

                    var getdeligatefromname = $('#ddldeligatefromnameEA option:selected').val().split('&');
                    oListItem.set_item('EmployeeName', $('#ddldeligatefromnameEA option:selected').text());
                    oListItem.set_item('EmployeeID', getdeligatefromname[0]);
                    oListItem.set_item('EmployeeGUID', getdeligatefromname[1]);
                    var getdeligatetoname = $('#ddldeligatetonameEA option:selected').val().split('&');
                    oListItem.set_item('Apr1EmployeeName', $('#ddldeligatetonameEA option:selected').text());
                    oListItem.set_item('Apr1EmployeeID', getdeligatetoname[0]);
                    oListItem.set_item('Apr1GUID', getdeligatetoname[1]);
                    oListItem.set_item('Startdatetime', StartDate);
                    oListItem.set_item('Finishdatetime', EndDate);
                    oListItem.set_item('DelegationalStatus', 'Delegable');

                }
				
            }
        }

        if (action_type1 == 'Exception') {
		
		
		
            var ddlresourcenameEA = $('#ddlresourcenameEA option:selected').val();
            var ddlapprover1nameEA = $('#ddlapprover1nameEA :selected').val();
            var ddlapprover2nameEA = $('#ddlapprover2nameEA :selected').val();
            //var txtstartdateEA = $('#txtstartdateEA').val();
            //var txtfinishdateEA = $('#txtfinishdateEA').val();
			
			
			
			  var result_duplicate_project_exception=false;
	  var duplicate_project_exception=false;
	  
	  var duplicate_Resource_Approver1=false;
	  var duplicate_Resource_Approver2=false;
	  
	  
	  
	  var selected = $("#ddlresourcenameEA option:selected");
           var message = "";
         
        selected.each(function () {
		
            message += $(this).text() + " " + + "\n";
			var getValue = $(this).val(); 
            var getEmpInfo = getValue.split("&");
            var getguidval = $('#ddlprojectnameEA option:selected');

           getguidval.each(function () 
		    {	
			
			var getValue = $(this).val(); 
            var getProjectInfo = getValue.split("&");
			var projectGuid = getProjectInfo[1];

	     result_duplicate_project_exception=checkduplicateForDeligationException(getEmpInfo[1],'Text','EmployeeGUID',projectGuid,'Text','ProjectGUID',action_type1,'BconeExceptionalApprovals','','');
						
	       if(result_duplicate_project_exception==true)
			{
			duplicate_project_exception=true;
			}
			
	  if(ddlapprover1nameEA!='0')
	  {
	  var ddlapprover1nameEA = $('#ddlapprover1nameEA option:selected').val().split('&');
	  if(ddlapprover1nameEA[1]==getEmpInfo[1])
			{
			duplicate_Resource_Approver1=true;
			
			}
	  
	  }
	   if(ddlapprover2nameEA!='0')
	  {
	    var ddlapprover2nameEA = $('#ddlapprover2nameEA option:selected').val().split('&');
	 
	     if(ddlapprover2nameEA[1]==getEmpInfo[1])
			{
			duplicate_Resource_Approver2=true;
			
			}
	  
	  }
			
			
			
	
	       });	
		   
		   
		   

			});
			
			if (duplicate_project_exception == true) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Duplicate Record.');
				$('#ddlprojectnameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlprojectnameEA').click(function () {
                $('#ddlprojectnameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                 });
                document.getElementById("ddlprojectnameEA").focus();
                $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddldeligatefromnameEA").focus();
                
                return false;

            }


            if (ddlresourcenameEA == '0'|| ddlresourcenameEA == undefined) {


                $('.Errormsg').text("");
                $('.Errormsg').text('Please select the Resource Name');

                $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlresourcenameEA").focus();
                return false;

            }
            if (ddlapprover1nameEA == '0') {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select the Approver 1 Name');

                $('#ddlapprover1nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover1nameEA').click(function () {
                    $('#ddlapprover1nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlapprover1nameEA").focus();
                return false;

            }
			
			 if (duplicate_Resource_Approver1 == true) {
               $('.Errormsg').text("");
                $('.Errormsg').text('Resource Name and Approver1 cannot be the same.');

                $('#ddlapprover1nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover1nameEA').click(function () {
                    $('#ddlapprover1nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				 $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlapprover1nameEA").focus();
                return false;
              
               

            }
			if (duplicate_Resource_Approver2 == true) {

             
				
				 $('.Errormsg').text("");
                $('.Errormsg').text('Resource Name and Approver2 cannot be the same.');

                $('#ddlapprover2nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover2nameEA').click(function () {
                    $('#ddlapprover2nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				 $('#ddlresourcenameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlresourcenameEA').click(function () {
                    $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
                document.getElementById("ddlapprover2nameEA").focus();
                return false;
                

            }
			
			
			if($('#ddlapprover1nameEA option:selected').val().split('&')[1]==$('#ddlapprover2nameEA option:selected').val().split('&')[1] && ddlapprover2nameEA != '0')		    
           {   

           
		    $('.Errormsg').text("");
                $('.Errormsg').text('Approver1 and Approver2 cannot be the same.');

                $('#ddlapprover2nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover2nameEA').click(function () {
                    $('#ddlapprover2nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				$('#ddlapprover1nameEA_div').css({ "border": "1px solid red", "background-color": "#FFCECE" });
                $('#ddlapprover1nameEA').click(function () {
                    $('#ddlapprover1nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
                });
				  document.getElementById("ddlapprover1nameEA").focus();
				    document.getElementById("ddlapprover2nameEA").focus();
		       return false;
           
		   
		   }
			//if (ddlapprover2nameEA == '0') {


            //    $('.Errormsg').text("");
            //    $('.Errormsg').text('Please select the Approver 2 Name');

            //    $('#ddlapprover2nameEA + p').css({ "border": "1px solid red", "background-color": "#FFCECE" });
            //    $('#ddlapprover2nameEA').click(function () {
            //        $('#ddlapprover2nameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
            //    });
            //    document.getElementById("ddlapprover2nameEA").focus();
            //    return false;

            //}

            if (expenseApplicableTd == '' || expenseApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to expense Option');
                $('#exceptionappExp').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappExp").focus();
                return false;

            }
            if (timesheetApplicableTd == '' || timesheetApplicableTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select Applicable to timesheet Option');
                $('#exceptioappTMSheet').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptioappTMSheet").focus();
                return false;

            }

            if (isActiveTd == '' || isActiveTd == undefined) {

                $('.Errormsg').text("");
                $('.Errormsg').text('Please select IsActive Option');
                $('#exceptionappIsActive').css({

                    "border": "1px solid red",
                    "background": "#FFCECE"
                });
                document.getElementById("exceptionappIsActive").focus();
                return false;

            }

            else {
                if ($('#ddlactiontypeEA option:selected').text() == 'Exception') {

                var selected = $("#ddlresourcenameEA option:selected");
           var message = "";
         
        selected.each(function () {
		
            message += $(this).text() + " " + + "\n";
			 var getValue = $(this).val(); 
            var getEmpInfo = getValue.split("&");
		
			var emp_name=$(this).text();
			 var getguidval = $('#ddlprojectnameEA option:selected');

           getguidval.each(function () 
		    {	
			 $('.loader').show();
			 var getValue = $(this).val(); 
            var getProjectInfo = getValue.split("&");
			
            var projectGuid = getProjectInfo[1];
            var projectcode = getProjectInfo[0];
             
			 var project_name=$(this).text();
            //alert($(this).text());
   
       
	   addexceptionalApprovals(getEmpInfo[0],getEmpInfo[1],emp_name,project_name,projectcode,projectGuid);
	
	});	

			});
			 $('.loader').hide();
			showmsg('Item Saved Successfully!');
			
                }
            }
        }
   if ($('#ddlactiontypeEA option:selected').text() == 'Delegation') 
   {
   
   	 var getguidval = $('#ddlprojectnameEA option:selected');
			
			 var message = "";
     
           getguidval.each(function () 
		    {	
			 $('.loader').show();
			 var getValue = $(this).val(); 
            var getProjectInfo = getValue.split("&");
			
            var projectGuid = getProjectInfo[1];
            var projectcode = getProjectInfo[0];
             
			 var project_name=$(this).text();
           // alert($(this).text());
   
       addexceptionalApprovalsDeligation(project_name,projectcode,projectGuid);
	});	
	        $('.loader').hide();
			showmsg('Item Saved Successfully!');
}
        ClearBackGroundColour();
    }

        function addexceptionalApprovalsDeligation(project_name,projectcode,projectGuid)
         {
		 siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		var StartDate = $("#txtstartdateEA").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();
          var EndDate = $("#txtfinishdateEA").datepicker('getDate').format('yyyy-MM-ddTHH:mm:ssZ').toString();
        var clientContext = new SP.ClientContext(siteUrl);
        var oList = clientContext.get_web().get_lists().getByTitle('BconeExceptionalApprovals');
        var itemCreateInfo = new SP.ListItemCreationInformation();
        this.oListItem = oList.addItem(itemCreateInfo);
		
		var getdeligatefromname = $('#ddldeligatefromnameEA option:selected').val().split('&');
                    oListItem.set_item('EmployeeName', $('#ddldeligatefromnameEA option:selected').text());
                    oListItem.set_item('EmployeeID', getdeligatefromname[0]);
                    oListItem.set_item('EmployeeGUID', getdeligatefromname[1]);
                    var getdeligatetoname = $('#ddldeligatetonameEA option:selected').val().split('&');
                    oListItem.set_item('Apr1EmployeeName', $('#ddldeligatetonameEA option:selected').text());
                    oListItem.set_item('Apr1EmployeeID', getdeligatetoname[0]);
                    oListItem.set_item('Apr1GUID', getdeligatetoname[1]);
                    oListItem.set_item('Startdatetime', StartDate);
                    oListItem.set_item('Finishdatetime', EndDate);
                    oListItem.set_item('DelegationalStatus', 'Delegable');
        oListItem.set_item('ActionType', $('#ddlactiontypeEA option:selected').text());
        var ddlprojectnameEA = $('#ddlprojectnameEA option:selected').val().split('&');
        oListItem.set_item('ProjectName',project_name);
        oListItem.set_item('Title',projectcode);
        oListItem.set_item('ProjectGUID', projectGuid);
        oListItem.set_item('IsActive', $('#rdisactiveyesEA').is(':checked'));
        oListItem.set_item('ForExpenseModule', $('#rdexpenseyesEA').is(':checked'));
        oListItem.set_item('ForTimeSheetModule', $('#rdtimesheetyesEA').is(':checked'));
        oListItem.update();
        clientContext.load(oListItem);
        clientContext.executeQueryAsync(
            Function.createDelegate(this, this.onQuerySucceededExceptional),
            Function.createDelegate(this, this.onQueryFailedExceptional)
        );
		
		

         }
    function onQuerySucceededExceptional() {
        //alert('Data Saved Successfully');
		//showmsg('Data Saved Successfully');
        //if (true)
        //    window.location.href = window.location.href;
        plotlistdata($('#ddllistsName option:selected').val());

        $("[data-dismiss=modal]").trigger({ type: "click" });


    }
    function onQueryFailedExceptional(sender, args) {
        //alert("Error");
    }

    ////get approved data
    function getapprovalid(id) {
	
	$('.loader').show();
        $('.Errormsg').text("");
	
		$("#ddlapprover2nameEA").select2().select2('val','0');
		$("#ddlapprover2nameEA").prop("selectedIndex",0);
		
		
		
        try {
		$('.opt').removeClass('selected');
        $("#ddlresourcenameEA").prop("selectedIndex",-1);
		
		$('#ddlresourcenameEA')[0].sumo.reload();
		$('#ddlexceresourcename')[0].sumo.reload();
		//  $("#ddlprojectnameEA").prop("selectedIndex",-1);
		$("#ddlactiontypeEA").attr("disabled", true); 
		
		$("#ddlprojectnameEA").prop("selectedIndex",-1);
    $('#ddlprojectnameEA')[0].sumo.reload();
            $.ajax({
                url: 'https://bristleconeonline.sharepoint.com/sites/pwa' + "/_api/web/lists/getbytitle('BconeExceptionalApprovals')/items?$filter=ID eq '" + id + "'",
                method: "GET",
                async: false,
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {
                    var result = data.d.results;
                    var index = 0;

                    //alert($("#ddlexceresourcename")[0][0].innerText);

                    var ProjectName = result[0].ProjectName;
                    //$("#ddlprojectnameEA").find("option[text=" + ProjectName + "]").attr("selected", true);

                    //var e = document.getElementById("ddlprojectnameEA");
                    //var selectedValue = e.options[e.selectedIndex].value;
                    //var ProjectName = e.options[e.selectedIndex].text;
                    //$("#ddlprojectnameEA").find("option[text=" + ProjectName + "]").attr("selected", true);

                    $("#ddlactiontypeEA option").each(function () {
                        if (this.text == result[0].ActionType) {
                            $("#ddlactiontypeEA").prop('selectedIndex', index);
                            return false;

                        }
                        index = index + 1;
                    });

                    index = 0;
                    $("#ddlprojectnameEA option").each(function () {
                        if ($(this).text() == result[0].ProjectName) {
                           // $("#ddlprojectnameEA.search-box")[0].sumo.selectItem(index);
							var getval =  result[0]["Title"] == null ? "" :  result[0]["Title"];
                        getval = getval + "&" +  result[0].ProjectGUID;
							 //$("#ddlprojectnameEA").select2().select2('val',getval);
							  $("#ddlprojectnameEA")[0].sumo.selectItem(index);
                            return false;
                        }
                        index = index + 1;
                    });

                    index = 0;
                    if (result[0].ActionType == 'Delegation') {
                        $("#ddlprojectnameEA option").each(function () {
                            //if (this.text == result[0].EmployeeName) {
                            if ($(this).text() == result[0].ProjectName) {
                                // $("#ddlprojectnameEA").prop('selectedIndex', index);
                                //$("#ddlprojectnameEA").prop('selectedIndex', index)
                                //$("#ddlprojectnameEA.search-box")[0].sumo.selectItem(index);
								var getval =  result[0]["Title"] == null ? "" :  result[0]["Title"];
                        getval = getval + "&" +  result[0].ProjectGUID;
							 //$("#ddlprojectnameEA").select2().select2('val',getval);
							  $("#ddlprojectnameEA")[0].sumo.selectItem(index);
                                return false;
                            }
                            index = index + 1;
                        });
                        index = 0;
                        $("#ddldeligatetonameEA option").each(function () {

                            if (this.text == result[0].Apr1EmployeeName) {
                                //$("#ddldeligatetonameEA").prop('selectedIndex', index);
                              //  $("#ddldeligatetonameEA.search-box")[0].sumo.selectItem(index);
								
								var getval =  result[0]["Apr1EmployeeID"] == null ? "" :  result[0]["Apr1EmployeeID"];
                        getval = getval + "&" +  result[0].Apr1GUID;
							 $("#ddldeligatetonameEA").select2().select2('val',getval);
                                return false;
                            }
                            index = index + 1;
                        });
                        index = 0;
                        $("#ddldeligatefromnameEA option").each(function () {

                            if (this.text == result[0].EmployeeName) {
                                //$("#ddldeligatefromnameEA").prop('selectedIndex', index);
                                //$("#ddldeligatefromnameEA.search-box")[0].sumo.selectItem(index);
								var getval =  result[0]["EmployeeID"] == null ? "" :  result[0]["EmployeeID"];
                        getval = getval + "&" +  result[0].EmployeeGUID;
							 $("#ddldeligatefromnameEA").select2().select2('val',getval);
                                return false;
                            }
                            index = index + 1;
                        });
                    }
                    index = 0;
                    if (result[0].ActionType == 'Exception') {
                        $("#ddlresourcenameEA option").each(function () {

                            if (this.text == result[0].EmployeeName) { //Apr2EmployeeName
                                //$("#ddlresourcenameEA").prop('selectedIndex', index);
                                //$("#ddlexceresourcename")[0][0].innerText = result[0].Apr2EmployeeName;
                                $("#ddlresourcenameEA.search-box")[0].sumo.selectItem(index);
                                return false;
                            }
                            index = index + 1;
                        });
                        index = 0;
                        $("#ddlapprover1nameEA option").each(function () {

                            if (this.text == result[0].Apr1EmployeeName) {
                                //$("#ddlapprover1nameEA").prop('selectedIndex', index);
                                //$("#ddlapprover1nameEA")[0][0].innerText = result[0].Apr1EmployeeName;
								
                                //$("#ddlapprover1nameEA.search-box")[0].sumo.selectItem(index);
								
								var getval =  result[0]["Apr1EmployeeID"] == null ? "" :  result[0]["Apr1EmployeeID"];
                        getval = getval + "&" +  result[0].Apr1GUID;
							 $("#ddlapprover1nameEA").select2().select2('val',getval);
                                return false;
                            }
                            index = index + 1;
                        });
                        index = 0;
                        $("#ddlapprover2nameEA option").each(function () {

                            if (this.text == result[0].Apr2EmployeeName) {
                                //$("#ddlapprover2nameEA").prop('selectedIndex', index);
                                //$("#ddlexceresourcename")[0][0].innerText = result[0].Apr2EmployeeName;
                                //$("#ddlapprover2nameEA.search-box")[0].sumo.selectItem(index);
								if(this.text!='--Select--')
								{
								var getval =  result[0]["Apr2EmployeeID"] == null ? "" :  result[0]["Apr2EmployeeID"];
                        getval = getval + "&" +  result[0].Apr2GUID;
							 $("#ddlapprover2nameEA").select2().select2('val',getval);
								}
								else
								{
								
								$("#ddlapprover2nameEA").select2().select2('val','0');
								}
                                return false;
                            }
                            index = index + 1;
                        });
                    }
                    index = 0;
                    if (result[0].ActionType == 'Delegation') {

                        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

                        var StartDate = result[0].Startdatetime;

                        var DelegationStartDate = StartDate;

                        var Sdt = new Date(DelegationStartDate);
                        var DelegationstartDay = new Date(Sdt).getDate();
                        var DelegationstartMonth = new Date(Sdt).getMonth();
                        var DelegationstartYear = new Date(Sdt).getFullYear();

                        Sdt = DelegationstartDay + "-" + months[DelegationstartMonth] + "-" + DelegationstartYear;

                        //Sdt.setDate(Sdt.getDate());

                        var EndDate = result[0].Finishdatetime;

                        var DelegationEndDate = EndDate;
                        //DelegationEndDate = DelegationEndDate.split('T')[0];
                        //DelegationEndDate = DelegationEndDate.split('-');
                        //DelegationEndDate = DelegationEndDate[2] + "/" + DelegationEndDate[1] + "/" + DelegationEndDate[0];
                        var Edt = new Date(DelegationEndDate);
                        var DelegationendDay = new Date(Edt).getDate();
                        var DelegationendMonth = new Date(Edt).getMonth();
                        var DelegationendYear = new Date(Edt).getFullYear();

                        Edt = DelegationendDay + "-" + months[DelegationendMonth] + "-" + DelegationendYear;

                        //Edt.setDate(Edt.getDate());

                        $('#txtstartdateEA').val(Sdt);
                        $('#txtfinishdateEA').val(Edt);
                    }
                    if (result[0].ForExpenseModule == true) {
                        $('#rdexpenseyesEA').prop('checked', 'checked');
                    }
                    else if (result[0].ForExpenseModule == false) {
                        $('#rdexpensenoEA').prop('checked', 'checked');
                    }
                    if (result[0].ForTimeSheetModule == true) {
                        $('#rdtimesheetyesEA').prop('checked', 'checked');
                    }
                    else if (result[0].ForTimeSheetModule == false) {
                        $('#rdtimesheetnoEA').prop('checked', 'checked');
                    }
                    if (result[0].IsActive == true) {
                        $('#rdisactiveyesEA').prop('checked', 'checked');
                    }
                    else if (result[0].IsActive == false) {
                        $('#rdisactiveenoEA').prop('checked', 'checked');
                    }


                },
                error: function (data) {
                    alert('Error while taking action');
                }
            });
        }
        catch (e) {
            //alert("Error");
        }
		
			$('.loader').hide();
    }
    //clear aprroval
    function clearItemapproval() {
	$('.opt').removeClass('selected');
		$("#ddlresourcenameEA").prop("selectedIndex",-1);
		$('#ddlresourcenameEA')[0].sumo.reload();
		
        $("#ddlactiontypeEA").prop('selectedIndex', 0);

        //$("#ddlprojectnameEA").prop('selectedIndex', 0);
		 //$("#ddlprojectnameEA").select2().select2('val','0');
		 $("#ddlprojectnameEA").prop("selectedIndex",-1);
		$('#ddlprojectnameEA')[0].sumo.reload();
        //$("#ddlprojectnameEA.search-box")[0].sumo.selectItem(0);

        //$("#ddldeligatetonameEA").prop('selectedIndex', 0);
       // $("#ddldeligatetonameEA.search-box")[0].sumo.selectItem(0);
 $("#ddldeligatetonameEA").select2().select2('val','0');
        // $("#ddldeligatefromnameEA").prop('selectedIndex', 0);
        //$("#ddldeligatefromnameEA.search-box")[0].sumo.selectItem(0);
$("#ddldeligatefromnameEA").select2().select2('val','0');
        //$("#ddlresourcenameEA").prop('selectedIndex', 0);
       // $("#ddlresourcenameEA.search-box")[0].sumo.selectItem(0);

        //$("#ddlapprover1nameEA").prop('selectedIndex', 0);
        //$("#ddlapprover1nameEA.search-box")[0].sumo.selectItem(0);
$("#ddlapprover1nameEA").select2().select2('val','0');
        // $("#ddlapprover2nameEA").prop('selectedIndex', 0);
      //  $("#ddlapprover2nameEA.search-box")[0].sumo.selectItem(0);
		$("#ddlapprover2nameEA").select2().select2('val','0');
        $('.Errormsg').text("");
        $('#rdisactiveyesEA').attr('checked', false);
        $('#rdisactiveynoEA').attr('checked', false);
        $('#rdexpenseyesEA').attr('checked', false);
        $('#rdexpensenoEA').attr('checked', false);
        $('#rdtimesheetyesEA').attr('checked', false);
        $('#rdtimesheetnoEA').attr('checked', false);
        $("#txtstartdateEA").val('');
        $("#txtfinishdateEA").val('');
        if ($('#ddlactiontypeEA option:selected').text() == '--Select--') {
            $('#Del1').hide();
            $('#Del2').hide();
            $('#Del3').hide();
            $('#Del4').hide();
            $('#Ex1').hide();
            $('#Ex2').hide();
            $('#Ex3').hide();
            $('#gen1').hide();
            $('#gen2').hide();
            $('#gen3').hide();
            $('#gen4').hide();
            $('#gen5').hide();
            //$('#tblexceptionalapprovals').hide();

            $("[data-dismiss=modal]").trigger({ type: "click" });
        }

    }

    function ClearBackGroundColour() {
	 //$('.Errormsg').text("");

	 $("#Tr_Price").hide();
	  $("#Tr_ItemCurrencydd").hide();
	   $("#Tr_Quantity").hide();
	   $('#DDItemCurrency').css({

                "border": "",
                "background": ""
            });
	 
   $('#txtcountrylegal').css({

            "border": "",
            "background": ""
        });
		$('#peoplePickerDiv').css({

            "border": "",
            "background": ""
        });
		$('#FinancepeoplePickerDiv').css({

            "border": "",
            "background": ""
        });
		$('#txtEmpBaseLocation').css({

            "border": "",
            "background": ""
        });
		$('#peoplePickerDiv1').css({

            "border": "",
            "background": ""
        });
		$('#peoplePickerDiv10').css({

            "border": "",
            "background": ""
        });
        $('#ddlexceresourcename + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
        
        $('#ddlexceprojectname_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
        $('#ddlprojectnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
        $('#ddldeligatefromnameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
        $('#ddldeligatetonameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
        $('#ddlresourcenameEA + p').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
        $('#ddlapprover1nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });
        $('#ddlapprover2nameEA_div').css({ "background-color": "#FFFFFF", "border": "1px solid #A4A4A4" });

        $('#bccurrency').css({

            "border": "",
            "background": ""
        });
        $('#divbcCurrency').css({

            "border": "",
            "background": ""
        });

        $('#radiobuttons').css({

            "border": "",
            "background": ""
        });

        $('#tbitem').css({

            "border": "",
            "background": ""
        });

        $('#divitemisactive').css({

            "border": "",
            "background": ""
        });
		 $('#itemIsPQDependant').css({

            "border": "",
            "background": ""
        });

        $('#tbitemAccno').css({

            "border": "",
            "background": ""
        });

        $('#ddlexceresourcename').css({

            "border": "",
            "background": ""
        });

        $('#ddlexceprojectname').css({

            "border": "",
            "background": ""
        });

        $('#ddlProjectApprover').css({

            "border": "",
            "background": ""
        });
		$('#ddlExpApprover_div').css({

            "border": "",
            "background": ""
        });

        $('#Tbexcestartdate').css({

            "border": "",
            "background": ""
        });

        $('#Tbexcdate').css({

            "border": "",
            "background": ""
        });

        $('#Div1').css({

            "border": "",
            "background": ""
        });

        $('#ddlprojectnameEA').css({

            "border": "",
            "background": ""
        });

        $('#ddldeligatefromnameEA').css({

            "border": "",
            "background": ""
        });

        $('#ddldeligatetonameEA').css({

            "border": "",
            "background": ""
        });

        $('#exceptionappExp').css({

            "border": "",
            "background": ""
        });

        $('#exceptioappTMSheet').css({

            "border": "",
            "background": ""
        });
        $('#txtstartdateEA').css({

            "border": "",
            "background": ""
        });
        $('#txtfinishdateEA').css({

            "border": "",
            "background": ""
        });
        $('#exceptionappIsActive').css({

            "border": "",
            "background": ""
        });
		 $('#tbitemPrice').css({

                "border": "",
                "background": ""
            });
			
			 $('#tbitemQuantity').css({

                "border": "",
                "background": ""
            });
        $('#ddlresourcenameEA').css({

            "border": "",
            "background": ""
        });
        $('#ddlapprover1nameEA').css({

            "border": "",
            "background": ""
        });
        $('#ddlapprover2nameEA').css({

            "border": "",
            "background": ""
        });
		  $('#peoplePickerDiv2').css({

                "border": "",
                "background": ""
            });
			  $('#peoplePickerDiv3').css({

               "border": "",
                "background": ""
            });
			  $('#proxyIsActive').css({

                "border": "",
                "background": ""
            });
			$('#TBProxyDate').css({

                "border": "",
                "background": ""
            });
			
			 $('#peoplePickerDiv4').css({

                "border": "",
                "background": ""
            });
			  $('#peoplePickerDiv5').css({

               "border": "",
                "background": ""
            });
			  $('#proxyApprovalIsActive').css({

                "border": "",
                "background": ""
            });
			$('#TBProxyDateApproval').css({

                "border": "",
                "background": ""
            });
			 $('#ddlApproval').css({

            "border": "",
            "background": ""
        });
		
    }
	 function hideerror(val) {



            $('#' + val).css({

                "border": "",
                "background": ""
            });
         $('.Errormsg').text("");
            
           // $('.Errormsg').text("");
        }
		   function GetUserId_load(userid) {
		   
            var NewloginName = "";
			var result;
            jQuery.ajax({
                url: "/sites/pwa/_api/Web/GetUserById(" + userid + ")",
                type: "GET",
			     async: false,
                headers: { "Accept": "application/json;odata=verbose" },
                success: function (data) {
				//alert(data);
				//console.log(data);
                    var dataResults = data.d;
                    var loginName = dataResults.LoginName;
                    NewloginName = encodeURIComponent(loginName); 
					//alert(dataResults.Title);
					$('#login_name_contain').text(dataResults.Title);
                     result =  dataResults.Title;
					 
                },
                complete: function () {
                },
            });
			return result;
        }
			function GetUserId(userid) {
            var NewloginName = "";
			var result;
            jQuery.ajax({
                url: "/sites/pwa/_api/Web/GetUserById(" + userid + ")",
                type: "GET",
			     async: false,
                headers: { "Accept": "application/json;odata=verbose" },
                success: function (data) {
				//alert(data);
				//console.log(data);
                    var dataResults = data.d;
                    var loginName = dataResults.LoginName;
                    NewloginName = encodeURIComponent(loginName); 
					//$('#login_name_contain').text(dataResults.Title);
					var my_guid=getResourcesGuid(NewloginName);
					console.log(my_guid);
                     result = dataResults.Title;
					 
                },
                complete: function () {
                },
            });
			return result;
        }
		function getReportingManagerGuidByRMEmp(RMempId) 
		{
          var emp_detail="";
            jQuery.ajax({

                //url: "/sites/Dev/_api/ProjectData/Resources?$filter=ResourceNTAccount eq('" + NewloginName + "')",
   // url: "sites/Dev/_api/projectdata/Resources?$filter=EmployeeID eq '"+RMempId+"'",
  url: "https://bristleconeonline.sharepoint.com/sites/pwa/_api/projectdata/Resources?$filter=EmployeeID eq '"+RMempId+"'",
                type: "GET",
				async:false,
                headers: { "Accept": "application/json;odata=verbose" },
                success: function (data) {
				
				//console.log('data'+data);

					emp_detail=data.d.results[0].ResourceName;
				

                }
            });
return emp_detail;
        }
		 function getResourcesGuid(NewloginName) {
		//alert('nilamcall');
		//alert(Type_query);
          var guid;
            jQuery.ajax({

                url: "/sites/pwa/_api/ProjectData/Resources?$filter=ResourceNTAccount eq('" + NewloginName.replace(/#/g , "%23") + "')",
                type: "GET",
				async:false,
                headers: { "Accept": "application/json;odata=verbose" },
                success: function (data) {
                    //console.log(data);
                 guid = data.d.results[0].ResourceId;
					//guid = data.d.results[0].ResourceId+"_"+data.d.results[0].EmployeeID;
                    //alert('GUID' + GUID);


                }
            });
           return guid;
        }
		function getResourcesGuidNew(NewloginName) {
		//alert('nilamcall');
		//alert(Type_query);
          var guid;
            jQuery.ajax({

                url: "/sites/pwa/_api/ProjectData/Resources?$filter=ResourceNTAccount eq('" + NewloginName.replace(/#/g , "%23") + "')",
                type: "GET",
				async:false,
                headers: { "Accept": "application/json;odata=verbose" },
                success: function (data) {
                    //console.log(data);
                // guid = data.d.results[0].ResourceId;
					guid = data.d.results[0].ResourceId+"_"+data.d.results[0].EmployeeID;
                    //alert('GUID' + GUID);


                }
            });
           return guid;
        }
		 function getResourcesGuidByResourceName(NewloginName) {
		//alert('nilamcall');
		//alert(Type_query);
          var guid;
            jQuery.ajax({

                url: "/sites/pwa/_api/ProjectData/Resources?$filter=ResourceName eq('" + NewloginName + "')",
                type: "GET",
				async:false,
                headers: { "Accept": "application/json;odata=verbose" },
                success: function (data) {
                    console.log(data);
                    guid = data.d.results[0].ResourceId+"_"+data.d.results[0].EmployeeID;
                }
            });
           return guid;
        }
		
		function GetUserId1(userid) {
            var NewloginName = "";
			var result;
            jQuery.ajax({
                url: "/sites/pwa/_api/Web/GetUserById(" + userid + ")",
                type: "GET",
			     async: false,
                headers: { "Accept": "application/json;odata=verbose" },
                success: function (data) {
				//alert(data);
				console.log(data);
                    var dataResults = data.d;
                    var loginName = dataResults.LoginName;
                    NewloginName = encodeURIComponent(loginName); 
					//$('#login_name_contain').text(dataResults.Title);
                     result =  data.d.LoginName;
					 
                },
                complete: function () {
                },
            });
			return result;
        }
		
		
		 function CheckDuplicate(my_value,field,datatype,listname) {
          
		   var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		  var result=false;
            var Div_Log = "";
            var notes = "";
            var query_cml = '<View><Query><Where><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq></Where></Query></View>';

            $.ajax({
                url: siteUrl + "/_api/web/lists/getbytitle('"+listname+"')/GetItems",
                type: "POST",
                async: false,
                headers: {
                    "accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                    "content-Type": "application/json;odata=verbose"
                },
                data: JSON.stringify({
                    query: {
                        __metadata: {
                            type: "SP.CamlQuery"
                        },
                        ViewXml: query_cml
                    }
                }),

                beforeSend: function () {
                   
                },

                success: function (data) {

                
                    if (data.d.results.length > 0) {
              result=true;
                       
                    }


                },
                error: function (data) {

                    alert(data.responseJSON.error.message.value);
                },
                complete: function () {
				
                }

            });
return result;
        }
				 function CheckDuplicateForUpdate(my_value,field,datatype,listname,my_value1,field1,datatype1) {
          
		   var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		  var result=false;
            var Div_Log = "";
            var notes = "";
            var query_cml = '<View><Query><Where><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Neq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 +'</Value></Neq></And></Where></Query></View>';

            $.ajax({
                url: siteUrl + "/_api/web/lists/getbytitle('"+listname+"')/GetItems",
                type: "POST",
                async: false,
                headers: {
                    "accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                    "content-Type": "application/json;odata=verbose"
                },
                data: JSON.stringify({
                    query: {
                        __metadata: {
                            type: "SP.CamlQuery"
                        },
                        ViewXml: query_cml
                    }
                }),

                beforeSend: function () {
                   
                },

                success: function (data) {

                
                    if (data.d.results.length > 0) {
              result=true;
                       
                    }


                },
                error: function (data) {

                    alert(data.responseJSON.error.message.value);
                },
                complete: function () {
				
                }

            });
return result;
        }
		
	  function close_div()
	  {
	  $("#alertmain").hide();
	  document.getElementById("Alert_msg").innerHTML="";
	  }
	  function showmsg(msg)
	  {
	  $("#alertmain").show();
	  document.getElementById("Alert_msg").innerHTML=msg;
	  }
	  function getapprover()
	  {
	// alert( )
	 if($('#ddlProjectApprover option:selected').text()=="Other")
	 {
	 $('#ExpApprover').show();
	 }
	 else
	 {
	 
	  $('#ExpApprover').hide();
	 }
	 
	  }
	  
	   function checkduplicateException(my_value,datatype,field,my_value1,datatype1,field1,listname) {
          
		   var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		  var result=false;
            var Div_Log = "";
            var notes = "";
            var query_cml = '<View><Query><Where><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq></And></Where></Query></View>';

            $.ajax({
                url: siteUrl + "/_api/web/lists/getbytitle('"+listname+"')/GetItems",
                type: "POST",
                async: false,
                headers: {
                    "accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                    "content-Type": "application/json;odata=verbose"
                },
                data: JSON.stringify({
                    query: {
                        __metadata: {
                            type: "SP.CamlQuery"
                        },
                        ViewXml: query_cml
                    }
                }),

                beforeSend: function () {
                   
                },

                success: function (data) {

                
                    if (data.d.results.length > 0) {
              result=true;
                       
                    }


                },
                error: function (data) {

                    alert(data.responseJSON.error.message.value);
                },
                complete: function () {
				
                }

            });
return result;
        }
		
		function checkduplicateExceptionUpdate(my_value,datatype,field,my_value1,datatype1,field1,listname,my_value2,datatype2,field2) {
          
		   var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		  var result=false;
            var Div_Log = "";
            var notes = "";
            //var query_cml = '<View><Query><Where><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq><And><Neq><FieldRef Name="ID"/><Value Type="COUNTER">' + my_value2 + '</Value></Neq></And></And></Where></Query></View>';
// var query_cml = '<View><Query><Where><And><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq><Neq><FieldRef Name='+field2+'/><Value Type='+datatype2+'>' + my_value2 + '</Value></Neq></And></Where></Query></View>';
   var query_cml = '<View><Query><Where><And><Neq><FieldRef Name='+field2+'/><Value Type='+datatype2+'>' + my_value2 + '</Value></Neq><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq></And></And></Where></Query></View>';        
		   $.ajax({
                url: siteUrl + "/_api/web/lists/getbytitle('"+listname+"')/GetItems",
                type: "POST",
                async: false,
                headers: {
                    "accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                    "content-Type": "application/json;odata=verbose"
                },
                data: JSON.stringify({
                    query: {
                        __metadata: {
                            type: "SP.CamlQuery"
                        },
                        ViewXml: query_cml
                    }
                }),

                beforeSend: function () {
                   
                },

                success: function (data) {

                
                    if (data.d.results.length > 0) {
              result=true;
                       
                    }


                },
                error: function (data) {

                    alert(data.responseJSON.error.message.value);
                },
                complete: function () {
				
                }

            });
return result;
        }
		
		function ChangeItemtype()
		{
		//alert($('#ddlItemtype option:selected').text());
		if($('#ddlItemtype option:selected').text()=="Payment Type")
		{
		$("#IsPriceQuantDependent").hide();
		}
		else
		{
		
		$("#IsPriceQuantDependent").show();
		}
		}
	  
	  function checkduplicateProxy(my_value,datatype,field,my_value1,datatype1,field1,listname,type,my_value2) {
          
		   var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		  var result=false;
            var Div_Log = "";
            var notes = "";
			if(type=="")
			{
            var query_cml = '<View><Query><Where><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq></And></Where></Query></View>';
            }
           else
           { 

          var query_cml = '<View><Query><Where><And><Neq><FieldRef Name=ID /><Value Type=Counter >' + my_value2 + '</Value></Neq><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq></And></And></Where></Query></View>';
           
            }
			//alert(query_cml);
            $.ajax({
                url: siteUrl + "/_api/web/lists/getbytitle('"+listname+"')/GetItems",
                type: "POST",
                async: false,
                headers: {
                    "accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                    "content-Type": "application/json;odata=verbose"
                },
                data: JSON.stringify({
                    query: {
                        __metadata: {
                            type: "SP.CamlQuery"
                        },
                        ViewXml: query_cml
                    }
                }),

                beforeSend: function () {
                   
                },

                success: function (data) {

                
                    if (data.d.results.length > 0) {
              result=true;
                       
                    }


                },
                error: function (data) {

                    alert(data.responseJSON.error.message.value);
                },
                complete: function () {
				
                }

            });
return result;
        }
		function checkduplicateForDeligationException(my_value,datatype,field,my_value1,datatype1,field1,my_value3,listname,type,my_value2) {
          
		   var siteUrl = 'https://bristleconeonline.sharepoint.com/sites/pwa';
		  var result=false;
            var Div_Log = "";
            var notes = "";
			if(type=="")
			{
            var query_cml = '<View><Query><Where><And><Eq><FieldRef Name=ActionType /><Value Type=Text>' + my_value3 + '</Value></Eq><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq></And></And></Where></Query></View>';
            }
           else
           { 

          var query_cml = '<View><Query><Where><And><Neq><FieldRef Name=ID /><Value Type=Counter >' + my_value2 + '</Value></Neq><And><Eq><FieldRef Name=ActionType /><Value Type=Text>' + my_value3 + '</Value></Eq><And><Eq><FieldRef Name='+field+'/><Value Type='+datatype+'>' + my_value + '</Value></Eq><Eq><FieldRef Name='+field1+'/><Value Type='+datatype1+'>' + my_value1 + '</Value></Eq></And></And></And></Where></Query></View>';
           
            }
			//alert(query_cml);
            $.ajax({
                url: siteUrl + "/_api/web/lists/getbytitle('"+listname+"')/GetItems",
                type: "POST",
                async: false,
                headers: {
                    "accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                    "content-Type": "application/json;odata=verbose"
                },
                data: JSON.stringify({
                    query: {
                        __metadata: {
                            type: "SP.CamlQuery"
                        },
                        ViewXml: query_cml
                    }
                }),

                beforeSend: function () {
                   
                },

                success: function (data) {

                
                    if (data.d.results.length > 0) {
              result=true;
                       
                    }


                },
                error: function (data) {

                    alert(data.responseJSON.error.message.value);
                },
                complete: function () {
				
                }

            });
return result;
        }
		
		
	  jQuery(window).load(function () {
   //alert('page is loaded');
   $(".loader").hide();
   
    
    
});
</script>

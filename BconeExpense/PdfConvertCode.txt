
<!--<style>
    .ExpenseDiv {
        border-color: black;
        border: 2px solid;
    }
    .ExpnsInfo table th, .nice-table table td {
    }

           .break {
        display: block;
        clear: both;
        page-break-after: always !important;
        page-break-before: always !important;
    }
        .clear {
            height:300px;
        }

</style>-->

<style>
        .ExpenseDiv {
        border-color: black;
        border: 2px solid;
    }
    /*.ExpenseTable {
        border-color: black;
        border: 2px solid;
        color:black;
        width:95%;
        height:400px;
    }
    .ExpnsInfo table th, .nice-table table td {
        width:80%;
    }
    .ItemInfo {
        width:80%;
    }

           .break {
        display: block;
        clear: both;
        page-break-after: always !important;
        page-break-before: always !important;
    }
        .clear {
            height:300px;
        }*/

</style>

  <div id="part1" style="width:93%; margin:40px 40px 40px 5px; font-family:Arial, Helvetica, sans-serif; font-size:12px;">
	<div style="margin-bottom:15px;">
    	<a href="javascript:void(0)">
        	<img src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/Bristlecone_logo.png" style="width:200px;" />
        </a>
    </div>
    <div style="">
        <div style="padding:5px; border:1px solid;border-color:black;width:98%;"> <!--solid #ccc;-->
            <b>Expenses</b><br />
            Tracking number: 72953 <br />
            Date: 06/04/14 <br />
            Name: Pune Mumbai travel <br />
            Description: Travel to discuss projects <br />
            Status: Approved
        </div>
        <div style="padding:5px; border:1px solid;border-color:black; border-bottom:0px; border-top:0px;width:98%;">
            <b>From</b> <br />
            ganesh ahire <br />
            Employee Num: B10799 <br />
            Employment Type: India <br />
            User location: Pune
        </div>
        <div>
        <table border="1" style="width:100%; padding:0; word-break: break-all;"><!--bordercolor="#CCCCCC" cellpadding="0" cellspacing="0" -->
        	<tr>
            	<td colspan="16" style="padding:5px; ">
                	<b>Daily summary of reimbursable expense items</b>
                </td>
            </tr>
        	<tr>
            	<td style="padding:5px;" colspan="14">
                	<b>Expense item </b>
                </td>
                <td style="padding:5px; text-align:right;">
                	<b>06/04/14</b>
                </td>
                <td style="padding:5px; text-align:right;">
                	<b>Total</b>
                </td>
            </tr>
        	<tr>
            	<td style="padding:5px;" colspan="14">Cab/Shuttle/Bus/Train/AutoRickshaw</td>
                <td style="padding:5px; text-align:right;">2,415.00 Rs</td>
                <td style="padding:5px; text-align:right;">2,415.00 Rs</td>
            </tr>
        	<tr>
            	<td style="padding:5px;" colspan="14">Daily totals</td>
                <td style="padding:5px; text-align:right;">2,415.00 Rs</td>
                <td style="padding:5px; text-align:right;">2,415.00 Rs</td>
            </tr>
        	<tr>
            	<td style="padding:5px;" colspan="14">Non-billable totals</td>
                <td style="padding:5px; text-align:right;">2,415.00 Rs</td>
                <td style="padding:5px; text-align:right;">2,415.00 Rs</td>
            </tr>
            <tr>
                <td colspan="16" style="padding:5px;">
                    <b>Reimbursable expense item(s)</b>
                </td>
            </tr>
            <tr style="vertical-align:top;">
                <th style="width:80px; padding:5px;">Reference #</th>
                <th style="width:73px; padding:5px;">Date</th>
                <th style="width:66px; padding:5px;">Customer</th>
                <th style="width:103px; padding:5px;">Project</th>
                <th style="width:75px; padding:5px;">Phase</th>
                <th style="width:175px; padding:5px;">Description</th>
                <th style="width:75px; padding:5px;">Notes</th>
                <th style="width:92px; padding:5px;">Reimbursable</th>
                <th style="width:76px; padding:5px;">SAP Account Number</th>
                <th style="width:60px; padding:5px;">Billable</th>
                <th style="width:75px; padding:5px;">Amount</th>
                <th style="width:60px; padding:5px;">Foreign currency price</th>
                <th style="width:60px; padding:5px;">Foreign currency symbol</th>
                <th style="width:60px; padding:5px;">Missing paper receipt</th>
                <th style="width:124px; padding:5px;">Expense item</th>
                <th style="width:124px; padding:5px;">SAP Project Number</th>
            </tr>
            <tr>
                <td style="padding:5px; text-align:center;">1</td>
                <td style="padding:5px;">06/04/14</td>
                <td style="padding:5px;">BCONE</td>
                <td style="padding:5px;">21G-998BCI029: Business Information and Application 21G-998BCI029</td>
                <td style="padding:5px;">G&A: Business Information & Applications</td>
                <td style="padding:5px; word-wrap: break-word;">Cab/Shuttle/Bus/Train/AutoRickshaw</td>
                <td style="padding:5px;">Bus ticket from Pune to Mumbai 415 and  Cab fare from Mumbai to Pune (for Me and Suchita)</td>
                <td style="padding:5px;">Y </td>
                <td style="padding:5px;">441000</td>
                <td style="padding:5px;">N</td>
                <td style="padding:5px;">2,415.00 Rs</td>
                <td style="padding:5px;">0.000</td>
                <td style="padding:5px;"></td>
                <td style="padding:5px;">No</td>
                <td style="padding:5px; word-wrap: break-word;">Cab/Shuttle/Bus/Train/AutoRickshaw</td>
                <td style="padding:5px;">21G-998BCI029</td>
            </tr>
        </table>
            </div>
    </div>
</div>

<div id="part2" style="width:93%; margin:40px 40px 40px 5px; font-family:Arial, Helvetica, sans-serif; font-size:12px;color:black">
	<div style="margin-bottom:15px;">
    	<a href="javascript:void(0)">
        	<img src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/Bristlecone_logo.png" style="width:200px;" />
        </a>
    </div>
    <div style="">
        <div style="padding:5px; border:1px solid;border-color:black;width:98%;">
            <b>Expenses</b><br />
            Tracking number: 72953 <br />
            Date: 06/04/14 <br />
            Name: Pune Mumbai travel <br />
            Description: Travel to discuss projects <br />
            Status: Approved
        </div>
        <div style="padding:5px; border:1px solid;border-color:black; border-bottom:0px; border-top:0px;width:98%;">
            <b>From</b> <br />
            ganesh ahire <br />
            Employee Num: B10799 <br />
            Employment Type: India <br />
            User location: Pune
        </div>
        <table border="1" style="width:100%; padding:0; word-break: break-all;"> <!--bordercolor="#CCCCCC" cellpadding="0" cellspacing="0"-->
        	<tr>
            	<td style="padding:5px;">
                	Total of all expense items
                </td>
                <td style="width:100px; text-align:right; padding:5px;">
                	2,415.00 Rs
                </td>
                <td style="width:100px; padding:5px;">
                </td>
            </tr>
        	<tr>
            	<td style="padding:5px;">
                	Non-reimbursable expense items
                </td>
                <td style="padding:5px; text-align:right;">
                	0.00 Rs
                </td>
                <td style="padding:5px; text-align:right;">
                	
                </td>
            </tr>
        	<tr>
            	<td style="padding:5px;">Cash advance</td>
                <td style="padding:5px; text-align:right;">0.00 Rs</td>
                <td style="padding:5px; text-align:right;"></td>
            </tr>
        	<tr>
            	<td style="padding:5px;">Total due </td>
                <td style="padding:5px; text-align:right;">2,415.00 Rs</td>
                <td style="padding:5px; text-align:right;"></td>
            </tr>
            <tr>
                <td colspan="16" style="padding:5px;">
                    <b>Approval history </b>
                </td>
            </tr>
            <tr>
                <td colspan="16" style="padding:5px;">
                    <b>Status: </b>Approved
                </td>
            </tr>
            <tr style="vertical-align:top;">
                <th style="width:60px; padding:5px;">Date/Time</th>
                <th style="width:200px; padding:5px;">Action</th>
                <th style="padding:5px;">Notes</th>
            </tr>
            <tr>
                <td style="padding:5px;">06/05/14 <br /> 14:57</td>
                <td style="padding:5px;">Submitted for approval by ganesh ahire</td>
                <td style="padding:5px;"></td>
            </tr>
            <tr>
                <td style="padding:5px;">06/05/14 <br /> 14:57</td>
                <td style="padding:5px;">Approved by [Manager] For project entries associated with 'BCONE:21G-998BCI029: Business Information and Application 21G-998BCI029'</td>
                <td style="padding:5px;">Automatic approval: [Manager] does not exist</td>
            </tr>
            <tr>
                <td style="padding:5px;">06/05/14 <br /> 14:57</td>
                <td style="padding:5px;">Approved by ganesh ahire</td>
                <td style="padding:5px;">Automatic approval: The approver is the same user as the submitter</td>
            </tr>
        </table>
    </div>
</div>

<div>
    <input type="button" id="btncmd" value="save"/>
</div>

<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/jquery.min.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/jspdf.debug.js"></script>
<!--<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/jspdf.min.js"></script>-->

<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/html2canvas.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/jquery.plugin.html2canvas.js"></script>
<!--<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/jspdftest.js"></script>-->

<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/cell.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/from_html.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/split_text_to_size.js"></script>
<script src="https://bristleconeonline.sharepoint.com/sites/Dev/SiteAssets/BconeExpenseJs/standard_fonts_metrics.js"></script>
<script type="text/javascript" src="../SiteAssets/BconeExpenseJs/Config.js"></script>

<script type="text/javascript">
        //$(function () {
        //    var doc = new jsPDF();
        //    var specialElementHandlers = {
        //        '#editor': function (element, renderer) {
        //            return true;
        //        }
        //    };

        //    $('#btncmd').click(function () {

        //        var table = tableToJson($('#exptab').get(0))
        //        var doc = new jsPDF('p', 'pt', 'a4', true);
        //        doc.cellInitialize();
        //        $.each(table, function (i, row) {
        //            console.debug(row);
        //            $.each(row, function (j, cell) {
        //                doc.cell(10, 50, 120, 50, cell, i);  // 2nd parameter=top margin,1st=left margin 3rd=row cell width 4th=Row height
        //            })
        //        })


        //        doc.save('sample-file.pdf');
        //    });
        //    function tableToJson(table) {
        //        var data = [];

        //        // first row needs to be headers
        //        var headers = [];
        //        for (var i = 0; i < table.rows[0].cells.length; i++) {
        //            headers[i] = table.rows[0].cells[i].innerHTML.toLowerCase().replace(/ /gi, '');
        //        }


        //        // go through cells
        //        for (var i = 0; i < table.rows.length; i++) {

        //            var tableRow = table.rows[i];
        //            var rowData = {};

        //            for (var j = 0; j < tableRow.cells.length; j++) {

        //                rowData[headers[j]] = tableRow.cells[j].innerHTML;

        //            }

        //            data.push(rowData);
        //        }

        //        return data;
        //    }
        //});

       
        //test 2

        //$("#btncmd").click(function () {
        //    var pdf = new jsPDF('p', 'pt', 'letter');//'p', 'pt', 'ledger'
        //    //var options = {
        //    //    pagesplit: true
               
        //    //};
        //    // source can be HTML-formatted string, or a reference
        //    // to an actual DOM element from which the text will be scraped.

        //   source = $('#maindiv')[0];

        //    //nextsource = $('#part2ExpenseDiv')[0];

        //    // we support special element handlers. Register them with jQuery-style 
        //    // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)

               
        //    // There is no support for any other type of selectors 
        //    // (class, of compound) at this time.
        //    specialElementHandlers = {
        //        // element with id of "bypass" - jQuery style selector
        //        '#bypassme': function (element, renderer) {
        //            // true = "handled elsewhere, bypass text extraction"
        //            return true
        //        }
        //    };

        //    //var pdfName = 'sample.pdf';

        //    margins = {
        //        top: 80,
        //        bottom: 60,
        //        left: 60,
        //        width: 522
        //    };
        //    // all coords and widths are in jsPDF instance's declared units
        //    // 'inches' in this case
        //    alert('start');

        //    pdf.fromHTML(source, // HTML string or DOM elem ref.
        //    margins.left, // x coord
        //    margins.top, { // y coord
        //        'width': margins.width, // max width of content on PDF
        //        'elementHandlers': specialElementHandlers
        //    },

        //    function (dispose) {
        //        // dispose: object with X, Y of the last line add to the PDF 
        //        //          this allow the insertion of new lines after html
        //        pdf.save('fileNameOfGeneretedPdf.pdf');
        //    }, margins);//,options);
        //});


        //test finally
 </script>

<script type="text/javascript">

    $(document).ready(function () {
	disableRightClick();
        //$(function () {
        //    var doc = new jsPDF();
        //    var specialElementHandlers = {
        //        '#editor': function (element, renderer) {
        //            return true;
        //        }
        //    };

        //    $('#btncmd').click(function () {

        //        var table = tableToJson($('#pt1').get(0))
        //        var doc = new jsPDF('p', 'pt', 'a4', true);
        //        doc.cellInitialize();
        //        $.each(table, function (i, row) {
        //            console.debug(row);
        //            $.each(row, function (j, cell) {
        //                doc.cell(10, 50, 120, 50, cell, i);  // 2nd parameter=top margin,1st=left margin 3rd=row cell width 4th=Row height
        //            })
        //        })


        //        doc.save('sample-file.pdf');
        //    });
        //    function tableToJson(table) {
        //        var data = [];

        //        // first row needs to be headers
        //        var headers = [];
        //        for (var i = 0; i < table.rows[0].cells.length; i++) {
        //            headers[i] = table.rows[0].cells[i].innerHTML.toLowerCase().replace(/ /gi, '');
        //        }


        //        // go through cells
        //        for (var i = 0; i < table.rows.length; i++) {

        //            var tableRow = table.rows[i];
        //            var rowData = {};

        //            for (var j = 0; j < tableRow.cells.length; j++) {

        //                rowData[headers[j]] = tableRow.cells[j].innerHTML;

        //            }

        //            data.push(rowData);
        //        }

        //        return data;
        //    }
        ////});
        var uid = '724';
        //test finally

        var filename='testingPDFfile';

        $("#btncmd").click(function () {

            window.open('https://bristleconeonline.sharepoint.com/sites/Dev/SitePages/TestPdf.aspx?TrackingID=' + uid, '_blank').focus();

           // var pdf = new jsPDF('p', 'pt', 'a4');

           // var pdfName = 'testsample';
           // //var options = {
           // //            format: 'JPEG',
           // //            //                    pagesplit: true,
           // //            //"background": '#000',background: '#fff' 
           // //        };

           // //var specialElementHandlers = {
           // //    '#editor': function (element, renderer) {
           // //        return true;
           // //    }
           // //};

           // //margins = {
           // //    top: 80,
           // //    bottom: 60,
           // //    left: 60,
           // //    width: 500,
           // //    //height: 400,
           // //};

           // //var fullPage = $('#testit')[0];//$('#fullpage')[0];
           // var firstPartPage = $('#test'),
           //  secondPartPage = $('#part2');

           //pdf.addHTML(firstPartPage, 10, 20,function () { pdf.addPage()});

           //pdf.addHTML(secondPartPage, 10, 20, function (dispose) {

           //     //                    pdf.save(pdfName);
           //     //var blob = pdf.output("blob");
           //     //window.open(URL.createObjectURL(blob));
           //    pdf.save(filename + '.pdf');
           //  });


            //pdf.fromHTML($('#part1').html(), 15, 15, {
            //    'width': 300,
            //    'elementHandlers': specialElementHandlers
            //});
            //pdf.save('sample-file.pdf');

        });

            //var pdf = new jsPDF('p', 'pt', 'a4');

            //var pdfName = 'testsample';

            ////margins = {
            ////    top: 80,
            ////    bottom: 60,
            ////    left: 60,
            ////    width: 600,

            ////};

            //var firstPartPage = $('#part1')[0],
            //  secondPartPage = $('#part2')[0];

            //pdf.addHTML(secondPartPage, 15, 20, function () { pdf.addPage() });
            //pdf.addHTML(firstPartPage, 15, 20, function (dispose) {

            //    pdf.save(pdfName + '.pdf');

            //  });


            ////////    var pdf = new jsPDF('p', 'pt', 'letter');

            ////////    var pdfName = 'testsample';

            ////////    //var options = {
            ////////    //   // format: 'JPEG',
            ////////    //    //                    pagesplit: true,
            ////////    //    //"background": '#000',
            ////////    //};
            ////////    margins = {
            ////////        top: 80,
            ////////        bottom: 60,
            ////////        left: 60,
            ////////        width: 520,

            ////////    };

            ////////     //var fullPage = $('#Printout_21571')[0],
            ////////    var firstPartPage = $('#part1')[0],
            ////////      secondPartPage = $('#part2')[0];
            ////////      //testpage = $('#parttt1')[0];
            ////////      //thirdPage = $('#part3')[0];

            ////////    //pdf.addHTML(testpage, 15, 20, function () { pdf.addPage() });
            ////////    pdf.addHTML(firstPartPage, 15, 20, function () { pdf.addPage() });
            ////////    pdf.addHTML(secondPartPage, 15, 20, function (dispose) {

                 
            ////////        pdf.save(pdfName + '.pdf');
            ////////    },margins);
            ////////});

            //var pdf = new jsPDF('p', 'pt', 'a3');

            //var pdfName = 'testSample';

            //margins={
            //    top:80,
            //    bottom:60,
            //    left:60,
            //    width:522,
            //};

            //var FirstPage = $('#part1')[0],
            //    SecondPage = $('#part2')[0];
            
            //pdf.addHTML(FirstPage, 15, 20, function () { pdf.addPage() });
            //pdf.addHTML(SecondPage, 15, 20, function (dispose) {

            //    pdf.save(pdfName + '.pdf');
        //},margins);

        ////////////////var pdf = new jsPDF('p', 'pt', 'a4');
        ////////////////// source can be HTML-formatted string, or a reference
        ////////////////// to an actual DOM element from which the text will be scraped.
        ////////////////source = $('#maincontentDiv')[0];

        ////////////////// we support special element handlers. Register them with jQuery-style 
        ////////////////// ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
        ////////////////// There is no support for any other type of selectors 
        ////////////////// (class, of compound) at this time.
        ////////////////specialElementHandlers = {
        ////////////////     //element with id of "bypass" - jQuery style selector
        ////////////////    '#bypassme': function (element, renderer) {
        ////////////////         //true = "handled elsewhere, bypass text extraction"
        ////////////////        return true
        ////////////////    }
        ////////////////};
        ////////////////margins = {
        ////////////////    top: 80,
        ////////////////    bottom: 60,
        ////////////////    left: 60,
        ////////////////    width: 522
        ////////////////};
        ////////////////// all coords and widths are in jsPDF instance's declared units
        ////////////////// 'inches' in this case
        ////////////////pdf.addHTML(source, // HTML string or DOM elem ref.
        ////////////////margins.left, // x coord
        ////////////////margins.top, { // y coord
        ////////////////    'width': margins.width, // max width of content on PDF
        ////////////////    'elementHandlers': specialElementHandlers
        ////////////////},

        ////////////////function (dispose) {
        ////////////////     //dispose: object with X, Y of the last line add to the PDF 
        ////////////////     //         this allow the insertion of new lines after html
        ////////////////    pdf.save('fileNameOfGeneretedPdf.pdf');
        ////////////////    pdf.save(filename+'.pdf');
        ////////////////}, margins);
    });

   
</script>


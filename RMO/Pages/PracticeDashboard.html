<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>RMO</title>
    <link rel="stylesheet" href="../SiteAssets/RMO/css/bootstrap.min.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/CSS/jquery-ui.css" type="text/css" />
    <link rel="stylesheet" href="../SiteAssets/RMO/css/font-awesome.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/jquery.mCustomScrollbar.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/style.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/buttons.dataTables.min.css">
    <style>
        .btn-file>input {
            position: absolute;
            top: 0;
            right: 0;
            margin: 0;
            opacity: 0;
            filter: alpha(opacity=0);                                                                                                             
            font-size: 23px;
            height: 100%;
            width: 100%;
            direction: ltr;
            cursor: pointer;
            border-radius: 0;
        }

        .fileinput .form-control {
            width: 100%;
            position: relative;
        }

        .tab-main {
            position: absolute;
            width: 98%;
            margin: 0 auto;
        }

        .mCS-dark-thin.mCSB_scrollTools .mCSB_dragger .mCSB_dragger_bar {
            width: 9px;
        }

        .mCS-dark-thin.mCSB_scrollTools .mCSB_dragger .mCSB_dragger_bar {
            width: 7px;
        }

        .small-nav li {
            position: relative;
        }

        div[id*="_paginate"],
        div[id*="_filter"] {
            position: absolute;
            right: 31px;
        }

        div[id*="_wrapper"] {
            padding-bottom: 40px;
        }
		.scrollxyz
		{

			white-space: nowrap;
			
		}
		#divSkillInfo
		{
		display:none;
		}
		
		.action-b-view {
			top: -10px;
		}
		
    </style>
</head>

<body>
    <div class="loader" style="display: block;"></div>
    <div class="breadcrumb-new">
        <ul>
            <li><a href="https://bristleconeonline.sharepoint.com/sites/pwa/default.aspx">Home</a> </li>
            <li><a style="cursor: default; text-decoration: none; color: #272727;">RRF Practice Dashboard</a> </li>
            <li> <select id="ddlRolewiseSubPractice" onchange="getRRFData()"></select> </li>
        </ul>
        <div class="breadcrumb-new pull-right">
            <ul>
                <li>Reports</li>
                <li> <select id="ddlReports" onchange="GotoSelectedReports()">
                        <option value='0'>Select</option>
                        <option value='BenchReports'>Bench Reports</option>
                        <option value='UtilizationReports'>Utilization Reports</option>
                        <option value='TimesheetReports'>Timesheet Reports</option>
                        <option value='TimesheetComplianceReports'>Sub Practice Utilization Calculator  </option>

                    </select> </li>
            </ul>
        </div>
        <div class="clearfix"></div>
    </div>
    <!-----------Breadcrumb End---------->
    <div class="contain-div">
        <div class="db_box">
            <ul>
                <li onclick="getResourcesDetails('Total')" style="background-color:#01c0c8" class="tooltipAR" title="Total Billable Head-count under Global Practices and ISV Practices. Total Head-count of Billable Consultants under this Practice. Includes Serving Notice. Data is integrated with WorkDay maintained by HR"> <span id="TotalCapacityVal"></span>
                    <div>Total Billable Capacity</div>
                </li>
                <li onclick="getResourcesDetails('Free')" style="background-color:#00c292" class="tooltipFR" title="% of Billable Consultants including Serving Notice/Long Leaves"><span id="DeployableVal"></span>
                    <div>Total Available Pool</div>
                </li>
                <li onclick="getResourcesDetails('RollOff')" style="background-color:#fdc006" class="tooltipRF" title="% of Consultants ending their Billable allocations in next 3 weeks and extension/release confirmation awaited from PM."><span id="RollOffVal"></span>
                    <div>Upcoming Project Roll-offs</div>
                </li>
                <li onclick="getResourcesDetails('Booked')" style="background-color:#fb9678" class="tooltipBK" title="% of Consultants allocated to Projects. This includes upcoming Roll-offs."><span id="AllocatedVal"></span>
                    <div>Allocated to Billable Projects</div>
                </li>
                <li onclick="getResourcesDetails('SoftBlock')" style="background-color:#9675ce" class="tooltipSB" title="% of Consultants soft-blocked for an upcoming demand."><span id="SoftBlockVal"></span>
                    <div>Softblocked / Proposed</div>
                </li>
				<!-- <li onclick="getResourcesDetails('Investment')" style="background-color:#03a9f3" class="tooltipIN" title="% of Consultants allocated as Investment to Practice based on exception approval and for specific period. Available for deployment only as last option."><span id="InvestmentVal"></span> -->
				<li style="background-color:#03a9f3" class="tooltipIN" title="Allocated to Billable Projects/Total Billable Capacity (-) variables of 10% (Leaves-7%, Missing Timesheets-1%, Presales-1%, Unapproved Timesheets-1%). "><span id="InvestmentVal"></span>
                    <div>Indicative Billable Utilization %</div>
                </li>
                <li class="pull-right" onclick="getResourcesDetails('NewJoinee')" title="Upcomming joinie" style="visibility:hidden"><span id="NewJoineeVal"></span>
                    <div>Upcoming New Joinee </div>
                </li>
            </ul>
        </div>
        <div class="clearfix"></div>
        <div class="clearfix"></div> <br />
        <div class="small-nav">
            <ul>
                <li class="active clssOpen" onclick="refine_status('allrecord','All Record')"><a href="#">OPEN DEMANDS</a><span class="red-count" id="rrfallrecordcount"></span></li>
                <li onclick="refine_status('fulfilled','Internally Fulfilled')"><a href="#">FULFILLED DEMANDS</a><span class="red-count" id="rrffulfilledcount"></span></li>
                <li onclick="refine_status('withdrawn','Withdrawn')"><a href="#">WITHDRAWN DEMANDS</a><span class="red-count" id="rrfwithdrawncount"></span></li>
            </ul>
        </div> <br />
        <div class="clearfix"></div>
        <div class="tab-main">
            <div class="" style="max-width: 99%; margin: auto;">
                <table id="RRFTable" class="display" width="100%"></table>
            </div>
        </div>
    </div>
    <!------------------------
   Alert Message
   -------------------------->
    <div class="popup-bg-alert" style="display: none">
        <div class="popup">
            <div class="popup-head">
                <div class="panel-head ">
                    <h4 class="alertmessage pull-left" style="display: none"></h4>
                    <div class="right-pol">
                        <div class="p-close">x</div>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
            <div class="popup-boday text-center"> <label id="withdrawnrejectdata" style="display: none"></label> <br /> </div>
        </div>
    </div>
    <!-----------------------------
		POPUP START
------------------------------>
    <div class="popup-bg">
        <div class="popup">
            <div class="popup-head">
                <div class="panel-head pull-left">
                    <h4 class="clssPopupHead"></h4>
                </div>
                <div class="right-pol">
                    <div class="p-close">x</div>
                </div>
                <div class="clear"></div>
            </div>
            <div class="popup-boday">
                <div id="divApproveBody" style="display: none"> </div>
                <div id="divExternalMsg" style="display: none" class="text-center"> </div>
                <div id="divExternalMsgApproval" style="display: none" class="text-center"> </div>
                <div id="divExternalFPNAMsgApproval" style="display: none" class="text-center"> </div>
                <div id="divRejectBody" style="display: none">
                    <div style="width: 600px" class="scrollxyz">
                        <table class="tabledivnew">
                            <tbody>
                                <tr>
                                    <td colspan="2" style="width: 195px;"> <textarea rows="4" class="form-control" cols="45" id="Txt_Comment" onkeyup="hideerrormsg(this)" maxlength="500"></textarea> <br> <sup style="color: #ababab; font-size: 12px;">(Max 500 characters and these special characters are not allowed \ " / : ; | ? ' < > * # ~ % & { } + ,(period))</sup> 
									
									
									</td>
                                </tr>
                                <tr>
                                    <td colspan="2"> <span id="AlertMsg" style="color: red;"></span> </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="clearfix"></div> <label id="rejectdata"></label> </div>
                </div>
                <!----divRejectBody----->
                <div id="divComment" style="display: none">
                    <div style="width: 600px" class="">
                        <table class="tabledivnew">
                            <tbody>
                                <tr>
                                    <td colspan="2" style="width: 195px;"> <textarea rows="4" class="form-control" cols="45" id="TxtAria_Comment"  maxlength="500"></textarea> <br> <sup style="color: #ababab; font-size: 12px;">(Max 500 characters and these special characters are not allowed \ " / : ; | ? ' < > * # ~ % & { } + (period))</sup> 
									<span class="error" id="errjobdescriptionmsg">Special Characters are not allowed (\ " / : ; | ? ' < > * # ~ % & { } + (period))</span></td>
                                </tr>
                                <tr>
                                    <td colspan="2"> <span id="commentAlert" style="color: red;"></span> </td>
                                </tr>
                            </tbody>
                        </table>
						<div class="pull-right">
                            <input class="btn btn-success" type='Button' value="Save" onclick="saveComment()" />

                        </div>
                        <div class="clearfix"></div> <label id="commentdata" class='pull-left'></label> </div>
                </div>
                <!--------divComment--------->
                <div id="divSearchResource" style="display: none">
                    <div style="width: 1090px" class="scrollxyz">
                        <div id="divSkillInfo" style="" class="AddResource">
                            <div class="col-md-2"> <label>Primary Skill</label> </div>
                            <div class="col-md-2"> <select class="form-control mx-sm-3 row" id="ddlPrimarySkill"></select> </div>
                            <div class="col-md-2"> <label>Secondary Skill</label> </div>
                            <div class="col-md-2"> <select class="form-control mx-sm-3 row" id="ddlSecondrySkill"></select> </div>
                            <div class="col-md-1"> <label>Role Band</label> </div>
                            <div class="col-md-2"> <select class="form-control mx-sm-3" id="ddlRoleband"></select> </div>
                            <div class="col-md-1"> <button type="button" class="btn btn-success row" onclick="searchResourceOnSkill();">
                                    <span class="glyphicon glyphicon-search"></span>Search
                                </button> </div>
                            <div class="clearfix"></div>
                        </div>
                        <h3 id="softblockHead" style="display: none">Soft-Block Resource</h3>
                        <div id="SoftBlockResource" class="softblock" style="display: none">
                            <div class="col-md-1" style="width: 100px">Start date</div>
                            <div class="col-md-2">
                                <div class="date"> <input type="text" class="form-control mx-sm-3 strtDt" id="sftblckstartDt" /> </div>
                                <div id="errsftblckstartDt" class="error">Start Date is required</div>
                            </div>
                            <div class="col-md-1">End date</div>
                            <div class="col-md-2">
                                <div class="date"> <input type="text" class="form-control mx-sm-3 endDt" id="sftblckendDt" /> </div>
                                <div id="errsftblckendDt" class="error">End Date is required</div>
                            </div>
                            <div class="col-md-4 action"> <input type="button" class="btn btn-primary" id="btnSoftblock" value="Save Soft-Block" onclick="resourceSoftblock()" /> <a href="#"><span class="glyphicon glyphicon-ok-sign" id="btnSoftblockOK" style="font-size: 21px; display: none; vertical-align: sub"></span></a> <br />
                                <div id="errMsgSvaeSoftBlock" class="error">Please select resource for Soft-Block</div>
                            </div>
                            <div class="clear"></div>
                        </div>
                        <div class="scrollxyz">
                            <table id="tblResources"> </table>
                        </div>
                        <div id="divmsgNoresource" style="display: none">
                            <p> There is no Resources </p>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        <div class="col-sm-12">
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </div>
                <!-------divSearchResource------>
                <div id="divViewLog" style="display: none">
                    <div style="width: 600px" class="">
                        <div id="logdata"> </div>
                        <div class="pull-right"> </div>
                        <div class="clearfix"></div>
                    </div>
                </div>
                <!-------divViewLog-------->
                <div class="clear"></div>
            </div>
        </div>
    </div>
    <div class="Toppopup-bg">
        <div class="Toppopup">
            <div class="Toppopup-head">
                <div class="Toppanel-head">
                    <h4 class="TopclssPopupHead pull-left"></h4>
                    <div class="right-pol">
                        <div class="T-close">x</div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="Toppopup-boday">
                <div id="divMultipleAssignment" style="display: none; width: 820px;">
                    <table id="tblMultipleAssignment"> </table>
                </div>
            </div>
            <div class="clear"></div>
        </div>
    </div>
    <script src="../SiteAssets/RMO/js/RRFConfig.js"></script>
    <script src="../_layouts/15/callout.js"></script>
    <script src="../SiteAssets/RMO/js/jquery.min.js"></script>
    <script src="../SiteAssets/RMO/js/jquery-ui.js"></script>
    <script src="../SiteAssets/RMO/js/bootstrap.min.js"></script>
    <script src="../SiteAssets/RMO/js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="../SiteAssets/RMO/js/SearchResource.js"></script>
    <script src="../SiteAssets/RMO/js/jquery.dataTables.min.js"></script>
    <script src="../SiteAssets/RMO/js/dataTables.bootstrap.min.js"></script>
    <script src="../SiteAssets/Timesheet/js/Config.js"></script>
    <!-- Export to excel js file start -->
    <script src="../SiteAssets/RMO/js/dataTables.buttons.min.js"></script>
    <script src="../SiteAssets/RMO/js/buttons.flash.min.js"></script>
    <script src="../SiteAssets/RMO/js/jszip.min.js"></script>
    <script src="../SiteAssets/RMO/js/pdfmake.min.js"></script>
    <script src="../SiteAssets/RMO/js/vfs_fonts.js"></script>
    <script src="../SiteAssets/RMO/js/buttons.html5.min.js"></script>
    <script src="../SiteAssets/RMO/js/buttons.print.min.js"></script>
    <script>
        var site_url = getPWAURl();
        var table_header = "";
        var table_element = "";
        var url = "";
        var allrecordCount = 0;
        var withdrawnCount = 0;
        var rrfexternalHiring = 0;
        var rrfnonbillable = 0;
        var ResourceTableFlag = "0";
        var CountFlag = 0;
        var TotalCount = 0;
        var BookedCount = 0;
        var FreeCount = 0;
        var RRFFormLength = 5;
        var RRFtblFlag = "0";
        var resourceProjectTableFlag = "0";
        var pageStatus = "";
        var LogProjectGUID = "";
        var LoginUserName = "";
        var txtidIndex = 0;
        var RRFRowID = "";
        //var site_url = "https://ppmdev.bcone.com/";
        var ResourceData = "";
        var ResourceApprovalData = "";
        var resourceListID = "";
        var resourceRRFCount = "";
        var RRF_Number = "";
        var ResourceAllocationFlag = "";
        var chechBoxFlag = "";
        var LoginUserID = "";
        var EmployeeRole = "";
        var Counter = 0;
        var GBU = "";
        var Customer = "";
        var NonBillableStatus = "";
        var PrimarySkill = "";
        var SecondrySkill = "";
        var RolBand = "";
        var ResourceAvailbilityCount = "";
        var projectStrtdate = "";
        var projectEndDate = "";
        var RRFEmployeeRole = "";
        var projectName = "";
        var ProLocation = "";
        var ResourceTable = "";
        var MinRevExp = "";
        var ProjectManagerUserId = "";
        var StatusFlag = "";
        var multipleAssignProject_Array = [];
        var softblockFlag = "";
        var NonBillableApproverID = "";
        var RRF_Table = "";
        var indecator_Parameter = [];
        var Projectdetails = "";
        var rrfresourceextension = 0;
        var TATMappingDays = "";
        var currentDate = "";
        var RMOSPOCUserId = "";
        var rrfStartDate = "";
        var rrfEndDate = "";
        var internallyfulfilledFlag = "";
        var RRFCreatedBy = "";
        var currentuserRole = "";
        var currentuserGUID;
        var ResourcesResult = "";
        var currentuserloginid;
        var RMOSuperUserFlag = "";
        var currentuseremail = "";
        var currentuserEmployeeId = "";
        var NewJoinieResults = "";
        var allSubpractice = "";
        var IsCP = "";
        var fulfilledCount = 0;
        var withdrawnCount = 0;
        var allrecordCount = 0;
        var Count_count = 0;
		var WithdrawnRRFFlag="";
		var HiddenFlag="";
        $(document).ready(function () {
            $('.tooltipAR').tooltip({
                animation: false
            });
            $('.tooltipFR').tooltip({
                animation: false
            });
            $('.tooltipRF').tooltip({
                animation: false
            });
            $('.tooltipBK').tooltip({
                animation: false
            });
            $('.tooltipIN').tooltip({
                animation: false
            });
            $('.tooltipSB').tooltip({
                animation: false
            });
            $('#example').DataTable();
            $('.popup-bg').hide();
            $('#show-popup').on('click', function () {
                $('.popup-bg').show();
            });
            $('.p-close').on('click', function () {
                $('.popup-bg').hide();
            });
            $("#ShowAddResource").click(function () {
                $("<div  class='AddResource'>TEST</div>").insertAfter("#ResourceInfo");
            });
            $("#VScroll").mCustomScrollbar({
                scrollButtons: {
                    enable: true
                },
                mouseWheel: {
                    scrollAmount: 60,
                    normalizeDelta: true
                },
                theme: "dark-thin",
                advanced: {
                    autoExpandHorizontalScroll: true,
                    updateOnContentResize: true
                }
            });
            var selector = '.small-nav li';
            $(selector).on('click', function () {
                $(selector).removeClass('active');
                $(this).addClass('active');
            });
        });
        $(document).ready(function () {
            var urluserprofile = _spPageContextInfo.webAbsoluteUrl + "/_api/SP.UserProfiles.PeopleManager/GetMyProperties";
            currentuserloginid = _spPageContextInfo.userId;
            var resultuserprofile = resultsetProfile(urluserprofile);
            currentuseremail = resultuserprofile.Email;
            currentuserGUID = GetCurrentUserGUID();
            var currentuserRole_empID = GetCurrentUserRole(currentuseremail);
            currentuserRole = currentuserRole_empID.split(';')[0];
            currentuserEmployeeId = currentuserRole_empID.split(';')[1];
            //Get logged in user name
            var CurrentUser = GetCurrentUserData();
            $.getJSON(CurrentUser).done(function (data) {
                LoginUserName = data.Title;
                LoginUserID = data.Id;
                getRolewiseSubpractice(currentuserGUID, currentuseremail);
                getRRFData();
            })
            //$(".horizontalcontent").mCustomScrollbar({
            //    scrollButtons: {
            //        enable: true
            //    },
            //    horizontalScroll: true,
            //    theme: "dark-thick",
            //    autoExpandScrollbar: true,
            //    advanced: { autoExpandHorizontalScroll: true }
            //});
            var groupURL = getuserinRMOSuperUsergroup(currentuserloginid);
            var RMOGroup = getuserinRMOUsergroup(currentuserloginid);
			var practiceHead="../_api/Web/GetUserById('"+currentuserloginid+"')/Groups?$select=Id,Title&$filter=Title eq 'Practice Head'";
            var gropVal = resultset(groupURL);
            var RMOVal = resultset(RMOGroup);
            var practiceHeadval = resultset(practiceHead);
            if (gropVal.length > 0 || RMOVal.length > 0 || practiceHeadval.length > 0) {
                RMOSuperUserFlag = "1";
            }
        });

        function getRRFData() {
            RRFtblFlag = "1";
            $('.loader').show();
            getRoleWiseResources(currentuserRole, currentuserGUID);
            refine_status('allrecord', 'ALL RECORDS', 'FirstTimeLoad');
            setTimeout(function () {
                if (Counter == 0) //Run the code on Page load 
                {
                    var restUrl = "../_api/web/lists/getbytitle('RRF')/items?$select=Status&$Filter=(Status eq 'Fulfilled' or Status eq 'Internally Fulfilled' or Status eq 'Externally Fulfilled' or Status eq 'Withdrawn' or Status eq 'Rejected') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A') and (RRFNO ne null) &$Top=100000&$orderby=ID%20desc";
                    $.ajax({
                        url: restUrl,
                        method: "GET",
                        async: false,
                        headers: {
                            "Accept": "application/json; odata=verbose"
                        },
                        success: function (data) {
                            $.each(data.d.results, function (key, value) {
                                if (value.Status == "Fulfilled" || value.Status == "Internally Fulfilled" || value.Status == "Externally Fulfilled") {
                                    fulfilledCount++;
                                } else if (value.Status == "Withdrawn" || value.Status == "Rejected") {
                                    withdrawnCount++;
                                }
                                Counter = 1;
                            });
                            document.getElementById('rrffulfilledcount').innerHTML = fulfilledCount;
                            document.getElementById('rrfwithdrawncount').innerHTML = withdrawnCount;
                        }
                    });
                }
            }, 1000);
            //setTimeout(function () {
            //    getRoleWiseResources(currentuserRole, currentuserGUID);
            //    refine_status('allrecord', 'ALL RECORDS', 'FirstTimeLoad');
            //    $('.loader').hide();
            //}, 2000);
            $(".stage ul li").on('click', function () {
                $(".stage ul li").removeClass('active');
                $(this).addClass('active');
            });
            //code to popup hide           
            $('.pupup-close').on('click', function () {
                RRFtblFlag = "1";
                $('.popup-bg').hide();
            });
            $('.p-close').on('click', function () {
                $('.popup-bg').hide();
                $('.popup-bg-alert').hide();
            });
            $('.T-close').on('click', function () {
                $('.Toppopup-bg').hide();
            });
            $('.Toppupup-close').on('click', function () {
                RRFtblFlag = "1";
                $('.Toppopup-bg').hide();
            });
            $(".VScroll,.VScroll-2").mCustomScrollbar('update');
            $(".VScroll").mCustomScrollbar({
                scrollButtons: {
                    enable: true
                },
                theme: "dark-thin",
                advanced: {
                    autoExpandHorizontalScroll: true,
                    updateOnContentResize: true
                }
            });
            $(".VScroll,.VScroll-2").mCustomScrollbar({
                scrollButtons: {
                    enable: true
                },
                theme: "dark-thin",
                advanced: {
                    autoExpandHorizontalScroll: true,
                    updateOnContentResize: true
                }
            });
            //$(".dataTables_wrapper").mCustomScrollbar({
            // scrollButtons: {
            //        enable: true
            //    },
            //    horizontalScroll: true,
            //    theme: "dark-thin",
            //   autoExpandScrollbar: true,
            //    advanced: { autoExpandHorizontalScroll: true }
            //});
        }

        function refine_status(status, liname, PageLoad) {
            indecator_Parameter = [];
            // $('.loader').show();
            setTimeout(function () {
                defer_refine_status(status, liname, PageLoad)
                // $('.loader').hide();
            }, 100);
        }

        function defer_refine_status(status, liname, PageLoad) {
            var subpracticeRRF = $("#ddlRolewiseSubPractice option:selected").text(); //document.getElementById('ddlRolewiseSubPractice').value;
            if (subpracticeRRF.indexOf('&') >= 0) {
                subpracticeRRF = subpracticeRRF.replace('&', '%26');
            }
            if (subpracticeRRF.indexOf('&') >= 0) {
                subpracticeRRF = subpracticeRRF.replace('&', '%26');
            }
            var subpracticeURLPara = "";
            if (IsCP != "1") {
                if (subpracticeRRF == "All") {
                    var splitSubpractice = allSubpractice.split(';');
                    $.each(splitSubpractice, function (key, val) {
                        if (subpracticeURLPara == "") {
                            subpracticeURLPara = "substringof('" + val + "',SubPractice)";
                        } else {
                            subpracticeURLPara = subpracticeURLPara + " or " + "substringof('" + val + "',SubPractice)";
                        }
                    })
                } else {
                    subpracticeURLPara = "substringof('" + subpracticeRRF + "',SubPractice)";
                }
            }
            if (IsCP == "1") {
                if (subpracticeRRF != "All") {
                    subpracticeURLPara = "ProjectName eq'" + subpracticeRRF + "'";
                }
            }
			if(subpracticeURLPara.indexOf('&')>0)
			{
				subpracticeURLPara = subpracticeURLPara.replace('&', '%26');
			}
            ResourceTableFlag = "";
            pageStatus = status;
            $("#status").text(liname);
            if ($.fn.dataTable.isDataTable('#RRFTable')) {
                destroyjs('#RRFTable');
            }
            if (status == "allrecord") {
                GetfulfilledWithdrawCount(subpracticeURLPara);
            }
            table_header = "<thead><tr>";
            if (status == "allrecord") { //open demands
                var selector = '.small-nav li';
                $(selector).removeClass('active');
                $('.clssOpen').addClass('active');
                //Table binding for ALL Record
                StatusFlag = "allrecord"; //
                table_header = table_header + "<th style='display: none;'>ID</th>"
                table_header = table_header + "<th style='max-width:7%'>Action</th>"
                table_header = table_header + "<th style='width:10%'>RRF No.</th>"
                table_header = table_header + "<th style='width:20%'>Project Name</th>"
                table_header = table_header + "<th style='width:12%'>Customer Name</th>"
                table_header = table_header + "<th style='width:8%'>Start Date</th>"
                table_header = table_header + "<th style='width:8%'>End Date</th>"
                table_header = table_header + "<th style='width:12%'>Work Location</th>"
                table_header = table_header + "<th style='width:8%'>Role-Band</th>"
                table_header = table_header + "<th style='width:12%'>Primary Skill</th>"
                table_header = table_header + "<th style='width:12%'>Status</th>"
                table_header = table_header + "</tr></thead>";
                //footer menu
                table_header = table_header + "<tfoot><tr>";
                table_header = table_header + "<th style='display: none;'>ID</th>"
                table_header = table_header + "<th>Action</th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + " </tr></tfoot>";
                allrecordCount = 0;
                //url for get All records.
               // if (currentuserRole == "RMO") {
                if (currentuserRole == "RMO" || currentuserRole == "Practice Head") {
                    if (subpracticeURLPara == "" || subpracticeRRF == "All") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=((Status ne 'Fulfilled') and (Status ne 'Withdrawn') and (Status ne 'Rejected') and (Status ne 'Externally Fulfilled')and (Status ne 'Internally Fulfilled') and (Status ne 'Draft' and Status ne 'RRF Saved' and Status ne 'Non Billable') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A'))and (RRFNO ne null)&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=((Status ne 'Fulfilled') and (Status ne 'Withdrawn') and (Status ne 'Rejected') and (Status ne 'Externally Fulfilled') and (Status ne 'Internally Fulfilled')  and (Status ne 'Draft' and Status ne 'RRF Saved' and Status ne 'Non Billable') and (" + subpracticeURLPara + "))and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    }
                } else if (IsCP == "1") { 
                    if (subpracticeURLPara != "") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=((Status ne 'Fulfilled') and (Status ne 'Withdrawn') and (Status ne 'Rejected') and (Status ne 'Externally Fulfilled') and (Status ne 'Internally Fulfilled')  and (Status ne 'Draft' and Status ne 'RRF Saved' and Status ne 'Non Billable') and (ClientPartnerUser eq '" + LoginUserID + "') and (" + subpracticeURLPara + "))and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=Status ne 'Fulfilled' and Status ne 'Withdrawn' and Status ne 'Rejected' and Status ne 'Externally Fulfilled' and Status ne 'Internally Fulfilled'  and (Status ne 'Draft' and Status ne 'RRF Saved' and Status ne 'Non Billable') and (ClientPartnerUser eq '" + LoginUserID + "') and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    }
                } else {
                    if (subpracticeURLPara != "") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=((Status ne 'Fulfilled') and (Status ne 'Withdrawn') and (Status ne 'Rejected') and (Status ne 'Externally Fulfilled') and (Status ne 'Internally Fulfilled')  and (Status ne 'Draft' and Status ne 'RRF Saved' and Status ne 'Non Billable') and (" + subpracticeURLPara + "))and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=Status ne 'Fulfilled' and Status ne 'Withdrawn' and Status ne 'Rejected' and Status ne 'Externally Fulfilled' and Status ne 'Internally Fulfilled'  and (Status ne 'Draft' and Status ne 'RRF Saved' and Status ne 'Non Billable')and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    }
                }
            } 
			else if (status == "fulfilled") {
                //Table binding for Fulfilled
                StatusFlag = "fulfilled";
                table_header = table_header + "<th style='display: none;'>ID</th>"
                table_header = table_header + "<th style='width:'>Action</th>"
                table_header = table_header + "<th style='width:10%'>RRF No.</th>"
                table_header = table_header + "<th style='width:20%'>Project Name</th>"
                table_header = table_header + "<th style='width:9%'>Customer Name</th>"
                table_header = table_header + "<th style='width:8%'>Start Date</th>"
                table_header = table_header + "<th style='width:8%'>End Date</th>"
                table_header = table_header + "<th style='width:8%'>Work Location</th>"
                table_header = table_header + "<th style='width:8%'>Role-Band</th>"
                table_header = table_header + "<th style='width:8%'>Primary Skill</th>"
                table_header = table_header + "<th style=''>Submitted Date</th>"
                table_header = table_header + "</tr></thead>";
                //footer menu
                table_header = table_header + "<tfoot><tr>";
                table_header = table_header + "<th style='display: none;'>ID</th>"
                table_header = table_header + "<th>Action</th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + " </tr></tfoot>";
                //url for get only projects with status is Resource Allocation and Offer.
               // if (currentuserRole == "RMO") {
                if (currentuserRole == "RMO" || currentuserRole == "Practice Head") {
                    if (subpracticeURLPara == "" || subpracticeRRF == "All") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Fulfilled' or Status eq 'Externally Fulfilled' or Status eq 'Internally Fulfilled')and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(((Status eq 'Fulfilled') or (Status eq 'Externally Fulfilled') or (Status eq 'Internally Fulfilled')) and (" + subpracticeURLPara + "))and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    }
                } else if (IsCP == "1") {
                    if (subpracticeURLPara != "") {
                        url = url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(((Status eq 'Fulfilled') or (Status eq 'Externally Fulfilled') or (Status eq 'Internally Fulfilled') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')) and (ClientPartnerUser eq '" + LoginUserID + "') and (" + subpracticeURLPara + "))and RRFNO ne null&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Fulfilled' or Status eq 'Externally Fulfilled' or Status eq 'Internally Fulfilled') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A') and (ClientPartnerUser eq '" + LoginUserID + "')and RRFNO ne null&$Top=100000&$orderby=ID%20desc";
                        //"../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=Status eq 'Fulfilled' and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
                    }
                } else {
                    if (subpracticeURLPara != "") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(((Status eq 'Fulfilled') or (Status eq 'Externally Fulfilled') or (Status eq 'Internally Fulfilled') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')) and (" + subpracticeURLPara + "))and RRFNO ne null&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=((Status eq 'Fulfilled') or (Status eq 'Externally Fulfilled') or (Status eq 'Internally Fulfilled') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A'))and RRFNO ne null&$Top=100000&$orderby=ID%20desc";
                    }
                }
            } else if (status == "withdrawn") {
                //Table binding for Withdrawn
                StatusFlag = "withdrawn";
                table_header = table_header + "<th style='display: none;'>ID</th>"
                table_header = table_header + "<th>Action</th>"
                table_header = table_header + "<th>RRF No.</th>"
                table_header = table_header + "<th>Project Name</th>"
                table_header = table_header + "<th>Customer Name</th>"
                table_header = table_header + "<th>Start Date</th>"
                table_header = table_header + "<th>End Date</th>"
                table_header = table_header + "<th>Work Location</th>"
                table_header = table_header + "<th>Role-Band</th>"
                table_header = table_header + "<th style='width:8%'>Primary Skill</th>"
                table_header = table_header + "<th>Withdrawn/Rejected Date</th>"
                table_header = table_header + "</tr></thead>";
                //footer menu
                table_header = table_header + "<tfoot><tr>";
                table_header = table_header + "<th style='display: none;'>ID</th>"
                table_header = table_header + "<th>Action</th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + "<th></th>"
                table_header = table_header + " </tr></tfoot>";
                withdrawnCount = 0;
                //url for get only projects with status is Withdrawn.
              //  if (currentuserRole == "RMO") {
                if (currentuserRole == "RMO" || currentuserRole == "Practice Head") {
                    if (subpracticeURLPara == "" || subpracticeRRF == "All") { 
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Withdrawn' or Status eq 'Rejected')and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(((Status eq 'Withdrawn') or (Status eq 'Rejected')) and (" + subpracticeURLPara + "))and RRFNO ne null&$Top=100000&$orderby=ID%20desc";
                    }
                } else if (IsCP == "1") {
                    if (subpracticeURLPara != "") {
                        url = url = "../_api/web/lists/getbytitle('RRF')/items?$select=Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(((Status eq 'Withdrawn') or (Status eq 'Rejected')) and (ClientPartnerUser eq '" + LoginUserID + "') and (" + subpracticeURLPara + ")) and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = url = "../_api/web/lists/getbytitle('RRF')/items?$select=Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Withdrawn' or Status eq 'Rejected') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A') and (ClientPartnerUser eq '" + LoginUserID + "')and RRFNO ne null&$Top=100000&$orderby=ID%20desc";
                        //"../_api/web/lists/getbytitle('RRF')/items?$select=Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Withdrawn' or Status eq 'Rejected') and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
                    }
                } else {
                    if (subpracticeURLPara != "") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=((Status eq 'Withdrawn' or Status eq 'Rejected') and (" + subpracticeURLPara + "))and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Withdrawn' or Status eq 'Rejected') and (RRFNO ne null) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    }
                }
            }
            //Call Rest API to Get Data from List
            var listname = "RRF";
            $.ajax({
                url: url,
                method: "GET",
                async: false,
                headers: {
                    "Accept": "application/json; odata=verbose"
                },
                success: function (data) {
                    var RRFLIHTML = "<tbody>";
                    var tdId = "";
                    var rejId = "";
                    var cmntID = "";
                    //if (data.d.results.length < 1) {
                    //    if (status == "allrecord") {
                    //        allrecordCount = data.d.results.length;
                    //    }
                    //    else if (status == "fulfilled") {
                    //        fulfilledCount = data.d.results.length;
                    //    } else if (status == "withdrawn") {
                    //        withdrawnCount = data.d.results.length;
                    //    }
                    //}
                    $.each(data.d.results, function (key, value) {
                        var ProjectName = "";
                        var ProjectGUID = "";
                        var RRFNO = "";
                        var StartDate = "";
                        var EndDate = "";
                        var Location = "";
                        var RoleBand = "";
                        var Billability = "";
                        var RRFStatus = "";
                        var projRRFNo = "";
                        var RRFCreatedDate = "";
                        var PrimarySkillData = "";
                        if (value.ProjectName != null) {
                            ProjectName = value.ProjectName;
                        } else if (value.LinkFilename != null) {
                            ProjectName = value.LinkFilename;
                        }
                        if (value.ProjectGUID != null) {
                            ProjectGUID = value.ProjectGUID;
                        }
                        if (value.RRFNO != null) {
                            RRFNO = value.RRFNO;
                        }
                        if (value.StartDate != null) {
                            StartDate = convert_date_DDMMYYYY(value.NewStartDate);
                        }
                        if (value.EndDate != null) {
                            EndDate = convert_date_DDMMYYYY(value.NewEndDate);
                        }
                        if (value.WorkLocation != null) {
                            Location = value.WorkLocation;
                        }
                        if (value.RoleBand != null) {
                            RoleBand = value.RoleBand;
                        }
                        if (value.Customer != null) {
                            Customer = value.Customer;
                        }
                        if (value.Status != null) {
                            RRFStatus = value.Status;
                        }
                        if (value.SubmittedDate != null) {
                            RRFCreatedDate = convert_date_DDMMYYYY(value.SubmittedDate);
                        }
                        if (value.PrimarySkill != null) {
                            PrimarySkillData = value.PrimarySkill;
                        }
                        //value.SubmittedDate;
                        if (status == "externalhiring") ResourceData = value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand + "#" + value.IndustryExp + "#" + value.MinRelevantExp + "#" + value.RRFNO + "#" + value.Status + "#" + value.SubPractice + "#" + value.ProjectName + "#" + value.WorkLocation + "#" + value.NewProjectStartDate + "#" + value.NewProjectEndDate + "#" + value.NewAuthorId + "#" + value.RMOSPOCUserId + "#" + value.ProjectManagerUserId + "#" + value.FPNAUserId + "#" + value.ReportingToUserId + "#" + value.ClientPartnerUserId + "#" + value.EmployeeRole + "#" + value.RequirementPct + "#" + value.ProjectManagerUser.Title + "#" + value.ClientPartnerUser.Title + "#" + value.RMOSPOCUser.Title + "#" + value.ProjectCode + "#" + value.ResourceAgainstRRFInWD.EMail + "#" + value.ExternalHiring + "#" + value.NewStartDate + "#" + value.NewEndDate + "#" + value.InternallyFulfilled;
                        else if (status == "rrfnonbillable") ResourceData = ""; //value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand + "#" + value.IndustryExp + "#" + value.MinRelevantExp + "#" + value.RRFNO + "#" + value.Status + "#" + value.SubPractice + "#" + value.ProjectName + "#" + value.BaseLocation + "#" + value.StartDate + "#" + value.EndDate + "#" + value.NewAuthorId + "#" + value.RMOSPOCUserId + "#" + value.ProjectManagerUserId + "#" + value.FPNAUserId + "#" + value.ReportingToUserId + "#" + value.ClientPartnerUserId + "#" + value.EmployeeRole + "#" + value.RequirementPct + "#" + value.ProjectManagerUser.Title + "#" + value.ClientPartnerUser.Title + "#" + value.RMOSPOCUser.Title + "#" + value.ProjectCode;
                        else ResourceData = value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand + "#" + value.IndustryExp + "#" + value.MinRelevantExp + "#" + value.RRFNO + "#" + value.Status + "#" + value.SubPractice + "#" + value.ProjectName + "#" + value.WorkLocation + "#" + value.NewProjectStartDate + "#" + value.NewProjectEndDate + "#" + value.NewAuthorId + "#" + value.RMOSPOCUserId + "#" + value.ProjectManagerUserId + "#" + value.FPNAUserId + "#" + value.ReportingToUserId + "#" + value.ClientPartnerUserId + "#" + value.EmployeeRole + "#" + value.RequirementPct + "#" + value.ProjectManagerUser.Title + "#" + value.ClientPartnerUser.Title + "#" + value.RMOSPOCUser.Title + "#" + value.ProjectCode + "#" + value.ResourceAgainstRRFInWD.EMail + "#" + value.ExternalHiring + "#" + value.NewStartDate + "#" + value.NewEndDate + "#" + value.InternallyFulfilled;
                        ResourceApprovalData = value.ID + "#" + value.ProjectGUID + "#" + value.EmployeeRole + "#" + value.Status + "#" + value.NonBillableFlag + "#" + value.GBU + "#" + value.EmployeeRole + "#" + value.ProjectManagerUserId;
                        //document.getElementById('rrfallrecordcount').innerHTML = allrecordCount;
                        //document.getElementById('rrfrmovalidationcount').innerHTML = rmovalidationCount;
                        //document.getElementById('rrfnonbillable').innerHTML = rrfnonbillable;
                        //document.getElementById('rrfresourceproposedcount').innerHTML = resourceproposedCount;
                        //document.getElementById('rrfresourceselectioncount').innerHTML = resourceselectionCount;
                        //document.getElementById('rrffulfilledcount').innerHTML = fulfilledCount;
                        //document.getElementById('rrfwithdrawncount').innerHTML = withdrawnCount;
                        ////document.getElementById('rrfsavedcount').innerHTML = rrfsavedCount;
                        //document.getElementById('rrfexternalhiring').innerHTML = rrfexternalHiring;
                        tdId = "imgbtnApprove" + key;
                        rejId = "imgbtnReject" + key;
                        cmntID = "imgbtnComment" + key;
                        if (value.Status == "RMO Validation" || value.Status == "Resource Proposed") projRRFNo = value.ProjectGUID + "#;" + (value.LinkFilename.split('.')[0]) + "#;" + value.RRFNO + "#;" + value.RequirementPct + "#;" + value.EmployeeRole + "#;" + value.Status;
                        else projRRFNo = value.ProjectGUID + "#;" + (value.LinkFilename.split('.')[0]) + "#;" + value.RRFNO + "#;" + value.Status;
                        var totalResourceId = "Total" + key;
                        var BookedResourceId = "Booked" + key;
                        var FreeResourceId = "Free" + key;
                        //var rrfprojectName = value.LinkFilename;
                        var IndicatorParameter = value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand;
                        indecator_Parameter.push(IndicatorParameter);
                        var clone = "";;
                        if (value.CloneType != null) {
                            clone = "<span class='clone'>Clone</span>";
                        } else {
                            clone = "";
                        }
                        var ExternalInitated = "";
                        if ((value.InternallyFulfilled != null && value.InternallyFulfilled != "") && (value.Status=="Internally Fulfilled")) {
                            ExternalInitated = "<span class='clone'>Internally Fulfilled</span>";
                        } else {
                            ExternalInitated = "";
                        }
                        //var SOWTatDate = dt.format("d-MMM-yy");
                        //var days = new Date(value.SubmittedDate.getDate() - i);
                        var BusinessDaysCount = "";
                        if (value.TATDateTime != "" && value.TATDateTime != null) {
                            if (status != "allrecord" && TATMappingDays.length > 0) {
                                var totalweekdays = "";
                                var newDate = new Date();
                                var submittedDate = new Date(value.TATDateTime);
                                var TodayDate = new Date(newDate);
                                submittedDate.setHours(0, 0, 0, 0);
                                TodayDate.setHours(0, 0, 0, 0);
                                var timeDiff_ = new Date(TodayDate - submittedDate);
                                var diffDays_ = timeDiff_ / 1000 / 60 / 60 / 24;
                                for (var i = submittedDate; i <= TodayDate;) {
                                    if (i.getDay() == 0) {
                                        totalweekdays++;
                                    }
                                    if (i.getDay() == 6) {
                                        totalweekdays++;
                                    }
                                    i.setTime(i.getTime() + 1000 * 60 * 60 * 24);
                                }
                                var Total_Week_days = parseInt(totalweekdays);
                                diffDays_ = diffDays_ - Total_Week_days;
                                if (TATMappingDays.length > 1) {
                                    $.each(TATMappingDays, function (Flagkey, Flag_Value) {
                                        if ((value.ResourceProposedFlag == "1" || value.ResourceProposedFlag == 1) && (Flag_Value.Flag == 1)) {
                                            var T_days = Flag_Value.TATDays;
                                            T_days = parseInt(T_days);
                                            if (diffDays_ > T_days) {
                                                BusinessDaysCount = "<div class='bgred'>" + diffDays_ + " - D</div>";
                                            } else if (diffDays_ > 0) {
                                                BusinessDaysCount = "<div class='bggreen'>" + diffDays_ + " - D</div>";
                                            }
                                        } else {
                                            var T_days = Flag_Value.TATDays;
                                            T_days = parseInt(T_days);
                                            if (diffDays_ > T_days) {
                                                BusinessDaysCount = "<div class='bgred'>" + diffDays_ + " - D</div>";
                                            } else if (diffDays_ > 0) {
                                                BusinessDaysCount = "<div class='bggreen'>" + diffDays_ + " - D</div>";
                                            }
                                        }
                                    });
                                } else {
                                    var T_days = TATMappingDays[0].TATDays;
                                    T_days = parseInt(T_days);
                                    if (diffDays_ > T_days) {
                                        BusinessDaysCount = "<div class='bgred'>" + diffDays_ + " - D</div>";
                                    } else if (diffDays_ > 0) {
                                        BusinessDaysCount = "<div class='bggreen'>" + diffDays_ + " - D</div>";
                                    }
                                }
                            }
                        }
                        if (status == "allrecord") {
                            //RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + " " + BusinessDaysCount + "</td></tr>"
                            if (status == "allrecord") {
                                if ((value.Status == "Draft" || value.Status == "RRF Saved")) {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                }
                                    //Check RMO ID
                                else if ((value.Status == "RMO Validation")) {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                }
                                    //Check RMO ID
                                else if (value.Status == "Resource Proposed") {
                                    var PendingWithTitle = "";
                                    var ExternalLink = "";
                                    if (value.PendingWithId != -1 && value.PendingWithId != null) {
                                        PendingWithTitle = value.PendingWith.Title;
                                        rejecticon = "";
                                        ExternalLink = "";
                                    } else {
                                        PendingWithTitle = value.RMOSPOCUser.Title;
                                        rejecticon = "<div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Withdrawn</div></div>";
                                        //ExternalLink = "<div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='fa fa-external-link-square' aria-hidden='true' onclick='ExternalPopUp(this)'></span><div class='tooltiptext-1' style='width:100px !important'>External Hiring</div></div>";
                                    }
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div>" + ExternalLink + "</div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.Status == "Resource Selection") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                }
                                    //Check RMO ID
                                else if (value.Status == "Resource Allocation") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Withdrawn</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.Status == "Offer" || value.Status == "External Hiring") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.NonBillableFlag == null && value.Status == "Non Billable") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.NonBillableFlag == 1 && value.Status == "FPNA") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.NonBillableFlag == 1 && value.Status == "Recruitment Head") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.NonBillableFlag == 1 && value.Status == "VPHR") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.NonBillableFlag == 1 && value.Status == "Functional Head") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.Status == "Initiated External Hiring") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.Status == "Non Billable") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else if (value.Status == "FPNA" || value.Status == "Recruitment Head" || value.Status == "VPHR" || value.Status == "Functional Head") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                } else {
                                    var PendingWith = "";
                                    if (value.Status == "RRF Saved") PendingWith = value.NewAuthor.Title;
                                    else if (value.Status == "RMO Validation") PendingWith = value.RMOSPOCUser.Title;
                                    else if (value.Status == "Resource Proposed") PendingWith = value.RMOSPOCUser.Title;
                                    else if (value.Status == "Resource Selection") PendingWith = value.RMOSPOCUser.Title;
                                    else if (value.Status == "External Hiring") PendingWith = value.FPNAUser.Title;
                                    else if (value.Status == "Functional Head" || value.Status == "Non Billable") PendingWith = value.NewAuthor.Title;
                                    else if (value.Status == "FPNA" || value.Status == "Recruitment Head" || value.Status == "VPHR") PendingWith = value.PendingWith.Title;
                                    else if (value.Status == "Initiated External Hiring") PendingWith = value.FPNAUser.Title;
                                    else PendingWith = "";
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFStatus + "</td></tr>"
                                }
                            }
                        } else {
                            if (value.Status == "Fulfilled" || value.Status == "Internally Fulfilled" || value.Status == "Externally Fulfilled") {
                                if (value.EmployeeRole != "Billable" && value.EmployeeRole != "Billable Consultant") // changed by Abhishek 13 09 17
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFCreatedDate + "</td></tr>"
                                else RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + RRFCreatedDate + "</td></tr>"
                            } else if (value.Status == "Withdrawn" || value.Status == "Rejected") {
                                var ModifiedDate = "";
                                if (value.Modified != null) {
                                    ModifiedDate = convert_date_DDMMYYYY(value.Modified);
                                }
                                if (value.NewAuthorId == LoginUserID) {
                                    if (value.EmployeeRole != "Billable") {
                                        RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:141px !important'>Withdrawn Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + ModifiedDate + "</td></tr>"
                                    } else {
                                        RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:141px !important'>Withdrawn Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + ModifiedDate + "</td></tr>"
                                    }
                                } else {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:141px !important'>Withdrawn Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + PrimarySkillData + "</td><td>" + ModifiedDate + "</td></tr>"
                                }
                            }
                        }
                    });
                    if (status == "allrecord") {
                        allrecordCount = data.d.results.length;
                    } else if (status == "fulfilled" || status == "Internally Fulfilled") {
                        fulfilledCount = data.d.results.length;
                    } else if (status == "withdrawn") {
                        withdrawnCount = data.d.results.length;
                    }
                    document.getElementById('rrfallrecordcount').innerHTML = allrecordCount;
                    document.getElementById('rrffulfilledcount').innerHTML = fulfilledCount;
                    document.getElementById('rrfwithdrawncount').innerHTML = withdrawnCount;
                    RRFLIHTML += "</tbody>";
                    table_element = table_header + RRFLIHTML;
                    $("#RRFTable").append(table_element);
                },
                error: function (error) {
                    alert(JSON.stringify(error));
                }
            });
            RRF_Table = $('#RRFTable').DataTable({
                "dom": 'Rlfrtip',
                "autoWidth": 'false',
                "paging": 'true',
                "lengthMenu": [
                    [5, 15, 35, -1],
                    [5, 15, 35, "All"]
                ],
                "dom": 'lBfrtip',
                buttons: [{
                    extend: 'excelHtml5',
                    exportOptions: {
                        columns: [2, 3, 4, 5, 6, 7, 8, 9, 10]
                    }
                }, ],
            });
            $('#RRFTable tfoot th').each(function () {
                var title = $(this).text();
                if (title != 'Action' && title != 'Indicators') {
                    $(this).html('<input type="text" placeholder="Search ' + title + '" />');
                } else {
                    $(this).html('');
                }
            });
            // DataTable
            var table = $('#RRFTable').DataTable();
            // Apply the search
            table.columns().every(function () {
                var that = this;
                $('input', this.footer()).on('keyup change', function () {
                    if (that.search() !== this.value) {
                        that.search(this.value).draw();
                    }
                });
            });
            $('.loader').hide();
        }
        //code to show Request Comment popup
        function showCommentpopup(cmntId) {
		$('#errjobdescriptionmsg').css('display', 'none');
            //var rowCmntID = cmntId.id;
            RRFRowID = cmntId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[0];
            var RowProjectID = cmntId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[1];
            LogProjectGUID = RowProjectID;
            $('.clssPopupHead').text('Please Enter Comment');
            $('.popup h4').css('text-align', 'left');
            // $('.left-pol').css('float', 'left');
            $('.allbtn').css('text-align', 'left');
            document.getElementById('divApproveBody').style.display = "none";
            document.getElementById('divExternalMsgApproval').style.display = "none";
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divSearchResource').style.display = "none";
            document.getElementById('divViewLog').style.display = "none";
            document.getElementById('divComment').style.display = "block";
            document.getElementById('TxtAria_Comment').value = "";
            $('#TxtAria_Comment').css({
                "border": "",
                "background": ""
            });
            document.getElementById("commentAlert").innerHTML = "";
            var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=Comment,NewCreatedDate,Name,Flag&$filter=ProjectGUID eq '" + RowProjectID + "'and Flag eq '2' and RRFListItemId eq '" + RRFRowID + "'&$orderby=Created desc";
            getRMOTransactionDetails(url, RowProjectID, 'Commentlog');
            $('.popup-bg').show();
        }
        //code to show search resources popup
        function showResourcepopup(ResourceData) {
            $('.loader').show();
            setTimeout(function () {
                getResourceDataPopUp(ResourceData);
                $('.loader').hide();
            }, 100);
        }

        function getResourceDataPopUp(ResourceData) {
		 
            var resourceRRF = ResourceData.id.split('#');
            multipleAssignProject_Array = [];
            RRFtblFlag = "0";
            ResourceTableFlag = "1";
            softblockFlag = "";
            if ($.fn.dataTable.isDataTable('#tblResources')) {
                destroyjs('#tblResources');
            }
            var requestID = resourceRRF[0]; //ROW ID
            RRFRowID = resourceRRF[0];
            var rrfprojectID = resourceRRF[1]; //ProjectGUID
            LogProjectGUID = resourceRRF[1]; //ProjectGUID
            PrimarySkill = resourceRRF[2]; // PrimarySkill
            SecondrySkill = resourceRRF[3]; //SecondarySkill
            RolBand = resourceRRF[4]; //RoleBand
            var IndustryExp = resourceRRF[5]; //IndustryExp
            MinRevExp = resourceRRF[6]; //MinimunExp
            var RRFNumber = resourceRRF[7]; //RRFNumber
            pageStatus = resourceRRF[8]; //RRF Status
            var sub_pracitc = resourceRRF[9]; //Sub Practic 
            projectName = resourceRRF[10]; //project name
            ProLocation = resourceRRF[11];
            projectStrtdate = resourceRRF[12];
            projectEnddate = resourceRRF[13]; //2017-08-29T19:00:00
            var AuthorId = resourceRRF[14]; // Creater or Initiator
            RMOSPOCUserId = resourceRRF[15]; // RMO
            ProjectManagerUserId = resourceRRF[16]; // Project Manager
            var FPNAUserId = resourceRRF[17]; // FPNA
            var ReportingToUserId = resourceRRF[18]; // Reporting Manager
            var ClientPartnerUserId = resourceRRF[19]; // Client partner
            var EmployeeRole = resourceRRF[20]; // Role
            var RRFAllocationPercent = resourceRRF[21]; //RRF Percentage
            var ProjectManagerName = resourceRRF[22]; // Project Manager Name
            var ClientPartnerName = resourceRRF[23]; // Client Partner Name
            var RMOSPOCName = resourceRRF[24]; // RMO SPOC Name
            var ProjectCode = resourceRRF[25]; // Project Code
            rrfStartDate = resourceRRF[28]; // RRF Start Date
            rrfEndDate = resourceRRF[29]; //RRF End Date
            internallyfulfilledFlag = resourceRRF[30];
            var ResourceAgainstRRFInWDId = "";
            var ExternalEmplooyeeId = "";
            var ExternalEmplooyeeName = "";
            var externalhiringflag = "";
            if (resourceRRF[26] != "" && resourceRRF[26] !== undefined && resourceRRF[26] != "undefined" && undefined != null && (pageStatus == "External Hiring" || pageStatus == "Offer")) {
                ResourceAgainstRRFInWDId = getResourceEmpIdEmpName(resourceRRF[26]) // Assigned Resource Emailid
                ExternalEmplooyeeId = ResourceAgainstRRFInWDId.split('#')[0];
                ExternalEmplooyeeName = ResourceAgainstRRFInWDId.split('#')[1];
            }
            if (pageStatus == "External Hiring" || pageStatus == "Offer") externalhiringflag = resourceRRF[27];
            RRF_Number = RRFNumber;
            $('.clssPopupHead').html(RRFNumber + ' : Search Resources ' + '| Primary Skill : ' + PrimarySkill + ' | Secondary Skill : ' + SecondrySkill + ' | View Selected Resources ').append(" <span  id='show-popup' class='action-c pull-right'><i class='fa fa-users' aria-hidden='true'></i><div class='action-c-view scrollxyz '> <ul id='slectedResource'></ul> </div></span>");
            $('.popup h4').css({
                'text-align': 'left',
                'width': '100%'
            });
            $('.allbtn').css('text-align', 'left');
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divComment').style.display = "none";
            document.getElementById('divApproveBody').style.display = "none";
            document.getElementById('divExternalMsgApproval').style.display = "none";
            document.getElementById('divViewLog').style.display = "none";
            document.getElementById('divSearchResource').style.display = "block";
            $('.error').css('display', 'none');
            $('.strtDt').val('');
            $('.endDt').val('');
            $('.loader').show();
            url = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
            $.ajax({
                url: url,
                method: "GET",
                async: false,
                headers: {
                    "Accept": "application/json; odata=verbose"
                },
                success: function (data) {
                    if (data.d.results.length > 0) {
                        ResourceAllocationFlag = data.d.results[0].Flag;
                    } else {
                        ResourceAllocationFlag = "";
                    }
                }
            });
            var SeletedEmployeeIDcheck = "";
            var dataurl = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
            $.ajax({
                url: dataurl,
                async: false,
                type: "GET",
                headers: {
                    "Accept": "application/json;odata=verbose"
                },
                success: function (data) {
                    resourceRRFCount = data.d.results.length;
                    if (resourceRRFCount > 0) {
                        var dataset = data.d.results[0];
                        resourceListID = dataset.ID;
                        if (pageStatus == "RRF Saved") {
                            SeletedEmployeeIDcheck = dataset.suggestedResource.split(';');
                        } else if (pageStatus == "RMO Validation") {
                            SeletedEmployeeIDcheck = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : "";
                        } else if (pageStatus == "Resource Proposed") {
                            SeletedEmployeeIDcheck = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : ""; // Changes done on 30-8-2017 
                        } else if (pageStatus == "Resource Selection") {
                            SeletedEmployeeIDcheck = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";
                        } else if (pageStatus == "Fulfilled" || pageStatus == "Internally Fulfilled") {
                            SeletedEmployeeIDcheck = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";
                        }
                    }
                }
            });
            document.getElementById('btnSoftblockOK').style.display = 'none';
            if (rrfprojectID != "" && rrfprojectID != undefined && rrfprojectID != "null") {
                document.getElementById('divmsgNoresource').style.display = 'none';
                var resourceTbl_header = "";
                var resourcetable_element = "";
                resourceTbl_header = "<thead><tr>";
                var ResourceLIHTML = "<tbody>";
                //table binding for resources data
                resourceTbl_header = resourceTbl_header + "<th>Item</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employee ID</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employee Name</th>"
                resourceTbl_header = resourceTbl_header + "<th >Project Name</th>"
                resourceTbl_header = resourceTbl_header + "<th>Project Manager</th>"
                resourceTbl_header = resourceTbl_header + "<th>Sub-Practice</th>"
                resourceTbl_header = resourceTbl_header + "<th >Start Date</th>"
                resourceTbl_header = resourceTbl_header + "<th >End Date</th>"
                resourceTbl_header = resourceTbl_header + "<th>Allocation %</th>"
                resourceTbl_header = resourceTbl_header + "<th>Employee Status</th>"
                resourceTbl_header = resourceTbl_header + "<th >Base Location</th>"
                resourceTbl_header = resourceTbl_header + "<th >Action</th>"
                resourceTbl_header = resourceTbl_header + "</tr></thead>";
                //footer menu
				<!-- resourceTbl_header = resourceTbl_header + "<tfoot><tr>";  -->
				<!-- resourceTbl_header = resourceTbl_header + "<th>Item</th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th></th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + "<th>Action</th>"   -->
				<!-- resourceTbl_header = resourceTbl_header + " </tr></tfoot>";  -->
                //Call Rest API to Get Data from project Server
                var bool = "";
                url = EmployeeSkill(PrimarySkill); //site_url + "_api/EmployeeSkills?$filter=Skill_Type eq 'Primary' and Skill_Detail eq'" + PrimarySkill + "'";
                var tdId = "";
                var rejId = "";
                var cmntID = "";
                if (resourceRRF[26] != "" && resourceRRF[26] !== undefined && resourceRRF[26] != "undefined" && undefined != null && ((pageStatus == "External Hiring" || pageStatus == "Offer") || externalhiringflag == "1")) {
                    document.getElementById('softblockHead').style.display = 'none';
                    $('#errMsgSvaeSoftBlock').css('display', 'none');
                    var Resource_Dataset = searchResourceWithNewService(ExternalEmplooyeeId);
                    $.each(Resource_Dataset, function (index, value) {
                        var EmpID = "";
                        var EmpName = "";
                        var Designation = "";
                        var projectcode = "";
                        var ProjectName = "";
                        var ProjectstartDate = "";
                        var ProjectEnddate = "";
                        var allocationPercent = ""
                        var Location = "";
                        var status = "";
                        var SubPractice = "";
                        if (value.EmployeeID != null) {
                            EmpID = value.EmployeeID;
                        }
                        // if (value.ResourceFullName != null) {
                        EmpName = ExternalEmplooyeeName;
                        //}
                        if (value.Designation != null) {
                            Designation = value.Designation;
                        }
                        //if (value.ProjectName != null) {
                        //    ProjectName = value.ProjectName;
                        //}
                        //if (value.Startdatetime != null) {
                        ProjectstartDate = convert_date_DDMMYYYY(projectStrtdate);
                        //}
                        //if (value.Finishdatetime != null) {
                        ProjectEnddate = convert_date_DDMMYYYY(projectEnddate);
                        //}
                        //if (value.Allocation != null) {
                        //    allocationPercent = value.Allocation;
                        //}
                        //if (value.Work_Location != null) {
                        //    Location = value.Work_Location;
                        //}
                        if (value.Employee_status != null) {
                            status = value.Employee_status;
                        }
                        if (value.SubPractice != null) {
                            SubPractice = value.SubPractice;
                        }
                        var ProjectNameHTML = projectName;
                        EmpID = ExternalEmplooyeeId;
                        cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
                        var externalDetails = rrfprojectID + "#;" + EmpID + "#;" + EmpName + "#;" + Designation + "#;" + projectName + "#;" + SubPractice + "#;" + projectStrtdate + "#;" + projectEnddate + "#;" + RRFAllocationPercent + "#;" + status + "#;" + ProLocation + "#;" + RRFNumber + "#;" + EmployeeRole + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName + "#;" + SubPractice;
                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td><input type='checkbox' name='checkResource' value='" + EmpID + "' /></td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + ProjectNameHTML + "</td><td>" + ProjectManagerName + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + RRFAllocationPercent + "</td><td>" + status + "</td><td>" + ProLocation + "</td><td><span id='" + externalDetails + "' class='glyphicon glyphicon-ok-sign icon-weight' aria-hidden='true' title='Approve' onclick='ResourceExternalApproval(this)'></span><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                    });
                } else if ((pageStatus == "Resource Selection" || ResourceAllocationFlag == "1" || ResourceAllocationFlag == "2") && pageStatus != "Fulfilled" && pageStatus != "Internally Fulfilled") {
                    document.getElementById('SoftBlockResource').style.display = 'none';
                    document.getElementById('softblockHead').style.display = 'none';
                    $('#errMsgSvaeSoftBlock').css('display', 'none');
                    url = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
                    //document.getElementById('btnResorceSave').style.display = 'none';
                    $.ajax({
                        url: url,
                        method: "GET",
                        async: false,
                        headers: {
                            "Accept": "application/json; odata=verbose"
                        },
                        success: function (data) {
                            $('.loader').show();
                            //var ResourceLIHTML = "<tbody>";
                            tdId = "";
                            rejId = "";
                            cmntID = "";
                            $.each(data.d.results, function (key, value) {
                                var EmpID = "";
                                if ((pageStatus == "Resource Proposed" && ResourceAllocationFlag == "1") || pageStatus == "Resource Selection" || pageStatus == "Fulfilled" || pageStatus == "Internally Fulfilled") {
                                    var EmpID_array = "";
                                    if (pageStatus == "Resource Proposed") {
                                        EmpID_array = value.ShortlistedResource;
                                    } else {
                                        EmpID_array = value.AllocatedResource;
                                    }
                                    if (EmpID_array != "" && EmpID_array != null) {
                                        if (EmpID_array.indexOf(';') > 0) {
                                            EmpID_array = EmpID_array.split(';');
                                        } else {
                                            var empIDSingle = EmpID_array;
                                            var EmpID_array = [];
                                            EmpID_array.push(empIDSingle);
                                        }
                                        $.each(EmpID_array, function (index, eployeeid) {
                                            EmpID = eployeeid;
                                            var Resource_Dataset = searchResourceWithNewService(EmpID, PrimarySkill, SecondrySkill, RolBand, rrfStartDate, RRFAllocationPercent, rrfEndDate);
                                            $.each(Resource_Dataset, function (index, value) {
                                                bool = index + 1;
                                                var EmpID = "";
                                                var EmpName = "";
                                                var Designation = "";
                                                var projectcode = "";
                                                var ProjectName = "";
                                                var ProjectstartDate = "";
                                                var ProjectEnddate = "";
                                                var allocationPercent = ""
                                                var Location = "";
                                                var status = "";
                                                var Employee_Email = "";
                                                var Project_Manager = "";
                                                var SubPractice = "";
                                                if (value.EmployeeID != null) {
                                                    EmpID = value.EmployeeID;
                                                }
                                                if (value.ResourceFullName != null) {
                                                    EmpName = value.ResourceFullName;
                                                }
                                                if (value.Designation != null) {
                                                    Designation = value.Designation;
                                                }
                                                if (value.ProjectName != null) {
                                                    ProjectName = value.ProjectName;
                                                }
                                                if (value.Startdatetime != null) {
                                                    ProjectstartDate = value.Startdatetime;
                                                }
                                                if (value.Finishdatetime != null) {
                                                    ProjectEnddate = value.Finishdatetime;
                                                }
                                                if (value.Allocation != null) {
                                                    allocationPercent = value.Allocation;
                                                }
                                                if (value.Work_Location != null) {
                                                    Location = value.Work_Location;
                                                }
                                                if (value.Employee_status != null) {
                                                    status = value.Employee_status;
                                                }
                                                if (value.Work_Email != null) {
                                                    Employee_Email = value.Work_Email;
                                                }
                                                if (value.SubPractice != null) {
                                                    SubPractice = value.SubPractice;
                                                }
                                                //if (value.Project_Manager != null) {
                                                //    Project_Manager = value.Project_Manager;
                                                //}
                                                $.each(SeletedEmployeeIDcheck, function (key, checkvalue) {
                                                    if (checkvalue == EmpID) {
                                                        bool = 0;
                                                    }
                                                })
                                                var ProjectNameHTML = "";
                                                if (ProjectName == "Multiple Assignment") {
                                                    Project_Manager = "NA";
                                                    ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                                                } else {
                                                    ProjectNameHTML = ProjectName;
                                                    if (value.ProjectCode != null) {
                                                        Project_Manager = findProjectwiseProjectManager(value.ProjectCode);
                                                    }
                                                }
                                                EmpID = eployeeid;
                                                tdId = "resourcebtnApprove" + key;
                                                rejId = "resourcebtnReject" + "#;" + EmpID + "#;" + EmpName + "#;" + ProjectCode + "#;" + projectName + "#;" + ProLocation + "#;" + PrimarySkill + "#;" + RRFNumber + "#;" + EmployeeRole;
                                                cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
                                                var assigmntDetails = EmpID + "#;" + rrfprojectID + "#;" + RRFNumber + "#;" + EmployeeRole + "#;" + projectStrtdate + "#;" + projectEnddate + "#;" + RRFAllocationPercent + "#;" + Designation + "#;" + EmpName + "#;" + status + "#;" + Employee_Email + "#;" + ProLocation + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName + "#;" + projectName + "#;" + PrimarySkill + "#;" + SubPractice;
                                                if (pageStatus == "Resource Proposed" && (LoginUserID == RMOSPOCUserId || LoginUserID == ProjectManagerUserId)) {
                                                    if (ResourceAllocationFlag == "1" && LoginUserID == ProjectManagerUserId) {
                                                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + EmpID + "#" + rrfprojectID + "' class='glyphicon glyphicon-ok-sign icon-weight' aria-hidden='true' title='Approve' onclick='ResourceApproval(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span> <span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                    } else {
                                                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' /></td>" + bool + "<td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                    }
                                                } else if (pageStatus == "Resource Selection" && LoginUserID == RMOSPOCUserId) {
                                                    ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td></td><td id=" + EmpID + "#;" + rrfprojectID + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + assigmntDetails + "' class='glyphicon glyphicon-lock icon-weight' aria-hidden='true' title='Resource Allocation' onclick='ResourceAssignment(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span> <span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                } else {
                                                    ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td></td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                }
                                            });
                                        })
                                    }
                                }
                            });
                        }
                    });
                } else if (pageStatus == "Fulfilled" || pageStatus == "Internally Fulfilled") {
                    document.getElementById('softblockHead').style.display = 'none';
                    document.getElementById('SoftBlockResource').style.display = 'none';
                    $('#errMsgSvaeSoftBlock').css('display', 'none');
                    $('.clssPopupHead').text(RRFNumber + ' : Allocated Resource');
                    url = "../_api/web/lists/getbytitle('RMOResourceAssignment')/items?$select=ResourceID,ResourceName,Designation,ProjectName,NewStartDate,NewEndDate,AllocationPercent,ProjectLoaction,Employee_status,SubPractice&$filter=RRFNumber eq'" + RRFNumber + "'";
                    $.ajax({
                        url: url,
                        method: "GET",
                        async: false,
                        headers: {
                            "Accept": "application/json; odata=verbose"
                        },
                        success: function (data) {
                            $.each(data.d.results, function (index, value) {
                                // var value = data.d.results;
                                var EmpID = "";
                                var EmpName = "";
                                var Designation = "";
                                var projectcode = "";
                                var ProjectName = "";
                                var ProjectstartDate = "";
                                var ProjectEnddate = "";
                                var allocationPercent = ""
                                var Location = "";
                                var status = "";
                                var Employee_Email = "";
                                var Project_Manager = "";
                                var SubPractice = "";
                                if (value.ResourceID != null) {
                                    EmpID = value.ResourceID;
                                }
                                if (value.ResourceName != null) {
                                    EmpName = value.ResourceName;
                                }
                                if (value.Designation != null) {
                                    Designation = value.Designation;
                                }
                                if (value.ProjectName != null) {
                                    ProjectName = value.ProjectName;
                                }
                                if (value.NewStartDate != null) {
                                    ProjectstartDate = value.NewStartDate;
                                    ProjectstartDate = convert_date_DDMMYYYY(ProjectstartDate);
                                }
                                if (value.NewEndDate != null) {
                                    ProjectEnddate = value.NewEndDate;
                                    ProjectEnddate = convert_date_DDMMYYYY(ProjectEnddate);
                                }
                                if (value.AllocationPercent != null) {
                                    allocationPercent = value.AllocationPercent;
                                }
                                if (value.ProjectLoaction != null) {
                                    Location = value.ProjectLoaction;
                                }
                                if (value.Employee_status != null) {
                                    status = value.Employee_status;
                                }
                                if (value.Work_Email != null) {
                                    Employee_Email = value.Work_Email;
                                }
                                if (value.SubPractice != null) {
                                    SubPractice = value.SubPractice;
                                }
                                //if (value.Project_Manager != null) {
                                //    Project_Manager = value.Project_Manager;
                                //}
                                var ProjectNameHTML = "";
                                if (ProjectName == "Multiple Assignment") ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                                else ProjectNameHTML = ProjectName;
                                tdId = "resourcebtnApprove";
                                rejId = "resourcebtnReject" + "#;" + EmpID + "#;" + EmpName + "#;" + ProjectCode + "#;" + projectName + "#;" + ProLocation + "#;" + PrimarySkill + "#;" + RRFNumber;
                                cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
                                var assigmntDetails = EmpID + "#;" + projectcode + "#;" + RRFNumber + "#;" + ProjectstartDate + "#;" + ProjectEnddate + "#;" + RRFAllocationPercent + "#;" + Designation + "#;" + EmpName + "#;" + status + "#;" + Employee_Email + "#;" + ProLocation + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName + "#;" + projectName + "#;" + PrimarySkill + "#;" + SubPractice;
                                ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + ProjectManagerName + ">" + ProjectNameHTML + "</td><td>" + ProjectManagerName + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                            });
                        }
                    });
                } else {
                    //document.getElementById('btnResorceSave').style.display = 'block';
                    document.getElementById('SoftBlockResource').style.display = 'none';
                    document.getElementById('softblockHead').style.display = 'none';
                    EmployeeIDPara = "NA";
                    chechBoxFlag = "1";
                    var Resource_Dataset = searchResourceWithNewService(EmployeeIDPara, PrimarySkill, SecondrySkill, RolBand, rrfStartDate, RRFAllocationPercent, rrfEndDate);
                    if (Resource_Dataset.length == 0) { }
                    $.each(Resource_Dataset, function (index, value) {
                        bool = index + 1;
                        var EmpID = "";
                        var EmpName = "";
                        var Designation = "";
                        var projectcode = "";
                        var ProjectName = "";
                        var ProjectstartDate = "";
                        var ProjectEnddate = "";
                        var allocationPercent = ""
                        var Location = "";
                        var status = "";
                        var Employee_Email = "";
                        var Project_Manager = "";
                        var SubPractice = "";
                        if (value.EmployeeID != null) {
                            EmpID = value.EmployeeID;
                        }
                        if (value.ResourceFullName != null) {
                            EmpName = value.ResourceFullName;
                        }
                        if (value.Designation != null) {
                            Designation = value.Designation;
                        }
                        if (value.ProjectName != null) {
                            ProjectName = value.ProjectName;
                        }
                        if (value.Startdatetime != null) {
                            ProjectstartDate = value.Startdatetime;
                        }
                        if (value.Finishdatetime != null) {
                            ProjectEnddate = value.Finishdatetime;
                        }
                        if (value.Allocation != null) {
                            allocationPercent = value.Allocation;
                        }
                        if (value.Work_Location != null) {
                            Location = value.Work_Location;
                        }
                        if (value.Employee_status != null) {
                            status = value.Employee_status;
                        }
                        if (value.Work_Email != null) {
                            Employee_Email = value.Work_Email;
                        }
                        if (value.SubPractice != null) {
                            SubPractice = value.SubPractice;
                        }
                        //if (value.Project_Manager != null) {
                        //    Project_Manager = value.Project_Manager;
                        //}
                        $.each(SeletedEmployeeIDcheck, function (key, checkvalue) {
                            if (checkvalue == EmpID) {
                                bool = 0;
                            }
                        })
                        var ProjectNameHTML = "";
                        if (ProjectName == "Multiple Assignment") {
                            Project_Manager = "NA"
                            ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                        } else {
                            if (value.ProjectCode != null) {
                                Project_Manager = findProjectwiseProjectManager(value.ProjectCode);
                            }
                            ProjectNameHTML = ProjectName;
                        }
                        tdId = "resourcebtnApprove" + index;
                        rejId = "resourcebtnReject" + "#;" + EmpID + "#;" + EmpName + "#;" + ProjectCode + "#;" + projectName + "#;" + ProLocation + "#;" + PrimarySkill + "#;" + RRFNumber + "#;" + EmployeeRole;
                        cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
                        var assigmntDetails = EmpID + "#;" + rrfprojectID + "#;" + RRFNumber + "#;" + EmployeeRole + "#;" + projectStrtdate + "#;" + projectEnddate + "#;" + RRFAllocationPercent + "#;" + Designation + "#;" + EmpName + "#;" + status + "#;" + Employee_Email + "#;" + ProLocation + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName + "#;" + projectName + "#;" + PrimarySkill + "#;" + SubPractice;
                        Projectdetails = ProjectCode + "#;" + projectName + "#;" + RRFAllocationPercent + "#;" + ProLocation + "#;" + RMOSPOCName + "#;" + ProjectManagerName + "#;" + PrimarySkill + "#;" + RRFNumber;
                        if (pageStatus == "RRF Saved" && LoginUserID == AuthorId) {
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                            document.getElementById('softblockHead').style.display = 'none';
                            document.getElementById('SoftBlockResource').style.display = 'none';
                            $('#errMsgSvaeSoftBlock').css('display', 'none');
                        } else if ((pageStatus == "RMO Validation" || pageStatus == "External Hiring" || pageStatus == "Offer") && LoginUserID == RMOSPOCUserId) {
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span></td></tr>"
                            document.getElementById('softblockHead').style.display = 'none';
                            document.getElementById('SoftBlockResource').style.display = 'none';
                            $('#errMsgSvaeSoftBlock').css('display', 'none');
                        } else if (pageStatus == "Resource Proposed" && LoginUserID == RMOSPOCUserId && (ResourceAllocationFlag == null || ResourceAllocationFlag == "" || ResourceAllocationFlag == undefined)) {
                            document.getElementById('softblockHead').style.display = 'block';
                            document.getElementById('SoftBlockResource').style.display = 'block';
                            $('#errMsgSvaeSoftBlock').css('display', 'none');
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span></td></tr>"
                        } else {
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + SubPractice + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                            document.getElementById('softblockHead').style.display = 'none';
                            document.getElementById('SoftBlockResource').style.display = 'none';
                            $('#errMsgSvaeSoftBlock').css('display', 'none');
                        }
                    });
                }
                ResourceLIHTML += "</tbody>";
                resourcetable_element = resourceTbl_header + ResourceLIHTML;
                $("#tblResources").append(resourcetable_element);
                ResourceTable = $('#tblResources').DataTable({
					scrollY: "250px",
					scrollX: true,
					paging: true,
                    "dom": 'Rlfrtip',
                    "iDisplayLength": 5,
                    "lengthMenu": [
                        [5, 15, 35, -1],
                        [5, 15, 35, "All"]
                    ],
                    "pagingType": "simple_numbers",
                    "dom": 'lBfrtip',
                    buttons: [{
                        extend: 'excelHtml5',
                        exportOptions: {
                            columns: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
							format: {
							body: function ( data, row, column, node ) {
							   if (column === 1) {
									//need to change double quotes to single
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									splitData =t.split('<')[0];
									
									/*data = '';
									for (i=0; i < splitData.length; i++) {
										//add escaped double quotes around each line
										data += '\"' + splitData[i] + '\"';
										//if its not the last line add CHAR(13)
										if (i + 1 < splitData.length) {
											data += ', CHAR(13), ';
										}
									}
									//Add concat function
									data = 'CONCATENATE(' + data + ')';*/
									return splitData;
								}
								if(column===2)
								{
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								
								return data;
								}
							}
                        }
                    }, ],
                });
                
                 if (ResourceTable.data().any()) { 
                     bindcheckedResources(RRFNumber); 
                 } 
            } 
			<!-- else { -->
                <!-- document.getElementById('divmsgNoresource').style.display = 'block'; -->
            <!-- } -->
            $('.popup-bg').show();
			$('.form-control').trigger('change');
            $('.loader').hide();
        }
        //code to show view log popup
        function showViewlogPopup(tdId) {
            RRFRowID = tdId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[0];
            var RowProjectID = tdId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[1];
            var RRFNumber = tdId.id.split('#;')[2];
            $('.clssPopupHead').text('View Log');
            $('.popup h4').css('text-align', 'left');
            $('.allbtn').css('text-align', 'left');
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divComment').style.display = "none";
            document.getElementById('divSearchResource').style.display = "none";
            document.getElementById('divApproveBody').style.display = "none";
            document.getElementById('divExternalMsgApproval').style.display = "none";
            document.getElementById('divViewLog').style.display = "block";
            $(".removedata").remove();
            var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=LogType,NewCreatedDate,Name,Flag,Author/Title&$expand=Author&$filter=(RRFListItemId eq '" + RRFRowID + "') and (Flag eq '1' or Flag eq '3')&$orderby=Created desc";
            getRMOTransactionDetails(url, RowProjectID, "Log");
            $('.popup-bg').show();
			$('.form-control').trigger('change');
        }

        function getWithdrawnComment(rejId) {
            $("#withdrawnrejectdata").empty();
            $('.popup-bg-alert').show();
            $('#withdrawnrejectdata').show();
            $('.alertmessage').text('  ');
            $('.alertmessage').show('');
            RRFRowID = rejId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[0];
            var RowProjectID = rejId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[1];
            LogProjectGUID = RowProjectID;
            var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=Comment,NewCreatedDate,Name,Flag&$filter=ProjectGUID eq '" + RowProjectID + "'and Flag eq '3' and RRFListItemId eq '" + RRFRowID + "'&$orderby=Created desc";
            getRMOTransactionDetails(url, RowProjectID, 'RejCommentlog');
        }

        function getRMOTransactionDetails(url, RowProjectID, Type) {
            $("#commentdata").empty();
            $("#rejectdata").empty();
            $("#resourceCommetdata").empty();
            $('#TextareaResourceComment').html('');
            $.ajax({
                url: url,
                method: "GET",
                async: false,
                headers: {
                    "Accept": "application/json; odata=verbose"
                },
                success: function (data) {
                    $.each(data.d.results, function (index, value) {
                        var Date = convert_date_DDMMYYYY(value.NewCreatedDate);
                        var Time = value.NewCreatedDate.split('T')[1];
                        var FinalTime = Time.split('Z')[0];
                        if (Type == "Log" || value.LogType == "External Hiring") {
                            if (value.Flag == "1" || value.Flag == "5" || value.Flag == "3") {
                                var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label><b><u>' + value.LogType + '</u></b></label></div>';
                                logDeatils += '<div class="com-user-text"><i>' + value.Author.Title + ' | ' + Date + ' - ' + FinalTime + '</i></div><hr/></div>';
                                $("#logdata").append(logDeatils);
                            }
                        } else if (Type == "Commentlog") {
                            if (value.Flag == "2") {
                                var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label class="pull-left"><b><u>' + value.Name + ' | ' + Date + ' - ' + FinalTime + '</u></b></label></div><br/>';
                                logDeatils += '<div class="clearfix"></div><div class="com-user-text"><i>' + value.Comment + '</i></div><hr/></div>';
                                $("#commentdata").append(logDeatils);
                            }
                        } else if (Type == "RejCommentlog") {
                            if (value.Flag == "3") {
                                var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label class="pull-left"><b><u>' + value.Name + ' | ' + Date + ' - ' + FinalTime + '</u></b></label></div><br/>';
                                logDeatils += '<div class="clearfix"></div><div class="com-user-text"><i>' + value.Comment + '</i></div><hr/></div>';
                                $("#rejectdata").append(logDeatils);
                                $("#withdrawnrejectdata").append(logDeatils);
                            }
                        } else if (Type == "ResourceComment") {
                            var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label class="pull-left"><b><u>' + value.Name + ' | ' + Date + ' - ' + FinalTime + '</u></b></label></div><br/>';
                            logDeatils += '<div class="clearfix"></div><div class="com-user-text"><i>' + value.Comment + '</i></div><hr/></div>';
                            $('#resourceCommetdata').append(logDeatils);
                        }
                    });
                }
            });
        }

        function bindcheckedResources(RRFNumber) {
            $("#slectedResource").empty();
            //code to display Saved record
            var dataurl = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
            $.ajax({
                url: dataurl,
                async: false,
                type: "GET",
                headers: {
                    "Accept": "application/json;odata=verbose"
                },
                success: function (data) {
                    resourceRRFCount = data.d.results.length;
                    var SeletedEmployeeID = "";
                    if (resourceRRFCount > 0) {
                        var dataset = data.d.results[0];
                        resourceListID = dataset.ID;
                        if (pageStatus == "RRF Saved") {
                            SeletedEmployeeID = (dataset.suggestedResource != "" && dataset.suggestedResource != null) ? dataset.suggestedResource.split(';') : "";
                        } else if (pageStatus == "RMO Validation") {
                            SeletedEmployeeID = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : "";
                        } else if (pageStatus == "Resource Proposed") {
                            SeletedEmployeeID = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : ""; // Changes done on 30-8-2017 
                        } else if (pageStatus == "Resource Selection") {
                            SeletedEmployeeID = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";
                        } else if (pageStatus == "Fulfilled" || pageStatus == "Internally Fulfilled") {
                            SeletedEmployeeID = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";
                        } else if (pageStatus == "External Hiring" || pageStatus == "Offer") {
                            SeletedEmployeeID = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : "";
                        }
                        if (SeletedEmployeeID != "") {
                            $.each(SeletedEmployeeID, function (key, value) {
                                var childCheckboxes = ResourceTable.rows().nodes().to$('#tblResources tbody tr td').find('input[type=checkbox]');
                                if (childCheckboxes.length > 0) {
                                    for (var index = 0; index < childCheckboxes.length; index++) {
                                        if (childCheckboxes[index].parentNode.parentNode.firstElementChild.nextSibling.innerText == value) {
                                            childCheckboxes[index].defaultChecked = true;
                                            var name = childCheckboxes[index].parentNode.parentNode.childNodes[2].innerText.split('Project')[0];
                                            var logDeatils = '<li>' + value + ' | ' + name + '</li>';
                                            $("#slectedResource").append(logDeatils);
                                        }
                                    }
                                } else {
                                    $('#tblResources tbody tr').each(function () {
                                        //var abc = $(this).find('td:eq(1)')[0].innerText;
                                        if ($(this).find('td:eq(1)')[0].innerText == value) {
                                            var name = $(this).find('td:eq(2)')[0].innerText.split('Project')[0];
                                            var logDeatils = '<li>' + value + ' | ' + name + '</li>';
                                            $("#slectedResource").append(logDeatils);
                                        }
                                    });
                                }
                            });
                        } else {
                            $('#tblResources tbody tr').each(function () {
                                $(this).find('td:eq(0) input').prop('checked', false);
                            });
                        }
                    }
                },
                complete: function () {
                    //bind rejected resource indication
                    var dataurl = "../_api/web/lists/getbytitle('RMOAssignmentRefusal')/items?$filter=RRFNo eq'" + RRFNumber + "'&$Top=1";
                    $.ajax({
                        url: dataurl,
                        async: false,
                        type: "GET",
                        headers: {
                            "Accept": "application/json;odata=verbose"
                        },
                        success: function (data) {
                            var RRFRefuseResourceCount = data.d.results.length;
                            var RRFRefuseResources = data.d.results;
                            var SeletedEmployeeID = "";
                            if (RRFRefuseResourceCount > 0) {
                                $.each(RRFRefuseResources, function (key, value) {
                                    $('#tblResources tbody tr').each(function () {
                                        // $('#tblResources tbody tr td:eq(1)')[0].innerHTML
                                        if ($(this).find('td:eq(1)')[0].innerHTML == value.EmployeeID) {
                                            $(this).find('td:eq(9)')[0].innerHTML = $(this).find('td:eq(9)')[0].innerHTML + "  " + "<span class='bgred' title='Rejected'>REJ</span>";
                                        }
                                    });
                                });
                            }
                        },
                        error: function (jqXHR, textStatus, errorThrown) { }
                    });
                },
                error: function (jqXHR, textStatus, errorThrown) { }
            });
        }
        //code to get total,booked,Free resources from service
        function getRoleWiseResources(Role, ResouceUID) {
            var ProjectCode = "";
            var subpractice = document.getElementById('ddlRolewiseSubPractice').value;
            if ((subpractice == "All" || subpractice == undefined || subpractice == "undefined") && IsCP != "1" && Role != "RMO") {
                subpractice = allSubpractice;
            }
            if (IsCP == "1") {
                if (subpractice != "All" && subpractice != undefined && subpractice != "undefined") {
                    ProjectCode = subpractice;
                    subpractice = "";
                } else {
                    ProjectCode = "";
                    subpractice = "";
                }
            }
           // if (Role == "RMO" && subpractice == "All" || subpractice == undefined || subpractice == "undefined") { 
            if ((Role == "RMO" || Role == "Practice Head")&& subpractice == "All" || subpractice == undefined || subpractice == "undefined") {
                subpractice = "";
            }
            var getResourcesURL = getRolewiseResourcesData();
            requestData = "{\"Role\":\"" + Role + "\",\"ResouceUID\":\"" + ResouceUID + "\",\"SubPractice\":\"" + subpractice + "\",\"ProjectCode\":\"" + ProjectCode + "\"}";
            $.ajax({
                url: getResourcesURL,
                method: "POST",
                data: requestData,
                async: false,
                dataType: "json",
                headers: {
                    "content-Type": "application/json"
                },
                success: function (data) {
                    var TotalCount = data.EmployeeAvailability[0].Total;
                    var FreeCount = data.EmployeeAvailability[0].Free;
                    var BookedCount = data.EmployeeAvailability[0].Booked;
                    var RollOffCount = data.EmployeeAvailability[0].Roll_Off;
                    var InvestmentCount = data.EmployeeAvailability[0].Invest;
                    var NewJoineeCount = data.NewJoin_Count;
                    var SoftblockCount = data.EmployeeAvailability[0].Total_Soft_Block;
                    document.getElementById('TotalCapacityVal').innerText = Math.round(TotalCount);
                     document.getElementById('DeployableVal').innerText = Math.round(FreeCount); 
                     document.getElementById('AllocatedVal').innerText = Math.round(BookedCount); 
                     document.getElementById('RollOffVal').innerText = Math.round(RollOffCount); 
                    // document.getElementById('InvestmentVal').innerText = Math.round(InvestmentCount); 
                     document.getElementById('NewJoineeVal').innerText = Math.round(NewJoineeCount); 
                     document.getElementById('SoftBlockVal').innerText = Math.round(SoftblockCount);
					 var utlizationcount=0;
					if(Math.round(TotalCount)==0 && Math.round(BookedCount)==0)
					{
						utlizationcount=0;
					}
					else	
					{				 
						utlizationcount=Math.round(BookedCount)/Math.round(TotalCount);
					}
					 var ucount=utlizationcount*100;
					 var tcount=ucount-10;
					 tcount=  Math.round(tcount) +"%";
					 
					 document.getElementById('InvestmentVal').innerText = tcount;
                    ResourcesResult = data.ResourceData;
                    NewJoinieResults = data.NewJoinDetails;
					//gettotalcount();
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus);
                }
            });
        }
		
		

        function getResourcesDetails(type) {
            multipleAssignProject_Array = [];
            if ($.fn.dataTable.isDataTable('#tblResources')) {
                destroyjs('#tblResources');
            }
            $('.popup h4').css({
                'text-align': 'left',
                'width': '100%'
            });
            $('.allbtn').css('text-align', 'left');
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divComment').style.display = "none";
            document.getElementById('divApproveBody').style.display = "none";
            document.getElementById('divExternalMsgApproval').style.display = "none";
            document.getElementById('divViewLog').style.display = "none";
            document.getElementById('divSearchResource').style.display = "block";
            var resourceTbl_header = "";
            var resourcetable_element = "";
            var ResourceLIHTML = "";
			if (type == "Total") {
                //Table Structure
                resourceTbl_header = "<thead><tr>";
                ResourceLIHTML = "<tbody>";
                //table binding for resources data
                resourceTbl_header = resourceTbl_header + "<th >Employee ID</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employee Name</th>"
                resourceTbl_header = resourceTbl_header + "<th >Role Band</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employment Type</th>"
                resourceTbl_header = resourceTbl_header + "<th>Current Project</th>"
                resourceTbl_header = resourceTbl_header + "<th>Location</th>"
                resourceTbl_header = resourceTbl_header + "<th >Assignment End Date</th>"
                resourceTbl_header = resourceTbl_header + "<th>% Available </th>"
                resourceTbl_header = resourceTbl_header + "<th>Employee Status </th>"
                resourceTbl_header = resourceTbl_header + "<th>Primary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Secondary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Sub Practice</th>"
                resourceTbl_header = resourceTbl_header + "</tr></thead>";
                //footer menu
                <!-- resourceTbl_header = resourceTbl_header + "<tfoot><tr>"; -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + " </tr></tfoot>"; -->
            }
            else if (type == "Free") {
                //Table Structure
                resourceTbl_header = "<thead><tr>";
                ResourceLIHTML = "<tbody>";
                //table binding for resources data
                resourceTbl_header = resourceTbl_header + "<th >Employee ID</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employee Name</th>"
                resourceTbl_header = resourceTbl_header + "<th >Role Band</th>"
                resourceTbl_header = resourceTbl_header + "<th>Current Project</th>"
                resourceTbl_header = resourceTbl_header + "<th>Location</th>"
				resourceTbl_header = resourceTbl_header + "<th>Bench Start Date</th>"
                resourceTbl_header = resourceTbl_header + "<th >Assignment End Date</th>"
				resourceTbl_header = resourceTbl_header + "<th >Bench Aging</th>"
                resourceTbl_header = resourceTbl_header + "<th>% Available </th>"
                resourceTbl_header = resourceTbl_header + "<th>Employee Status </th>"
                resourceTbl_header = resourceTbl_header + "<th>Primary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Secondary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Sub Practice</th>"
                resourceTbl_header = resourceTbl_header + "</tr></thead>";
                //footer menu
                <!-- resourceTbl_header = resourceTbl_header + "<tfoot><tr>"; -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + " </tr></tfoot>"; -->
            } else if (type == "Booked" || type == "Investment" || type == "RollOff") {
                resourceTbl_header = "<thead><tr>";
                ResourceLIHTML = "<tbody>";
                //table binding for resources data
                resourceTbl_header = resourceTbl_header + "<th >Employee ID</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employee Name</th>"
                resourceTbl_header = resourceTbl_header + "<th >Role Band</th>"
                resourceTbl_header = resourceTbl_header + "<th>Current Project</th>"
                resourceTbl_header = resourceTbl_header + "<th>Location</th>"
                resourceTbl_header = resourceTbl_header + "<th >Assignment End Date</th>"
                resourceTbl_header = resourceTbl_header + "<th>% Allocated </th>"
                resourceTbl_header = resourceTbl_header + "<th>Employee Status </th>"
                resourceTbl_header = resourceTbl_header + "<th>Primary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Secondary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Sub Practice</th>"
                resourceTbl_header = resourceTbl_header + "</tr></thead>";
                //footer menu
                <!-- resourceTbl_header = resourceTbl_header + "<tfoot><tr>"; -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + " </tr></tfoot>"; -->
            } else if (type == "SoftBlock") {
                resourceTbl_header = "<thead><tr>";
                ResourceLIHTML = "<tbody>";
                //table binding for resources data
                
                resourceTbl_header = resourceTbl_header + "<th >RRF No.</th>"
				resourceTbl_header = resourceTbl_header + "<th >Employee ID</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employee Name</th>"
                resourceTbl_header = resourceTbl_header + "<th >Role Band</th>"
                resourceTbl_header = resourceTbl_header + "<th>SoftBlocked Project/Opportunity</th>"
                resourceTbl_header = resourceTbl_header + "<th>Location</th>"
                resourceTbl_header = resourceTbl_header + "<th >SoftBlock End Date</th>"
                resourceTbl_header = resourceTbl_header + "<th>% Softblocked </th>"
                resourceTbl_header = resourceTbl_header + "<th>Employee Status </th>"
                resourceTbl_header = resourceTbl_header + "<th>Primary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Secondary Skill</th>"
                resourceTbl_header = resourceTbl_header + "<th>Sub Practice</th>"
                resourceTbl_header = resourceTbl_header + "</tr></thead>";
                //footer menu
                <!-- resourceTbl_header = resourceTbl_header + "<tfoot><tr>"; -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + " </tr></tfoot>"; -->
            } else if (type == "NewJoinee") {
                resourceTbl_header = "<thead><tr>";
                ResourceLIHTML = "<tbody>";
                //table binding for resources data
                resourceTbl_header = resourceTbl_header + "<th >Employee ID</th>"
                resourceTbl_header = resourceTbl_header + "<th >Employee Name</th>"
                resourceTbl_header = resourceTbl_header + "<th >Role Band</th>"
                resourceTbl_header = resourceTbl_header + "<th>Location</th>"
                resourceTbl_header = resourceTbl_header + "</tr></thead>";
                //footer menu
                <!-- resourceTbl_header = resourceTbl_header + "<tfoot><tr>"; -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + "<th></th>" -->
                <!-- resourceTbl_header = resourceTbl_header + " </tr></tfoot>"; -->
            }
            if (type == "Total") {
                $('.clssPopupHead').html("Complete Resource List");
                if (ResourcesResult.length > 0) {
                    $.each(ResourcesResult, function (key, Resource) {
                        var empData = [];
                        var EmpID = Resource.EmployeeID;
                        var EmpName = Resource.ResourceName;
                        var E_status = Resource.EmployeeStatus;
                        var P_Skill = Resource.PrimarySkill;
                        var S_Skill = Resource.SecondarySkill;
                        var Sub_practice = Resource.SubPractice;
                        empData.push({
                            "EmployeeID": EmpID,
                            "ResourceFullName": EmpName
                        });
                        var RoleBand = Resource.Role_Band;
                        var projectDetails = Resource.ProjectsData;
                        var ProjectName = "";
                        var Location = "";
                        var EndDate = "";
                        var Project_Manager = "";
                        var AllocationPer = 0;
                        var allocation_Flag = "";
                        if (projectDetails.length > 1) {
                            var array2 = [];
                            var array_d1 = [];
                            var array_d2 = [];
                            var Projectdatacount = 0;
                            var Locationdatacount = 0;
                            var allocation = [];
                            var singleProjectAllocation = 0;
                            for (var k = 0; k < projectDetails.length; k++) {
                                if (projectDetails[k].Flag != "Soft Block") {
                                    projectDetails[k].EmployeeID = EmpID;
                                    projectDetails[k].ResourceFullName = EmpName;
									if(projectDetails[k].BenchProjects !="1")
									{
										AllocationPer += parseInt(projectDetails[k].Allocation);
									}
                                    var endDate = projectDetails[k].Finishdatetime;
                                    if (endDate != null && endDate != "") {
                                        endDate = Date.parse(endDate);
                                        array_d2.push(endDate);
                                    }
                                    if (projectDetails[k].ProjectName != projectDetails[0].ProjectName || (Projectdatacount == 0 || Projectdatacount == "0") ) {
                                        multipleAssignProject_Array.push(projectDetails[k]);
										
											Projectdatacount++;
										
                                        if (projectDetails[k].ProjectName == projectDetails[0].ProjectName && (Projectdatacount == 1 || Projectdatacount == "1")) {
                                            singleProjectAllocation++;
                                        } else {
                                            singleProjectAllocation--;
                                        }
                                    } else {
                                        if (Projectdatacount > 0) {
                                            multipleAssignProject_Array.push(projectDetails[k]);
                                            singleProjectAllocation--;
                                        }
                                    }
                                    if (projectDetails[k].Location != projectDetails[0].Location) {
                                        Locationdatacount++;
                                    }
									
										allocation.push(projectDetails[k].Allocation);
									
                                    Project_Manager = projectDetails[k].ProjectOwnerName;
									ProjectName = (Projectdatacount > 1 && singleProjectAllocation != 1) ? "Multiple Assignment" : projectDetails[k].ProjectName;
                                }
								
                            }
                            var maxEndDate = Math.min.apply(Math, array_d2);
                            EndDate = formateRefinedDate(maxEndDate);
                            var allocationPer = Math.max.apply(Math, allocation);
                            
                            Location = Locationdatacount > 0 ? "Multiple Location" : projectDetails[0].Location;
                        } else {
                            if (projectDetails.length > 0) {
                                ProjectName = projectDetails[0].ProjectName;
                                Location = projectDetails[0].Location;
                                allocation_Flag = projectDetails[0].Flag;
                                if (allocation_Flag != "Soft Block") {
								if(projectDetails[0].BenchProjects !="1")
								{
									AllocationPer = projectDetails[0].Allocation;
								}
                                }
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? Date.parse(projectDetails[0].Finishdatetime) : "";
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? formateRefinedDate(EndDate) : "";
                            }
                        }
                        var ProjectNameHTML = "";
                        if (ProjectName == "Multiple Assignment") {
                           ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                        } else {
                            ProjectNameHTML = ProjectName;
                        }
                        if (parseInt(AllocationPer) > 100) {
                            Count_count++;
                        }
                        AllocationPer = parseInt(AllocationPer) > 100 ? 100 : AllocationPer;
                        AllocationPer = 100 - parseInt(AllocationPer);
                        Location = Resource.Location;
                        // if (allocation_Flag != "Soft Block") {
                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td>" + Resource.EmployeementType + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                        // }
                    });
                }
            } else if (type == "Free") {
                $('.clssPopupHead').html("Deployable Resource List");
                $.each(ResourcesResult, function (key, Resource) {
                    if (Resource.IsFree == 1 || Resource.IsFree == "1") {
                        if (Resource.EmployeeID == "10208") {
                            var abc = "abc";
                            var cde = "cde";
                        }
                        var empData = [];
                        var EmpID = Resource.EmployeeID;
                        var EmpName = Resource.ResourceName;
                        var E_status = Resource.EmployeeStatus;
                        var P_Skill = Resource.PrimarySkill;
                        var S_Skill = Resource.SecondarySkill;
                        var Sub_practice = Resource.SubPractice;
                        var allocation_Flag = "";
                        empData.push({
                            "EmployeeID": EmpID,
                            "ResourceFullName": EmpName
                        });
                        var RoleBand = Resource.Role_Band;
                        var projectDetails = Resource.ProjectsData;
                        var ProjectName = "";
                        var Location = "";
                        var EndDate = "";
                        var Project_Manager = "";
                        var AllocationPer = 0;
						if(projectDetails.length==0)
						{
							ProjectName="No Allocation";
						}
                        else if (projectDetails.length > 1) {
                            var array2 = [];
                            var array_d1 = [];
                            var array_d2 = [];
                            var Projectdatacount = 0;
                            var Locationdatacount = 0;
                            var allocation = [];
                            var singleProjectAllocation = 0;
                            for (var k = 0; k < projectDetails.length; k++) {
                                if (projectDetails[k].Flag != "Soft Block") {
                                    projectDetails[k].EmployeeID = EmpID;
                                    projectDetails[k].ResourceFullName = EmpName;
                                    //var TempProjectName=projectDetails[k].ProjectName;
                                    if (projectDetails[k].BenchProjects != "1" && projectDetails[k].BenchProjects != 1) {
                                        AllocationPer += parseInt(projectDetails[k].Allocation);
                                    }
                                    var endDate = projectDetails[k].Finishdatetime;
                                    if (endDate != null && endDate != "") {
                                        endDate = Date.parse(endDate);
                                        array_d2.push(endDate);
                                    }
                                    if (projectDetails[k].ProjectName != projectDetails[0].ProjectName || (Projectdatacount == 0 || Projectdatacount == "0")) {
                                        multipleAssignProject_Array.push(projectDetails[k]);
                                        Projectdatacount++;
                                        if (projectDetails[k].ProjectName == projectDetails[0].ProjectName && (Projectdatacount == 1 || Projectdatacount == "1")) {
                                            singleProjectAllocation++;
                                        } else {
                                            singleProjectAllocation--;
                                        }
                                    } else {
                                        if (Projectdatacount > 0) {
                                            multipleAssignProject_Array.push(projectDetails[k]);
                                            singleProjectAllocation--;
                                        }
                                    }
                                    if (projectDetails[k].Location != projectDetails[0].Location) {
                                        Locationdatacount++;
                                    }
                                    allocation.push(projectDetails[k].Allocation);
                                    Project_Manager = projectDetails[k].ProjectOwnerName;
									ProjectName = (Projectdatacount > 1 && singleProjectAllocation != 1) ? "Multiple Assignment" : projectDetails[k].ProjectName;
                                }
								
                            }
                            var maxEndDate = Math.min.apply(Math, array_d2);
                            EndDate = formateRefinedDate(maxEndDate);
                            var allocationPer = Math.max.apply(Math, allocation);
                            Location = Locationdatacount > 0 ? "Multiple Location" : projectDetails[0].Location;
                        } else {
                            if (projectDetails.length > 0) {
                                ProjectName = projectDetails[0].ProjectName;
                                Location = projectDetails[0].Location;
                                allocation_Flag = projectDetails[0].Flag;
                                if (projectDetails[0].BenchProjects != "1" && projectDetails[0].BenchProjects != 1 && allocation_Flag != "Soft Block") {
                                    AllocationPer = projectDetails[0].Allocation;
                                }
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? Date.parse(projectDetails[0].Finishdatetime) : "";
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? formateRefinedDate(EndDate) : "";
                            }
                        }
                        var ProjectNameHTML = "";
                        if (ProjectName == "Multiple Assignment") {
                            ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                        } else {
                            ProjectNameHTML = ProjectName;
                        }
						var AgingStartDate=""
						if(Resource.MAX_Finishdatetime!="" && Resource.MAX_Finishdatetime!=" " && Resource.MAX_Finishdatetime!=undefined && Resource.MAX_Finishdatetime!=null)
						{
							AgingStartDate=formateRefinedDate(Resource.MAX_Finishdatetime);
						}
                        AllocationPer = parseInt(AllocationPer) > 100 ? 100 : AllocationPer;
                        AllocationPer = 100 - parseInt(AllocationPer);
                        if (AllocationPer >= 11 || allocation_Flag == "Soft Block") {
						var BenchAging="";
                            Location = Resource.Location;
							if(AllocationPer<100)
							{
								BenchAging="";
							}
							else 
							{
								BenchAging=Resource.BENCH_AGING
							}
							//ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + AgingStartDate + "</td><td>" + EndDate + "</td><td>" + BenchAging + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                        }
                    }
                });
            } else if (type == "Booked") {
                $('.clssPopupHead').html("Allocated Resource List");
                $.each(ResourcesResult, function (key, Resource) {
                    if (Resource.IsBooked == 1 || Resource.IsBooked == "1") {
                        var empData = [];
                        var EmpID = Resource.EmployeeID;
                        var EmpName = Resource.ResourceName;
                        var E_status = Resource.EmployeeStatus;
                        var P_Skill = Resource.PrimarySkill;
                        var S_Skill = Resource.SecondarySkill;
                        var Sub_practice = Resource.SubPractice;
                        var allocation_Flag = "";
                        empData.push({
                            "EmployeeID": EmpID,
                            "ResourceFullName": EmpName
                        });
                        var RoleBand = Resource.Role_Band;
                        var projectDetails = Resource.ProjectsData;
                        var ProjectName = "";
                        var Location = "";
                        var EndDate = "";
                        var Project_Manager = "";
                        var AllocationPer = 0;
                        if (projectDetails.length > 1) {
                            var array2 = [];
                            var array_d1 = [];
                            var array_d2 = [];
                            var Projectdatacount = 0;
                            var Locationdatacount = 0;
                            var allocation = [];
                            var singleProjectAllocation = 0;
                            for (var k = 0; k < projectDetails.length; k++) {
                                if (projectDetails[k].BenchProjects != "1" && projectDetails[k].BenchProjects != 1 && projectDetails[k].Flag != "Soft Block") {
                                    projectDetails[k].EmployeeID = EmpID;
                                    projectDetails[k].ResourceFullName = EmpName;
                                    AllocationPer += parseInt(projectDetails[k].Allocation);
                                    var endDate = projectDetails[k].Finishdatetime;
                                    if (endDate != null && endDate != "") {
                                        endDate = Date.parse(endDate);
                                        array_d2.push(endDate);
                                    }
                                    if (projectDetails[k].ProjectName != projectDetails[0].ProjectName || (Projectdatacount == 0 || Projectdatacount == "0")) {
                                        multipleAssignProject_Array.push(projectDetails[k]);
                                        Projectdatacount++;
                                        if (projectDetails[k].ProjectName == projectDetails[0].ProjectName && (Projectdatacount == 1 || Projectdatacount == "1")) {
                                            singleProjectAllocation++;
                                        } else {
                                            singleProjectAllocation--;
                                        }
                                    } else {
                                        if (Projectdatacount > 0) {
                                            multipleAssignProject_Array.push(projectDetails[k]);
                                            singleProjectAllocation--;
                                        }
                                    }
                                    if (projectDetails[k].Location != projectDetails[0].Location) {
                                        Locationdatacount++;
                                    }
                                    allocation.push(projectDetails[k].Allocation);
                                    Project_Manager = projectDetails[k].ProjectOwnerName;
									ProjectName = (Projectdatacount > 1 && singleProjectAllocation != 1) ? "Multiple Assignment" : projectDetails[k].ProjectName;
                                }
								
                            }
                            var maxEndDate = Math.min.apply(Math, array_d2);
                            EndDate = formateRefinedDate(maxEndDate);
                            var allocationPer = Math.max.apply(Math, allocation);
                            
                            Location = Locationdatacount > 0 ? "Multiple Location" : projectDetails[0].Location;
                        } else {
                            if (projectDetails.length > 0 && projectDetails[0].BenchProjects != "1" && projectDetails[0].BenchProjects != 1) {
                                ProjectName = projectDetails[0].ProjectName;
                                Location = projectDetails[0].Location;
                                AllocationPer = projectDetails[0].Allocation;
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? Date.parse(projectDetails[0].Finishdatetime) : "";
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? formateRefinedDate(EndDate) : "";
                                allocation_Flag = projectDetails[0].Flag;
                            }
                        }
                        var ProjectNameHTML = "";
                        if (ProjectName == "Multiple Assignment") {
                            ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                        } else {
                            ProjectNameHTML = ProjectName;
                        }
                        AllocationPer = parseInt(AllocationPer) > 100 ? 100 : AllocationPer;
                        //AllocationPer = 100 - parseInt(AllocationPer);
                        Location = Resource.Location;
                        if (ProjectName != "" && allocation_Flag != "Soft Block") {
							
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                        }
                    }
                });
            } else if (type == "Investment") {
                $('.clssPopupHead').html("Investment Resource List");
                $.each(ResourcesResult, function (key, Resource) {
                    if (Resource.IsInvestment == 1 || Resource.IsInvestment == "1") {
                        var empData = [];
                        var EmpID = Resource.EmployeeID;
                        var EmpName = Resource.ResourceName;
                        var E_status = Resource.EmployeeStatus;
                        var P_Skill = Resource.PrimarySkill;
                        var S_Skill = Resource.SecondarySkill;
                        var Sub_practice = Resource.SubPractice;
                        var allocation_Flag = "";
                        empData.push({
                            "EmployeeID": EmpID,
                            "ResourceFullName": EmpName
                        });
                        var RoleBand = Resource.Role_Band;
                        var projectDetails = Resource.ProjectsData;
                        var ProjectName = "";
                        var Location = "";
                        var EndDate = "";
                        var Project_Manager = "";
                        var AllocationPer = 0;
                        if (projectDetails.length > 1) {
                            var array2 = [];
                            var array_d1 = [];
                            var array_d2 = [];
                            var Projectdatacount = 0;
                            var Locationdatacount = 0;
                            var allocation = [];
                            var singleProjectAllocation = 0;
                            for (var k = 0; k < projectDetails.length; k++) {
                                if (projectDetails[k].Flag != "Soft Block") {
                                    projectDetails[k].EmployeeID = EmpID;
                                    projectDetails[k].ResourceFullName = EmpName;
                                    AllocationPer += parseInt(projectDetails[k].Allocation);
                                    var endDate = projectDetails[k].Finishdatetime;
                                    if (endDate != null && endDate != "") {
                                        endDate = Date.parse(endDate);
                                        array_d2.push(endDate);
                                    }
                                    if (projectDetails[k].ProjectName != projectDetails[0].ProjectName || (Projectdatacount == 0 || Projectdatacount == "0")) {
                                        multipleAssignProject_Array.push(projectDetails[k]);
                                        Projectdatacount++;
                                        if (projectDetails[k].ProjectName == projectDetails[0].ProjectName && (Projectdatacount == 1 || Projectdatacount == "1")) {
                                            singleProjectAllocation++;
                                        } else {
                                            singleProjectAllocation--;
                                        }
                                    } else {
                                        if (Projectdatacount > 0) {
                                            multipleAssignProject_Array.push(projectDetails[k]);
                                            singleProjectAllocation--;
                                        }
                                    }
                                    if (projectDetails[k].Location != projectDetails[0].Location) {
                                        Locationdatacount++;
                                    }
                                    allocation.push(projectDetails[k].Allocation);
                                    Project_Manager = projectDetails[k].ProjectOwnerName;
									ProjectName = (Projectdatacount > 1 && singleProjectAllocation != 1) ? "Multiple Assignment" : projectDetails[k].ProjectName;
                                }
								
                            }
                            var maxEndDate = Math.min.apply(Math, array_d2);
                            EndDate = formateRefinedDate(maxEndDate);
                            var allocationPer = Math.max.apply(Math, allocation);
                            
                            Location = Locationdatacount > 0 ? "Multiple Location" : projectDetails[0].Location;
                        } else {
                            if (projectDetails.length > 0) {
                                ProjectName = projectDetails[0].ProjectName;
                                Location = projectDetails[0].Location;
                                AllocationPer = projectDetails[0].Allocation;
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? Date.parse(projectDetails[0].Finishdatetime) : "";
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? formateRefinedDate(EndDate) : "";
                                allocation_Flag = projectDetails[0].Flag;
                            }
                        }
                        var ProjectNameHTML = "";
                        if (ProjectName == "Multiple Assignment") {
                            ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                        } else {
                            ProjectNameHTML = ProjectName;
                        }
                        AllocationPer = parseInt(AllocationPer) > 100 ? 100 : AllocationPer;
                        // AllocationPer = 100 - parseInt(AllocationPer);
                        Location = Resource.Location;
                        if (allocation_Flag != "Soft Block") {
							//ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                        }
                    }
                });
            } else if (type == "RollOff") {
                $('.clssPopupHead').html("Roll-Off Resource List");
                $.each(ResourcesResult, function (key, Resource) {
                    if (Resource.RoleOff == 1 || Resource.RoleOff == "1") {
                        var empData = [];
                        var EmpID = Resource.EmployeeID;
                        var EmpName = Resource.ResourceName;
                        var E_status = Resource.EmployeeStatus;
                        var P_Skill = Resource.PrimarySkill;
                        var S_Skill = Resource.SecondarySkill;
                        var Sub_practice = Resource.SubPractice;
                        var allocation_Flag = "";
                        empData.push({
                            "EmployeeID": EmpID,
                            "ResourceFullName": EmpName
                        });
                        var RoleBand = Resource.Role_Band;
                        var projectDetails = Resource.ProjectsData;
                        var ProjectName = "";
                        var Location = "";
                        var EndDate = "";
                        var Project_Manager = "";
                        var AllocationPer = 0;
                        if (projectDetails.length > 1) {
                            var array2 = [];
                            var array_d1 = [];
                            var array_d2 = [];
                            var Projectdatacount = 0;
                            var Locationdatacount = 0;
                            var allocation = [];
                            var singleProjectAllocation = 0;
                            for (var k = 0; k < projectDetails.length; k++) {
                                if (projectDetails[k].Flag != "Soft Block") {
                                    projectDetails[k].EmployeeID = EmpID;
                                    projectDetails[k].ResourceFullName = EmpName;
                                    AllocationPer += parseInt(projectDetails[k].Allocation);
                                    var endDate = projectDetails[k].Finishdatetime;
                                    if (endDate != null && endDate != "") {
                                        endDate = Date.parse(endDate);
                                        array_d2.push(endDate);
                                    }
                                    if (projectDetails[k].ProjectName != projectDetails[0].ProjectName || (Projectdatacount == 0 || Projectdatacount == "0")) {
                                        multipleAssignProject_Array.push(projectDetails[k]);
                                        Projectdatacount++;
                                        if (projectDetails[k].ProjectName == projectDetails[0].ProjectName && (Projectdatacount == 1 || Projectdatacount == "1")) {
                                            singleProjectAllocation++;
                                        } else {
                                            singleProjectAllocation--;
                                        }
                                    } else {
                                        if (Projectdatacount > 0) {
                                            multipleAssignProject_Array.push(projectDetails[k]);
                                            singleProjectAllocation--;
                                        }
                                    }
                                    if (projectDetails[k].Location != projectDetails[0].Location) {
                                        Locationdatacount++;
                                    }
                                    allocation.push(projectDetails[k].Allocation);
                                    Project_Manager = projectDetails[k].ProjectOwnerName;
									ProjectName = (Projectdatacount > 1 && singleProjectAllocation != 1) ? "Multiple Assignment" : projectDetails[k].ProjectName;
                                }
								
                            }
                            var maxEndDate = Math.min.apply(Math, array_d2);
                            EndDate = formateRefinedDate(maxEndDate);
                            var allocationPer = Math.max.apply(Math, allocation);
                            
                            Location = Locationdatacount > 0 ? "Multiple Location" : projectDetails[0].Location;
                        } else {
                            if (projectDetails.length > 0) {
                                ProjectName = projectDetails[0].ProjectName;
                                Location = projectDetails[0].Location;
                                AllocationPer = projectDetails[0].Allocation;
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? Date.parse(projectDetails[0].Finishdatetime) : "";
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? formateRefinedDate(EndDate) : "";
                                allocation_Flag = projectDetails[0].Flag;
                            }
                        }
                        var ProjectNameHTML = "";
                        if (ProjectName == "Multiple Assignment") {
                            ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                        } else {
                            ProjectNameHTML = ProjectName;
                        }
                        AllocationPer = parseInt(AllocationPer) > 100 ? 100 : AllocationPer;
                        //AllocationPer = 100 - parseInt(AllocationPer);
                        Location = Resource.Location;
                        if (allocation_Flag != "Soft Block") {
							//ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                        }
                    }
                });
            } else if (type == "SoftBlock") {
                $('.clssPopupHead').html("Softblocked Employee List");
                $.each(ResourcesResult, function (key, Resource) {
                    if (Resource.IsSoftBlock == 1 || Resource.IsSoftBlock == "1") {
                        var empData = [];
                        var EmpID = Resource.EmployeeID;
                        var EmpName = Resource.ResourceName;
                        //var E_status = "Soft Block";
                        var E_status = Resource.EmployeeStatus;
                        var P_Skill = Resource.PrimarySkill;
                        var S_Skill = Resource.SecondarySkill;
                        var Sub_practice = Resource.SubPractice;
                        empData.push({
                            "EmployeeID": EmpID,
                            "ResourceFullName": EmpName
                        });
                        var RoleBand = Resource.Role_Band;
                        var projectDetails = Resource.ProjectsData;
                        var ProjectName = "";
                        var Location = "";
                        var EndDate = "";
                        var Project_Manager = "";
                        var AllocationPer = 0;
						
                        if (projectDetails.length > 1) {
                            var array2 = [];
                            var array_d1 = [];
                            var array_d2 = [];
                            var Projectdatacount = 0;
                            var Locationdatacount = 0;
                            var allocation = [];
                            var singleProjectAllocation = 0;
							var rrfno="";
                            for (var k = 0; k < projectDetails.length; k++) {
                                if (projectDetails[k].Flag == "Soft Block" && projectDetails[k].Active=="0") {
                                    projectDetails[k].EmployeeID = EmpID;
                                    projectDetails[k].ResourceFullName = EmpName;
                                    AllocationPer += parseInt(projectDetails[k].Allocation);
									rrfno=projectDetails[k].RRFNO;
                                    var endDate = projectDetails[k].Finishdatetime;
                                    if (endDate != null && endDate != "") {
                                        endDate = Date.parse(endDate);
                                        array_d2.push(endDate);
                                    }
                                    if (projectDetails[k].ProjectName != projectDetails[0].ProjectName || (Projectdatacount == 0 || Projectdatacount == "0")) {
                                        multipleAssignProject_Array.push(projectDetails[k]);
                                        Projectdatacount++;
                                        if (projectDetails[k].ProjectName == projectDetails[0].ProjectName && (Projectdatacount == 1 || Projectdatacount == "1")) {
                                            singleProjectAllocation++;
                                        } else {
                                            singleProjectAllocation--;
                                        }
                                    } else {
                                        if (Projectdatacount > 0) {
                                            multipleAssignProject_Array.push(projectDetails[k]);
                                            singleProjectAllocation--;
                                        }
                                    }
                                    if (projectDetails[k].Location != projectDetails[0].Location) {
                                        Locationdatacount++;
                                    }
                                    allocation.push(projectDetails[k].Allocation);
                                    Project_Manager = projectDetails[k].ProjectOwnerName;
									ProjectName = (Projectdatacount > 1 && singleProjectAllocation != 1) ? "Multiple Assignment" : projectDetails[k].ProjectName;
                                }
								
                            }
                            var maxEndDate = Math.min.apply(Math, array_d2);
                            EndDate = formateRefinedDate(maxEndDate);
                            var allocationPer = Math.max.apply(Math, allocation);
                            
                            Location = Locationdatacount > 0 ? "Multiple Location" : projectDetails[0].Location;
                        } else {
                            if (projectDetails.length > 0 && projectDetails[0].Flag == "Soft Block" && projectDetails[0].Active=="0") {
                                ProjectName = projectDetails[0].ProjectName;
                                Location = projectDetails[0].Location;
								rrfno=projectDetails[0].RRFNO;
                                AllocationPer = projectDetails[0].Allocation;
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? Date.parse(projectDetails[0].Finishdatetime) : "";
                                EndDate = projectDetails[0].Finishdatetime != "" && projectDetails[0].Finishdatetime != null ? formateRefinedDate(EndDate) : "";
                            }
                        }
                        var ProjectNameHTML = "";
                        if (ProjectName == "Multiple Assignment") {
                            ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                        } else {
                            ProjectNameHTML = ProjectName;
                        }
                        AllocationPer = parseInt(AllocationPer) > 100 ? 100 : AllocationPer;
                        //AllocationPer = 100 - parseInt(AllocationPer);
                        Location = Resource.Location;
                        if (ProjectName != "") {
							//ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                            ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td><a style='color:#361bd6' href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + rrfno + "' target='_blank' >" + rrfno + "</a></td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + RoleBand + "</td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Location + "</td><td>" + EndDate + "</td><td>" + AllocationPer + "</td><td>" + E_status + "</td><td>" + P_Skill + "</td><td>" + S_Skill + "</td><td>" + Sub_practice + "</td></tr>";
                        }
                    }
                });
            } //NewJoinee
            else if (type == "NewJoinee") {
                $('.clssPopupHead').html("New Joinee Resource List");
                $.each(NewJoinieResults, function (key, Resource) {
                    //  if (Resource.IsNewJoin == 1 || Resource.IsNewJoin == "1") {
                    var empData = [];
                    var EmpID = Resource.EmployeeID;
                    var EmpName = Resource.ResourceName;
                    var RoleBand = Resource.RoleBand;
                    var Location = Resource.Location;
                    ResourceLIHTML = ResourceLIHTML + "<tr id=" + EmpID + "><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td>" + EmpName + "</td><td>" + RoleBand + "</td><td>" + Location + "</td></tr>";
                    // }
                });
            }
            ResourceLIHTML += "</tbody>";
            resourcetable_element = resourceTbl_header + ResourceLIHTML;
            $("#tblResources").append(resourcetable_element);
			if(type == "Total")
			{
				ResourceTable = $('#tblResources').DataTable({
					scrollY: "250px",
					scrollX: true,
					paging: true,
					"dom": 'Rlfrtip',
					"iDisplayLength": 5,
					"lengthMenu": [
						[5, 15, 35, -1],
						[5, 15, 35, "All"]
					],
					"pagingType": "simple_numbers",
					"dom": 'lBfrtip',
					buttons: [{
						extend: 'excelHtml5',
						exportOptions: {
							columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
							format: {
							body: function ( data, row, column, node ) {
							   if (column === 1) {
									//need to change double quotes to single
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									splitData =t.split('<')[0];
									
									/*data = '';
									for (i=0; i < splitData.length; i++) {
										//add escaped double quotes around each line
										data += '\"' + splitData[i] + '\"';
										//if its not the last line add CHAR(13)
										if (i + 1 < splitData.length) {
											data += ', CHAR(13), ';
										}
									}
									//Add concat function
									data = 'CONCATENATE(' + data + ')';*/
									return splitData;
								}
								
								if(column===4)
								{
									data = data.replace( /"/g, "'" );
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								
								<!-- alert( str.replace(/&amp;/g, '&') ); -->
								if(column===9)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								 if(column===10)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								if(column===11)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								
								return data;
								}
							}
						}
					}, ],
				});
			}
			else if (type == "NewJoinee") {
                ResourceTable = $('#tblResources').DataTable({
					scrollY: "250px",
					scrollX: true,
					paging: true,
                    "dom": 'Rlfrtip',
                    "iDisplayLength": 5,
                    "lengthMenu": [
                        [5, 15, 35, -1],
                        [5, 15, 35, "All"]
                    ],
                    "pagingType": "simple_numbers",
                    "dom": 'lBfrtip',
                    buttons: [{
                        extend: 'excelHtml5',
                        exportOptions: {
                            columns: [0, 1, 2, 3],
							format: {
							body: function ( data, row, column, node ) {
							   if (column === 1) {
									//need to change double quotes to single
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									splitData =t.split('<')[0];
									
									/*data = '';
									for (i=0; i < splitData.length; i++) {
										//add escaped double quotes around each line
										data += '\"' + splitData[i] + '\"';
										//if its not the last line add CHAR(13)
										if (i + 1 < splitData.length) {
											data += ', CHAR(13), ';
										}
									}
									//Add concat function
									data = 'CONCATENATE(' + data + ')';*/
									return splitData;
								}
								
								if(column===3)
								{
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
									//return splitData;
								}
								return data;
								}
							}
                        }
                    }, ],
                });
            }
			else if(type == "SoftBlock")
			{
					ResourceTable = $('#tblResources').DataTable({
					scrollY: "250px",
					scrollX: true,
					paging: true,
                    "dom": 'Rlfrtip',
                    "iDisplayLength": 5,
                    "lengthMenu": [
                        [5, 15, 35, -1],
                        [5, 15, 35, "All"]
                    ],
                    "pagingType": "simple_numbers",
                    "dom": 'lBfrtip',
                    buttons: [{
                        extend: 'excelHtml5',
                        exportOptions: {
                            columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
							format: {
							body: function ( data, row, column, node ) {
							   if (column ===0) {
									//need to change double quotes to single
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									splitData =t.split('<')[0];
									
									/*data = '';
									for (i=0; i < splitData.length; i++) {
										//add escaped double quotes around each line
										data += '\"' + splitData[i] + '\"';
										//if its not the last line add CHAR(13)
										if (i + 1 < splitData.length) {
											data += ', CHAR(13), ';
										}
									}
									//Add concat function
									data = 'CONCATENATE(' + data + ')';*/
									return splitData;
								}
								if (column ===2) {
									//need to change double quotes to single
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									splitData =t.split('<')[0];
									
									/*data = '';
									for (i=0; i < splitData.length; i++) {
										//add escaped double quotes around each line
										data += '\"' + splitData[i] + '\"';
										//if its not the last line add CHAR(13)
										if (i + 1 < splitData.length) {
											data += ', CHAR(13), ';
										}
									}
									//Add concat function
									data = 'CONCATENATE(' + data + ')';*/
									return splitData;
								}
								if(column===4)
								{
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								return data;
								}
							}
                        }
                    }, ],
                });
			}
else if(type == "Free")
{

                ResourceTable = $('#tblResources').DataTable({
					scrollY: "250px",
					scrollX: true,
					paging: true,
                    "dom": 'Rlfrtip',
                    "iDisplayLength": 5,
                    "lengthMenu": [
                        [5, 15, 35, -1],
                        [5, 15, 35, "All"]
                    ],
                    "pagingType": "simple_numbers",
                    "dom": 'lBfrtip',
                    buttons: [{
                        extend: 'excelHtml5',
                        exportOptions: {
                            columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
							format: {
							body: function ( data, row, column, node ) {
							   if (column === 1) {
									//need to change double quotes to single
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									splitData =t.split('<')[0];
									
									/*data = '';
									for (i=0; i < splitData.length; i++) {
										//add escaped double quotes around each line
										data += '\"' + splitData[i] + '\"';
										//if its not the last line add CHAR(13)
										if (i + 1 < splitData.length) {
											data += ', CHAR(13), ';
										}
									}
									//Add concat function
									data = 'CONCATENATE(' + data + ')';*/
									return splitData;
								}
								
								if(column===3)
								{
									data = data.replace( /"/g, "'" );
								    data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								 if(column===10)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								 if(column===11)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								 if(column===12)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								
								return data;
								}
							}
                        }
                    }, ],
                });
}	
		
			else {
                ResourceTable = $('#tblResources').DataTable({
					scrollY: "250px",
					scrollX: true,
					paging: true,
                    "dom": 'Rlfrtip',
                    "iDisplayLength": 5,
                    "lengthMenu": [
                        [5, 15, 35, -1],
                        [5, 15, 35, "All"]
                    ],
                    "pagingType": "simple_numbers",
                    "dom": 'lBfrtip',
                    buttons: [{
                        extend: 'excelHtml5',
                        exportOptions: {
                            columns: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
							format: {
							body: function ( data, row, column, node ) {
							   if (column === 1) {
									//need to change double quotes to single
									data = data.replace( /"/g, "'" );
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									splitData =t.split('<')[0];
									
									/*data = '';
									for (i=0; i < splitData.length; i++) {
										//add escaped double quotes around each line
										data += '\"' + splitData[i] + '\"';
										//if its not the last line add CHAR(13)
										if (i + 1 < splitData.length) {
											data += ', CHAR(13), ';
										}
									}
									//Add concat function
									data = 'CONCATENATE(' + data + ')';*/
									return splitData;
								}
								
								if(column===3)
								{
									data = data.replace( /"/g, "'" );
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								 if(column===8)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								 if(column===9)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								 if(column===10)
								{
									data = data.replace(/&amp;/g, '&');
									//split at each new line
									//splitData = data.split('projects');
									var t =data.split('>')[1];
									if(t !=undefined)
									{
										data =t.split('<')[0];
									}
								}
								return data;
								}
							}
                        }
                    }, ],
                });
            }
            <!-- $('#tblResources tfoot th').each(function () { -->
                <!-- var title = $(this).text(); -->
                <!-- if (title != 'Action' && title != 'Item') { -->
                    <!-- $(this).html('<input type="text" placeholder="Search ' + title + '" />'); -->
                <!-- } else { -->
                    <!-- $(this).html(''); -->
                <!-- } -->
            <!-- }); -->
            <!-- // DataTable -->
            <!-- var table = $('#tblResources').DataTable(); -->
            <!-- // Apply the search -->
            <!-- table.columns().every(function () { -->
                <!-- var that = this; -->
                <!-- $('input', this.footer()).on('keyup change', function () { -->
                    <!-- if (that.search() !== this.value) { -->
                        <!-- that.search(this.value).draw(); -->
                    <!-- } -->
                <!-- }); -->
            <!-- }); -->
			
            $('.popup-bg').show();
			$('.form-control').trigger('change');
			
        }

        function resultsetProfile(Url) {
            var result;
            $.ajax({
                url: Url,
                async: false,
                method: "GET",
                headers: {
                    "Accept": "application/json; odata=verbose",
                    "Content-Type": "application/json; odata=verbose"
                },
                success: function (data) {
                    result = data.d;
                },
                error: function (error) {
                    result = 'error';
                }
            });
            return result;
        }
        //Code to destroy jquery datatable 
        function destroyjs(tableid) {
            if ($.fn.dataTable.isDataTable(tableid)) {
                $(tableid).DataTable({
                    "filter": false,
                    "destroy": true
                });
                $(tableid).DataTable().destroy();
                //clear_tbody();
                $(tableid).html("");
                $(tableid + " tbody tr").remove();
            }
        }

        function convert_date_DDMMYYYY(date_to_convert) {
            if (date_to_convert.indexOf('T') >= 0) {
                var arr_dateandtime = date_to_convert.split('T');
            } else {
                var arr_dateandtime = date_to_convert.split(' ');
            }
            var arr_dateonly = arr_dateandtime[0].split('-');
            var MonthName = GetMonthName(arr_dateonly[1]);
            converted_date = arr_dateonly[2] + "-" + MonthName + "-" + arr_dateonly[0];
            return converted_date;
        }

        function formateRefinedDate(date) {
            var resultdate = "";
            var newdate = new Date(date);
            newdate.setDate(newdate.getDate());
            var tempDate_array = newdate.toDateString().split(' ');
            resultdate = tempDate_array[2] + "-" + tempDate_array[1] + "-" + tempDate_array[3];
            return resultdate;
        }

        function GetMonthName(monthNumber) {
            var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return months[monthNumber - 1];
        }

        function ShowMultipleAssignmentProjectsDetails(event, Flag) {
            if (event.firstChild.nodeValue == "Multiple Assignment") {
                var eid = event.parentNode.id.split('#')[0]; //.parentNode.parentNode.childNodes[1].innerText;
                var eName = event.parentNode.id.split('#')[1]; //event.parentNode.parentNode.childNodes[2].innerText;       
                document.getElementById('divMultipleAssignment').style.display = 'block';
                $('.TopclssPopupHead').text('Multiple Assignment of : ' + eName + ' | ' + eid);
                $('.Toppopup h4').css('text-align', 'left');
                if ($.fn.dataTable.isDataTable('#tblMultipleAssignment')) {
                    destroyjs('#tblMultipleAssignment');
                }
                var resourceTbl_header = "";
                var resourcetable_element = "";
                resourceTbl_header = "<thead><tr>";
                var ResourceLIHTML = "<tbody>";
                //table binding for resources data
                resourceTbl_header = resourceTbl_header + "<th>Project Name</th>"
                resourceTbl_header = resourceTbl_header + "<th>Start Date</th>"
                resourceTbl_header = resourceTbl_header + "<th>End Date</th>"
                resourceTbl_header = resourceTbl_header + "<th>Allocation %</th>"
                resourceTbl_header = resourceTbl_header + "<th>Project Manager</th>"
                resourceTbl_header = resourceTbl_header + "<th>Work Location</th>"
                resourceTbl_header = resourceTbl_header + "<th>Fulfillment Type</th>"
                resourceTbl_header = resourceTbl_header + "</tr></thead>";
                //footer menu
                resourceTbl_header = resourceTbl_header + "<tfoot><tr>";
                resourceTbl_header = resourceTbl_header + "<th></th>"
                resourceTbl_header = resourceTbl_header + "<th></th>"
                resourceTbl_header = resourceTbl_header + "<th></th>"
                resourceTbl_header = resourceTbl_header + "<th></th>"
                resourceTbl_header = resourceTbl_header + "<th></th>"
                resourceTbl_header = resourceTbl_header + "<th></th>"
                resourceTbl_header = resourceTbl_header + "<th></th>"
                resourceTbl_header = resourceTbl_header + " </tr></tfoot>";
                if (multipleAssignProject_Array.length > 0) {
                    $.each(multipleAssignProject_Array, function (index, value) {
                        if (eid == value.EmployeeID) {
                            var EmpID = "";
                            var EmpName = "";
                            var Designation = "";
                            var projectcode = "";
                            var ProjectName = "";
                            var ProjectstartDate = "";
                            var ProjectEnddate = "";
                            var allocationPercent = ""
                            var Location = "";
                            var projectManager = "";
                            var projectCode = "";
                            var Type = "";
                            //if (value.EmployeeID != null) {
                            //    EmpID = value.EmployeeID;
                            //}
                            //if (value.ResourceFullName != null) {
                            //    EmpName = value.ResourceFullName;
                            //}
                            if (value.Designation != null) {
                                Designation = value.Designation;
                            }
                            if (value.ProjectName != null) {
                                ProjectName = value.ProjectName;
                            }
                            if (value.ProjectCode != null) {
                                projectCode = value.ProjectCode;
                                projectManager = value.ProjectOwnerName;
                            }
                            if (value.Startdatetime != null && value.Startdatetime != "") {
                                ProjectstartDate = value.Startdatetime;
                                var date1 = Date.parse(ProjectstartDate);
                                ProjectstartDate = formateRefinedDate(date1);
                            }
                            if (value.Finishdatetime != null && value.Finishdatetime != "") {
                                ProjectEnddate = value.Finishdatetime;
                                var date2 = Date.parse(ProjectEnddate);
                                ProjectEnddate = formateRefinedDate(date2);
                            }
                            if (value.Allocation != null) {
                                allocationPercent = value.Allocation;
                            }
                            if (value.Location != null) {
                                Location = value.Location;
                            }
                            if (value.Flag != null) {
                                Type = value.Flag;
                            }
                            ResourceLIHTML = ResourceLIHTML + "<tr><td>" + ProjectName + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + projectManager + "</td><td>" + Location + "</td><td>" + Type + "</td></tr>"
                        }
                    })
                    ResourceLIHTML = ResourceLIHTML + "</tbody>";
                    resourcetable_element = resourceTbl_header + ResourceLIHTML;
                    $("#tblMultipleAssignment").append(resourcetable_element);
                    $('#tblMultipleAssignment').DataTable({
                        "dom": 'Rlfrtip',
                        "iDisplayLength": 5,
                        "lengthMenu": [
                            [5, 15, 35, -1],
                            [5, 15, 35, "All"]
                        ],
                        "pagingType": "simple_numbers",
                        "dom": 'lBfrtip',
                        buttons: [{
                            extend: 'excelHtml5',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4, 5, 6]
                            }
                        }, ],
                    });
                    $('#tblMultipleAssignment tfoot th').each(function () {
                        var title = $(this).text();
                        if (title != 'Action' && title != 'Indicators') {
                            $(this).html('<input type="text" placeholder="Search ' + title + '" />');
                        }
                    });
                    // DataTable
                    var table = $('#tblMultipleAssignment').DataTable();
                    // Apply the search
                    table.columns().every(function () {
                        var that = this;
                        $('input', this.footer()).on('keyup change', function () {
                            if (that.search() !== this.value) {
                                that.search(this.value).draw();
                            }
                        });
                    });
                    $('.Toppopup-bg').show();
                }
            }
        }

        function getRolewiseSubpractice(currentuserGUID, currentuseremail) {
            var getSubpracticeURL = "";
            var resultsubpractice = "";
            IsCP = "";
            if (RMOSuperUserFlag == "1") {
                getSubpracticeURL = "../_api/web/lists/getbytitle('RMOSubPracticeHead')/items?$select=SubPractice&$filter=Active eq'Yes'&$orderby=SubPractice asc";
                //site_url + "_api/Skills?$select=Sub_Practice&$orderby=Sub_Practice asc";
                resultsubpractice = resultset(getSubpracticeURL);
            } else {
                getSubpracticeURL = "../_api/web/lists/getbytitle('RMOSubPracticeHead')/items?$select=SubPractice&$filter=Active eq'Yes' and PracticeLeadId eq'" + LoginUserID + "' or PraticeLead2Id eq'" + LoginUserID + "' or PracticeHeadId eq'" + LoginUserID + "'&$orderby=SubPractice asc";
                resultsubpractice = resultset(getSubpracticeURL);
                if (resultsubpractice.length == 0) {
                    getProjectsURL = site_url + "_api/Projects?$select=ProjectName,ProjectCode&$filter=ProjectOwnerId eq guid'" + currentuserGUID + "' or substringof('" + currentuserEmployeeId + "',ClientPartner) or PracticeLead2 eq'" + currentuseremail + "' or PracticeHead eq'" + currentuseremail + "'&$orderby=SubPractice asc";
                    resultsubpractice = resultset(getProjectsURL);
                    IsCP = "1";
                }
            }
            // resultsubpractice = resultset(getSubpracticeURL);
            var unique = {};
            var distinct = [];
            for (var index in resultsubpractice) {
                if (RMOSuperUserFlag == "1") {
                    if (typeof (unique[resultsubpractice[index].SubPractice]) == "undefined") {
                        distinct.push(resultsubpractice[index].SubPractice);
                    }
                    unique[resultsubpractice[index].SubPractice] = 0;
                } else {
                    if (IsCP == "1") {
                        distinct.push(resultsubpractice[index]);
                    } else {
                        if (typeof (unique[resultsubpractice[index].SubPractice]) == "undefined") {
                            distinct.push(resultsubpractice[index].SubPractice);
                        }
                        unique[resultsubpractice[index].SubPractice] = 0;
                    }
                }
            }
            $("#ddlRolewiseSubPractice").append("<option value='All'>All</option>").val('Select');
            if (IsCP == "1") {
                $.each(distinct, function (val, text) {
                    $('#ddlRolewiseSubPractice').append($('<option></option>').val(text.ProjectCode).html(text.ProjectName));
                });
            } else {
                $.each(distinct, function (val, text) {
				if(text=="Global Practices-Value Management Services" || text=="ISV Management")
				{
				}
				else{
                    $('#ddlRolewiseSubPractice').append($('<option></option>').val(text).html(text));
                    allSubpractice = allSubpractice != "" ? allSubpractice + ";" + text : text;
					}
                });
            }
        }

        function resultset(Url) {
            var result;
            $.ajax({
                url: Url,
                async: false,
                method: "GET",
                headers: {
                    "Accept": "application/json; odata=verbose",
                    "Content-Type": "application/json; odata=verbose"
                },
                success: function (data) {
                    result = data.d.results;
                },
                error: function (error) {
                    result = 'error';
                }
            });
            return result;
        }

        function GotoSelectedReports() {
            var reportsType = document.getElementById('ddlReports').value;
            if (reportsType == "BenchReports") {
                window.open('https://bristleconeonline.sharepoint.com/RMORevamp/Pages/BenchReport.aspx');
            } else if (reportsType == "UtilizationReports") {
                window.open('https://bristleconeonline.sharepoint.com/RMORevamp/Pages/Utilization.aspx');
            } else if (reportsType == "TimesheetReports") {
                window.open('https://bristleconeonline.sharepoint.com/RMORevamp/Pages/Timesheet.aspx');
            } else if (reportsType == "TimesheetComplianceReports") {
                window.open('https://bristleconeonline.sharepoint.com/RMORevamp/Pages/SPUC.aspx');
            }
        }

        function GetfulfilledWithdrawCount(subpracticeURLPara) {
            if (Counter == 1) {
                fulfilledCount = 0;
                withdrawnCount = 0;
                var subpracticeRRF = $("#ddlRolewiseSubPractice option:selected").text(); //document.getElementById('ddlRolewiseSubPractice').value;
               // if (currentuserRole == "RMO") { 
                if (currentuserRole == "RMO" || currentuserRole == "Practice Head") {
                    if (subpracticeURLPara == "" || subpracticeRRF == "All") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Fulfilled' or Status eq 'Internally Fulfilled' or Status eq 'Externally Fulfilled' or Status eq 'Withdrawn' or Status eq 'Rejected') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(((Status eq 'Fulfilled') or (Status eq 'Internally Fulfilled') or (Status eq 'Externally Fulfilled') or (Status eq 'Withdrawn') or (Status eq 'Rejected')) and (" + subpracticeURLPara + ") and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A'))&$Top=100000&$orderby=ID%20desc";
                    }
                } else if (IsCP == "1") {
                    if (subpracticeURLPara != "") {
                        url = url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Fulfilled' or Status eq 'Internally Fulfilled' or Status eq 'Externally Fulfilled' or Status eq 'Withdrawn' or Status eq 'Rejected') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A') and (ClientPartnerUser eq '" + LoginUserID + "') and " + subpracticeURLPara + "&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Fulfilled' or Status eq 'Internally Fulfilled' or Status eq 'Externally Fulfilled' or Status eq 'Withdrawn' or Status eq 'Rejected') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A') and (ClientPartnerUser eq '" + LoginUserID + "')&$Top=100000&$orderby=ID%20desc";
                        //"../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=Status eq 'Fulfilled' and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
                    }
                } else {
                    if (subpracticeURLPara != "") {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(((Status eq 'Fulfilled') or (Status eq 'Internally Fulfilled') or (Status eq 'Externally Fulfilled') or (Status eq 'Withdrawn') or (Status eq 'Rejected')) and (" + subpracticeURLPara + ")) and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    } else {
                        url = "../_api/web/lists/getbytitle('RRF')/items?$select=InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Fulfilled' or Status eq 'Internally Fulfilled' or Status eq 'Externally Fulfilled' or Status eq 'Withdrawn' or Status eq 'Rejected') and (EmployeeRole ne 'Intern' and EmployeeRole ne 'Investment' and EmployeeRole ne 'Senior Management' and EmployeeRole ne 'SG%26A')&$Top=100000&$orderby=ID%20desc";
                    }
                }
                $.ajax({
                    url: url,
                    method: "GET",
                    async: false,
                    headers: {
                        "Accept": "application/json; odata=verbose"
                    },
                    success: function (data) {
                        $.each(data.d.results, function (key, value) {
                            if (value.Status == "Fulfilled" || value.Status == "Internally Fulfilled" || value.Status == "Externally Fulfilled") {
                                fulfilledCount++;
                            } else if (value.Status == "Withdrawn" || value.Status == "Rejected") {
                                withdrawnCount++;
                            }
                        });
                        document.getElementById('rrffulfilledcount').innerHTML = fulfilledCount;
                        document.getElementById('rrfwithdrawncount').innerHTML = withdrawnCount;
                    }
                });
            }
        }
		
		function saveComment() {
        $('.loader').show();
        setTimeout(function () {
            saveCommentDate();
            $('.loader').hide();
        }, 100);

    }
	
	function saveCommentDate() {
        var comment = document.getElementById('TxtAria_Comment').value;
        if (comment.trim() == "") {
            $('#TxtAria_Comment').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });

            document.getElementById("commentAlert").innerHTML = "Please Enter the Comment";
            document.getElementById("TxtAria_Comment").focus();
            return false;
        }
        else {
            var match = (new RegExp('[/:~#%\&{}+\|<>*]|\'\|\\\\|^\\|\\$')).test(comment);
            if (match) {
                return false;

            } else {


                $('#TxtAria_Comment').css({

                    "border": "",
                    "background": ""
                });
                document.getElementById("commentAlert").innerHTML = "";
                var Flag = "2";
                insertProjectComment(comment, Flag, "", "");

            }
        }
    }
	
	function insertProjectComment(comment, Flag, RRFNumber, ResourceID, LogType) {
        var item = {
            __metadata: { "type": "SP.Data.RRFTransactionDetailsListItem" }
        };
        if (RRFNumber == "") {
            $.extend(item, { ProjectGUID: LogProjectGUID });
            $.extend(item, { Comment: comment });
            $.extend(item, { Flag: Flag });
            $.extend(item, { Name: LoginUserName });
            $.extend(item, { RRFListItemId: RRFRowID });
            if (Flag == "1") {
                Type = "";
                if (pageStatus == "RRF Saved") {
                    Type = "RRF Initiated";
                }
                else {
                    Type = pageStatus;
                }
                if (LogType == "RMO") {
                    Type = "Resource Proposed (RMO)"
                    $.extend(item, { LogType: Type });
                }
                else if (LogType == "PM") {
                    Type = "Resource Proposed (Initiator)"
                    $.extend(item, { LogType: Type });
                }
                else if (LogType == "ExternalRMO") {
                    $.extend(item, { LogType: "RMO Validation (Initiated External Hiring)" });
                }
                else if (LogType == "ExternalRMOProposed") {
                    $.extend(item, { LogType: "Resource Proposed (Initiated External Hiring)" });
                }
                else if (LogType == "ExternalApproved") {
                    $.extend(item, { LogType: "FPNA (Approved External Hiring)" });
                }
                else {
                    $.extend(item, { LogType: Type });
                }
                //$.extend(item, { LogType: Type });
            }
        } else {
            $.extend(item, { RRFNO: RRFNumber });
            $.extend(item, { RRFListItemId: RRFRowID });
            $.extend(item, { Comment: comment });
            $.extend(item, { Name: LoginUserName });
            $.extend(item, { ResourceID: ResourceID });
            $.extend(item, { LogType: pageStatus });

        }
        if (WithdrawnRRFFlag == "1") {
            $.extend(item, { LogType: "RRF Withdrawn" });
        }
		else if(Flag == "3" && LogType == "Resource Rejected")
		{
			
			$.extend(item, { LogType: "Resource Rejected" });
			
		}		
		else if (Flag == "3") {
            $.extend(item, { LogType: "RRF Rejected" });
        }
		
        $.ajax({
            url: "../_api/Web/Lists/GetByTitle('RRFTransactionDetails')/items",
            type: "POST",
            contentType: "application/json;odata=verbose",
            data: JSON.stringify(item),
            async: false,
            headers: {
                "Accept": "application/json;odata=verbose",
                "X-RequestDigest": $("#__REQUESTDIGEST").val()
            },
            success: function (data) {

                if (HiddenFlag != "1") {
                    if (RRFNumber != "") {
                        $('.Toppopup-bg').hide();
                    } else {
                        $('.popup-bg').hide();
                    }
                }

                HiddenFlag = "";
            },
            error: function (error) {
                if(JSON.stringify(error)==TimedOutPopuperror)
                {
                    alert("oops! something went wrong. please refresh the page and try again");
                    window.location.href=window.location.href;
                    return false;
                }
                else{
                    alert(JSON.stringify(error));
                }
            }
        });

    }
	
	 
	
	  $('#TxtAria_Comment').keypress(function (e) { 
			 var k = e.keyCode; 
             if ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 46 || k == 44 || k == 32 || k == 13 || (k >= 48 && k <= 57)) { 

                 $('#errjobdescriptionmsg').css('display', 'none'); 
				 document.getElementById("commentAlert").innerHTML = "";
                 return true; 

             } else { 
                 $('#errjobdescriptionmsg').css('display', 'block'); 
				 document.getElementById("commentAlert").innerHTML = "";
                 e.preventDefault(); 
                 return false; 
             } 


         }); 
		 
	
    </script>
</body>

</html><html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><meta name="Robots" content="NOINDEX " /></head><body></body>
                <script type="text/javascript">
                 var gearPage = document.getElementById('GearPage');
                 if(null != gearPage)
                 {
                     gearPage.parentNode.removeChild(gearPage);
                     document.title = "Error";
                 }
                 </script>
                 </html>
<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="description" content="Font Awesome, the iconic font and CSS framework">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>RMO</title>
    <!-- <link rel="stylesheet" href="../SiteAssets/RMO/css/style.css"> -->
	<link rel="stylesheet" href="../SiteAssets/RMO/css/style1.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/bootstrap.min.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/CSS/jquery-ui.css" type="text/css" />
    <link rel="stylesheet" href="../SiteAssets/RMO/css/font-awesome.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/sumoselect.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/buttons.dataTables.min.css">
    <link rel="stylesheet" href="../SiteAssets/RMO/css/jquery.mCustomScrollbar.css">

    <script src="../SiteAssets/RMO/js/jquery-1.11.1.min.js"></script>
    <script src="../SiteAssets/RMO/js/RRFConfig.js"></script>
    <script src="../_layouts/15/callout.js"></script>
    <!--<script src="../SiteAssets/RMO/js/jquery.min.js"></script>-->
    <script src="../SiteAssets/RMO/js/jquery-ui.js"></script>
    <script src="../SiteAssets/RMO/js/jquery.sumoselect.js"></script>
    <script src="../SiteAssets/RMO/js/bootstrap.min.js"></script>
    <script src="../SiteAssets/RMO/js/jquery.dataTables.min.js"></script>
    <script src="../SiteAssets/RMO/js/dataTables.bootstrap.min.js"></script>
    <script src="../SiteAssets/RMO/js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="../SiteAssets/RMO/js/SearchResource.js"></script>


    <!-- Export to excel js file start -->
    <script src="../SiteAssets/RMO/js/dataTables.buttons.min.js"></script>
    <script src="../SiteAssets/RMO/js/buttons.flash.min.js"></script>
    <script src="../SiteAssets/RMO/js/jszip.min.js"></script>
    <script src="../SiteAssets/RMO/js/pdfmake.min.js"></script>
    <script src="../SiteAssets/RMO/js/vfs_fonts.js"></script>
    <script src="../SiteAssets/RMO/js/buttons.html5.min.js"></script>
    <script src="../SiteAssets/RMO/js/buttons.print.min.js"></script>
    <!-- Export to excel js file end  -->

</head>
<style>
    #divRejectBody table, #tblResources_filter {
        width: 100% !important;
    }

    .SumoSelect > .CaptionCont {
        height: 30px;
    }

    .horizontalcontent-2 {
        width: 98%;
        overflow: auto;
        margin: 0 auto;
        position: absolute;
    }

    .horizontalcontent-3 {
        width: 100%;
        overflow: auto;
    }

    #RRFForm th:last-child {
        min-width: 85px !important;
    }

    #RRFForm th:nth-child(2) {
        max-width: 50px !important;
    }
	
	div[id*="_paginate"],div[id*="_filter"]{position: absolute;right:31px;}
	div[id*="_wrapper"]{padding-bottom: 40px;}
	
	/ The Modal (background) /
.modal {
  display: none; / Hidden by default /
  position: fixed; / Stay in place /
  z-index: 1; / Sit on top /
  padding-top: 150px; / Location of the box /
  left: 0;
  top: 0;
  width: 100%; / Full width /
  height: 100%; / Full height /
  overflow: auto; / Enable scroll if needed /
  background-color: rgb(0,0,0); / Fallback color /
  background-color: rgba(0,0,0,0.4); / Black w/ opacity /
}

/ Modal Content /
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 10px;
  border: 5px solid #888;
  width: 50%;
  text-align: center;
  margin-top: 50%;
}
.action-b-view {
    left: 43px;
    top: 0px;
  
}
	
</style>
<body>
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <p style="font-size: large;">Kindly use IE (Version 11 and above) or Chrome (Version 59 and above) in Laptop or Desktop to access PPM</p>
  </div>

</div>
    <div class="loader" style="display: block;"></div>
    <div class="breadcrumb-new">
        <ul>
            <li><a href="../default.aspx">Home</a> </li>
            <li><a style="cursor: default; text-decoration: none; color: #272727;">My RRF</a> </li>
            <li id="status"></li>
        </ul>
        <div class="resource-ext pull-right">
            <ul>
                <li class="active"><a href='../SitePages/RRFResourceApprovalPage.aspx' target='_blank'>resource extension / early release</a><span class="red-count" id='rrfresourceextension'></span></li>
            </ul>

        </div>
        <div class="clearfix"></div>
    </div>
    <!-----------Breadcrumb End---------->
    <div class="contain-div" style="position: absolute; width: 100%">

        <div class="clearfix"></div>
        <div class="clearfix"></div>
        <!-- <span class="btn-a"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span><span id="A1" onclick="CalloutManager.closeAll();CoreInvoke('createNewDocumentWithProgIDEx',event,'https:\u002f\u002fbristleconeonline.sharepoint.com\u002fsites\u002fDev\u002fTestcustomForm\u002fForms\u002fTemplate10.dotm', 'https:\u002f\u002fbristleconeonline.sharepoint.com\u002fsites\u002fDev\u002fTestcustomForm', 'SharePoint.OpenDocuments', false, 'ms-word')">Create New RRF</span></span><span class="btn-a"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span><span id="A1" onclick="CalloutManager.closeAll();CoreInvoke('createNewDocumentWithProgIDEx',event,'https:\u002f\u002fbristleconeonline.sharepoint.com\u002fsites\u002fDev\u002fTestcustomForm\u002fForms\u002fTemplate10.dotm', 'https:\u002f\u002fbristleconeonline.sharepoint.com\u002fsites\u002fDev\u002fTestcustomForm', 'SharePoint.OpenDocuments', false, 'ms-word')">Create New RRF</span></span> -->
        <span class="btn-a"><span class="glyphicon glyphicon-plus" aria-hidden="true"><a href='../SitePages/ResourceRequestForm.aspx' target='_blank'>Create New RRF</a></span></span>
        <div class="stage pull-right">
            <ul>
                <li onclick="refine_status('rrfnonbillable','Non Billable')"data-toggleNB='tooltip' title='All RRFs other than Billable Consultants can be viewed/actioned here'>Non Billable<span class="red-count" id="rrfnonbillable"></span></li>
                <li class="active" onclick="refine_status('allrecord','All Records')" data-toggleAR='tooltip' title='All RRFs for Billable Consultants at various stages (except Internally Fulfilled & Withdrawn/Rejected). This is a view tab only and no action can be taken'>all records<span class="red-count" id="rrfallrecordcount"></span></li>
                <li onclick="refine_status('rrfsaved','Saved RRF')" data-toggleSR='tooltip' title='All RRFs in Saved (not submitted) can be seen and actioned here. Only Requestor can take action needed on these Saved RRFs'>saved rrf<span class="red-count" id="rrfsavedcount"></span></li>
                <li onclick="refine_status('rmovalidation','RMO Validation')"data-toggleRV='tooltip' title='Submitted RRFs, pending with RMO for internal sourcing or moving for hiring are visible here'>rmo validation <span class="red-count" id="rrfrmovalidationcount"></span></li>
                <li onclick="refine_status('resourceproposed','Resource Proposed')"data-toggleRP='tooltip' title='Internal resources proposed by RMO and awaiting PM responses can be seen here'>resource proposed<span class="red-count" id="rrfresourceproposedcount"></span></li>
                <li onclick="refine_status('resourceselection','Resource Allocation')"data-toggleRA='tooltip' title='RRFs where resources identified and to be allocated are listed here'>resource allocation<span class="red-count" id="rrfresourceselectioncount"></span></li>
				<li onclick="refine_status('fpnapproval','FP&A Approval')"data-toggleFPNA='tooltip' title='RRFs submitted and with FP&A for approval '>fp&a Approval<span class="red-count" id="rrffpnaapproval"></span></li>
                <li onclick="refine_status('fulfilled','7')"data-toggleIF='tooltip' title='RRFs fulfilled with internal resources are visible here'>Internally Fulfilled<span class="red-count" id="rrffulfilledcount"></span></li>
                <li onclick="refine_status('externalhiring','External Hiring')"data-toggleEH='tooltip' title='RRFs moved for Hiring into Work Day and at various stages of hiring are visible here'>external hiring<span class="red-count" id="rrfexternalhiring"></span></li>
				<li onclick="refine_status('withdrawn','Withdrawn/Rejected')"data-toggleW='tooltip' title='RRFs which are withdrawn/rejected at various stages'>withdrawn/rejected<span class="red-count" id="rrfwithdrawncount"></span></li>
				<li onclick="refine_status('externnallyfullfilled','Externally Fullfilled')"data-toggleW='tooltip' title='RRFs which are Externally fullfilled are visible here(Billable and nonbillable)'>Externally Fullfilled<span class="red-count" id="rrfextfullfilled"></span></li>
            </ul>
        </div>
        <div class="clearfix"></div>
        <div class="container-fluid">
            <div class="horizontalcontent-3">
                <table id="RRFForm" class="display nowrap">
                </table>
            </div>
        </div>
    </div>

    <!------------------------
   Alert Message
   -------------------------->


    <div class="popup-bg-alert" style="display: none">
        <div class="popup">
            <div class="popup-head">
                <div class="panel-head ">
                    <h4 class="alertmessage" style="display: none"></h4>
                </div>

                <div class="clear"></div>
            </div>
            <div class="popup-boday text-center">
                <label id="withdrawnrejectdata" style="display: none"></label>
                <br />
                <input type="button" value="OK" class="btn btn-primary a-close" />

            </div>
        </div>
    </div>



    <!-----------------------------
		POPUP START
        ------------------------------>
    <div class="popup-bg">
        <div class="popup">
            <div class="popup-head">
                <div class="panel-head pull-left">
                    <h4 class="clssPopupHead"></h4>
                </div>
                <div class="right-pol">
                    <div class="p-close">x</div>
                </div>
                <div class="clear"></div>
            </div>
            <div class="popup-boday">
                <div id="divApproveBody" style="display: none">
                    <div class="allbtn">
                        <input class="btn btn-primary" type='Button' value="Yes" onclick="submitRRF()" />
                        <input class="btn btn-primary" type='Button' value="No" onclick="closePopUp()" />
                    </div>
                </div>
				<div id="divstartdatepopup" style="display: none">
                    <div class="allbtn">
                        <input class="btn btn-primary" type='Button' value="Yes" onclick="closePopUp5()" />
                        <input class="btn btn-primary" type='Button' value="No" onclick="OpenCreateForm()" />
                    </div>
                </div>
                <div id="divExternalMsg" style="display: none" class="text-center">
                    <div class="allbtn">
                        <input class="btn btn-primary" type='Button' value="OK" onclick="closePopUp()" />
                    </div>
                </div>
				
                <div id="divExternalMsgApproval" style="display: none" class="text-center">
                    <div class="allbtn">
                        <input class="btn btn-primary" type='Button' value="Yes" onclick="InitinateExternal()" />
                        <input class="btn btn-primary" type='Button' value="No" onclick="closePopUp()" />
                    </div>
                </div>
                <div id="divExternalFPNAMsgApproval" style="display: none" class="text-center">
                    <div class="allbtn">
                        <input class="btn btn-primary" type='Button' value="Yes" onclick="ApprovedExternal()" />
                        <input class="btn btn-primary" type='Button' value="No" onclick="closePopUp()" />
                    </div>
                </div>
                <div id="divRejectBody" style="display: none">
                    <div style="width: 600px" class="VScroll">
                        <table class="tabledivnew">
                            <tbody>
									  <tr><label style="padding: 15px;">Please Provide Reason <span style="color: red">*</span></label>
                                        <select id="ddlregion" style="width:300px; height: 30px;" onclick="showRejectionpopup();" onchange="hiderrforddl();">
                                        
                                           <!--  <div id="errorMsgddlReason" style="color: red;"></div> -->
                                            <option>
                                                
                                            </option>
                                        </select>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <span id="errorMsgddlReason" style="color: red;"></span>
                                        </td>
                                    </tr><br>
                                <tr>
                                    <td colspan="2" style="width: 195px;">
                                        <textarea rows="4" class="form-control" cols="45" id="Txt_Comment" onkeyup="hideerrormsg(this)" maxlength="500"></textarea>
                                        <br>
                                        <sup style="color: #ababab; font-size: 12px;">(Max 500 characters and these special characters are not allowed \ " / : ; | ? ' < > * # ~ % & { } + ,(period))</sup>
										<span class="error" id="errjobdescriptionmsg2">Special Characters are not allowed (\ " / : ; | ? ' < > * # ~ % & { } + ,(period))</span>
                                    </td>
                                </tr>


                                <tr>
                                    <td colspan="2">
                                        <span id="AlertMsg" style="color: red;"></span>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        <div class="pull-right">
                            <input class="btn btn-danger" id="rejectid" type='Button' value="Reject" onclick="rejectRequest()" />


                        </div>
                        <div class="clearfix"></div>
                        <label id="rejectdata"></label>

                    </div>
                </div>
                <!----divRejectBody----->
                <div id="divComment" style="display: none">
                    <div style="width: 600px" class="VScroll">
                        <table class="tabledivnew">
                            <tbody>

                                <tr>
                                    <td colspan="2" style="width: 195px;">
                                        <textarea rows="4" class="form-control" cols="45" id="TxtAria_Comment"  maxlength="500"></textarea>
                                        <br>
                                        <sup style="color: #ababab; font-size: 12px;">(Max 500 characters and these special characters are not allowed \ " / : ; | ? ' < > * # ~ % & { } + ,(period))</sup>
										<span class="error" id="errjobdescriptionmsg">Special Characters are not allowed (\ " / : ; | ? ' < > * # ~ % & { } + ,(period))</span>
                                    </td>
                                </tr>


                                <tr>
                                    <td colspan="2">
                                        <span id="commentAlert" style="color: red;"></span>

                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        <div class="pull-right">
                            <input class="btn btn-success" type='Button' value="Save" onclick="saveComment()" />

                        </div>
                        <div class="clearfix"></div>
                        <label id="commentdata" class='pull-left'></label>
                    </div>
                </div>
                <!--------divComment--------->
                <div id="divSearchResource" style="display: none">

                    <div style="width: 1090px" class="VScroll ">
                        <div id="divSkillInfo" style="display: none; width: 100%" class="AddResource">
                            <div class="col-md-2">
                                <label>Primary Skill</label>
                            </div>
                            <div class="col-md-2">
                                <select class="form-control mx-sm-3 row" id="ddlPrimarySkill"></select>
                            </div>
                            <div class="col-md-2">
                                <label>Secondary Skill</label>
                            </div>
                            <div class="col-md-2">
                                <select class="form-control mx-sm-3 row" id="ddlSecondrySkill"></select>
                            </div>
                            <div class="col-md-1">
                                <label>Role Band</label>
                            </div>
                            <div class="col-md-2">
                                <select class="form-control mx-sm-3" id="ddlRoleband"></select>
                            </div>


                            <div class="col-md-1">
                                <button type="button" class="btn btn-success row" onclick="searchResourceOnSkill();">
                                    <span class="glyphicon glyphicon-search"></span>Search
                                </button>

                            </div>

                            <div class="clearfix"></div>
                        </div>
                        <h3 id="softblockHead" style="display: none">Soft-Block Resource</h3>
                        <div id="SoftBlockResource" class="softblock" style="display: none">
                            <div class="col-md-1" style="width: 100px">Start date</div>
                            <div class="col-md-2">
                                <div class="date">
                                    <input type="text" class="form-control mx-sm-3 strtDt" id="sftblckstartDt" />
                                </div>
                                <div id="errsftblckstartDt" class="error">Start Date is required</div>
                            </div>
                            <div class="col-md-1">End date</div>
                            <div class="col-md-2">
                                <div class="date">
                                    <input type="text" class="form-control mx-sm-3 endDt" id="sftblckendDt" />
                                </div>
                                <div id="errsftblckendDt" class="error">End Date is required</div>
                            </div>
                            <div class="col-md-4 action">
                                <input type="button" class="btn btn-primary" id="btnSoftblock" value="Save Soft-Block" onclick="resourceSoftblock()" />
                                <a href="#"><span class="glyphicon glyphicon-ok-sign" id="btnSoftblockOK" style="font-size: 21px; display: none; vertical-align: sub"></span></a>
                                <br />
                                <div id="errMsgSvaeSoftBlock" class="error">Please select resource for Soft-Block</div>

                            </div>

                            <div class="clear"></div>
                        </div>
                        <div class="horizontalcontent-3">
                            <table id="tblResources" class="nowrap" style="width: 100%;">
                            </table>
                        </div>

                        <div id="divmsgNoresource" style="display: none">
                            <p>
                                There is no Resources
                            </p>
                        </div>

                    </div>
                    <div class="col-sm-12"></div>
                    <div class="col-sm-12">
                        <div class="pull-right">
                            <input class="btn btn-success" type='Button' id="btnResorceSave" value="Save" onclick="RRFSaveResource()" />

                        </div>
                        <div id="errMsgSaveResourcevalidaion" class="error">Please select resource for save</div>
                        <div class="clearfix"></div>
                    </div>
                </div>
                <!-------divSearchResource------>
                <div id="divViewLog" style="display: none">
                    <div style="width: 600px" class="VScroll">
                        <div id="logdata">
                        </div>
                        <div class="pull-right">
                        </div>
                        <div class="clearfix"></div>
                    </div>
                </div>
                <!-------divViewLog-------->
                <div class="clear"></div>
            </div>

        </div>
    </div>

    <div class="Toppopup-bg">
        <div class="Toppopup">
            <div class="Toppopup-head">
                <div class="Toppanel-head">
                    <h4 class="TopclssPopupHead pull-left"></h4>
                    <div class="right-pol">
                        <div class="T-close">x</div>
                    </div>
                    <div class="clear"></div>
                </div>

            </div>
            <div class="Toppopup-boday">
                <div id="divResourceApproval" style="display: none">
                    <span id="empIdResourceSelection" style="visibility: hidden"></span>
                    <div class="allbtn">
                        <input class="btn btn-primary" type='Button' value="Yes" onclick="ResourceApproveForSelection()" />
                        <input class="btn btn-primary" type='Button' value="No" onclick="closePopUp()" />

                    </div>
                </div>
                <div id="divResourceRejection" style="display: none; width: 600px">

                    <div class="col-xs-1">
                        <p><span class='glyphicon glyphicon-remove-sign' aria-hidden='true' style="font-size: 20px;"></span></p>
                    </div>
                    <div class="col-xs-11">
                        <div>
                            <p style="text-align: left">Proposed Resource <span id="empIDName"></span>is being rejected by you. Please Provide reason of rejection.<span id="ProjecDetails" style="visibility: hidden"></span></p>
                            <div class="col-md-4">
                                <div class="row">
                                    <label>Reason of Rejection <span class="mandatory">*</span></label>
                                </div>
                            </div>
                            <div class="col-md-8 ">
                                <div class="row">
                                    <select id="ddlRejectionReason" class="form-control" onchange="validReason()"></select>

                                    <div id="errorMsgddlReason" style="color: red;"></div>
                                </div>
                            </div>
                            <br />
                            <textarea rows="4" class="form-control" cols="45" id="TextareaResourceReject"  maxlength="500" style="width: 100%"></textarea>
                            <br>
                            <sup style="color: #ababab; font-size: 12px;">(Max 500 characters and these special characters are not allowed \ " / : ; | ? ' < > * # ~ % & { } + ,(period))</sup>
										<span class="error" id="errjobdescriptionmsg1">Special Characters are not allowed (\ " / : ; | ? ' < > * # ~ % & { } + ,(period))</span>
                            <div><span id="ResourceRejecterrormsg" style="color: red;"></span></div>
                        </div>
                        <div class="allbtn">
                            <input class="btn btn-danger" type='Button' value="Reject" onclick="RejectResources()" />

                        </div>
                    </div>



                </div>
                <div id="divResourceComment" style="display: none">
                    <div style="width: 600px" class="VScroll">
                        <textarea rows="4" class="form-control" cols="45" id="TextareaResourceComment"  maxlength="500" style="width: 500px"></textarea>
                        <br>
                        <sup style="color: #ababab; font-size: 12px;">(Max 500 characters and these special characters are not allowed \ " / : ; | ? ' < > * # ~ % & { } + ,(period))</sup>
										<span class="error" id="errjobdescriptionmsg5">Special Characters are not allowed (\ " / : ; | ? ' < > * # ~ % & { } + ,(period))</span>
                        <div><span id="errorMsgComment" style="color: red;"></span></div>
                        <div class="allbtn">
                            <input class="btn btn-success" type='Button' value="Save" onclick="ResourcesCommentSubmit()" />

                        </div>
                        <span id="resourceCommentSpan" style="visibility: hidden"></span>
                        <div class="clear"></div>

                        <label id="resourceCommetdata" class='pull-left'></label>
                    </div>
                </div>

                <div id="divResourceAssignment" style="display: none">

                    <div style="width: 750px" class="VScroll">
                        <div id="resourceInfo" style="display: none">
                            <div class="col-md-3">
                                <label>Employee Name</label>
                            </div>
                            <div class="col-md-3">
                                <select id="ddlResourceName" class="search-box form-control mx-sm-3" onchange="bindSelectedResourceData();"></select>
                            </div>
                            <div class="col-md-3">
                                <label>Employee ID</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtResourceID" readonly="readonly" class="form-control mx-sm-3" />
                            </div>
                        </div>
                        <div class="clear"></div>
                        <h3>Project Information</h3>
                        <div id="ProjectInfo">

                            <div class="col-md-3">
                                <label>Project Name</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtProjectName" class="form-control mx-sm-3" readonly="readonly">
                            </div>
                            <div class="col-md-3">
                                <label>Project Code</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtProjectCode" class="form-control mx-sm-3" readonly="readonly">
                            </div>
                            <div class="col-md-3">
                                <label>Project Manager</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtProjectManager" class="form-control mx-sm-3" readonly="readonly">
                            </div>
                            <div class="col-md-3">
                                <label>Client Partner</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtclientPertner" class="form-control mx-sm-3" readonly="readonly">
                            </div>
                            <div class="col-md-3">
                                <label>RMO SPOC</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtResourcemanager" class="form-control mx-sm-3" readonly="readonly">
                            </div>
                            <div class="col-md-3">
                                <label>Base Location</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtPLocation" class="form-control mx-sm-3" maxlength="100" onkeyup="removeErrorMsgResourceAssignment()">
                                <div id="errMsgLocation" class="error">Location is required</div>
                            </div>
							<div class="col-md-3">
                                    <label>Contract Type </label>
                                </div>
                            <div class="col-md-3">
                                   <input type="text" id="txtContractType" class="form-control mx-sm-3" readonly="readonly">
                            </div>
                            <div class="clearfix"></div>
                        </div>

                        <h3>Resource Information</h3>

                        <div id="ResourceInformation">
                            <div class="col-md-3">
                                <label>Allocation%</label>
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="txtAllocation" class="form-control mx-sm-3 classAllocation" onkeyup="removeErrorMsgResourceAssignment()">
                                <div id="errtxtAllocation" class="error">Allocation % is required</div>
                            </div>
                            <div class="col-md-3">
                                <label>Employee Role</label>
                            </div>
                            <div class="col-md-3">
                                <!-- <select id="ddlBillability" class="form-control mx-sm-3 ddlBillability">
                                </select> -->
                                <input type="text" id="txtEmployeeRole" class="form-control mx-sm-3 txtEmployeeRole" readonly="readonly">
                                <div id="errddlBillability" class="error">Employee Role is required</div>
                            </div>
                            <div class="clear"></div>
                            <div class="col-md-3">
                                <label>Allocation Start Date</label>
                            </div>
                            <div class="col-md-3">
                                <div class="date">
                                    <input type="text" id="txtstrtDt" class="form-control mx-sm-3 strtDt">
                                </div>
                                <div id="errtxtstrtDt" class="error">Allocation Start Date is required</div>
                            </div>
                            <div class="col-md-3">
                                <label>Allocation End Date</label>
                            </div>
                            <div class="col-md-3">
                                <div class="date">
                                    <input type="text" id="txtendDt" class="form-control mx-sm-3 endDt">
                                </div>
                                <div id="errtxtendDt" class="error">Allocation End Date is required</div>
                            </div>
                            <div class="clear"></div>
                            <div class="col-md-3">
                                <label>Type Of Assignment</label>
                            </div>
                            <div class="col-md-4">
                                <select class="form-control mx-sm-3" id="ddlAssignmentTyp">
                                    <option value="BCONE LOCATION">BCONE LOCATION</option>
                                    <option value="CLIENT LOCATION">CLIENT LOCATION</option>
                                    <option value="Both">BOTH</option>
                                </select>

                            </div>

                            <div class="col-md-5 action">
                                <input type="button" class="btn btn-primary" value="Check Availability" id="btncheckAvailbility" onclick="checkResourceAvailbility(this);" />
                                <a href="#"><span class="glyphicon glyphicon-ok-sign" id="Availabilitysign" style="display: none;"></span><span id="Availabilityvalue" style="visibility: hidden"></span></a>
                                <a href="#"><span id="ShowAddResource" class="glyphicon glyphicon-plus" onclick="BindResourceInfoDiv()"></span></a>
                                <a href="#"><span id="removeaddResource" style="display: none" class="glyphicon glyphicon-minus" onclick="RemoveResourceInfoDiv()"></span></a>
                                <div id="AvailbilityErrMsg" class="error" style="font-size: 11px;">Please check Resource Availbility</div>
                            </div>
                            <div class="clear"></div>
                        </div>

                        <h3>Other Information</h3>
                        <div id="OtherInfo">
                            <div class="col-md-3">
                                <label>Additional Email</label>
                            </div>
                            <div class="col-md-9">
                                <input type="email" id="txtAdditionalEmail" class="form-control mx-sm-3" onchange="removeErrorMsgResourceAssignment();">
                                <div><span id="errMsgEmail" class="error">Email Id is not valid</span></div>
                            </div>
                            <div class="col-md-3">
                                <label>Notes</label>
                            </div>
                            <div class="col-md-9">
                                <textarea rows="4" class="form-control mx-sm-3" cols="45" id="TextareaResourceNote" maxlength="500"></textarea>
                                <br>
                                <sup style="color: #ababab; font-size: 12px;">(Max 500 characters and these special characters are not allowed /:|'<>*#~%&{}+)</sup>
                                <div><span id="errMsgNote" class="error">Invalid comment.Comment contains invalid character</span></div>

                            </div>
                        </div>
                    </div>

                    <div class="allbtn">
                        <input class="btn btn-success" id="btnSaveResource" type='Button' value="Submit" onclick="SaveResourceassignment()" />

                        <span id="rrfnumber" style="visibility: hidden"></span>
                    </div>
                </div>
                <div class="clear"></div>
                <div id="divMultipleAssignment" style="display: none; width: 820px;">
                    <table id="tblMultipleAssignment">
                    </table>

                </div>
            </div>

            <div class="clear"></div>
        </div>
    </div>
    <div class="Alertpopup-bg">
        <div class="Alertpopup">
            <div class="Alertpopup-head">
                <div class="Alertpanel-head">
                    <h4 class="AlertclssPopupHead" style="text-align: center"></h4>
                </div>
                <div class="Alertpopup-boday">
				
					<div id="divMsgOnreject" style="display: none">
                        <p id="RejectMsg">Resource rejected please propose another resource</p>
                        <div class="allbtn" style="text-align: center">
                            <input class="btn btn-default" style="text-align: center" type='Button' value="OK" onclick="RejectResourcesalert();" />
                        </div>
                    </div>
                    <div id="divMsgOnApprove" style="display: none">
                        <p>PM approved the proposed resource. Check the feedback given and allocate as per RRF</p>
                        <div class="allbtn" style="text-align: center">
                            <input class="btn btn-default" style="text-align: center" type='Button' value="OK" onclick="SelectionResourceAlert();" />
                        </div>
                    </div>
                    <div id="divMsgAllocateResource" style="display: none">
                        <p>RMO allocated the selected resource successfully.</p>
                        <div class="allbtn">
                            <input class="btn btn-default" style="text-align: center" type='Button' value="OK" onclick="SelectionResourceAlert();" />
                        </div>
                    </div>
                    <div id="divMsgExternalAlloctaion" style="display: none">
                        <p>Resource is allocated successfully and RRF is Externally Fulfilled</p>
                        <div class="allbtn">
                            <input class="btn btn-default" style="text-align: center" type='Button' value="OK" onclick="ExternalResourceAlert();" />
                        </div>
                    </div>
                    <div id="divMsgSaveValidateResource" style="display: none">
                        <p>Identified resources saved successfully</p>
                        <div class="allbtn">
                            <input class="btn btn-default" style="text-align: center" type='Button' value="OK" onclick="ResourceValidationAlert();" />
                        </div>
                    </div>
                    <div id="divMsgProposedResourceFirst" style="display: none">
                        <p id="propsedMsg">RMO softblocked the selected resources successfully</p>
                        <div class="allbtn">
                            <input class="btn btn-default" style="text-align: center" type='Button' value="OK" onclick="RejectResourcesalert();" />
                        </div>
                    </div>

                </div>
                <div class="clear"></div>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    var table_header = "";
    var table_element = "";
    var url = "";
    var allrecordCount = 0;
    var rrfsavedCount = 0;
    var rmovalidationCount = 0;
    var fpnapprovalCount = 0;
    var resourceproposedCount = 0;
    var resourceselectionCount = 0;
    var fulfilledCount = 0;
    var withdrawnCount = 0;
    var rrfexternalHiring = 0;
    var rrfnonbillable = 0;
    var ResourceTableFlag = "0";
    var CountFlag = 0;
    var TotalCount = 0;
    var BookedCount = 0;
    var FreeCount = 0;
    var RRFFormLength = 5;
    var RRFtblFlag = "0";
    var resourceProjectTableFlag = "0";
    var pageStatus = "";
    var LogProjectGUID = "";
    var LoginUserName = "";
    var txtidIndex = 0;
    var RRFRowID = "";
    //var site_url = "https://ppm.bcone.com/";
	var site_url = getPWAURl();
    var ResourceData = "";
    var ResourceApprovalData = "";
    var resourceListID = "";
    var resourceRRFCount = "";
    var RRF_Number = "";
    var ResourceAllocationFlag = "";
    var chechBoxFlag = "";
    var LoginUserID = "";
    var LoginUserID_for_substring = "";
    var EmployeeRole = "";
    var Counter = 0;
    var GBU = "";
    var Customer = "";
    var NonBillableStatus = "";
    var PrimarySkill = "";
    var SecondrySkill = "";
    var RolBand = "";
    var ResourceAvailbilityCount = "";
    var projectStrtdate = "";
    var projectEndDate = "";
    var RRFEmployeeRole = "";
    var projectName = "";
    var ProLocation = "";
    var ResourceTable = "";
    var MinRevExp = "";
    var ProjectManagerUserId = "";
    var StatusFlag = "";
    var multipleAssignProject_Array = [];
    var softblockFlag = "";
    var NonBillableApproverID = "";
    var RRF_Table = "";
    var indecator_Parameter = [];
    var Projectdetails = "";
    var rrfresourceextension = 0;
    var TATMappingDays = "";
    var currentDate = "";
    var RMOSPOCUserId = "";
    var rrfStartDate = "";
    var rrfEndDate = "";
    var internallyfulfilledFlag = "";
    var RRFCreatedBy = "";
    var LoginUserEmail = "";

    var _MailPendingWith = "";
    var _MailNonApprovers = "";
    var _MailRMOSPOCUserId = "";
    var _MailNewAuthorId = "";
    var _MailClientPartner = "";
    var _MailRRFNO = "";
    var _MailFPNAUserId = "";
    var RRFAuthorId = "";
    var HiddenFlag = "";
    var Past15_Days_date = "";
    var WithdrawnRRFFlag = "";
    var _MailNewProjectManagerId = "";
	var StartDate_ConfirmationValue=0;
	var Hiring_Spoc="";
	var hiringspocmailid="";
    //var popuperror=JSON.stringify({"readyState":4,"responseText":"{\"error\":{\"code\":\"-1, Microsoft.SharePoint.Client.InvalidClientQueryException\",\"message\":{\"lang\":\"en-US\",\"value\":\"Cannot convert a primitive value to the expected type 'Edm.DateTime'. See the inner exception for more details.\"}}}","responseJSON":{"error":{"code":"-1, Microsoft.SharePoint.Client.InvalidClientQueryException","message":{"lang":"en-US","value":"Cannot convert a primitive value to the expected type 'Edm.DateTime'. See the inner exception for more details."}}},"status":400,"statusText":"error"});
    var TimedOutPopuperror = JSON.stringify({ "readyState": 4, "responseText": "{\"error\":{\"code\":\"-2130575252, Microsoft.SharePoint.SPException\",\"message\":{\"lang\":\"en-US\",\"value\":\"The security validation for this page is invalid and might be corrupted. Please use your web browser's Back button to try your operation again.\"}}}", "responseJSON": { "error": { "code": "-2130575252, Microsoft.SharePoint.SPException", "message": { "lang": "en-US", "value": "The security validation for this page is invalid and might be corrupted. Please use your web browser's Back button to try your operation again." } } }, "status": 403, "statusText": "error" });
    //code to display indicator value on datatable page change


    $(document).ready(function () {
	var is_iPad = navigator.userAgent.match(/iPhone/i) != null;
		if(is_iPad == true)
		{
			var modal = document.getElementById('myModal');
			modal.style.display = "block";
		}
        $('[data-toggleNB="tooltip"]').tooltip();
        $('[data-toggleAR="tooltip"]').tooltip();
        $('[data-toggleSR="tooltip"]').tooltip();
        $('[data-toggleRV="tooltip"]').tooltip();
        $('[data-toggleFPNA="tooltip"]').tooltip();
        $('[data-toggleRP="tooltip"]').tooltip();
        $('[data-toggleRA="tooltip"]').tooltip();
        $('[data-toggleIF="tooltip"]').tooltip();
        $('[data-toggleW="tooltip"]').tooltip();
        $('[data-toggleEH="tooltip"]').tooltip();
        $('#errMsgSaveResourcevalidaion').css('display', 'none');
    });


    $(document).on('click', '.paginate_button ', function (event) {

        //get_alerts(parseInt($(this).text(), 10)); //commented as per abhishek instruction
        if (RRFtblFlag == "1") {
            $('#tblResources').on('click', 'tr', function () {
                var oData = oTable.fnGetData(this);
                console.log(oData.ID);
            });

            var activeBtnVal = RRF_Table.page.info().page; //changes by varsha 12-sep
            activeBtnVal = activeBtnVal + 1;
            var last_i = $(this)[0].innerText;
            if (last_i == "Next") {
                last_i = parseInt(activeBtnVal);
            }
            if (last_i == "Previous") {
                last_i = parseInt(activeBtnVal);
            }
            findProjectCode(last_i, RRFFormLength);

        }
        $('#mCSB_3_scrollbar_vertical').css('visibility', 'visible');
        //else {
        //    if (chechBoxFlag == "1") {
        //        bindcheckedResources(RRF_Number);
        //    }

        //}
    });
    // sort disable function


    //code to bind Employee role
    $(document).on('click', '#ShowAddResource ', function () {
        var roleval = document.getElementById('txtEmployeeRole').value;
        $('.txtEmployeeRole').val(roleval);
    });

    //paginate_button.click(function(event){});
    function get_alerts(page) {
        console.log('calling get_alerts');
        $.getJSON('/api/import_preview?p=1', function (data) {
            $('#alerts').empty();
            $.each(data, function (key, val) {
                $('#alerts').append(key);

            });
            populate_pagination(page, data['num_pages'])
        });
    };

    function populate_pagination(current_page, total_pages) {
        var i;
        var page_element;
        $('.pagination').empty();
        for (i = current_page - 5; i < current_page + 5; i++) {
            console.log('i=' + i)
            console.log('current_page=' + current_page)
            if (i > 0 && i <= total_pages) {
                console.log('creating new element');
                page_element = $('<li><a href="#!">' + i + '</a></li>')
                page_element.addClass('waves-effect');
                //page_element.attr('onclick', 'get_alerts('+i+');');
                if (i == current_page) {
                    page_element.addClass('active');
                }
                else {
                    page_element.click(function (event) { get_alerts($(this).text()); });
                }
                $('.pagination').append(page_element);
            };
        };
    };


    $(document).ready(function () {

        currentDate = new Date();
        //code to bind resouces in Resource Search Dropdown in Resource assignment
        url = GetResource();//"https://ppmdev.bcone.com/_api/Resources";
        $.ajax({
            url: url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                $('#ddlResourceName').append(new Option("", 0));
                $.each(data.d.results, function (key, value) {
                    $('#ddlResourceName').append("<option data-value = '" + value["EmployeeID"] + "'>" + value.ResourceName + "</option>");
                })
            }
        });
        //code to searchable DropDpwn
        window.Search = $('.search-box').SumoSelect({ csvDispCount: 3, search: true, placeholder: 'Type Name' });
        Past15_Days_date = Past15_Days();

    });


    $(document).on('click', '.a-close ', function () {
        $('.popup-bg-alert').hide();
    });

    $(document).ready(function () {
        //Get logged in user name
        var CurrentUser = GetCurrentUserData();
        $.getJSON(CurrentUser)
        .done(function (data) {
            LoginUserName = data.Title;
            LoginUserID = data.Id;
            LoginUserID_for_substring = ','+LoginUserID+',';
			LoginUserEmail = data.Email;
            getRRFData();

        });
        setTimeout(function () {
            if (Counter == 0)  //Run the code on Page load 
            {
                var restUrl = "../_api/web/lists/getbytitle('RRF')/items?$select=Status&$Filter=(Status eq 'Fulfilled' or Status eq 'Internally Fulfilled' or Status eq 'WITHDRAWN' or Status eq 'Rejected') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "')or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
                $.ajax({
                    url: restUrl,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        $.each(data.d.results, function (key, value) {
                            if (value.Status == "Fulfilled" || value.Status=="Internally Fulfilled") {
                                fulfilledCount++;
                            }
                            else if (value.Status == "Withdrawn" || value.Status == "Rejected") {
                                withdrawnCount++;
                            }
                            Counter = 1;
                        });
                        document.getElementById('rrffulfilledcount').innerHTML = fulfilledCount;
                        document.getElementById('rrfwithdrawncount').innerHTML = withdrawnCount;
                    }
                });
				var restUrlBillable = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,HiringSpocMail,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,NewAuthor/Title,PendingWith/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,NonBillableFlag,PendingWithId,EmployeeRole,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,PendingWith,NewAuthor&$Filter=(EmployeeRole ne 'Billable' and EmployeeRole ne 'Billable Consultant') and ((Status eq 'VPHR') or (Status eq 'Recruitment Head') or (Status eq 'FPNA') or (Status eq 'Functional Head') or (Status eq 'Non Billable') or (Status eq 'External Hiring')) and ((Status ne 'Withdrawn') or (Status ne 'Rejected') or (Status ne 'Fulfilled') or (Status ne 'Internally Fulfilled') or (Status ne 'Externally Fulfilled')) and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or (PendingWithId eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
				
                //var restUrlBillable = "../_api/web/lists/getbytitle('RRF')/items?$select=PendingWithId,NonBillableFlag,EmployeeRole&$Filter=EmployeeRole ne 'Billable' and (RRFNO ne null) and ((Status eq 'VPHR') or (Status eq 'Recruitment Head') or (Status eq 'FPNA') or (Status eq 'Functional Head') or (Status eq 'Non Billable')) and ((Status ne 'Withdrawn') or (Status ne 'Rejected') or (Status ne 'Fulfilled')) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (PendingWithId eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
                $.ajax({
                    url: restUrlBillable,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        
                            Counter = 1;
                       
                        document.getElementById('rrfnonbillable').innerHTML = data.d.results.length;
                    }
                });

                var restSave = "../_api/web/lists/getbytitle('RRF')/items?$select=ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Filter=(Status eq 'Draft' or Status eq 'RRF Saved') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
                $.ajax({
                    url: restSave,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        $.each(data.d.results, function (key, value) {
                            rrfsavedCount++;
                            Counter = 1;
                        });
                        document.getElementById('rrfsavedcount').innerHTML = rrfsavedCount;
                    }
                });


               /* var restSaveExternalHiring = "../_api/web/lists/getbytitle('RRF')/items?$Filter=Status eq 'Initiated External Hiring' and (RRFNO ne null) and FPNAUserId eq '" + LoginUserID + "'&$Top=100000&$orderby=ID%20desc";
*/
      var restSaveExternalHiring = "../_api/web/lists/getbytitle('RRF')/items?$Filter=(Status eq 'Initiated External Hiring') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "'))&$Top=100000&$orderby=ID%20desc";
                $.ajax({
                    url: restSaveExternalHiring,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        $.each(data.d.results, function (key, value) {
                            fpnapprovalCount++;
                            Counter = 1;// If Counter is one it will not execute for the next time
                            document.getElementById('rrffpnaapproval').innerHTML = fpnapprovalCount;
                            //document.getElementById('lifpnaApproval').style.display = "block";
                        });
                        document.getElementById('rrffpnaapproval').innerHTML = fpnapprovalCount;

                    }
                });


                var restResoruceAllocation = "../_api/web/lists/getbytitle('ResourceAllocationDetails')/items?$filter=PendingWithUserIDStringId eq '" + LoginUserID + "' and ApprovalStatus eq 'Pending'";
                $.ajax({
                    url: restResoruceAllocation,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        $.each(data.d.results, function (key, value) {
                            rrfresourceextension++;
                            Counter = 1;// If Counter is one it will not execute for the next time

                        });
                        document.getElementById('rrfresourceextension').innerHTML = rrfresourceextension;
                    }
                });
				var externallyfullfilled = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Hiring_x0020_Spoc/Title,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,Hiring_x0020_Spoc,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=(Status eq 'Externally Fulfilled') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
                $.ajax({
                    url: externallyfullfilled,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        
                            
                            Counter = 1;// If Counter is one it will not execute for the next time

                       
                       document.getElementById('rrfextfullfilled').innerHTML = data.d.results.length;
                    }
                });
				var allrecordurl = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Hiring_x0020_Spoc/Title,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,Hiring_x0020_Spoc,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=(Status ne 'Fulfilled' and Status ne 'Internally Fulfilled' and Status ne 'Withdrawn' and Status ne 'Rejected') and (RRFNO ne null) and ((Status ne 'VPHR') and (Status ne 'Recruitment Head') and (Status ne 'FPNA') and (Status ne 'Functional Head') and (Status ne 'Non Billable') and (Status ne 'Internally Fulfilled') and (Status ne 'Externally Fulfilled')) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
				
                $.ajax({
                    url: allrecordurl,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        
                            
                            Counter = 1;// If Counter is one it will not execute for the next time

                       
                       document.getElementById('rrfallrecordcount').innerHTML = data.d.results.length;
                    }
                });
				
				
				




            }
        }, 1000);

        //$("#txtAllocation").input('Regex', { regex: "^[1-9][0-9]?$|^100$" });
        $('.classAllocation').numeric({ max: 100 });

    });


    (function ($) {

        $.fn.numeric = function (options) {

            return this.each(function () {
                var $this = $(this);

                $this.keypress(options, function (e) {
                    // allow backspace and delete 
                    if (e.which == 8 || e.which == 0)
                        return true;

                    //if the letter is not digit 
                    if (e.which < 48 || e.which > 57)
                        return false;

                    // check max range 
                    var dest = e.which - 48;
                    var result = this.value + dest.toString();
                    if (result > e.data.max) {
                        return false;
                    }
                });
            });
        };
    })(jQuery);

    function getRRFData() {
        RRFtblFlag = "1";
        refine_status('allrecord', 'ALL RECORDS', 'FirstTimeLoad');
        $(".stage ul li").on('click', function () {
            $(".stage ul li").removeClass('active');
            $(this).addClass('active');

        });
        //code to popup hide           
        $('.pupup-close').on('click', function () {
            RRFtblFlag = "1";
            $('.popup-bg').hide();
        });
        $('.p-close').on('click', function () {
		
            $('.popup-bg').hide();
			$("#divExternalMsg").hide();
			$("#divExternalFPNAMsgApproval").hide();
			$('#divApproveBody').css('display', 'none');
			$('#divstartdatepopup').css('display', 'none');
			$('#divstartdatepopup').css('display', 'none');
			$('#divExternalMsgApproval').css('display', 'none');
        });
        $('.T-close').on('click', function () {
            $('.Toppopup-bg').hide();
        });
        $('.Toppupup-close').on('click', function () {
            RRFtblFlag = "1";
            $('.Toppopup-bg').hide();
        });


        $(document).on("click", "input", function () {
            $(".strtDt").datepicker({
                dateFormat: 'dd-M-yy',
                changeMonth: true,
                changeYear: true,
                minDate: new Date(Past15_Days_date),
                onSelect: function (selected, evnt) {
                    document.getElementById('Availabilitysign').style.display = 'none';
                    document.getElementById('Availabilityvalue').innerHTML = "";
                    removeErrorMsgResourceAssignment();
                    takeenddate();
                }
            });
        });
        $(document).on("click", "input", function () {
            $(".endDt").datepicker({
                dateFormat: 'dd-M-yy',
                changeMonth: true,
                changeYear: true,
                minDate: new Date(Past15_Days_date),
                onSelect: function (selected, evnt) {
                    document.getElementById('Availabilitysign').style.display = 'none';
                    document.getElementById('Availabilityvalue').innerHTML = "";
                    removeErrorMsgResourceAssignment();
                    //takeenddate();
                }
            });
        });
        $(".strtDt,.endDt").keypress(function (e) {
            return false;
        });
        $('.strtDt,.endDt').bind("cut copy paste", function (e) {
            e.preventDefault();
        });
        $(".VScroll,.VScroll-2").mCustomScrollbar('update');
        $(".VScroll").mCustomScrollbar({
            scrollButtons: {
                enable: true
            },
            theme: "dark-thin",
            advanced: { autoExpandHorizontalScroll: true, updateOnContentResize: true }
        });
        $(".VScroll,.VScroll-2").mCustomScrollbar({
            scrollButtons: {
                enable: true
            },
            theme: "dark-thin",
            advanced: { autoExpandHorizontalScroll: true, updateOnContentResize: true }
        });
        //$(".dataTables_wrapper").mCustomScrollbar({
        // scrollButtons: {
        //        enable: true
        //    },
        //    horizontalScroll: true,
        //    theme: "dark-thin",
        //   autoExpandScrollbar: true,
        //    advanced: { autoExpandHorizontalScroll: true }
        //});

    }
	function hiderrforddl()
    {
        $('#errorMsgddlReason').hide();
    }
    function saveCommentDate() {
        var comment = document.getElementById('TxtAria_Comment').value;
        if (comment.trim() == "") {
            $('#TxtAria_Comment').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });

            document.getElementById("commentAlert").innerHTML = "Please Enter the Comment";
            document.getElementById("TxtAria_Comment").focus();
            return false;
        }
        else {
            var match = (new RegExp('[~#%\&{}+\|<>*]|\'\|\\\\|^\\|\\$')).test(comment);
            if (match) {
                return false;

            } else {


                $('#TxtAria_Comment').css({

                    "border": "",
                    "background": ""
                });
                document.getElementById("commentAlert").innerHTML = "";
                var Flag = "2";
                insertProjectComment(comment, Flag, "", "","",);

            }
        }
    }
    //code to show popup dynemically
    //code to show Request approval popup
    function showApprovalpopup(ResourceApprovalData) {
        var resourceApprovalRRF = ResourceApprovalData.id.split('#');
        RRFRowID = resourceApprovalRRF[0]; //ROW ID
        LogProjectGUID = resourceApprovalRRF[1]; // RRF Project GUID
        RRFEmployeeRole = resourceApprovalRRF[2] + "#" + resourceApprovalRRF[4]; // RRF Employee Role
        pageStatus = resourceApprovalRRF[3]; // RRF Status
        GBU = resourceApprovalRRF[5]; // RRF GBU
        EmployeeRole = resourceApprovalRRF[6]; // RRF Employee Role
        NonBillableApproverID = resourceApprovalRRF[7]; //RRF Project Manager ID
        _MailPendingWith = resourceApprovalRRF[8];
        _MailNonApprovers = resourceApprovalRRF[9];
        _MailRMOSPOCUserId = resourceApprovalRRF[10];
        _MailNewAuthorId = resourceApprovalRRF[12];
        _MailClientPartner = resourceApprovalRRF[11];
        _MailRRFNO = resourceApprovalRRF[13];
		Hiring_Spoc= resourceApprovalRRF[15];
        var rrfValidationData = "";
        var ValidationFlag_val = "";
        if (pageStatus == "RRF Saved" || pageStatus == "Non Billable" || pageStatus == "RMO Validation") {
            rrfValidationData = ValidatedData(RRFRowID);
            if (pageStatus == "RMO Validation") {
                url = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + _MailRRFNO + "'";
                $.ajax({
                    url: url,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        if (data.d.results.length <= 0) {
                            ValidationFlag_val = "false";
                        }
                    }
                });

            }
        }
		if(rrfValidationData=="startdate_false")
		{
			$('.clssPopupHead').text("The Start and End dates of this RRF are in past and needs correction. Would you still want to go ahead. Click 'Yes' if OK.");
			$('.popup h4').css('text-align', 'center');
			$('.allbtn').css('text-align', 'center');
			$('#divExternalMsg').css('display', 'none');
			$('#divExternalMsgApproval').css('display', 'none');
			$('#divApproveBody').css('display', 'none');
			$('#divstartdatepopup').css('display', 'block');
			document.getElementById('divRejectBody').style.display = "none";
			document.getElementById('divComment').style.display = "none";
			document.getElementById('divSearchResource').style.display = "none";
			document.getElementById('divViewLog').style.display = "none";
			document.getElementById('divApproveBody').style.display = "none";
			document.getElementById('divstartdatepopup').style.display = "block";
			StartDate_ConfirmationValue=0;
			$('.popup-bg').show();
		}
        else if(rrfValidationData == "false") {

            $('.alertmessage').show();
            $('#withdrawnrejectdata').hide();
            $('.alertmessage').text('Please fill complete RRF and Submit');
            $('.popup-bg-alert').show();
        } else if (ValidationFlag_val == "false") {
            $('.alertmessage').show();
            $('#withdrawnrejectdata').hide();
            $('.alertmessage').text('Please select resource to propose and Submit');
            $('.popup-bg-alert').show();
        }
        else {
            $('.clssPopupHead').text('Are You Sure Want To Submit?');
            $('.popup h4').css('text-align', 'center');
            $('.allbtn').css('text-align', 'center');
            $('#divExternalMsg').css('display', 'none');
            $('#divExternalMsgApproval').css('display', 'none');
            $('#divstartdatepopup').css('display', 'none');
            $('#divApproveBody').css('display', 'block');
			
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divComment').style.display = "none";
            document.getElementById('divSearchResource').style.display = "none";
            document.getElementById('divViewLog').style.display = "none";
            document.getElementById('divstartdatepopup').style.display = "none";
            document.getElementById('divApproveBody').style.display = "block";
            $('.popup-bg').show();

        }

    }
	function OpenCreateForm()
	{
		StartDate_ConfirmationValue=0;
		$('.popup-bg').hide();
		rrfno1=getrrfno(RRFRowID);
		//location.href="../SitePages/ResourceRequestForm.aspx?RRFNO="+rrfno1+"";
		window.open("../SitePages/ResourceRequestForm.aspx?RRFNO="+rrfno1+"");
		return false;
	}
	
	function getrrfno(RRFRowID)
	{
	
        var rrfno1 = "";
        $.ajax({
            url: "../_api/web/lists/getbytitle('RRF')/items?$filter=ID eq " + RRFRowID + "&$Top=1&$orderby=ID%20desc",
            type: "GET",
            async: false,
            headers: { "Accept": "application/json;odata=verbose" },
            success: function (data) {
                var RRFCount1 = data.d.results.length;
                if (RRFCount1 > 0) {
						var dataset = data.d.results[0];
						rrfno1=dataset.RRFNO;
					}
					

                        
            },
            complete: function () {

            },
            error: function (jqXHR, textStatus, errorThrown) {

            }

        });
        return rrfno1;
    
	}
    //code to show Request rejection popup
    function showRejectionpopup(ResourceData) {
        //var rowID = rejId.id;
        RRFRowID = ResourceData.id.split('#')[0];
        var RowProjectID = ResourceData.id.split('#')[1];
        LogProjectGUID = RowProjectID;
        RRFCreatedBy = ResourceData.id.split('#')[14];
        _MailNewAuthorId = RRFCreatedBy;
        _MailRMOSPOCUserId = ResourceData.id.split('#')[15]; // RMO

        _MailRRFNO = ResourceData.id.split('#')[7];//RRFNumber
		
		RejectReason(); 
		
        $('.clssPopupHead').text('Please Provide Reason For Rejection Of This Request.');
		$('#rejectid').val("Reject");
        $('.popup h4').css('text-align', 'left');
        $('.allbtn').css('text-align', 'left');
        document.getElementById('divApproveBody').style.display = "none";
        document.getElementById('divstartdatepopup').style.display = "none";
        document.getElementById('divExternalMsgApproval').style.display = "none";
        document.getElementById('divComment').style.display = "none";
        document.getElementById('divSearchResource').style.display = "none";
        document.getElementById('divViewLog').style.display = "none";
        document.getElementById('divRejectBody').style.display = "block";
        document.getElementById('Txt_Comment').value = "";
        $('.popup-bg').show();
        $('#Txt_Comment').css({
            "border": "",
            "background": ""
        });
        document.getElementById("AlertMsg").innerHTML = "";
        var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=Comment,NewCreatedDate,Name,Flag&$filter=ProjectGUID eq '" + RowProjectID + "'and Flag eq '3' and RRFListItemId eq '" + RRFRowID + "'&$orderby=Created desc";
        getRMOTransactionDetails(url, RowProjectID, 'RejCommentlog');
    }
	
	function RejectReason()
 {  $('#ddlregion').empty();
    $('#errorMsgddlReason').hide();
     $.ajax({
            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('ResourceRejectionReasonHead')/Items?$SELECT=ReasonHead&$filter=Flag eq 'Reject'",
                            method: "GET",
                            async: false,
                            headers: {
                                "Accept": "application/json; odata=verbose"
                            },
                            success: function(data) {
                                result=data.d.results.length;
                                if(result>0)
                               {
                                $('#ddlregion').append(new Option("Select Reason of Rejection", 0));
                                $.each(data.d.results, function (index, value) {

                    $('#ddlregion').append("<option data-value = '" + value.Flag + "'>" + value.ReasonHead + "</option>");
                });  
                                    
                                }
                          
                            },
                            error: function(data) {
                                alert(JSON.stringify(error));
                                $('.loader').hide();
                            }
                        });
 }
    //code to show Request Comment popup
    function showCommentpopup(cmntId) {
        //var rowCmntID = cmntId.id;
        RRFRowID = cmntId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[0];
        var RowProjectID = cmntId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[1];
        LogProjectGUID = RowProjectID;
        $('.clssPopupHead').text('Please Enter Comment');
        $('.popup h4').css('text-align', 'left');
        // $('.left-pol').css('float', 'left');
        $('.allbtn').css('text-align', 'left');
        document.getElementById('divApproveBody').style.display = "none";
        document.getElementById('divstartdatepopup').style.display = "none";
        document.getElementById('divExternalMsgApproval').style.display = "none";
        document.getElementById('divRejectBody').style.display = "none";
        document.getElementById('divSearchResource').style.display = "none";
        document.getElementById('divViewLog').style.display = "none";
        document.getElementById('divComment').style.display = "block";
        document.getElementById('TxtAria_Comment').value = "";

        $('#TxtAria_Comment').css({
            "border": "",
            "background": ""
        });
        document.getElementById("commentAlert").innerHTML = "";
        var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=Comment,NewCreatedDate,Name,Flag&$filter=ProjectGUID eq '" + RowProjectID + "'and Flag eq '2' and RRFListItemId eq '" + RRFRowID + "'&$orderby=Created desc";
        getRMOTransactionDetails(url, RowProjectID, 'Commentlog');
        $('.popup-bg').show();
    }
    //code to show search resources popup
    function showResourcepopup(ResourceData) {
        $('.loader').show();
        setTimeout(function () {
            getResourceDataPopUp(ResourceData);
            $('.loader').hide();
        }, 100);
    }

    function getResourceDataPopUp(ResourceData) {
        var resourceRRF = ResourceData.id.split('#');
        multipleAssignProject_Array = [];
        RRFtblFlag = "0";
        ResourceTableFlag = "1";
        softblockFlag = "";
        if ($.fn.dataTable.isDataTable('#tblResources')) {
            destroyjs('#tblResources');
        }
        var requestID = resourceRRF[0];  //ROW ID
        RRFRowID = resourceRRF[0];
        var rrfprojectID = resourceRRF[1]; //ProjectGUID
        LogProjectGUID = resourceRRF[1]; //ProjectGUID
        PrimarySkill = resourceRRF[2]; // PrimarySkill
        SecondrySkill = resourceRRF[3];//SecondarySkill
        RolBand = resourceRRF[4]; //RoleBand
        var IndustryExp = resourceRRF[5];//IndustryExp
        MinRevExp = resourceRRF[6];//MinimunExp
        var RRFNumber = resourceRRF[7];//RRFNumber
        pageStatus = resourceRRF[8]; //RRF Status
        var sub_pracitc = resourceRRF[9]; //Sub Practic 
        projectName = resourceRRF[10];//project name
        ProLocation = resourceRRF[11];
        projectStrtdate = resourceRRF[12];
        projectEnddate = resourceRRF[13]; //2017-08-29T19:00:00
        var AuthorId = resourceRRF[14]; // Creater or Initiator
        RRFAuthorId = resourceRRF[14];
        RMOSPOCUserId = resourceRRF[15]; // RMO
        ProjectManagerUserId = resourceRRF[16]; // Project Manager
        var FPNAUserId = resourceRRF[17]; // FPNA
        var ReportingToUserId = resourceRRF[18]; // Reporting Manager
        var ClientPartnerUserId = resourceRRF[19]; // Client partner
        var EmployeeRole = resourceRRF[20]; // Role
        var RRFAllocationPercent = resourceRRF[21]; //RRF Percentage
        var ProjectManagerName = resourceRRF[22]; // Project Manager Name
        var ClientPartnerName = resourceRRF[23]; // Client Partner Name
        var RMOSPOCName = resourceRRF[24]; // RMO SPOC Name
        var ProjectCode = resourceRRF[25]; // Project Code
        rrfStartDate = resourceRRF[28]; // RRF Start Date
        rrfEndDate = resourceRRF[29]; //RRF End Date
        internallyfulfilledFlag = resourceRRF[30];
        var ResourceAgainstRRFInWDId = "";
        var ExternalEmplooyeeId = "";
        var ExternalEmplooyeeName = "";
        var externalhiringflag = "";

        _MailNewAuthorId = RRFAuthorId;
        _MailRMOSPOCUserId = RMOSPOCUserId;
        _MailRRFNO = RRFNumber;
		hiringspocmailid=resourceRRF[32];
		FPNAFlagMail=resourceRRF[33];
        $('#errMsgSaveResourcevalidaion').css('display', 'none');
        if (LogProjectGUID != "" && LogProjectGUID != null && LogProjectGUID != "null" && LogProjectGUID != "0") {
            url = "../_api/ProjectData/Projects?$select=ProjectFinishDate,ProjectStartDate&$filter=ProjectId eq (guid'" + LogProjectGUID + "')";
            $.ajax({
                url: url,
                method: "GET",
                async: false,
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {
                    if (data.d.results.length > 0) {
                        projectStrtdate = formateRefinedProjectDate(parseInt(data.d.results[0].ProjectStartDate.toString().substring(6, 19)))
                        projectEnddate = formateRefinedProjectDate(parseInt(data.d.results[0].ProjectFinishDate.toString().substring(6, 19)))
                    }
                }
            });
        } else if (LogProjectGUID == "0") {
            projectStrtdate = rrfStartDate;
            projectEnddate = rrfEndDate;
        }

        if (resourceRRF[26] != "" && resourceRRF[26] !== undefined && resourceRRF[26] != "undefined" && resourceRRF[26] != null && (pageStatus == "External Hiring" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check")) {
            ResourceAgainstRRFInWDId = getResourceEmpIdEmpName(resourceRRF[26]) // Assigned Resource Emailid
            ExternalEmplooyeeId = ResourceAgainstRRFInWDId.split('#')[0];
            ExternalEmplooyeeName = ResourceAgainstRRFInWDId.split('#')[1];
        }

        if (pageStatus == "External Hiring" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check")
            externalhiringflag = resourceRRF[27];

        RRF_Number = RRFNumber;
        $('.clssPopupHead').html(RRFNumber + ' : Search Resources ' + '| Primary Skill : ' + PrimarySkill + ' | Secondary Skill : ' + SecondrySkill + ' | View Selected Resources ').append(" <span  id='show-popup' class='action-c pull-right'><i class='fa fa-users' aria-hidden='true'></i><div class='action-c-view VScroll '> <ul id='slectedResource'></ul> </div></span>");
        $('.popup h4').css({ 'text-align': 'left', 'width': '100%' });
        $('.allbtn').css('text-align', 'left');
        document.getElementById('divRejectBody').style.display = "none";
        document.getElementById('divComment').style.display = "none";
        document.getElementById('divApproveBody').style.display = "none";
        document.getElementById('divstartdatepopup').style.display = "none";
        document.getElementById('divExternalMsgApproval').style.display = "none";
        document.getElementById('divViewLog').style.display = "none";
        document.getElementById('divSearchResource').style.display = "block";
        $('.error').css('display', 'none');
        $('.strtDt').val('');
        $('.endDt').val('');
        $('.loader').show();

        url = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
        $.ajax({
            url: url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                if (data.d.results.length > 0) {
                    ResourceAllocationFlag = data.d.results[0].Flag;
                } else {
                    ResourceAllocationFlag = "";
                }
            }
        });
        var SeletedEmployeeIDcheck = "";
        var dataurl = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
        $.ajax({
            url: dataurl,
            async: false,
            type: "GET",
            headers: { "Accept": "application/json;odata=verbose" },
            success: function (data) {
                resourceRRFCount = data.d.results.length;

                if (resourceRRFCount > 0) {
                    var dataset = data.d.results[0];
                    resourceListID = dataset.ID;
                    if (pageStatus == "RRF Saved") {
						SeletedEmployeeIDcheck = (dataset.suggestedResource != "" && dataset.suggestedResource != null) ? dataset.suggestedResource.split(';') : "";
                       // SeletedEmployeeIDcheck = dataset.suggestedResource.split(';');
                    } else if (pageStatus == "RMO Validation") {
                        SeletedEmployeeIDcheck = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : "";

                    } else if (pageStatus == "Resource Proposed") {
                        SeletedEmployeeIDcheck = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : ""; // Changes done on 30-8-2017 

                    } else if (pageStatus == "Resource Selection") {

                        SeletedEmployeeIDcheck = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";

                    } else if (pageStatus == "Fulfilled" || pageStatus=="Internally Fulfilled") {
                        SeletedEmployeeIDcheck = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";
                    }

                }
            }
        });
        document.getElementById('btnSoftblockOK').style.display = 'none';
        if (rrfprojectID != "" && rrfprojectID != undefined && rrfprojectID != "null") {
            document.getElementById('divmsgNoresource').style.display = 'none';
            var resourceTbl_header = "";
            var resourcetable_element = "";
            resourceTbl_header = "<thead><tr>";
            var ResourceLIHTML = "<tbody >";
            //table binding for resources data
            resourceTbl_header = resourceTbl_header + "<th >Item</th>"
            resourceTbl_header = resourceTbl_header + "<th >Employee ID</th>"
            resourceTbl_header = resourceTbl_header + "<th >Employee Name</th>"
            resourceTbl_header = resourceTbl_header + "<th >Project Name</th>"
            resourceTbl_header = resourceTbl_header + "<th>Project Manager</th>"
            resourceTbl_header = resourceTbl_header + "<th>Sub-Practice</th>"
            resourceTbl_header = resourceTbl_header + "<th id='sord-disable'>Start Date</th>"
            resourceTbl_header = resourceTbl_header + "<th id='sord-disable'>End Date</th>"
            resourceTbl_header = resourceTbl_header + "<th>Allocation %</th>"
            resourceTbl_header = resourceTbl_header + "<th>Status</th>"
            resourceTbl_header = resourceTbl_header + "<th >Base Location</th>"
            resourceTbl_header = resourceTbl_header + "<th >Action</th>"
            resourceTbl_header = resourceTbl_header + "</tr></thead>";

            //footer menu
            resourceTbl_header = resourceTbl_header + "<tfoot><tr>";
            resourceTbl_header = resourceTbl_header + "<th>Item</th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th></th>"
            resourceTbl_header = resourceTbl_header + "<th>Action</th>"
            resourceTbl_header = resourceTbl_header + " </tr></tfoot>";
            //Call Rest API to Get Data from project Server
            var bool = "";
            url = EmployeeSkill(PrimarySkill); //site_url + "_api/EmployeeSkills?$filter=Skill_Type eq 'Primary' and Skill_Detail eq'" + PrimarySkill + "'";
            var tdId = "";
            var rejId = "";
            var cmntID = "";

            if (resourceRRF[26] != "" && resourceRRF[26] !== undefined && resourceRRF[26] != "undefined" && resourceRRF[26] != null && ((pageStatus == "External Hiring" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check") || externalhiringflag == "1")) {
                document.getElementById('SoftBlockResource').style.display = 'none';
                document.getElementById('softblockHead').style.display = 'none';
                $('#errMsgSvaeSoftBlock').css('display', 'none');
                var Resource_Dataset = searchResourceWithNewService(ExternalEmplooyeeId);
                $.each(Resource_Dataset, function (index, value) {
                    var EmpID = "";
                    var EmpName = "";
                    var Designation = "";
                    var projectcode = "";
                    var ProjectName = "";
                    var ProjectstartDate = "";
                    var ProjectEnddate = "";
                    var allocationPercent = ""
                    var Location = "";
                    var status = "";
                    var Base_Location = "";
                    if (value.EmployeeID != null) {
                        EmpID = value.EmployeeID;
                    }
                    // if (value.ResourceFullName != null) {
                    EmpName = ExternalEmplooyeeName;
                    //}
                    if (value.Designation != null) {
                        Designation = value.Designation;
                    }
                    //if (value.ProjectName != null) {
                    //    ProjectName = value.ProjectName;
                    //}
                    //if (value.Startdatetime != null) {
                    ProjectstartDate = convert_date_DDMMYYYY(projectStrtdate);
                    //}
                    //if (value.Finishdatetime != null) {
                    ProjectEnddate = convert_date_DDMMYYYY(projectEnddate);
                    //}
                    //if (value.Allocation != null) {
                    //    allocationPercent = value.Allocation;
                    //}
                    //if (value.Work_Location != null) {
                    //    Location = value.Work_Location;
                    //}
                    if (value.Employee_status != null) {
                        status = value.Employee_status;
                    }
                    if (value.BaseLocation != null) {
                        Base_Location = value.BaseLocation;
                    }
                    document.getElementById('btnResorceSave').style.display = 'none';
                    var ProjectNameHTML = projectName;
                    EmpID = ExternalEmplooyeeId;
                    cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;

                    var externalDetails = rrfprojectID + "#;" + EmpID + "#;" + EmpName + "#;" + Designation + "#;" + projectName + "#;" + sub_pracitc + "#;" + projectStrtdate + "#;" + projectEnddate + "#;" + RRFAllocationPercent + "#;" + status + "#;" + Base_Location + "#;" + RRFNumber + "#;" + EmployeeRole + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName;
                    ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td><input type='checkbox' name='checkResource' value='" + EmpID + "' /></td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + ProjectNameHTML + "</td><td>" + ProjectManagerName + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + RRFAllocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + externalDetails + "' class='glyphicon glyphicon-ok-sign icon-weight' aria-hidden='true' title='Approve' onclick='ResourceExternalApproval(this)'></span><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"

                });

            } else if ((pageStatus == "Resource Selection" || ResourceAllocationFlag == "1" || ResourceAllocationFlag == "2") && pageStatus != "Fulfilled" && pageStatus !="Internally Fulfilled") {
                document.getElementById('SoftBlockResource').style.display = 'none';
                document.getElementById('softblockHead').style.display = 'none';
                $('#errMsgSvaeSoftBlock').css('display', 'none');
                url = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
                //document.getElementById('btnResorceSave').style.display = 'none';
                $.ajax({
                    url: url,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        $('.loader').show();
                        //var ResourceLIHTML = "<tbody>";
                        tdId = "";
                        rejId = "";
                        cmntID = "";
                        $.each(data.d.results, function (key, value) {
                            var EmpID = "";
                            if ((pageStatus == "Resource Proposed" && ResourceAllocationFlag == "1") || pageStatus == "Resource Selection" || pageStatus == "Fulfilled" || pageStatus == "Internally Fulfilled") {
                                var EmpID_array = "";
                                if (pageStatus == "Resource Proposed") {
                                    EmpID_array = value.ShortlistedResource;
									//EmpID_array.trim();
									EmpID_array =EmpID_array.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                                } else {
                                    EmpID_array = value.AllocatedResource;
									//EmpID_array.trim();
									EmpID_array =EmpID_array.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                                }
                                if (EmpID_array != "" && EmpID_array != null) {
                                    if (EmpID_array.indexOf(';') > 0) {
                                        EmpID_array = EmpID_array.split(';');
										//EmpID_array.trim();
                                    } else {
                                        //var empIDSingle = EmpID_array.trim();
                                        var empIDSingle = EmpID_array.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                                        var EmpID_array = [];
                                        EmpID_array.push(empIDSingle);
                                    }
                                    $.each(EmpID_array, function (index, eployeeid) {
                                        EmpID = eployeeid;
                                        var Resource_Dataset = searchResourceWithNewService(EmpID, PrimarySkill, SecondrySkill, RolBand, rrfStartDate, RRFAllocationPercent, rrfEndDate);
                                        $.each(Resource_Dataset, function (index, value) {
                                            bool = index + 1;
                                            var EmpID = "";
                                            var EmpName = "";
                                            var Designation = "";
                                            var projectcode = "";
                                            var ProjectName = "";
                                            var ProjectstartDate = "";
                                            var ProjectEnddate = "";
                                            var allocationPercent = ""
                                            var Location = "";
                                            var status = "";
                                            var Employee_Email = "";
                                            var Project_Manager = "";
                                            var Base_Location = "";
											var Role_Band="";
											if (value.RoleBand != null) {
                                                Role_Band = value.RoleBand;
                                            }
                                            if (value.EmployeeID != null) {
                                                EmpID = value.EmployeeID;
												//EmpID.trim();
												EmpID=EmpID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
												
                                            }
                                            if (value.ResourceFullName != null) {
                                                EmpName = value.ResourceFullName;
                                            }
                                            if (value.Designation != null) {
                                                Designation = value.Designation;
                                            }
                                            if (value.ProjectName != null) {
                                                ProjectName = value.ProjectName;
                                            }
                                            if (value.Startdatetime != null) {
                                                ProjectstartDate = value.Startdatetime;
                                            }
                                            if (value.Finishdatetime != null) {
                                                ProjectEnddate = value.Finishdatetime;
                                            }
                                            if (value.Allocation != null) {
                                                allocationPercent = value.Allocation;
                                            }
                                            if (value.Work_Location != null) {
                                                Location = value.Work_Location;
                                            }
                                            if (value.Employee_status != null) {
                                                status = value.Employee_status;
                                            }
                                            if (value.Work_Email != null) {
                                                Employee_Email = value.Work_Email;
                                            }
                                            if (value.BaseLocation != null) {
                                                Base_Location = value.BaseLocation;
                                            }
                                            //if (value.Project_Manager != null) {
                                            //    Project_Manager = value.Project_Manager;
                                            //}
                                            $.each(SeletedEmployeeIDcheck, function (key, checkvalue) {
                                                if (checkvalue == EmpID) {
                                                    bool = 0;
                                                }

                                            })
                                            var ProjectNameHTML = "";
                                            if (ProjectName == "Multiple Assignment") {
                                                Project_Manager = "NA";
                                                ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                                            } else {
                                                ProjectNameHTML = ProjectName;
                                                if (value.ProjectCode != null) {
                                                    Project_Manager = findProjectwiseProjectManager(value.ProjectCode);
                                                }
                                            }

                                            EmpID = eployeeid;
                                            tdId = "resourcebtnApprove" + key;
                                            rejId = "resourcebtnReject" + "#;" + EmpID + "#;" + EmpName + "#;" + ProjectCode + "#;" + projectName + "#;" + Base_Location + "#;" + PrimarySkill + "#;" + RRFNumber + "#;" + EmployeeRole;
                                            cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
                                            var assigmntDetails = EmpID + "#;" + rrfprojectID + "#;" + RRFNumber + "#;" + EmployeeRole + "#;" + projectStrtdate + "#;" + projectEnddate + "#;" + RRFAllocationPercent + "#;" + Designation + "#;" + EmpName + "#;" + status + "#;" + Employee_Email + "#;" + Base_Location + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName + "#;" + projectName + "#;" + PrimarySkill + "#;" + Role_Band;
                                            if (pageStatus == "Resource Proposed" && (LoginUserID == RMOSPOCUserId || LoginUserID == RRFAuthorId)) {

                                                if (ResourceAllocationFlag == "1" && LoginUserID == RRFAuthorId) {
                                                    document.getElementById('btnResorceSave').style.display = 'none';
													//add worklocation instead of Baselocation by Manohar
                                                    //ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Location + "</td><td><span id='" + EmpID + "#" + rrfprojectID + "' class='glyphicon glyphicon-ok-sign icon-weight' aria-hidden='true' title='Approve' onclick='ResourceApproval(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span> <span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                    ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + EmpID + "#" + rrfprojectID + "' class='glyphicon glyphicon-ok-sign icon-weight' aria-hidden='true' title='Approve' onclick='ResourceApproval(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span> <span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                }
                                                else {
                                                    document.getElementById('btnResorceSave').style.display = 'none';
                                                    //add worklocation instead of Baselocation by Manohar
													ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' /></td>" + bool + "<td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                }
                                            }
                                            else if (pageStatus == "Resource Selection" && LoginUserID == RMOSPOCUserId) {
                                                //add worklocation instead of Baselocation by Manohar
												ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td></td><td id=" + EmpID + "#;" + rrfprojectID + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + assigmntDetails + "' class='glyphicon glyphicon-lock icon-weight' aria-hidden='true' title='Resource Allocation' onclick='ResourceAssignment(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span> <span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                document.getElementById('btnResorceSave').style.display = 'none';
                                            }
                                            else {
                                                //add worklocation instead of Baselocation by Manohar
												ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td></td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                                                document.getElementById('btnResorceSave').style.display = 'none';
                                            }

                                        });

                                    })
                                }
                            }
                        });
                    }
                });

            } else if (pageStatus == "Fulfilled" || pageStatus =="Internally Fulfilled") {
                document.getElementById('softblockHead').style.display = 'none';
                document.getElementById('SoftBlockResource').style.display = 'none';
                $('#errMsgSvaeSoftBlock').css('display', 'none');
                $('.clssPopupHead').text(RRFNumber + ' : Allocated Resource');
                url = "../_api/web/lists/getbytitle('RMOResourceAssignment')/items?$select=ResourceID,ResourceName,Designation,ProjectName,NewStartDate,NewEndDate,AllocationPercent,ProjectLoaction,Employee_status&$filter=RRFNumber eq'" + RRFNumber + "'";
                document.getElementById('btnResorceSave').style.display = 'none';
                $.ajax({
                    url: url,
                    method: "GET",
                    async: false,
                    headers: { "Accept": "application/json; odata=verbose" },
                    success: function (data) {
                        $.each(data.d.results, function (index, value) {
                            // var value = data.d.results;
                            var EmpID = "";
                            var EmpName = "";
                            var Designation = "";
                            var projectcode = "";
                            var ProjectName = "";
                            var ProjectstartDate = "";
                            var ProjectEnddate = "";
                            var allocationPercent = ""
                            var Location = "";
                            var status = "";
                            var Employee_Email = "";
                            var Project_Manager = "";
                            var Base_Location = "";
                            if (value.ResourceID != null) {
                                EmpID = value.ResourceID;
								//EmpID.trim();
								EmpID=EmpID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                            }
                            if (value.ResourceName != null) {
                                EmpName = value.ResourceName;
                            }
                            if (value.Designation != null) {
                                Designation = value.Designation;
                            }
                            if (value.ProjectName != null) {
                                ProjectName = value.ProjectName;
                            }
                            if (value.NewStartDate != null) {
                                ProjectstartDate = value.NewStartDate;
                                ProjectstartDate = convert_date_DDMMYYYY(ProjectstartDate);
                            }
                            if (value.NewEndDate != null) {
                                ProjectEnddate = value.NewEndDate;
                                ProjectEnddate = convert_date_DDMMYYYY(ProjectEnddate);
                            }
                            if (value.AllocationPercent != null) {
                                allocationPercent = value.AllocationPercent;
                            }
                            if (value.ProjectLoaction != null) {
                                Location = value.ProjectLoaction;
                            }
                            if (value.Employee_status != null) {
                                status = value.Employee_status;
                            }
                            if (value.Work_Email != null) {
                                Employee_Email = value.Work_Email;
                            }
                            if (value.BaseLocation != null) {
                                Base_Location = value.BaseLocation;
                            }
                            //if (value.Project_Manager != null) {
                            //    Project_Manager = value.Project_Manager;
                            //}
                            var ProjectNameHTML = "";
                            if (ProjectName == "Multiple Assignment")
                                ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                            else
                                ProjectNameHTML = ProjectName;

                            tdId = "resourcebtnApprove";
                            rejId = "resourcebtnReject" + "#;" + EmpID + "#;" + EmpName + "#;" + ProjectCode + "#;" + projectName + "#;" + Base_Location + "#;" + PrimarySkill + "#;" + RRFNumber;
                            cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
                            var assigmntDetails = EmpID + "#;" + projectcode + "#;" + RRFNumber + "#;" + ProjectstartDate + "#;" + ProjectEnddate + "#;" + RRFAllocationPercent + "#;" + Designation + "#;" + EmpName + "#;" + status + "#;" + Employee_Email + "#;" + Base_Location + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName + "#;" + projectName + "#;" + PrimarySkill;
                           //add worklocation instead of Baselocation by Manohar
						   ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + ProjectManagerName + ">" + ProjectNameHTML + "</td><td>" + ProjectManagerName + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"


                        });
                    }
                });
            } else {
                //document.getElementById('btnResorceSave').style.display = 'block';
                document.getElementById('SoftBlockResource').style.display = 'none';
                document.getElementById('softblockHead').style.display = 'none';
                EmployeeIDPara = "NA";
                chechBoxFlag = "1";
                var Resource_Dataset = searchResourceWithNewService(EmployeeIDPara, PrimarySkill, SecondrySkill, RolBand, rrfStartDate, RRFAllocationPercent, rrfEndDate);
                if (Resource_Dataset.length == 0) {
                    document.getElementById('btnResorceSave').style.display = 'none';
                }
                $.each(Resource_Dataset, function (index, value) {
                    bool = index + 1;
                    var EmpID = "";
                    var EmpName = "";
                    var Designation = "";
                    var projectcode = "";
                    var ProjectName = "";
                    var ProjectstartDate = "";
                    var ProjectEnddate = "";
                    var allocationPercent = ""
                    var Location = "";
                    var status = "";
                    var Employee_Email = "";
                    var Project_Manager = "";
                    var Base_Location = "";
					var Role_Band="";
					if (value.RoleBand != null) {
					Role_Band = value.RoleBand;
					}
                    if (value.EmployeeID != null) {
                        EmpID = value.EmployeeID;
						//EmpID.trim();
						EmpID=EmpID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                    }
                    if (value.ResourceFullName != null) {
                        EmpName = value.ResourceFullName;
                    }
                    if (value.Designation != null) {
                        Designation = value.Designation;
                    }
                    if (value.ProjectName != null) {
                        ProjectName = value.ProjectName;
                    }
                    if (value.Startdatetime != null) {
                        ProjectstartDate = value.Startdatetime;
                    }
                    if (value.Finishdatetime != null) {
                        ProjectEnddate = value.Finishdatetime;
                    }
                    if (value.Allocation != null) {
                        allocationPercent = value.Allocation;
                    }
                    if (value.Work_Location != null) {
                        Location = value.Work_Location;
                    }
                    if (value.Employee_status != null) {
                        status = value.Employee_status;
                    }
                    if (value.Work_Email != null) {
                        Employee_Email = value.Work_Email;
                    }
                    if (value.BaseLocation != null) {
                        Base_Location = value.BaseLocation;
                    }
                    //if (value.Project_Manager != null) {
                    //    Project_Manager = value.Project_Manager;
                    //}
                    $.each(SeletedEmployeeIDcheck, function (key, checkvalue) {
                        if (checkvalue == EmpID) {
                            bool = 0;
                        }

                    })
                    var ProjectNameHTML = "";
                    if (ProjectName == "Multiple Assignment") {
                        Project_Manager = "NA"
                        ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
                    } else {
                        if (value.ProjectCode != null) {
                            Project_Manager = findProjectwiseProjectManager(value.ProjectCode);
                        }
                        ProjectNameHTML = ProjectName;
                    }
                    tdId = "resourcebtnApprove" + index;
                    rejId = "resourcebtnReject" + "#;" + EmpID + "#;" + EmpName + "#;" + ProjectCode + "#;" + projectName + "#;" + Base_Location + "#;" + PrimarySkill + "#;" + RRFNumber + "#;" + EmployeeRole;
                    cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
                    var assigmntDetails = EmpID + "#;" + rrfprojectID + "#;" + RRFNumber + "#;" + EmployeeRole + "#;" + projectStrtdate + "#;" + projectEnddate + "#;" + RRFAllocationPercent + "#;" + Designation + "#;" + EmpName + "#;" + status + "#;" + Employee_Email + "#;" + Base_Location + "#;" + ProjectCode + "#;" + ProjectManagerName + "#;" + ClientPartnerName + "#;" + RMOSPOCName + "#;" + projectName + "#;" + PrimarySkill +"#;"+ Role_Band;
                    Projectdetails = ProjectCode + "#;" + projectName + "#;" + RRFAllocationPercent + "#;" + Base_Location + "#;" + RMOSPOCName + "#;" + ProjectManagerName + "#;" + PrimarySkill + "#;" + RRFNumber;
                    if (pageStatus == "RRF Saved" && LoginUserID == AuthorId) {
                        // display Save button 
                        document.getElementById('btnResorceSave').style.display = 'inline-block';
                        //document.getElementById('divSkillInfo').style.display = 'none';
						//add worklocation instead of Baselocation by Manohar
                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                        document.getElementById('softblockHead').style.display = 'none';
                        document.getElementById('SoftBlockResource').style.display = 'none';
                        $('#errMsgSvaeSoftBlock').css('display', 'none');
                    }
                    else if ((pageStatus == "RMO Validation" || pageStatus == "External Hiring" || pageStatus == "Initiated External Hiring" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check") && LoginUserID == RMOSPOCUserId) {
                        document.getElementById('btnResorceSave').style.display = 'inline-block';
                        // document.getElementById('divSkillInfo').style.display = 'none';
                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span></td></tr>"
                        document.getElementById('softblockHead').style.display = 'none';
                        document.getElementById('SoftBlockResource').style.display = 'none';
                        $('#errMsgSvaeSoftBlock').css('display', 'none');
                    }
                    else if (pageStatus == "Resource Proposed" && LoginUserID == RMOSPOCUserId && (ResourceAllocationFlag == null || ResourceAllocationFlag == "" || ResourceAllocationFlag == undefined)) {
                        document.getElementById('btnResorceSave').style.display = 'inline-block';
                        //document.getElementById('divSkillInfo').style.display = 'none';
                        document.getElementById('softblockHead').style.display = 'block';
                        document.getElementById('SoftBlockResource').style.display = 'block';
                        $('#errMsgSvaeSoftBlock').css('display', 'none');

                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span> <span id='" + rejId + "' class='glyphicon glyphicon-remove-sign icon-weight' aria-hidden='true' title='Reject' onclick='ResourceRejectionpopup(this)'></span></td></tr>"

                    }
                    else {
                        ResourceLIHTML = ResourceLIHTML + "<tr id=" + rrfprojectID + "><td class='clsCheckbox'><input type='checkbox' name='checkResource' value='" + EmpID + "' />" + bool + "</td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td id=" + EmpID + "#" + EmpName + "#" + Project_Manager + ">" + ProjectNameHTML + "</td><td>" + Project_Manager + "</td><td>" + sub_pracitc + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + status + "</td><td>" + Base_Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"
                        document.getElementById('btnResorceSave').style.display = 'none';
                        // document.getElementById('divSkillInfo').style.display = 'none';
                        document.getElementById('softblockHead').style.display = 'none';
                        document.getElementById('SoftBlockResource').style.display = 'none';
                        $('#errMsgSvaeSoftBlock').css('display', 'none');

                    }
                });

            }
            ResourceLIHTML += "</tbody>";
            resourcetable_element = resourceTbl_header + ResourceLIHTML;
            $("#tblResources").append(resourcetable_element);

            ResourceTable = $('#tblResources').DataTable({
                "dom": 'Rlfrtip',
                "iDisplayLength": 5,
                "lengthMenu": [[5, 15, 35, -1], [5, 15, 35, "All"]],
                "pagingType": "simple_numbers"
            });

            $('#tblResources tfoot th').each(function () {
                var title = $(this).text();
                if (title != 'Action' && title != 'Item') {
                    $(this).html('<input type="text" placeholder="Search ' + title + '" />');
                }
                else {
                    $(this).html('');
                }
            });

            // DataTable
            var table = $('#tblResources').DataTable();

            // Apply the search
            table.columns().every(function () {
                var that = this;

                $('input', this.footer()).on('keyup change', function () {
                    if (that.search() !== this.value) {
                        that
                            .search(this.value)
                            .draw();
                    }
                });
            });

            if (table.data().any()) {

                bindcheckedResources(RRFNumber);
            }

        } else {
            document.getElementById('divmsgNoresource').style.display = 'block';
        }

        $('.popup-bg').show();
        $('.loader').hide();
    }



    //Code to withdraw RRF
    function WithdrawRRF(WithdrawnRRFID) {
        RRFRowID = WithdrawnRRFID.id.split('#')[0];
        var RowProjectID = WithdrawnRRFID.id.split('#')[1];
        LogProjectGUID = RowProjectID;
        RRFCreatedBy = WithdrawnRRFID.id.split('#')[12];
        _MailNewAuthorId = RRFCreatedBy;
        _MailRRFNO = WithdrawnRRFID.id.split('#')[13];
		 WithdrawnReason();
        var WithdrawnRRFStatus = WithdrawnRRFID.id.split('#')[8]; //RRF Status
        $('.clssPopupHead').text('Please Provide Reason For Withdrawn Of This Request.');
		$('#rejectid').val("Withdraw");
        $('.popup h4').css('text-align', 'left');
        $('.allbtn').css('text-align', 'left');
        document.getElementById('divApproveBody').style.display = "none";
        document.getElementById('divstartdatepopup').style.display = "none";
        document.getElementById('divExternalMsgApproval').style.display = "none";
        document.getElementById('divComment').style.display = "none";
        document.getElementById('divSearchResource').style.display = "none";
        document.getElementById('divViewLog').style.display = "none";
        document.getElementById('divRejectBody').style.display = "block";
        document.getElementById('Txt_Comment').value = "";
        $('.popup-bg').show();
        $('#Txt_Comment').css({
            "border": "",
            "background": ""
        });
        document.getElementById("AlertMsg").innerHTML = "";
        var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=Comment,NewCreatedDate,Name,Flag&$filter=ProjectGUID eq '" + RowProjectID + "'and Flag eq '3' and RRFListItemId eq '" + RRFRowID + "'&$orderby=Created desc";
        getRMOTransactionDetails(url, RowProjectID, 'RejCommentlog');
        WithdrawnRRFFlag = "1";
    }
function WithdrawnReason()
        {
                $('#ddlregion').empty();
                $.ajax({
            url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/Lists/getbytitle('ResourceRejectionReasonHead')/Items?$SELECT=ReasonHead&$filter=Flag eq 'Withdrawn'",
                            method: "GET",
                            async: false,
                            headers: {
                                "Accept": "application/json; odata=verbose"
                            },
                            success: function(data) {
                                result=data.d.results.length;
                                if(result>0)
                               {
                                $('#ddlregion').append(new Option("Select Reason of Withdrawn", 0));
                                $.each(data.d.results, function (index, value) {

                    $('#ddlregion').append("<option data-value = '" + value.Flag + "'>" + value.ReasonHead + "</option>");
                });  
                                    
                                }
                          
                            },
                            error: function(data) {
                                alert(JSON.stringify(error));
                                $('.loader').hide();
                            }
                        });
        }
    //code to show view log popup
    function showViewlogPopup(tdId) {
        RRFRowID = tdId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[0];
        var RowProjectID = tdId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[1];
        var RRFNumber = tdId.id.split('#;')[2];
        $('.clssPopupHead').text('View Log');
        $('.popup h4').css('text-align', 'left');
        $('.allbtn').css('text-align', 'left');
        document.getElementById('divRejectBody').style.display = "none";
        document.getElementById('divComment').style.display = "none";
        document.getElementById('divSearchResource').style.display = "none";
        document.getElementById('divApproveBody').style.display = "none";
        document.getElementById('divstartdatepopup').style.display = "none";
        document.getElementById('divExternalMsgApproval').style.display = "none";
        document.getElementById('divViewLog').style.display = "block";
        $(".removedata").remove();
        var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=LogType,NewCreatedDate,Name,Flag,Author/Title&$expand=Author&$filter=(RRFListItemId eq '" + RRFRowID + "') and (Flag eq '1' or Flag eq '3')&$orderby=Created desc";
        getRMOTransactionDetails(url, RowProjectID, "Log");
        $('.popup-bg').show();
    }


    //Code to show transactional Record details

    function getRMOTransactionDetails(url, RowProjectID, Type) {
        $("#commentdata").empty();
        $("#rejectdata").empty();
        $("#resourceCommetdata").empty();
        $('#TextareaResourceComment').html('');
        $.ajax({
            url: url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                $.each(data.d.results, function (index, value) {

                    var Date = convert_date_DDMMYYYY(value.NewCreatedDate);
                    var Time = value.NewCreatedDate.split('T')[1];
                    var FinalTime = Time.split('Z')[0];

                    if (Type == "Log" || value.LogType == "External Hiring") {
                        if (value.Flag == "1" || value.Flag == "5" || value.Flag == "3") {
                            var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label><b><u>' + value.LogType + '</u></b></label></div>';
                            logDeatils += '<div class="com-user-text"><i>' + value.Author.Title + ' | ' + Date + ' - ' + FinalTime + '</i></div><hr/></div>';

                            $("#logdata").append(logDeatils);
                        }
                    }
                    else if (Type == "Commentlog") {
                        if (value.Flag == "2") {
                            var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label class="pull-left"><b><u>' + value.Name + ' | ' + Date + ' - ' + FinalTime + '</u></b></label></div><br/>';
                            logDeatils += '<div class="clearfix"></div><div class="com-user-text"><i>' + value.Comment + '</i></div><hr/></div>';
                            $("#commentdata").append(logDeatils);
                        }
                    }
                    else if (Type == "RejCommentlog") {
                        if (value.Flag == "3") {
                            var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label class="pull-left"><b><u>' + value.Name + ' | ' + Date + ' - ' + FinalTime + '</u></b></label></div><br/>';
                            logDeatils += '<div class="clearfix"></div><div class="com-user-text"><i>' + value.Comment + '</i></div><hr/></div>';
                            $("#rejectdata").append(logDeatils);
                            $("#withdrawnrejectdata").append(logDeatils);
                        }
                    }
                    else if (Type == "ResourceComment") {
                        var logDeatils = '<div class="user-comments removedata"><div class="com-user-text" style="text-align:center"><label class="pull-left"><b><u>' + value.Name + ' | ' + Date + ' - ' + FinalTime + '</u></b></label></div><br/>';
                        logDeatils += '<div class="clearfix"></div><div class="com-user-text"><i>' + value.Comment + '</i></div><hr/></div>';
                        $('#resourceCommetdata').append(logDeatils);
                    }
                });
            }
        });
    }

    //code to resource assignment popup
    function ResourceAssignment(data) {
	
	var Group_url="../_api/Web/GetUserById('"+LoginUserID+"')/Groups?$select=Id,Title&$filter=Title eq 'Flash News'";
				var RMOAdminCount = resultset(Group_url);
				if (RMOAdminCount.length > 0) {
					$(".strtDt").datepicker({
                    dateFormat: 'dd-M-yy',
                    changeMonth: true,
                    changeYear: true,
                   // minDate: new Date(pastdays),
                    onSelect: function (selected, evnt) {
                        document.getElementById('Availabilitysign').style.display = 'none';
                        document.getElementById('Availabilityvalue').innerHTML = "";
                        removeErrorMsgResourceAssignment();
                    }
                });
				}
	
        document.getElementById('btnSaveResource').style.display = 'block';
        txtidIndex = 0;
        var empId = data.id.split('#;')[0];
		//empId.trim();
		empId=empId.replace(/(\r\n\s|\n|\r|\s)/gm, '');
        var projectId = data.id.split('#;')[1];
        var rrfNumebr = data.id.split('#;')[2];
        var employeeRole = data.id.split('#;')[3];
        var rrfProjStartDate = data.id.split('#;')[4];
        var rrfProjEndDate = data.id.split('#;')[5];
        var rrfProjAllocation = data.id.split('#;')[6];
        var Designation = data.id.split('#;')[7];
        var status = data.id.split('#;')[9];
        var employee_email = data.id.split('#;')[10];
        var Location = data.id.split('#;')[11];
        var ProjectCode = data.id.split('#;')[12];
        var ProjectManager = data.id.split('#;')[13];
        var ClientPertner = data.id.split('#;')[14];
        var RMOSPOC = data.id.split('#;')[15];
        var ProjectName = data.id.split('#;')[16];
        var Primaryskill = data.id.split('#;')[17];
		var Resource_roleband=data.id.split('#;')[18];

		getContractTypeValue(ProjectName);

        var ResourceFullName = data.id.split('#;')[8];
        document.getElementById('rrfnumber').innerHTML = rrfNumebr;
        document.getElementById('txtEmployeeRole').value = data.id.split('#;')[3];
        $('.Toppopup h4').css('text-align', 'left');
        $('.Toppopup').css('top', '7%');
        $('.allbtn').css('text-align', 'left');
        document.getElementById('divResourceApproval').style.display = "none";
        document.getElementById('divResourceComment').style.display = "none";
        document.getElementById('divResourceRejection').style.display = "none";
        document.getElementById('divMultipleAssignment').style.display = 'none';
        document.getElementById('divResourceAssignment').style.display = "block";
        document.getElementById('Availabilitysign').style.display = 'none';
        $('.AddResource').remove();
        $('.error').css('display', 'none');
        document.getElementById('Availabilityvalue').innerHTML = "";
        document.getElementById('btnSoftblockOK').style.display = 'none';
        document.getElementById('sftblckstartDt').value = "";
        document.getElementById('sftblckendDt').value = "";
        //url = GetProjects(projectId);//"https://ppmdev.bcone.com/_api/Projects?$filter=ProjectId eq (guid'" + projectId + "')";

        //$.ajax({
        //    url: url,
        //    method: "GET",
        //    async: false,
        //    headers: { "Accept": "application/json; odata=verbose" },
        //    success: function (data) {


        if (ProjectCode != null && ProjectCode != "null") {
            document.getElementById('txtProjectCode').value = ProjectCode;
            document.getElementById('txtProjectCode').title = ProjectCode;
        }
        if (ProjectName != null && ProjectName != "null") {
            document.getElementById('txtProjectName').value = ProjectName;
            document.getElementById('txtProjectName').title = ProjectName;
        }
        if (ProjectManager != null && ProjectManager != "null") {
            document.getElementById('txtProjectManager').value = ProjectManager;
            document.getElementById('txtProjectManager').title = ProjectManager;
        }
        if (ClientPertner != null && ClientPertner != "null") {
            document.getElementById('txtclientPertner').value = ClientPertner;
            document.getElementById('txtclientPertner').title = ClientPertner;
        }
        if (RMOSPOC != null && RMOSPOC != "null") {
            document.getElementById('txtResourcemanager').value = RMOSPOC;
            document.getElementById('txtResourcemanager').title = RMOSPOC;
        }
        if (Location != null && Location != "null") {
            document.getElementById('txtPLocation').value = Location;
            document.getElementById('txtPLocation').title = Location;
        }


        //    }

        //});
        //previous Save data from RRF Library

        document.getElementById('txtAllocation').value = rrfProjAllocation;
        document.getElementById("txtstrtDt").value = convert_date_DDMMYYYY(rrfStartDate);
        document.getElementById("txtendDt").value = convert_date_DDMMYYYY(rrfEndDate);
        $('.txtEmployeeRole').val(employeeRole);
        //url = GetProjectWiseResourceAllocation(ProjectCode, empId); //"https://ppmdev.bcone.com/_api/ProjectWiseResourceAllocation?$filter=AllocatedProjectCode eq'" + ProjectCode + "' and EmployeeID eq'" + empId + "'";
        //var details = "";

        //$.ajax({
        //    url: url,
        //    method: "GET",
        //    async: false,
        //    headers: { "Accept": "application/json; odata=verbose" },
        //    success: function (data) {
        //        if (data.d.results.length > 0) {
        //            var allocationPercent = data.d.results[0].Allocation;
        //            ResourceFullName = data.d.results[0].ResourceFullName;
        //            var srtDate = convert_date_DDMMYYYY(data.d.results[0].Startdatetime);
        //            var endDate = convert_date_DDMMYYYY(data.d.results[0].Finishdatetime);
        //            document.getElementById('txtAllocation').value = allocationPercent;
        //            document.getElementById("txtstrtDt").value = srtDate;
        //            document.getElementById("txtendDt").value = endDate;
        //        }
        //    }
        //});
        //$('.TopclssPopupHead').text('Resource Assignment : ' + ResourceFullName);
        $('.TopclssPopupHead').html("Resource Assignment : <span href='#' id='show-popup' class='action-b pull-right'>" + ResourceFullName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + empId + "&employeename=" + ResourceFullName + "' target='_blank' >Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + empId + "&employeename=" + ResourceFullName + "' target='_blank' >View Profile</a></div></span>");
        document.getElementById('rrfnumber').innerHTML = rrfNumebr + ";" + ResourceFullName + ";" + empId + ";" + Designation + ";" + status + ";" + employee_email + ";" + Primaryskill + ";" + Resource_roleband;
        if (txtidIndex == 0) {
            document.getElementById('removeaddResource').style.display = 'none';
        }
        $('.Toppopup-bg').show();
    }

	function getContractTypeValue(ProjectName)
	{
	url = "https://ppmprod.bcone.com/_api/Projects?$select=ProjectName,ContractType&$filter=ProjectName eq '" + ProjectName +"' and ProjectStatus ne 'Closed'";
	 
            $.ajax({
                url: url,
                method: "GET",
                async: false,
                headers: { "Accept": "application/json; odata=verbose" },
                success: function (data) {
                    // $('#ddlProjectName').append(new Option("", 0));
					var res = data.d.results;
                    if (res.length > 0) {
                       
							
							document.getElementById('txtContractType').value = data.d.results[0].ContractType != "" && data.d.results[0].ContractType != "null" ? data.d.results[0].ContractType : "";
						
                    }
                    
                }
            });
	}
    //code to show resource approval popup
    function ResourceApproval(tdID) {
        var empID = tdID.id.split('#')[0];
		//empID.trim();
		empID=empID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
        LogProjectGUID = tdID.id.split('#')[1];
        $('.TopclssPopupHead').text('Are You Sure Want To Approve?');
        $('.Toppopup h4').css('text-align', 'center');
        $('.Toppopup').css('top', '25%');
        $('.allbtn').css('text-align', 'center');
        document.getElementById('divResourceRejection').style.display = "none";
        document.getElementById('divResourceComment').style.display = "none";
        document.getElementById('divResourceAssignment').style.display = "none";
        document.getElementById('divMultipleAssignment').style.display = 'none';
        document.getElementById('divResourceApproval').style.display = "block";
        document.getElementById('empIdResourceSelection').innerHTML = empID;
        $('.Toppopup-bg').show();

    }

    // Code to Approver External Hiring 

    function showExternalApprovalpopup(ResourceApprovalData) {

        var resourceApprovalRRF = ResourceApprovalData.id.split('#');
        RRFRowID = resourceApprovalRRF[0]; //ROW ID
        LogProjectGUID = resourceApprovalRRF[1]; // RRF Project GUID
        EmployeeRole = resourceApprovalRRF[2] + "#" + resourceApprovalRRF[4]; // RRF Employee Role
        pageStatus = resourceApprovalRRF[3]; // RRF Status
        GBU = resourceApprovalRRF[5]; // RRF GBU
        _MailRMOSPOCUserId = resourceApprovalRRF[10];
        _MailRRFNO = resourceApprovalRRF[13];
		Hiring_Spoc=resourceApprovalRRF[15];
        $('.popup-bg').show();
        $('.clssPopupHead').text('Are You Sure Want To Submit?');
        $('#divExternalFPNAMsgApproval').css('display', 'block');
        $('#divExternalMsg').css('display', 'none');
        $('#divExternalMsgApproval').css('display', 'none');
        $('#divApproveBody').css('display', 'none');
        $('#divstartdatepopup').css('display', 'none');
        document.getElementById('divRejectBody').style.display = "none";
        document.getElementById('divComment').style.display = "none";
        document.getElementById('divSearchResource').style.display = "none";
        document.getElementById('divViewLog').style.display = "none";

    }

    //code to show resource rejection popup
    function ResourceRejectionpopup(rejID) {
        var empID = rejID.id.split('#;')[1];
		//empID.trim();
		empID=empID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
        var empNm = rejID.id.split('#;')[2];
        var ProjectCode = rejID.id.split('#;')[3];
        var projectName = rejID.id.split('#;')[4];
        var ProjLocation = rejID.id.split('#;')[5];
        var Skill = rejID.id.split('#;')[6];
        var RRFNumber = rejID.id.split('#;')[7];
        $('.TopclssPopupHead').text('Rejection of Proposed Resources');
        $('.Toppopup h4').css('text-align', 'left');
        $('.Toppopup').css('top', '25%');
        $('.allbtn').css('text-align', 'left');
        document.getElementById('TextareaResourceReject').value = "";
        document.getElementById('divResourceApproval').style.display = "none";
        document.getElementById('divResourceComment').style.display = "none";
        document.getElementById('divResourceAssignment').style.display = "none";
        document.getElementById('divMultipleAssignment').style.display = 'none';
        document.getElementById('divResourceRejection').style.display = "block";
        document.getElementById('empIDName').innerHTML = empID + " " + empNm;
        $('#TextareaResourceReject').prop({
            'disabled': true
        });
        document.getElementById('ProjecDetails').innerHTML = empID + "#;" + empNm + "#;" + ProjectCode + "#;" + projectName + "#;" + ProjLocation + "#;" + Skill + "#;" + RRFNumber;
        url = "../_api/web/lists/getbytitle('ResourceRejectionReasonHead')/items?$select=ReasonHead,Flag&$filter=Flag eq 'Reject'";
        $.ajax({
            url: url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                $('#ddlRejectionReason').empty();
                var parentReason = [];
                var parentFlag = [];
                var childReason = [];
                var childFlag = [];
                $('#ddlRejectionReason').append(new Option("Select Reason of Rejection", 0));
                $.each(data.d.results, function (index, value) {

                    <!-- if (value.Flag.indexOf('Item') >= 0) { -->
                        <!-- childReason.push(value.ReasonHead); -->
                        <!-- childFlag.push(value.Flag); -->
                    <!-- } else { -->
                        <!-- parentReason.push(value.ReasonHead); -->
                        <!-- parentFlag.push(value.Flag); -->
                    <!-- } -->
					$('#ddlRejectionReason').append("<option data-value = '" + value.Flag + "'>" + value.ReasonHead + "</option>");
                });
                <!-- for (var i = 0; i < parentReason.length; i++) { -->
                    <!-- $('#ddlRejectionReason').append("<optgroup label = '" + parentReason[i] + "'>" + parentFlag[i] + "</optgroup>"); -->
                    <!-- for (var j = 0; j < childReason.length; j++) { -->
                        <!-- if (childFlag[j].indexOf(parentFlag[i]) >= 0) { -->
                            <!-- $('#ddlRejectionReason').append("<option data-value = '" + childFlag[j] + "'>" + childReason[j] + "</option>"); -->
                        <!-- } -->
                    <!-- } -->
                <!-- } -->
				$('#TextareaResourceReject').prop({
                    'disabled': false
                });
            }

        });

        $('.Toppopup-bg').show();

    }
    //code to show resources comment popup
    function ResourceCommentpopup(comntId) {
        var resourceId = comntId.id.split('#;')[1];
		//resourceId.trim();
		resourceId=resourceId.replace(/(\r\n\s|\n|\r|\s)/gm, '');
        var rrfNumber = comntId.id.split('#;')[3];
        document.getElementById('TextareaResourceComment').value = "";
        document.getElementById('resourceCommentSpan').innerHTML = rrfNumber + '#' + resourceId;
        $('.TopclssPopupHead').text('Please Enter Comment');
        $('.Toppopup h4').css('text-align', 'left');
        $('.allbtn').css('text-align', 'left');
        document.getElementById('divResourceApproval').style.display = "none";
        document.getElementById('divResourceRejection').style.display = "none";
        document.getElementById('divResourceAssignment').style.display = "none";
        document.getElementById('divMultipleAssignment').style.display = 'none';
        document.getElementById('divResourceComment').style.display = "block";
        var comment = document.getElementById('TextareaResourceComment').value;
        //showPreviousComment(resourceId, rrfNumber);
        var dataurl = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$filter=RRFNO eq'" + rrfNumber + "'and ResourceID eq'" + resourceId + "'&$orderby=Created desc";
        getRMOTransactionDetails(dataurl, "", "ResourceComment");
        $('.Toppopup-bg').show();
    }
    //Code to refine data based on status

    function refine_status(status, liname, PageLoad) {
        indecator_Parameter = [];
        $('.loader').show();
        setTimeout(function () {
            defer_refine_status(status, liname, PageLoad)
            $('.loader').hide();
        }, 100);
    }


    function defer_refine_status(status, liname, PageLoad) {
        ResourceTableFlag = "";
        pageStatus = status;
        $("#status").text(liname);
        if (PageLoad != "FirstTimeLoad")
            destroyjs('#RRFForm');
        table_header = "<thead><tr>";
        if (status == "allrecord") {
            //Table binding for ALL Record
            StatusFlag = "allrecord"; //
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style=''>Status</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";

            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            allrecordCount = 0;
            //url for get All records.
            //url = "../_api/web/lists/getbytitle('RRF')/items?$select=NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=(Status ne 'Fulfilled' and Status ne 'Withdrawn' and Status ne 'Rejected') and (RRFNO ne null)  and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Hiring_x0020_Spoc/Title,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,Hiring_x0020_Spoc,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=(Status ne 'Fulfilled' and Status ne 'Internally Fulfilled' and Status ne 'Withdrawn' and Status ne 'Rejected') and (RRFNO ne null) and ((Status ne 'VPHR') and (Status ne 'Recruitment Head') and (Status ne 'FPNA') and (Status ne 'Functional Head') and (Status ne 'Non Billable') and (Status ne 'Internally Fulfilled') and (Status ne 'Externally Fulfilled')) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";

        }
        else if (status == "rmovalidation") {
            //Table binding for RMO Validation
            StatusFlag = "rmovalidation";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";
            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            rmovalidationCount = 0;
            //url for get only projects with status is Submitted or RMO validation.
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'RMO Validation') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "'))&$Top=100000&$orderby=ID%20desc";
        }
        else if (status == "fpnapproval") {

            // //Table binding for FPNA Approval
            StatusFlag = "fpnapproval";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";
            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            fpnapprovalCount = 0;
            //url for get only project with status is FPNA Approval.
            /*url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,PendingWith/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,PendingWithId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,Hiring_x0020_Spoc,PendingWith&$Filter=Status eq 'Initiated External Hiring' and (RRFNO ne null) and (FPNAUser eq '" + LoginUserID + "')&$Top=100000&$orderby=ID%20desc";*/

            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,PendingWith/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,PendingWithId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,Hiring_x0020_Spoc,PendingWith&$Filter=(Status eq 'Initiated External Hiring') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "'))&$Top=100000&$orderby=ID%20desc";
        }
        else if (status == "resourceproposed") {

            //Table binding for Resource Proposed
            StatusFlag = "resourceproposed";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";
            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            resourceproposedCount = 0;
            //url for get only projects with status is Resource Proposed.
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,PendingWith/Title,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=Status eq 'Resource Proposed' and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "'))&$Top=100000&$orderby=ID%20desc";
        }
        else if (status == "resourceselection") {

            //Table binding for Resource Selection
            StatusFlag = "resourceselection";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";
            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            resourceselectionCount = 0;
            //url for get only projects with status is Resource Selection.
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=ResourceAgainstRRFInWD,Hiring_x0020_Spoc,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=Status eq 'Resource Selection' and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "'))&$Top=100000&$orderby=ID%20desc";
        }
        else if (status == "fulfilled" || status == "Internally Fulfilled") {

            //Table binding for Fulfilled
            StatusFlag = "fulfilled";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";
            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            fulfilledCount = 0;
            //url for get only projects with status is Resource Allocation and Offer.
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Fulfilled' or Status eq 'Internally Fulfilled') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
        }
        else if (status == "withdrawn") {

            //Table binding for Withdrawn
            StatusFlag = "withdrawn";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Withdrawn/Rejected Date</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Status</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "</tr></thead>";
            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + " </tr></tfoot>";
            withdrawnCount = 0;
            //url for get only projects with status is Withdrawn.
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,Modified,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Withdrawn' or Status eq 'Rejected') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
        }
        else if (status == "rrfsaved") {

            //Table binding for RRF Saved.
            StatusFlag = "rrfsaved";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";

            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            //rrfsavedCount = 0;
            //url for get only projects with status is Draft.
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Draft' or Status eq 'RRF Saved') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "'))&$Top=100000&$orderby=ID%20desc";
        }
        else if (status == "externalhiring") {

            //Table binding for RRF Saved.
            StatusFlag = "externalhiring";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th style=''>Status</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "</tr></thead>";

            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + " </tr></tfoot>";
            rrfexternalHiring = 0;
            //url for get only projects with status is Draft.
            //url = "../_api/web/lists/getbytitle('RRF')/items?$select=NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ExternalHiring,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ResourceAgainstRRFInWDId,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Reference Check' or Status eq 'Offer' or Status eq 'External Hiring' or Status eq 'Internally Fulfilled' or Status eq 'External') and (Status ne 'Fulfilled') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "')or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";

			//brackets missing getting empty data
           // url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,HiringSpocMail,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ExternalHiring,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Hiring_x0020_Spoc/Title,Customer,GBU,EmployeeRole,NonBillableFlag,ResourceAgainstRRFInWDId,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$Expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,Hiring_x0020_Spoc,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Reference Check' or Status eq 'Offer' or Status eq 'External Hiring' or Status eq 'External') and (Status ne 'Fulfilled') and (Status ne 'Internally Fulfilled') and (EmployeeRole eq 'Billable Consultant') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "')or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
           
		  url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ExternalHiring,ProjectCode,PendingWithId,RequirementPct,RRFCreatedDate,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Hiring_x0020_Spoc/Title,Customer,GBU,EmployeeRole,NonBillableFlag,ResourceAgainstRRFInWDId,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,Hiring_x0020_Spoc,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser&$Filter=(Status eq 'Screen' or Status eq 'Assessment' or Status eq 'Interview' or Status eq 'Reference' or Status eq 'Check' or Status eq 'Review' or Status eq 'Offer' or Status eq 'External Hiring' or Status eq 'Reference Check') and (EmployeeRole eq 'Billable Consultant') and (RRFNO ne null) and (NewAuthorId eq '" + LoginUserID + "' or ReportingToUser eq '" + LoginUserID + "' or ClientPartnerUser eq '" + LoginUserID + "' or ProjectManagerUser eq '" + LoginUserID + "' or FPNAUser eq '" + LoginUserID + "' or RMOSPOCUser eq '" + LoginUserID + "' or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
           
		 
        }
        else if (status == "rrfnonbillable") {

            //Table to bind NonBillable data
            StatusFlag = "rrfnonbillable";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:'>Action</th>"
            table_header = table_header + "<th style='width:'>RRF No.</th>"
            table_header = table_header + "<th style='width:'>Project</th>"
            table_header = table_header + "<th style='width:'>Customer Name</th>"
            table_header = table_header + "<th style='width:'>Primary Skill</th>"
            table_header = table_header + "<th style='width:' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:'>Work Location</th>"
            table_header = table_header + "<th style='width:'>Role-Band</th>"
            table_header = table_header + "<th style='' id='sord-disable'>Submitted Date</th>"
            table_header = table_header + "<th>Status</th>"
            table_header = table_header + "<th style=''>Pending With</th>"
            table_header = table_header + "<th style='width:'>Indicators</th>"
            table_header = table_header + "</tr></thead>";

            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            //rrfsavedCount = 0;
            //url for get only projects with status is Draft.
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,HiringSpocMail,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,RequirementPct,RRFCreatedDate,NewAuthor/Title,PendingWith/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,NonBillableFlag,PendingWithId,EmployeeRole,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status,Hiring_x0020_Spoc/Title&$expand=Hiring_x0020_Spoc,ResourceAgainstRRFInWD,PendingWith,NewAuthor&$Filter=(EmployeeRole ne 'Billable' and EmployeeRole ne 'Billable Consultant') and ((Status eq 'VPHR') or (Status eq 'Recruitment Head') or (Status eq 'FPNA') or (Status eq 'Functional Head') or (Status eq 'Non Billable') or (Status eq 'External Hiring')) and ((Status ne 'Withdrawn') or (Status ne 'Rejected') or (Status ne 'Fulfilled') or (Status ne 'Internally Fulfilled') or (Status ne 'Externally Fulfilled')) and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or (PendingWithId eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
        }
		else if (status == "externnallyfullfilled") {
            //Table binding for ALL Record
            StatusFlag = "allrecord"; //
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th style='width:7%'>Action</th>"
            table_header = table_header + "<th style='width:10%'>RRF No.</th>"
            table_header = table_header + "<th style='width:20%'>Project Name</th>"
            table_header = table_header + "<th style='width:9%'>Customer Name</th>"
            table_header = table_header + "<th style='width:9%'>Primary Skill</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>Start Date</th>"
            table_header = table_header + "<th style='width:8%' id='sord-disable'>End Date</th>"
            table_header = table_header + "<th style='width:8%' >Sub Practice</th>"
            table_header = table_header + "<th style='width:8%'>Work Location</th>"
            table_header = table_header + "<th style='width:8%'>Role-Band</th>"
            table_header = table_header + "<th style=''>Status</th>"
            table_header = table_header + "<th style='width:9%'>Indicators</th>"
            table_header = table_header + "</tr></thead>";

            //footer menu
            table_header = table_header + "<tfoot><tr>";
            table_header = table_header + "<th style='display: none;'>ID</th>"
            table_header = table_header + "<th>Action</th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th></th>"
            table_header = table_header + "<th>Indicators</th>"
            table_header = table_header + " </tr></tfoot>";
            allrecordCount = 0;
            //url for get All records.
            //url = "../_api/web/lists/getbytitle('RRF')/items?$select=NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=(Status ne 'Fulfilled' and Status ne 'Withdrawn' and Status ne 'Rejected') and (RRFNO ne null)  and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";
            url = "../_api/web/lists/getbytitle('RRF')/items?$select=HiringSpocMail,FPNAFlag,NonApprovers,InternallyFulfilled,WorkLocation,NewProjectStartDate,NewProjectEndDate,ResourceProposedFlag,TATDateTime,SubmittedDate,CloneType,ProjectCode,ExternalHiring,RequirementPct,RRFCreatedDate,PendingWith/Title,ProjectManagerUser/Title,NewAuthor/Title,FPNAUser/Title,ReportingToUser/Title,ClientPartnerUser/Title,RMOSPOCUser/Title,ResourceAgainstRRFInWD/EMail,Hiring_x0020_Spoc/Title,Customer,GBU,EmployeeRole,NonBillableFlag,ProjectManagerUserId,FPNAUserId,ReportingToUserId,ClientPartnerUserId,RMOSPOCUserId,NewAuthorId,PendingWithId,ID,ProjectName,LinkFilename,MinRelevantExp,IndustryExp,SecondarySkill,PrimarySkill,RoleBand,ProjectGUID,RRFNO,SubPractice,NewStartDate,NewEndDate,StartDate,EndDate,BaseLocation,RoleBand,Billability,Status&$Expand=ResourceAgainstRRFInWD,Hiring_x0020_Spoc,ProjectManagerUser,NewAuthor,FPNAUser,ReportingToUser,ClientPartnerUser,RMOSPOCUser,PendingWith&$Filter=(Status eq 'Externally Fulfilled') and (RRFNO ne null) and ((NewAuthorId eq '" + LoginUserID + "') or (ReportingToUser eq '" + LoginUserID + "') or (ClientPartnerUser eq '" + LoginUserID + "') or (ProjectManagerUser eq '" + LoginUserID + "') or (FPNAUser eq '" + LoginUserID + "') or (RMOSPOCUser eq '" + LoginUserID + "') or substringof('" + LoginUserID_for_substring + "',NonApprovers))&$Top=100000&$orderby=ID%20desc";

        }

        //Call Rest API to Get Data from List
        var listname = "RRF";
        $.ajax({
            url: url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                //document.getElementById('rrfallrecordcount').innerHTML = allrecordCount;
                document.getElementById('rrfrmovalidationcount').innerHTML = rmovalidationCount;
                //document.getElementById('rrfnonbillable').innerHTML = rrfnonbillable;
                document.getElementById('rrfresourceproposedcount').innerHTML = resourceproposedCount;
                document.getElementById('rrfresourceselectioncount').innerHTML = resourceselectionCount;
                document.getElementById('rrffulfilledcount').innerHTML = fulfilledCount;
                document.getElementById('rrfwithdrawncount').innerHTML = withdrawnCount;
                //document.getElementById('rrfsavedcount').innerHTML = rrfsavedCount;
                document.getElementById('rrfexternalhiring').innerHTML = rrfexternalHiring;
                if (status == "allrecord") {
                    allrecordCount = data.d.results.length;
                } else {
                    if (data.d.results.length > 0)
                        TATMappingDays = getRRFTATdaysbyStatus(data.d.results[0].Status);
                }
                var RRFLIHTML = "<tbody>";
                var tdId = "";
                var rejId = "";
                var cmntID = "";
                $.each(data.d.results, function (key, value) {
                    var ProjectName = "";
                    var ProjectGUID = "";
                    var RRFNO = "";
                    var StartDate = "";
                    var EndDate = "";
                    var Location = "";
                    var RoleBand = "";
                    var Billability = "";
                    var RRFStatus = "";
                    var projRRFNo = "";
                    var RRFCreatedDate = "";
                    var NonBillableResourceData = "";

                    if (value.ProjectName != null) {
                        ProjectName = value.ProjectName;
                    }
                    else if (value.LinkFilename != null) {
                        ProjectName = value.LinkFilename;
                    }
                    if (value.ProjectGUID != null) {
                        ProjectGUID = value.ProjectGUID;
                    }
                    if (value.RRFNO != null) {
                        RRFNO = value.RRFNO;
                    }

                    if (value.StartDate != null) {
                        StartDate = convert_date_DDMMYYYY(value.NewStartDate);
                    }
                    if (value.EndDate != null) {
                        EndDate = convert_date_DDMMYYYY(value.NewEndDate);
                    }
                    if (value.WorkLocation != null) {
                        Location = value.WorkLocation;
                    }
                    if (value.RoleBand != null) {
                        RoleBand = value.RoleBand;
                    }
                    if (value.Customer != null) {
                        Customer = value.Customer;
                    } else {
                        Customer = "";
                    }

                    if (value.Status != null) {
                        RRFStatus = value.Status;
                    }
                    if (value.SubmittedDate != null) {
                        RRFCreatedDate = convert_date_DDMMYYYY(value.SubmittedDate);
                    }


                    if (PageLoad == "FirstTimeLoad") {
                        if (value.Status == "RMO Validation" || value.Status == "Submitted") {
                            rmovalidationCount++;
                        }
                        else if (value.Status == "Resource Proposed") {
                            resourceproposedCount++;
                        }
                        else if (value.Status == "Resource Selection") {
                            resourceselectionCount++;
                        }
                        else if (value.Status == "Resource Allocation") {
                            fulfilledCount++;
                        }
                        else if (value.Status == "Withdrawn" || value.Status == "Rejected") {
                            withdrawnCount++;
                        }

                       // else if (value.Status=="External Hiring") {
					   else if (value.Status == "Offer" || value.Status == "External Hiring" || value.Status == "Review" || value.Status == "Screen" || value.Status == "Assessment" || value.Status == "Interview" || value.Status == "Reference" || value.Status == "Check") {
                            rrfexternalHiring++;
                        }
                        else if (value.Status == "Fulfilled" || value.Status=="Internally Fulfilled") {
                            fulfilledCount++;
                        }
                    }
                    else {
                        if (status == "allrecord") {
                            allrecordCount;
                        }
                        else if (status == "rmovalidation") {
                            rmovalidationCount++;
                        }
                        else if (status == "resourceproposed") {
                            resourceproposedCount++;
                        }
                        else if (status == "resourceselection") {
                            resourceselectionCount++;
                        }
                        else if (status == "fulfilled" || value.Status=="Internally Fulfilled") {
                            fulfilledCount++;
                        }
                        else if (status == "withdrawn") {
                            withdrawnCount++;
                        }

                        else if (status == "externalhiring") {
                            rrfexternalHiring++;
                        }
                    }
                    if ((key < 5 && value.Status != "External Hiring" && value.Status != "Offer" && value.Status != "Review" && value.Status != "Screen" && value.Status != "Assessment" && value.Status != "Interview" && value.Status != "Reference" && value.Status != "Check")) { //changes by varsha 12-sep
                        if ((value.PrimarySkill != null || value.SecondarySkill != null) && value.RoleBand != null) {
                            var serviceurl = EmployeeAvailability(); //"https://ppmdev.bcone.com/api/RMO/EmployeeAvailability";
                            requestData = "{\"PrimarySkills\":\"" + value.PrimarySkill + "\",\"SecondarySkills\":\"" + value.SecondarySkill + "\",\"RoleBand\":\"" + value.RoleBand + "\",\"StartDate\":\"" + value.NewStartDate + "\",\"EndDate\":\"" + value.NewEndDate + "\"}";
                            $.ajax({

                                url: serviceurl,
                                method: "POST",
                                data: requestData,
                                async: false,
                                dataType: "json",
                                headers:
                                {
                                    "content-Type": "application/json"
                                },
                                success: function (data) {
                                    TotalCount = data.EmployeeAvailability[0].Total;
                                    BookedCount = data.EmployeeAvailability[2].Booked;
                                    FreeCount = data.EmployeeAvailability[1].Free;
                                }
                            });
                        } else {
                            TotalCount = 0;
                            BookedCount = 0;
                            FreeCount = 0;
                        }
                    } else {
                        TotalCount = 0;
                        BookedCount = 0;
                        FreeCount = 0;
                    }

                    //value.SubmittedDate;
                    if (status == "externalhiring")
                        ResourceData = value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand + "#" + value.IndustryExp + "#" + value.MinRelevantExp + "#" + value.RRFNO + "#" + value.Status + "#" + value.SubPractice + "#" + value.ProjectName + "#" + value.WorkLocation + "#" + value.NewProjectStartDate + "#" + value.NewProjectEndDate + "#" + value.NewAuthorId + "#" + value.RMOSPOCUserId + "#" + value.ProjectManagerUserId + "#" + value.FPNAUserId + "#" + value.ReportingToUserId + "#" + value.ClientPartnerUserId + "#" + value.EmployeeRole + "#" + value.RequirementPct + "#" + value.ProjectManagerUser.Title + "#" + value.ClientPartnerUser.Title + "#" + value.RMOSPOCUser.Title + "#" + value.ProjectCode + "#" + value.ResourceAgainstRRFInWD.EMail + "#" + value.ExternalHiring + "#" + value.NewStartDate + "#" + value.NewEndDate + "#" + value.InternallyFulfilled+"#"+value.HiringSpocMail+"#"+value.FPNAFlag;
                    else if (status == "rrfnonbillable")
                        NonBillableResourceData = value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand + "#" + value.IndustryExp + "#" + value.MinRelevantExp + "#" + value.RRFNO + "#" + value.Status + "#" + value.SubPractice + "#" + value.ProjectName + "#" + value.WorkLocation + "#" + value.NewProjectStartDate + "#" + value.NewProjectEndDate + "#" + value.NewAuthorId + "#" + value.RMOSPOCUserId + "#" + value.ProjectManagerUserId + "#" + value.FPNAUserId + "#" + value.ReportingToUserId + "#" + value.ClientPartnerUserId + "#" + value.EmployeeRole + "#" + value.RequirementPct + "#" + "" + "#" + "" + "#" + "" + "#" + value.ProjectCode + "#" + value.ResourceAgainstRRFInWD.EMail + "#" + value.ExternalHiring + "#" + value.NewStartDate + "#" + value.NewEndDate + "#" + value.InternallyFulfilled + "#" + value.HiringSpocMail+"#"+value.FPNAFlag;
                    else
                        ResourceData = value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand + "#" + value.IndustryExp + "#" + value.MinRelevantExp + "#" + value.RRFNO + "#" + value.Status + "#" + value.SubPractice + "#" + value.ProjectName + "#" + value.WorkLocation + "#" + value.NewProjectStartDate + "#" + value.NewProjectEndDate + "#" + value.NewAuthorId + "#" + value.RMOSPOCUserId + "#" + value.ProjectManagerUserId + "#" + value.FPNAUserId + "#" + value.ReportingToUserId + "#" + value.ClientPartnerUserId + "#" + value.EmployeeRole + "#" + value.RequirementPct + "#" + value.ProjectManagerUser.Title + "#" + value.ClientPartnerUser.Title + "#" + value.RMOSPOCUser.Title + "#" + value.ProjectCode + "#" + value.ResourceAgainstRRFInWD.EMail + "#" + value.ExternalHiring + "#" + value.NewStartDate + "#" + value.NewEndDate + "#" + value.InternallyFulfilled + "#" + value.HiringSpocMail+"#"+value.FPNAFlag;

                    ResourceApprovalData = value.ID + "#" + value.ProjectGUID + "#" + value.EmployeeRole + "#" + value.Status + "#" + value.NonBillableFlag + "#" + value.GBU + "#" + value.EmployeeRole + "#" + value.ProjectManagerUserId + "#" + value.PendingWithId + "#" + value.NonApprovers + "#" + value.RMOSPOCUserId + "#" + value.ClientPartnerUserId + "#" + value.NewAuthorId + "#" + value.RRFNO+"#"+value.HiringSpocMail+"#"+value.FPNAFlag;
                    //document.getElementById('rrfallrecordcount').innerHTML = allrecordCount;
                    document.getElementById('rrfrmovalidationcount').innerHTML = rmovalidationCount;
                    //document.getElementById('rrfnonbillable').innerHTML = rrfnonbillable;
                    document.getElementById('rrfresourceproposedcount').innerHTML = resourceproposedCount;
                    document.getElementById('rrfresourceselectioncount').innerHTML = resourceselectionCount;
                    document.getElementById('rrffulfilledcount').innerHTML = fulfilledCount;
                    document.getElementById('rrfwithdrawncount').innerHTML = withdrawnCount;
                    //document.getElementById('rrfsavedcount').innerHTML = rrfsavedCount;
                    document.getElementById('rrfexternalhiring').innerHTML = rrfexternalHiring;
                    tdId = "imgbtnApprove" + key;
                    rejId = "imgbtnReject" + key;
                    cmntID = "imgbtnComment" + key;
                    if (value.Status == "RMO Validation" || value.Status == "Resource Proposed")
                        projRRFNo = value.ProjectGUID + "#;" + (value.LinkFilename.split('.')[0]) + "#;" + value.RRFNO + "#;" + value.RequirementPct + "#;" + value.EmployeeRole + "#;" + value.Status + "#;" + value.FPNAUserId + "#;" + value.RMOSPOCUserId + "#;" + value.NewAuthorId + "#;" + value.ProjectManagerUserId;
                    else
                        projRRFNo = value.ProjectGUID + "#;" + (value.LinkFilename.split('.')[0]) + "#;" + value.RRFNO + "#;" + value.Status;
                    var totalResourceId = "Total" + key;
                    var BookedResourceId = "Booked" + key;
                    var FreeResourceId = "Free" + key;
                    //var rrfprojectName = value.LinkFilename;
                    var IndicatorParameter = value.ID + "#" + value.ProjectGUID + "#" + value.PrimarySkill + "#" + value.SecondarySkill + "#" + value.RoleBand + "#" + value.NewStartDate + "#" + value.NewEndDate;
                    indecator_Parameter.push(IndicatorParameter);

                    var clone = "";;
                    if (value.CloneType != null) {
                        clone = "<span class='clone'>Clone</span>";
                    }
                    else {
                        clone = "";
                    }
                    var ExternalInitated = "";
                    if ((value.InternallyFulfilled != null && value.InternallyFulfilled != "") && (value.Status=="Internally Fulfilled")) {
                        ExternalInitated = "<span class='clone'>Internally Fulfilled</span>";
                    }
                    else {
                        ExternalInitated = "";
                    }


                    //var SOWTatDate = dt.format("d-MMM-yy");
                    //var days = new Date(value.SubmittedDate.getDate() - i);

                    var BusinessDaysCount = "";

                    if (value.TATDateTime != "" && value.TATDateTime != null) {
                        if (status != "allrecord" && TATMappingDays.length > 0) {

                            var totalweekdays = "";
                            var newDate = new Date();
                            var submittedDate = new Date(value.TATDateTime);
                            var TodayDate = new Date(newDate);
                            submittedDate.setHours(0, 0, 0, 0);
                            TodayDate.setHours(0, 0, 0, 0);
                            var timeDiff_ = new Date(TodayDate - submittedDate);
                            var diffDays_ = timeDiff_ / 1000 / 60 / 60 / 24;
                            for (var i = submittedDate; i <= TodayDate;) {
                                if (i.getDay() != 0 && i.getDay() != 6) {
                                    totalweekdays++;
                                }
                                //if (i.getDay() == 6) {
                                //    totalweekdays++;
                                //}
                                i.setTime(i.getTime() + 1000 * 60 * 60 * 24);
                            }
                            var Total_Week_days = parseInt(totalweekdays);
                            diffDays_ = diffDays_ - Total_Week_days;
                            if (TATMappingDays.length > 1) {
                                $.each(TATMappingDays, function (Flagkey, Flag_Value) {
                                    if ((value.ResourceProposedFlag == "1" || value.ResourceProposedFlag == 1) && (Flag_Value.Flag == 1)) {
                                        var T_days = Flag_Value.TATDays;
                                        T_days = parseInt(T_days);

                                        if (diffDays_ > T_days) {
                                            BusinessDaysCount = "<div class='bgred'>" + diffDays_ + " - D</div>";
                                        }
                                        else if (diffDays_ > 0) {
                                            BusinessDaysCount = "<div class='bggreen'>" + diffDays_ + " - D</div>";
                                        }
                                    } else {
                                        var T_days = Flag_Value.TATDays;
                                        T_days = parseInt(T_days);

                                        if (diffDays_ > T_days) {
                                            BusinessDaysCount = "<div class='bgred'>" + diffDays_ + " - D</div>";
                                        }
                                        else if (diffDays_ > 0) {
                                            BusinessDaysCount = "<div class='bggreen'>" + diffDays_ + " - D</div>";
                                        }
                                    }

                                });
                            } else {
                                var T_days = TATMappingDays[0].TATDays;
                                T_days = parseInt(T_days);

                                if (diffDays_ > T_days) {
                                    BusinessDaysCount = "<div class='bgred'>" + diffDays_ + " - D</div>";
                                }
                                else if (diffDays_ > 0) {
                                    BusinessDaysCount = "<div class='bggreen'>" + diffDays_ + " - D</div>";
                                }
                            }
                        }
                    }
                    if (status == "rrfnonbillable") {
						if ((value.NonBillableFlag == null && LoginUserID == value.NewAuthorId) || (value.Status=="Non Billable")) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + NonBillableResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.Status + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
						else if ((value.NonBillableFlag == null && LoginUserID == value.NewAuthorId) || (value.Status=="External Hiring")) {
						var hiringspoc=value.Hiring_x0020_Spoc.Title;
						if(hiringspoc==undefined || hiringspoc==null)
						{
							hiringspoc="";
						}
						var hiringspocmail=value.HiringSpocMail;
						var spocemail="";
						var spocnumber="";
						if(hiringspocmail!=undefined || hiringspocmail!=null)
						{
							spocemail=hiringspocmail.split("#")[1];
							spocnumber=hiringspocmail.split("#")[2];
						}
                         RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + NonBillableResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.Status + "</td><td><span href='#' id='show-popup' style='color:blue' class='action-b'>" + hiringspoc + "<div class='action-b-view' style='left: -65px;top: -40px;'><span target='_blank'>"+spocemail+"</span><br/><span target='_blank'>"+spocnumber+"</span></div></span></td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + NonBillableResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.Status + "</td><td>" + value.PendingWith.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else {
                            var NonPendingWith = "";
                            if (value.NonBillableFlag == null)
                                NonPendingWith = value.NewAuthor.Title;
                            else if (value.NonBillableFlag == 1)
                                NonPendingWith = value.PendingWith.Title;
                            else
                                NonPendingWith = "";

                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.Status + "</td><td>" + NonPendingWith + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }

                    }
                    else if (status == "allrecord") {
                        if ((value.Status == "Draft" || value.Status == "RRF Saved") && value.NewAuthorId == LoginUserID) {

                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.NewAuthor.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                            //Check RMO ID
                        else if ((value.Status == "RMO Validation") && value.RMOSPOCUserId == LoginUserID) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.RMOSPOCUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                            //Check RMO ID
                        else if (value.Status == "Resource Proposed" && (value.RMOSPOCUserId == LoginUserID || value.NewAuthorId == LoginUserID)) {

                            var PendingWithTitle = "";
                            var ExternalLink = "";

                            if (value.PendingWithId != -1) {
                                PendingWithTitle = value.ProjectManagerUser.Title;
                                rejecticon = "";
                                ExternalLink = "";
                            }
                            else {
                                PendingWithTitle = value.ProjectManagerUser.Title;

                                rejecticon = "<div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div>";
                                //ExternalLink = "<div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='fa fa-external-link-square' aria-hidden='true' onclick='ExternalPopUp(this)'></span><div class='tooltiptext-1' style='width:100px !important'>External Hiring</div></div>";
                            }


                            if (value.RMOSPOCUserId == LoginUserID) {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div>" + ExternalLink + "</div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + PendingWithTitle + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
								
                            }
                            else {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + PendingWithTitle + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            }
                        }
                        else if (value.Status == "Resource Selection" && value.RMOSPOCUserId == LoginUserID) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.RMOSPOCUser.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                            //Check RMO ID
                        else if (value.Status == "Resource Allocation" && value.RMOSPOCUserId == LoginUserID) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.RMOSPOCUser.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "Fulfilled" || value.Status == "Internally Fulfilled") {
                            if (value.EmployeeRole != "Billable" && value.EmployeeRole != "Billable Consultant") // changed by Abhishek 13 09 17
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            else
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "Withdrawn" || value.Status == "Rejected") {
                            if (value.NewAuthorId == LoginUserID) {
                                if (value.EmployeeRole != "Billable" && value.EmployeeRole != "Billable Consultant") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='action-view'><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.NewAuthor.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                                }
                                else {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td><td>" + value.NewAuthor.Title + "</td><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                                }
                            }
                            else {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td><td>" + value.NewAuthor.Title + "</td><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            }
                        }
                        else if (value.Status == "Offer" || value.Status == "External Hiring" || value.Status == "Review" || value.Status == "Screen" || value.Status == "Assessment" || value.Status == "Interview" || value.Status == "Reference" || value.Status == "Check") {
						var hiringspoc=value.Hiring_x0020_Spoc.Title;
						if(hiringspoc==undefined || hiringspoc==null)
						{
							hiringspoc="";
						}
						var hiringspocmail=value.HiringSpocMail;
						var spocemail="";
						var spocnumber="";
						if(hiringspocmail!=undefined || hiringspocmail!=null)
						{
							spocemail=hiringspocmail.split("#")[1];
							spocnumber=hiringspocmail.split("#")[2];
						}
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td><span href='#' id='show-popup' style='color:blue' class='action-b'>" + hiringspoc + "<div class='action-b-view'><span>"+spocemail+"</span><br/><span>"+spocnumber+"</span></div></span></td><td></td></tr>"
                        }
                        else if (value.NonBillableFlag == null && LoginUserID == value.NewAuthorId && value.Status == "Non Billable") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.NewAuthor.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "FPNA") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.PendingWith.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "Recruitment Head") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.PendingWith.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "VPHR") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.PendingWith.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "Functional Head") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.PendingWith.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "Initiated External Hiring" && LoginUserID == value.FPNAUserId) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.FPNAUser.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "Non Billable") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.NewAuthor.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "FPNA" || value.Status == "Recruitment Head" || value.Status == "VPHR" || value.Status == "Functional Head") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + value.PendingWith.Title + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }

                        

                        else {
                            var PendingWith = "";
                            if (value.Status == "RRF Saved") {
                                PendingWith = value.NewAuthor.Title;
                            }
                            else if (value.Status == "RMO Validation") {
                                PendingWith = value.RMOSPOCUser.Title;
                            }
                            else if (value.Status == "Resource Proposed") {
                                if (value.PendingWithId != -1) {
                                    PendingWith = value.ProjectManagerUser.Title;
                                    rejecticon = "";
                                    ExternalLink = "";
                                }
                                else {
                                    PendingWith = value.RMOSPOCUser.Title;
                                }

                            }
                            else if (value.Status == "Resource Selection") {
                                PendingWith = value.RMOSPOCUser.Title;
                            }
                            else if (value.Status == "External Hiring") {
                                PendingWith = value.FPNAUser.Title;
                            }
                            else if (value.Status == "Functional Head" || value.Status == "Non Billable") {
                                PendingWith = value.NewAuthor.Title;
                            }
                            else if (value.Status == "FPNA" || value.Status == "Recruitment Head" || value.Status == "VPHR") {
                                PendingWith = value.PendingWith.Title;
                            }
                            else if (value.Status == "Initiated External Hiring") {
                                PendingWith = value.FPNAUser.Title;
                            }
                            else {
                                PendingWith = "";
                            }
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td>" + PendingWith + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                    }
                    else {
                        if ((value.Status == "Draft" || value.Status == "RRF Saved") && value.NewAuthorId == LoginUserID) {

                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Submit</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                            //Check RMO ID
                        else if ((value.Status == "RMO Validation") && (value.RMOSPOCUserId == LoginUserID || value.NewAuthorId == LoginUserID)) {


                            if (value.RMOSPOCUserId == LoginUserID) {
                                //RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='fa fa-external-link-square' aria-hidden='true' onclick='ExternalPopUp(this)'></span><div class='tooltiptext-1' style='width:100px !important'>External Hiring</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.RMOSPOCUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
								RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + ResourceApprovalData + "' class='fa fa-external-link-square' aria-hidden='true' onclick='ExternalPopUp(this)'></span><div class='tooltiptext-1' style='width:100px !important'>External Hiring</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.RMOSPOCUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            }
                            else if (value.NewAuthorId == LoginUserID) {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.RMOSPOCUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            }

                        }
                            //Check RMO ID


                            //Check RMO ID
                        else if (value.Status == "Resource Allocation" && value.RMOSPOCUserId == LoginUserID) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.RMOSPOCUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "Fulfilled" || value.Status == "Internally Fulfilled") {
                            if (value.EmployeeRole != "Billable" && value.EmployeeRole != "Billable Consultant") // changed by Abhishek 13 09 17
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            else
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "Rejected") {
                            var ModifiedDate = "";
                            if (value.Modified != null) {
                                ModifiedDate = convert_date_DDMMYYYY(value.Modified);
                            }

                            if (value.NewAuthorId == LoginUserID) {
                                if (value.EmployeeRole != "Billable" && value.EmployeeRole != "Billable Consultant") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Submit</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + ModifiedDate + "</td><td>" + value.Status + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td></tr>"
                                }
                                else {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Submit</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + ModifiedDate + "</td><td>" + value.Status + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td></tr>"
                                }
                            }
                            else {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + ModifiedDate + "</td><td>" + value.Status + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td></tr>"
                            }
                        }
						else if (value.Status == "Withdrawn") {
                            var ModifiedDate = "";
                            if (value.Modified != null) {
                                ModifiedDate = convert_date_DDMMYYYY(value.Modified);
                            }

                            if (value.NewAuthorId == LoginUserID) {
                                if (value.EmployeeRole != "Billable" && value.EmployeeRole != "Billable Consultant") {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + ModifiedDate + "</td><td>" + value.Status + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td></tr>"
                                }
                                else {
                                    RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + ModifiedDate + "</td><td>" + value.Status + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td></tr>"
                                }
                            }
                            else {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + ModifiedDate + "</td><td>" + value.Status + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td></tr>"
                            }
                        }
                        else if (value.Status == "Offer" || value.Status == "External Hiring" || value.InternallyFulfilled == "External" || value.Status == "Review" || value.Status == "Screen" || value.Status == "Assessment" || value.Status == "Interview" || value.Status == "Reference Check" || value.Status == "Check" && StatusFlag == "externalhiring") {

                            var PendingWith = "";
                            if (value.Status == "Resource Proposed") {
                                PendingWith = value.ProjectManagerUser.Title;
                            }
                            else if (value.Status == "Resource Selection") {
                                PendingWith = value.RMOSPOCUser.Title;
                            }
                            else {
                                PendingWith = "";

                            }
							var hiringspoc=value.Hiring_x0020_Spoc.Title;
						if(hiringspoc==undefined || hiringspoc==null)
						{
							hiringspoc="";
						}
						var hiringspocmail=value.HiringSpocMail;
						var spocemail="";
						var spocnumber="";
						if(hiringspocmail!=undefined || hiringspocmail!=null)
						{
							spocemail=hiringspocmail.split("#")[1];
							spocnumber=hiringspocmail.split("#")[2];
						}
                        if (value.Status == "Externally Fulfilled") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>"+value.SubPractice+"</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }


                        else if ((value.RMOSPOCUserId == LoginUserID || value.NewAuthorId == LoginUserID) && value.Status != "Offer") {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.Status + "</td><td><span href='#' id='show-popup' style='color:blue' class='action-b'>" + hiringspoc + "<div class='action-b-view'><span>"+spocemail+"</span><br/><span>"+spocnumber+"</span></div></span></td></tr>"
                            }

                            else if (value.Status == "Resource Proposed" && (LoginUserID == value.FPNAUserId || LoginUserID == value.RMOSPOCUserId || LoginUserID == value.ClientPartnerUserId || LoginUserID == value.NewAuthorId || LoginUserID == value.ReportingToUserId )) 
                            {

                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>"+value.SubPractice+"</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.ProjectManagerUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                            else {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.Status + "</td><td><span href='#' id='show-popup' style='color:blue' class='action-b'>" + hiringspoc + "<div class='action-b-view'><span>"+spocemail+"</span><br/><span></tr>"

                            }
                        }
                        else if (value.Status == "Resource Proposed" && (value.RMOSPOCUserId == LoginUserID || value.NewAuthorId == LoginUserID)) {
                            var PendingWithTitle = "";
                            var ExternalLink = "";

                            if (value.PendingWithId != -1 && value.PendingWithId != null && value.PendingWithId != "null") {
                                PendingWithTitle = value.ProjectManagerUser.Title;
                                rejecticon = "";
                                ExternalLink = "";
                            }
                            else {
                                PendingWithTitle = value.ProjectManagerUser.Title;

                                rejecticon = "<div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div>";
                                ExternalLink = "<div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='fa fa-external-link-square' aria-hidden='true' onclick='ExternalPopUp(this)'></span><div class='tooltiptext-1' style='width:100px !important'>External Hiring</div></div>";
                            }

                            if (value.RMOSPOCUserId == LoginUserID) {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'>" + rejecticon + "<div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div>" + ExternalLink + "<div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + PendingWithTitle + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            }
                            else {
                                RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + PendingWithTitle + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                            }
                        }
                        else if (value.Status == "Resource Selection" && value.RMOSPOCUserId == LoginUserID) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div><div class='tooltip-1'><span id='" + ResourceApprovalData + '#;View' + "' class='fa fa-share-square-o' aria-hidden='true' onclick='WithdrawRRF(this)'></span><div class='tooltiptext-1' style='width:100px !important'>Withdraw RRF</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.RMOSPOCUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == null && LoginUserID == value.NewAuthorId && value.Status == "Non Billable") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Submit</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.NewAuthor.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "FPNA") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.PendingWith.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "Recruitment Head") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.PendingWith.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "VPHR") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.PendingWith.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.NonBillableFlag == 1 && LoginUserID == value.PendingWithId && value.Status == "Functional Head") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.PendingWith.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                        else if (value.Status == "Initiated External Hiring" && LoginUserID == value.FPNAUserId) {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + ResourceApprovalData + "' class='glyphicon glyphicon-send' aria-hidden='true' onclick='showExternalApprovalpopup(this)'></span><div class='tooltiptext-1'>Approve</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-remove-sign' aria-hidden='true' onclick='showRejectionpopup(this)'></span><div class='tooltiptext-1'>Reject</div></div><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + ResourceData + "' class='glyphicon glyphicon-user' aria-hidden='true' onclick='showResourcepopup(this)'></span><div class='tooltiptext-1'>Resource</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + value.FPNAUser.Title + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
						else if (value.Status == "Externally Fulfilled") {
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFStatus + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
						

                        else {
                            var PendingWith = "";
                            if (value.Status == "RRF Saved") {
                                PendingWith = value.NewAuthor.Title;
                            }
                            else if (value.Status == "RMO Validation") {
                                PendingWith = value.RMOSPOCUser.Title;
                            }
                            else if (value.Status == "Resource Proposed") {
                                if (value.PendingWithId != -1) {
                                    PendingWith = value.ProjectManagerUser.Title;
                                    rejecticon = "";
                                    ExternalLink = "";
                                }
                                else {
                                    PendingWith = value.RMOSPOCUser.Title;
                                }

                            }
                            else if (value.Status == "Resource Selection") {
                                PendingWith = value.RMOSPOCUser.Title;
                            }
                            else if (value.Status == "External Hiring") {
                                PendingWith = value.FPNAUser.Title;
                            }
                            else if (value.Status == "Functional Head" || value.Status == "Non Billable") {
                                PendingWith = value.NewAuthor.Title;
                            }
                            else if (value.Status == "FPNA" || value.Status == "Recruitment Head" || value.Status == "VPHR") {
                                PendingWith = value.PendingWith.Title;
                            }
                            else if (value.Status == "Initiated External Hiring") {
                                PendingWith = value.FPNAUser.Title;
                            }
                            else {
                                PendingWith = "";
                            }
                            RRFLIHTML = RRFLIHTML + "<tr id=" + value.ID + "#" + value.ProjectGUID + "><td style='display:none;'></td><td width='10%'><div id='action'><i class='fa fa-info-circle' aria-hidden='true'></i><div class='action-view'><div class='tooltip-1'><span id='" + cmntID + "' class='glyphicon glyphicon-comment' aria-hidden='true' onclick='showCommentpopup(this)'></span><div class='tooltiptext-1'>Comment</div></div><div class='tooltip-1'><span id='" + rejId + "' class='fa fa-ban' aria-hidden='true' onclick='getWithdrawnComment(this)'></span><div class='tooltiptext-1' style='width:185px !important'>Withdrawn/Reject Comment</div></div><div class='tooltip-1'><span id='" + projRRFNo + '#;View' + "' class='glyphicon glyphicon-tag' aria-hidden='true' onclick='showViewlogPopup(this)'></span><div class='tooltiptext-1'>Log</div></div></div></div></td><td><a href='../SitePages/ResourceRequestForm.aspx?RRFNO=" + RRFNO + "' target='_blank' >" + RRFNO + "</a>" + clone + "</td><td>" + ProjectName + "" + ExternalInitated + "</td><td>" + Customer + "</td><td>" + value.PrimarySkill + "</td><td>" + StartDate + "</td><td>" + EndDate + "</td><td>" + value.SubPractice + "</td><td>" + Location + "</td><td>" + RoleBand + "</td><td>" + RRFCreatedDate + "</td><td>" + PendingWith + " " + BusinessDaysCount + "</td><td id='" + key + "'><div class='indication'><ul><li id='" + totalResourceId + "' title='Capacity'>" + TotalCount + "</li><li id='" + FreeResourceId + "' title='Availability'>" + FreeCount + "</li><li id='" + BookedResourceId + "' title='Roll Offs'>" + BookedCount + "</li><li onclick='refreshData(this)' title='Refresh'><i class='fa fa-refresh' aria-hidden='true'></i></li></ul></div></td></tr>"
                        }
                    }
                });

                RRFLIHTML += "</tbody>";
                table_element = table_header + RRFLIHTML;
                $("#RRFForm").append(table_element);
            },
            error: function (error) {
                alert(JSON.stringify(error));
            }

        });
        RRF_Table = $('#RRFForm').DataTable({
            // "autoWidth": false,
            "dom": 'Rlfrtip',
            "iDisplayLength": 5,
            "lengthMenu": [[5, 15, 35, -1], [5, 15, 35, "All"]],
            "dom": 'lBfrtip',
            buttons: [
              {
                  extend: 'excelHtml5',
                  exportOptions: {
                      columns: [2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
                  }
              },
            ],
        });

        $('#RRFForm tfoot th').each(function () {
            var title = $(this).text();
            if (title != 'Action' && title != 'Indicators') {
                $(this).html('<input type="text" placeholder="Search ' + title + '" />');
            }
            else {
                $(this).html('');
            }
        });
        // DataTable
        var table = $('#RRFForm').DataTable();

        // Apply the search
        table.columns().every(function () {
            var that = this;

            $('input', this.footer()).on('keyup change', function () {
                if (that.search() !== this.value) {
                    that
                        .search(this.value)
                        .draw();
                }
            });
        });
        $('.loader').hide();
        $("th#sord-disable").off("click").removeClass("sorting");
    }


    //Code to destroy jquery datatable 
    function destroyjs(tableid) {
        if ($.fn.dataTable.isDataTable(tableid)) {
            $(tableid).DataTable({
                "filter": false,
                "destroy": true
            });
            $(tableid).DataTable().destroy();
            //clear_tbody();
            $(tableid).html("");
            $(tableid + " tbody tr").remove();
        }

    }


    function InitinateExternal() {
        $('.loader').show();

        setTimeout(function () {
            var Flag = "4";
            if (pageStatus == "Resource Proposed") {
                insertProjectComment("", "1", "", "", "ExternalRMOProposed");
            }
            else {
                insertProjectComment("", "1", "", "", "ExternalRMO");
            }
            DeletefromRmoResourceAllocation(_MailRRFNO);
            updateRRF(Flag);
            $('.popup-bg').show();
            $('.clssPopupHead').text('External Hiring has been initiated');
            $('#divExternalMsg').css('display', 'block');
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divExternalMsgApproval').style.display = "none";
            document.getElementById('divComment').style.display = "none";
            document.getElementById('divSearchResource').style.display = "none";
            document.getElementById('divViewLog').style.display = "none";
            $('.loader').hide();
        }, 100);
    }

    //code to approved external hiring
    function ApprovedExternal() {
        $('.loader').show();
        setTimeout(function () {
            //insertProjectComment("", "1", "", "", "ExternalApproved");
            $('.popup-bg').show();
            $('.clssPopupHead').text('External Hiring has been Approved');
            $('#divExternalMsg').css('display', 'block');
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divExternalMsgApproval').style.display = "none";
            document.getElementById('divComment').style.display = "none";
            document.getElementById('divSearchResource').style.display = "none";
            document.getElementById('divViewLog').style.display = "none";
            document.getElementById('divExternalFPNAMsgApproval').style.display = "none";
            document.getElementById('divExternalMsg').style.display = "none";
            insertProjectComment("", "1", "", "", "ExternalApproved");
            updateRRF("2");
        }, 100);
        $('.loader').hide();
    }

    // code to submit RRF
    function submitRRF() {
        var Flag = "1";
        var comment = "";
        $('.loader').show();
        $('.popup-bg').hide();
        setTimeout(function () {
            if (pageStatus == "rmovalidation") {
                pageStatus = "RMO Validation";
            }
            insertProjectComment(comment, Flag, "", "");
            updateRRF(Flag);
            $('.alertmessage').show();
            $('#withdrawnrejectdata').hide();
            if (pageStatus == "RMO Validation") {
                $('.alertmessage').text('RRF validated successfully');
            }
            else {
                $('.alertmessage').text('RRF Submitted Successfully');
            }
            $('.popup-bg-alert').show();
            $('.loader').hide();
        }, 100);
    }


    //Close Popup
    function closePopUp() {
        $('.popup-bg').hide();
        $('.clssPopupHead').text('');
        $('#divApproveBody').css('display', 'none');
        $('#divstartdatepopup').css('display', 'none');
        $('#divExternalMsgApproval').css('display', 'none');
        $('#divExternalMsg').css('display', 'none');
		$("#divExternalFPNAMsgApproval").hide();
		
    }
		function closePopUp5() {
	
		StartDate_ConfirmationValue=1;
		//var retdata=ValidatedData(RRFRowID);
        $('.popup-bg').hide();
        $('.clssPopupHead').text('');
        $('#divApproveBody').css('display', 'none');
        $('#divstartdatepopup').css('display', 'none');
        $('#divExternalMsgApproval').css('display', 'none');
        $('#divExternalMsg').css('display', 'none');
        $("#divExternalFPNAMsgApproval").hide();
		submitRRF();
    }
	
	
    //code to update RRF 
    function updateRRF(Flag) {

        var rrfstatus = "";
        var item = {
            __metadata: { "type": "SP.Data.RRFItem" }
        };
        $.extend(item, { EmailFlag: 1 });
        if (pageStatus == "Withdrawn" || pageStatus == "Rejected") {
            if (RRFEmployeeRole.split('#')[0] != "Billable" && RRFEmployeeRole.split('#')[0] != "Billable Consultant") {
                getApproverNames(GBU, RRFRowID, LogProjectGUID, NonBillableApproverID);
                $.extend(item, { PendingWithId: NonBillableApproverID });
                $.extend(item, { NonApprovers: NonApprovers });
                $.extend(item, { NonBillableFlag: null });
                $.extend(item, { Status: "Non Billable" });
                $.extend(item, { TATDateTime: currentDate });
                $.extend(item, { SubmittedDate: currentDate });
                $.extend(item, { RRFCreatedDate: currentDate });
            }
            else {
                pageStatus = "RRF Saved";
                $.extend(item, { Status: pageStatus });
                $.extend(item, { ReinitiatedFlag: 1 });
                $.extend(item, { TATDateTime: currentDate });
                $.extend(item, { SubmittedDate: currentDate });
                $.extend(item, { RRFCreatedDate: currentDate });
            }
        }
        else if (RRFEmployeeRole.split('#')[0] != "Billable" && RRFEmployeeRole.split('#')[0] != "Billable Consultant" && RRFEmployeeRole.split('#')[1] == "null" && pageStatus != "Functional Head") {
            getApproverNames(GBU, RRFRowID, LogProjectGUID, NonBillableApproverID);
            $.extend(item, { PendingWithId: NonBillableApproverID });
            $.extend(item, { Status: "Functional Head" });
            $.extend(item, { NonBillableFlag: 1 });
            $.extend(item, { NonApprovers: NonApprovers });
            $.extend(item, { TATDateTime: currentDate });
            $.extend(item, { SubmittedDate: currentDate });
            $.extend(item, { RRFCreatedDate: currentDate });

            var NonApproversCC = _MailNonApprovers.split(',');
            var To = NonBillableApproverID.toString();
            NonApproversCC = NonApproversCC[0] + ";" + NonApproversCC[1] + ";" + NonApproversCC[2] + ";" + NonApproversCC[3];
            var Cc = _MailNewAuthorId.toString() + ";" + NonApproversCC.toString() + ";" + "rmo@bcone.com" + ";" + Hiring_Spoc;
            var EventId = "59";
            var Flag = "5";
            var TrackingId = _MailRRFNO.toString();
            insertIntoSendEmailData(To, Cc, EventId, Flag, TrackingId);

        }
        else if ((RRFEmployeeRole.split('#')[1] == 1 || pageStatus == "Functional Head") && RRFEmployeeRole.split('#')[0] != "Billable" && RRFEmployeeRole.split('#')[0] != "Billable Consultant") {
            var ApproverId = getApprover2Name(RRFRowID, LogProjectGUID);
            $.extend(item, { PendingWithId: ApproverId });
            $.extend(item, { NonBillableFlag: 1 });
            $.extend(item, { Status: NonBillableStatus });
            $.extend(item, { TATDateTime: currentDate });
            if (NonBillableStatus == "External Hiring") {
                $.extend(item, { ExternalHiring: 1 });// Code to set the flag for Work Day
                $.extend(item, { WorkDay: 1 });// Code to set the flag for Work Day
            }
            var NonApproversCC = _MailNonApprovers.split(',');
            var To = ApproverId.toString();
            NonApproversCC = NonApproversCC[0] + ";" + NonApproversCC[1] + ";" + NonApproversCC[2] + ";" + NonApproversCC[3];
            Cc = _MailNewAuthorId.toString() + ";" + NonApproversCC.toString() + ";" + "rmo@bcone.com" + ";" + Hiring_Spoc;
            //var EventId = "59";
            var Flag = "5";
            var TrackingId = _MailRRFNO.toString();
            //var EventId = "59";
            if (NonBillableStatus == "Functional Head") {
                insertIntoSendEmailData(To, Cc, "59", Flag, TrackingId);
            }
            else if (NonBillableStatus == "FPNA") {
                insertIntoSendEmailData(To, Cc, "63", Flag, TrackingId);
            }
            else if (NonBillableStatus == "Recruitment Head") {
                insertIntoSendEmailData(To, Cc, "61", Flag, TrackingId);
            }
            else if (NonBillableStatus == "VPHR") {
                insertIntoSendEmailData(To, Cc, "62", Flag, TrackingId);
            }
			//external hiring Adding hiring spoc
			else if(NonBillableStatus=="External Hiring")
			{
				//To=Hiring_Spoc;
				//insertIntoSendEmailData(To, Cc, "75", "", TrackingId);
			}

        }
        else {
            if (Flag == "1") {



                if (pageStatus == "RRF Saved") {
                    pageStatus = "RMO Validation";
                    $.extend(item, { CloneType: "" });
                    $.extend(item, { TATDateTime: currentDate });
                    $.extend(item, { SubmittedDate: currentDate });
                    $.extend(item, { ReinitiatedFlag: 1 });
                    $.extend(item, { RRFCreatedDate: currentDate });
                    // Save Email Data (To : RMO SPOC) ( CC : Requestor , Client Partner , RMO Team )
                    //saveEmailData("25", "RMO SPOC", "");
                    var To = _MailRMOSPOCUserId.toString();
                    var Cc = _MailNewAuthorId + ";" + _MailClientPartner + ";" + "rmo@bcone.com";
                    var EventId = "25";
                    var Flag = "5";
                    var TrackingId = _MailRRFNO.toString();
                    insertIntoSendEmailData(To, Cc.toString(), EventId, Flag, TrackingId);
                    var otherCC = _MailNewAuthorId + ";" + "rmo@bcone.com";
                    insertIntoSendEmailData(_MailRMOSPOCUserId.toString(), otherCC.toString(), "27", Flag, TrackingId);

                }
                else if (pageStatus == "RMO Validation") {
                    pageStatus = "Resource Proposed";
                    $.extend(item, { TATDateTime: currentDate });
                    var To = _MailRMOSPOCUserId.toString();
                    var Cc = _MailNewAuthorId + ";" + "rmo@bcone.com";
                    var EventId = "28";
                    var Flag = "5";
                    var TrackingId = _MailRRFNO.toString();
                    insertIntoSendEmailData(To, Cc.toString(), EventId, Flag, TrackingId);
                }
                else if (pageStatus == "Resource Proposed") {
                    pageStatus = "Resource Selection";
                }
                $.extend(item, { WorkDayUpdate: 1 });// Code to set the flag for Work Day
                $.extend(item, { Status: pageStatus });
            }
            else if (Flag == "2") {
                if (pageStatus == "Initiated External Hiring") {
                    pageStatus = "External Hiring";
                }
                $.extend(item, { Status: pageStatus });
                $.extend(item, { ExternalHiring: 1 });// Code to set the flag for Work Day
                $.extend(item, { WorkDay: 1 });// Code to set the flag for Work Day
				$.extend(item, { FPNAFlag: 1 });// Code to set the flag After fpna approval mail will trigger to hiringspoc


                var To = Hiring_Spoc;
				var Cc = _MailRMOSPOCUserId + ";" + "rmo@bcone.com" + ";" + "kinnary.desai@bcone.com" + ";" + "kiran.nair@bcone.com" + ";" + "aman.gupta@bcone.com";
                var TrackingId = _MailRRFNO.toString();

                insertIntoSendEmailData(To.toString(), Cc.toString(), "44", "5", TrackingId);

            }
            else if (Flag == "4") {
                if (pageStatus == "RMO Validation" || pageStatus == "Resource Proposed") {
                    //pageStatus = "Initiated External Hiring";
                    $.extend(item, { Status: "Initiated External Hiring" });
                    $.extend(item, { WorkDayUpdate: 1 });// Code to set the flag for Work Day
                    $.extend(item, { TATDateTime: currentDate });

                    var Cc = _MailRMOSPOCUserId + ";" + _MailNewAuthorId + ";" + "rmo@bcone.com" + ";" + _MailNewProjectManagerId + ";" + _MailHiringSpoc;
                    var TrackingId = _MailRRFNO.toString();
                    insertIntoSendEmailData(_MailFPNAUserId.toString(), Cc.toString(), "58", "5", TrackingId);
                }

            }
            else if (Flag == "3") {
                if (pageStatus == "External Hiring" || pageStatus == "Initiated External Hiring" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check") {
                    pageStatus = "Resource Proposed";
                    $.extend(item, { Status: "Resource Proposed" });
                    $.extend(item, { InternallyFulfilled: "External" });
                    $.extend(item, { PendingWithId: RRFAuthorId });
                    $.extend(item, { WorkDayUpdate: 1 }); // Code to set the flag for Work Day
                    $.extend(item, { TATDateTime: currentDate });
                    $.extend(item, { ResourceProposedFlag: 1 }); //proposed flag 1 for step1
                } else {
                    pageStatus = "Resource Proposed";
                    $.extend(item, { PendingWithId: RRFAuthorId });
                    $.extend(item, { WorkDayUpdate: 1 }); // Code to set the flag for Work Day
                    $.extend(item, { TATDateTime: currentDate });
                    $.extend(item, { ResourceProposedFlag: 1 }); //proposed flag 1 for step1
                }
            }


        }

        $.ajax({
            url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
            type: "POST",
            contentType: "application/json;odata=verbose",
            data: JSON.stringify(item),
            async: false,
            headers: {
                "Accept": "application/json;odata=verbose",
                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                "X-HTTP-Method": "MERGE",
                "If-Match": "*"
            },
            success: function (data) {
                // $('.popup-bg').hide();

                if (StatusFlag == "allrecord") {
                    rrfstatus = "allrecord"; pageStatus = "All Record";
                }
                else if (StatusFlag == "rmovalidation") {
                    rrfstatus = "rmovalidation"; pageStatus = "RMO Validation";
                }
                else if (StatusFlag == "resourceproposed") {
                    rrfstatus = "resourceproposed"; pageStatus = "Resource Proposed";
                }
                else if (StatusFlag == "fpnapproval") {
                    rrfstatus = "fpnapproval"; pageStatus = "FPNA Approval";
                }
                else if (StatusFlag == "resourceselection") {
                    rrfstatus = "resourceselection"; pageStatus = "Resource Selection";
                }
                else if (StatusFlag == "fulfilled" || StatusFlag == "Internally Fulfilled") {
                    rrfstatus = "fulfilled"; pageStatus = "Fulfilled";
                }
                else if (StatusFlag == "withdrawn") {
                    rrfstatus = "withdrawn"; pageStatus = "Withdrawn";
                }
                else if (StatusFlag == "rrfsaved") {
                    rrfstatus = "rrfsaved"; pageStatus = "RRF Saved";
                }
                else if (StatusFlag == "externalhiring") {
                    rrfstatus = "externalhiring"; pageStatus = "External Hiring";
                }
                else if (StatusFlag == "rrfnonbillable") {
                    rrfstatus = "rrfnonbillable"; pageStatus = "Non Billable";
                }

                refine_status(rrfstatus, pageStatus, "");

            },
            error: function (error) {
                if (JSON.stringify(error) == TimedOutPopuperror) {	
                    alert("oops! something went wrong. please refresh the page and try again");
                    window.location.href = window.location.href;
                    return false;
                }
                else {
                    alert(JSON.stringify(error));
                }
            }
        });
    }






    // code to reject request
    function rejectRequest() {
        $('.loader').show();
		
        setTimeout(function () {
            var reasonReject= document.getElementById('ddlregion').value;
            if(reasonReject == '0')
            {
               
                document.getElementById("errorMsgddlReason").innerHTML = "Please Select The Valid Reason";
                $('#errorMsgddlReason').show();
                document.getElementById("errorMsgddlReason").focus();
                $('.loader').hide();
                return false; 
            }
            else
            {
                document.getElementById('errorMsgddlReason').innerHTML = "";
            }
            var comment = document.getElementById('Txt_Comment').value;
            if (comment.trim() == "") {
                /*$('#Txt_Comment').css({
                    "border": "1px solid red",
                    "background": "#FFCECE"
                });*/
                document.getElementById("AlertMsg").innerHTML = "Please Enter the Comment";
				$('#AlertMsg').show();
                document.getElementById("Txt_Comment").focus();
                $('.loader').hide();
                return false;
            }
            else {
                /*$('#Txt_Comment').css({
                    "border": "",
                    "background": ""
                });*/
                document.getElementById("AlertMsg").innerHTML = "";
                var Flag = "3";
                var ddlvalStore= $('#ddlregion option:selected').val();
                insertProjectComment(comment, Flag, "", "","",ddlvalStore);
                UpdateProjectStatus(comment);

                $('.alertmessage').show();
                $('#withdrawnrejectdata').hide();

                if (WithdrawnRRFFlag == "1") {
                    $('.alertmessage').text('RRF Withdrawn Successfully');
                }
                else {
                    $('.alertmessage').text('RRF Rejected Successfully');
                }
                $('.popup-bg-alert').show();
                $('.loader').hide();
                WithdrawnRRFFlag = "";
            }
        }, 100);
    }

    function saveCommentDate() {
        var comment = document.getElementById('TxtAria_Comment').value;
        if (comment.trim() == "") {
            $('#TxtAria_Comment').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });

            document.getElementById("commentAlert").innerHTML = "Please Enter the Comment";
            document.getElementById("TxtAria_Comment").focus();
            return false;
        }
        else {
            var match = (new RegExp('[~#%\&{}+\|<>*]|\'\|\\\\|^\\|\\$')).test(comment);
            if (match) {
                return false;

            } else {


                $('#TxtAria_Comment').css({

                    "border": "",
                    "background": ""
                });
                document.getElementById("commentAlert").innerHTML = "";
                var Flag = "2";
                insertProjectComment(comment, Flag, "", "");

            }
        }
    }

    function insertProjectComment(comment, Flag, RRFNumber, ResourceID, LogType) {
        var item = {
            __metadata: { "type": "SP.Data.RRFTransactionDetailsListItem" }
        };
        if (RRFNumber == "") {
            $.extend(item, { ProjectGUID: LogProjectGUID });
            $.extend(item, { Comment: comment });
            $.extend(item, { Flag: Flag });
            $.extend(item, { Name: LoginUserName });
            $.extend(item, { RRFListItemId: RRFRowID });
            if (Flag == "1") {
                Type = "";
                if (pageStatus == "RRF Saved") {
                    Type = "RRF Initiated";
                }
                else {
                    Type = pageStatus;
                }
                if (LogType == "RMO") {
                    Type = "Resource Proposed (RMO)"
                    $.extend(item, { LogType: Type });
                }
                else if (LogType == "PM") {
                    Type = "Resource Proposed (Initiator)"
                    $.extend(item, { LogType: Type });
                }
                else if (LogType == "ExternalRMO") {
                    $.extend(item, { LogType: "RMO Validation (Initiated External Hiring)" });
                }
                else if (LogType == "ExternalRMOProposed") {
                    $.extend(item, { LogType: "Resource Proposed (Initiated External Hiring)" });
                }
                else if (LogType == "ExternalApproved") {
                    $.extend(item, { LogType: "FPNA (Approved External Hiring)" });
                }
                else {
                    $.extend(item, { LogType: Type });
                }
                //$.extend(item, { LogType: Type });
            }
        } else {
            $.extend(item, { RRFNO: RRFNumber });
            $.extend(item, { RRFListItemId: RRFRowID });
            $.extend(item, { Comment: comment });
            $.extend(item, { Name: LoginUserName });
            $.extend(item, { ResourceID: ResourceID });
            $.extend(item, { LogType: pageStatus });

        }
        if (WithdrawnRRFFlag == "1") {
            $.extend(item, { LogType: "RRF Withdrawn" });
        } 
		else if(Flag == "3" && LogType == "Resource Rejected")
		{
			$.extend(item, { LogType: "Resource Rejected" });
		}
		else if (Flag == "3") {
            $.extend(item, { LogType: "RRF Rejected" });
        }
        $.ajax({
            url: "../_api/Web/Lists/GetByTitle('RRFTransactionDetails')/items",
            type: "POST",
            contentType: "application/json;odata=verbose",
            data: JSON.stringify(item),
            async: false,
            headers: {
                "Accept": "application/json;odata=verbose",
                "X-RequestDigest": $("#__REQUESTDIGEST").val()
            },
            success: function (data) {

                if (HiddenFlag != "1") {
                    if (RRFNumber != "") {
                        $('.Toppopup-bg').hide();
                    } else {
                        $('.popup-bg').hide();
                    }
                }

                HiddenFlag = "";
            },
            error: function (error) {
                if (JSON.stringify(error) == TimedOutPopuperror) {
                    alert("oops! something went wrong. please refresh the page and try again");
                    window.location.href = window.location.href;
                    return false;
                }
                else {
                    alert(JSON.stringify(error));
                }
            }
        });

    }

    function UpdateProjectStatus(comment) {
        if (WithdrawnRRFFlag != "1") {
            var To = _MailNewAuthorId;
            var Cc = _MailRMOSPOCUserId + ";" + "rmo@bcone.com";
            var TrackingId = _MailRRFNO.toString();
            insertIntoSendEmailData(To.toString(), Cc.toString(), "45", "5", TrackingId);
        }
        else if (WithdrawnRRFFlag == "1") 
		{
            var To = Hiring_Spoc; 
			if(To == "")
			{
				To = "Recruitmentglobal@bcone.com";
			}
            var Cc = "rmo@bcone.com" + ";" + _MailNewAuthorId + ";" + "kiran.nair@bcone.com" + ";" + "aman.gupta@bcone.com" + ";" + "kinnary.desai@bcone.com"; 
            var TrackingId = _MailRRFNO.toString(); 
            insertIntoSendEmailData(To.toString(), Cc.toString(), "67", "5", TrackingId); 
			 
			
			//var To = "Recruitmentglobal@bcone.com";
            //var Cc = "rmo@bcone.com" + ";" + _MailNewAuthorId;
            //var TrackingId = _MailRRFNO.toString();
            //insertIntoSendEmailData(To.toString(), Cc.toString(), "67", "5", TrackingId);
        }

        var item = {
            __metadata: { "type": "SP.Data.RRFItem" }
        };
        if (LoginUserID == RRFCreatedBy || WithdrawnRRFFlag == "1") {
            $.extend(item, { Status: "Withdrawn" });
        }
        else {
            $.extend(item, { Status: "Rejected" });
        }

        $.extend(item, { RejectReason: comment });

        $.extend(item, { PendingWithId: -1 });
        $.extend(item, { TATDateTime: currentDate });

        $.ajax({
            url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
            type: "POST",
            contentType: "application/json;odata=verbose",
            data: JSON.stringify(item),
            async: false,
            headers: {
                "Accept": "application/json;odata=verbose",
                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                "X-HTTP-Method": "MERGE",
                "If-Match": "*"
            },
            success: function (data) {
				if(pageStatus == "externalhiring" || pageStatus == "External Hiring"){
					refine_status('externalhiring','External Hiring');
				}
				if(pageStatus == "rrfnonbillable" || pageStatus == "Non Billable"){
					refine_status('rrfnonbillable','Non Billable');
				}
				if(pageStatus == "rmovalidation" || pageStatus == "RMO Validation"){
					refine_status('rmovalidation','RMO Validation');
				}
				if(pageStatus == "fpnapproval" || pageStatus == "FP&A Approval"){
					refine_status('fpnapproval','FP&A Approval');
				}
				if(pageStatus == "resourceproposed" || pageStatus == "Resource Proposed"){
					refine_status('resourceproposed','Resource Proposed');
				}
				if(pageStatus == "resourceselection" || pageStatus == "Resource Allocation"){
					refine_status('resourceselection','Resource Allocation');
				}
				
              //  refine_status("withdrawn", "withdrawn", "");
            },
            error: function (error) {
                if (JSON.stringify(error) == TimedOutPopuperror) {
                    alert("oops! something went wrong. please refresh the page and try again");
                    window.location.href = window.location.href;
                    return false;
                }
                else {
                    alert(JSON.stringify(error));
                }
            }
        });
    }

    function hideerrormsg(comment) {
        var commentID = comment.id;
        var comment = document.getElementById(commentID).value;
        var match = (new RegExp('[~#%\&{}+\|<>*]|\'\|\\\\|^\\|\\$')).test(comment);
        if (match) {
            $('#' + commentID).css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });

            document.getElementById("AlertMsg").innerHTML = "Comment contains invalid character";
            document.getElementById("commentAlert").innerHTML = "Comment contains invalid character";
            document.getElementById("ResourceRejecterrormsg").innerHTML = "Comment contains invalid character";
            document.getElementById("errorMsgComment").innerHTML = "Comment contains invalid character";
            $('#errMsgNote').css('display', 'block');

            document.getElementById(commentID).focus();
            return false;
        } else {
            $('#' + commentID).css({

                "border": "",
                "background": ""
            });
            document.getElementById("AlertMsg").innerHTML = "";
            document.getElementById("commentAlert").innerHTML = "";
            document.getElementById("ResourceRejecterrormsg").innerHTML = "";
            document.getElementById("errorMsgComment").innerHTML = "";
            $('#errMsgNote').css('display', 'none');
        }
        return true;
    }
    //code to reject Resources
    function RejectResources() {
        var reason = document.getElementById('ddlRejectionReason').value;
        if (reason == "" || reason == "0") {
            document.getElementById("errorMsgddlReason").innerHTML = "Please select the reason of rejection";
        } else {
           
                var Comment = document.getElementById('TextareaResourceReject').value;
                if (Comment.trim() == "") {
                    document.getElementById("ResourceRejecterrormsg").innerHTML = "Please Provide comment";
                    return false;
                } else {
                    var match = (new RegExp('[~#%\&{}+\|<>*]|\'\|\\.\\.|^\\.|\\.$')).test(Comment);
                    if (match) {
                        document.getElementById("ResourceRejecterrormsg").innerHTML = "Comment contains invalid character";
                        return false;
                    }
                }
            
            var ResourceProjectDetails = document.getElementById('ProjecDetails').innerHTML;
            var emp_ID = ResourceProjectDetails.split("#;")[0];
            //var empID =emp_ID.trim();
            var empID =emp_ID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
            var empName = ResourceProjectDetails.split("#;")[1];
            var projectCode = ResourceProjectDetails.split("#;")[2];
            var ProjName = ResourceProjectDetails.split("#;")[3];
            var ProjLocation = ResourceProjectDetails.split("#;")[4];
            var Skill = ResourceProjectDetails.split("#;")[5];
            var RRFNumber = ResourceProjectDetails.split("#;")[6];
            var listName = "RMOAssignmentRefusal";
            var itemType = GetItemTypeForListName(listName);
            var item = {
                __metadata: { "type": itemType },
                RRFNo: RRFNumber,
                ProjectCode: projectCode,
                ProjectName: ProjName,
                SkillWorked: Skill,
                Location: ProjLocation,
                EmployeeID: empID,
                RejectionReason: reason,
                RejectedBy: LoginUserName,
                Comment: Comment
            };

            $.ajax({
                url: "../_api/Web/Lists/GetByTitle('" + listName + "')/items",
                type: "POST",
                contentType: "application/json;odata=verbose",
                data: JSON.stringify(item),
                headers: {
                    "Accept": "application/json;odata=verbose",
                    "X-RequestDigest": $("#__REQUESTDIGEST").val()
                },
                success: function (data) {
                    if ((pageStatus == "RMO Validation" || pageStatus == "Resource Proposed" || pageStatus == "External Hiring") && (ResourceAllocationFlag == null || ResourceAllocationFlag == "")) {
                        HiddenFlag = "1";
                        var checkedEmployeeID = "";
                        var checkedEmployee_array = [];
                        var childCheckboxes = ResourceTable.rows().nodes().to$('#tblResources tbody tr td').find('input[type=checkbox]');
                        var no_checked = childCheckboxes.filter(':checked').each(function () { });
                        for (var index = 0; index < no_checked.length; index++) {
                            checkedEmployee_array.push(no_checked[index].parentNode.parentNode.firstElementChild.nextSibling.innerText);
                            //if (checkedEmployeeID == "") {
                            //    checkedEmployeeID = no_checked[index].parentNode.parentNode.firstElementChild.nextSibling.innerText;
                            //}
                            //else {
                            //    checkedEmployeeID = checkedEmployeeID + ";" + no_checked[index].parentNode.parentNode.firstElementChild.nextSibling.innerText;
                            //}
                        }
                        $.each(checkedEmployee_array, function (index, employee) {
                            if (employee != empID) {
                                checkedEmployeeID = checkedEmployeeID == "" ? employee : checkedEmployeeID + ";" + employee;
								//checkedEmployeeID.trim();
								checkedEmployeeID =checkedEmployeeID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                            }
                        });

                        var listName = "RMOResourceAllocation";
                        var itemType = GetItemTypeForListName(listName);
                        var item = {
                            __metadata: { "type": itemType },
                            RRFNumber: RRFNumber
                        };

                        if (pageStatus == "RMO Validation" || pageStatus == "External Hiring") {
                            $.extend(item, { ShortlistedResource: checkedEmployeeID });
                            //$.extend(item, { AllocatedResource: selectedEmployeeID });
                        } else if (pageStatus == "Resource Proposed") {
                            if (ResourceAllocationFlag == null || ResourceAllocationFlag == "") {
                                $.extend(item, { ShortlistedResource: checkedEmployeeID });
                            }
                        }
                        if (resourceRRFCount > 0) {
                            $.ajax({
                                url: "../_api/Web/Lists/GetByTitle('" + listName + "')/GetItemById('" + resourceListID + "')",
                                type: "POST",
                                async: false,
                                contentType: "application/json;odata=verbose",
                                data: JSON.stringify(item),
                                headers: {
                                    "accept": "application/json;odata=verbose",
                                    "Content-Type": "application/json;odata=verbose",
                                    "X-RequestDigest": jQuery("#__REQUESTDIGEST").val(),
                                    "IF-MATCH": "*",
                                    "X-Http-Method": "MERGE"
                                },
                                success: function (data) {
                                    $('.AlertclssPopupHead').text('Rejected Message');
                                    document.getElementById('divMsgProposedResourceFirst').style.display = 'none';
                                    document.getElementById('divMsgSaveValidateResource').style.display = "none";
                                    document.getElementById('divMsgAllocateResource').style.display = 'none';
                                    document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                    document.getElementById('divMsgOnApprove').style.display = 'none';
                                    document.getElementById('divMsgOnreject').style.display = 'block';
                                    $('.Alertpopup-bg').show();

                                },
                                error: function (error) {
                                    //alert(JSON.stringify(error));
                                }
                            });
                        } else {
                            $.ajax({
                                url: "../_api/Web/Lists/GetByTitle('" + listName + "')/items",
                                type: "POST",
                                contentType: "application/json;odata=verbose",
                                data: JSON.stringify(item),
                                headers: {
                                    "Accept": "application/json;odata=verbose",
                                    "X-RequestDigest": $("#__REQUESTDIGEST").val()
                                },
                                success: function (data) {
                                    $('.AlertclssPopupHead').text('Rejected Message');
                                    document.getElementById('divMsgProposedResourceFirst').style.display = 'none';
                                    document.getElementById('divMsgSaveValidateResource').style.display = "none";
                                    document.getElementById('divMsgAllocateResource').style.display = 'none';
                                    document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                    document.getElementById('divMsgOnApprove').style.display = 'none';
                                    document.getElementById('divMsgOnreject').style.display = 'block';
                                    $('.Alertpopup-bg').show();

                                },
                                error: function (error) {
                                    //alert(JSON.stringify(error));
                                }
                            });
                        }
                    } else {


                        //alert("Insert Refuasal data");
                        var EmployeeID_array = [];
                        var Employee_Save = "";
                        $('#tblResources tbody tr').each(function () {
                            EmployeeID_array.push($(this).find('td:eq(1)')[0].innerText);
                        });
                        $.each(EmployeeID_array, function (index, employee) {
                            if (employee != empID) {
                                Employee_Save = Employee_Save == "" ? employee : Employee_Save + ";" + employee;
								//Employee_Save.trim();
								Employee_Save =Employee_Save.replace(/(\r\n\s|\n|\r|\s)/gm, '');
								
                            }
                        });
                        var listName = "RMOResourceAllocation";
                        var itemType = GetItemTypeForListName(listName);
                        var item = {
                            __metadata: { "type": itemType },

                        };
                        $.extend(item, { ShortlistedResource: Employee_Save });
                        //$.extend(item, { AllocatedResource: Employee_Save });
                        if (Employee_Save == "") {
                            $.extend(item, { Flag: "" });
                            $.extend(item, { AllocatedResource: "" });
                        }
                        $.ajax({
                            url: "../_api/Web/Lists/GetByTitle('" + listName + "')/GetItemById('" + resourceListID + "')",
                            type: "POST",
                            async: false,
                            contentType: "application/json;odata=verbose",
                            data: JSON.stringify(item),
                            headers: {
                                "accept": "application/json;odata=verbose",
                                "Content-Type": "application/json;odata=verbose",
                                "X-RequestDigest": jQuery("#__REQUESTDIGEST").val(),
                                "IF-MATCH": "*",
                                "X-Http-Method": "MERGE"
                            },
                            success: function (data) {
                                //alert("Resource Rejected Successfully");
                                if (Employee_Save == "") {


                                    var rrfstatus = "";
                                    var item = {
                                        __metadata: { "type": "SP.Data.RRFItem" }
                                    };
                                    if (internallyfulfilledFlag == "External") {
                                        NewpageStatus = "External Hiring";
                                        $.extend(item, { InternallyFulfilled: "" });
                                    } else {
                                        NewpageStatus = "Resource Proposed";
                                    }
                                    $.extend(item, { Status: NewpageStatus });
                                    $.extend(item, { TATDateTime: currentDate });
                                    $.extend(item, { PendingWithId: -1 });

                                    $.ajax({
                                        url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
                                        type: "POST",
                                        contentType: "application/json;odata=verbose",
                                        data: JSON.stringify(item),
                                        async: false,
                                        headers: {
                                            "Accept": "application/json;odata=verbose",
                                            "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                            "X-HTTP-Method": "MERGE",
                                            "If-Match": "*"
                                        },
                                        success: function (data) {
                                            if (pageStatus == "Resource Proposed") {
                                                document.getElementById('RejectMsg').innerHTML = "PM rejected the proposed resource. Check the feedback given and propose another resource.";
                                            } else if (pageStatus == "Resource Selection") {
                                                document.getElementById('RejectMsg').innerHTML = "RMO rejected the resource preferred by PM.";
                                                insertProjectComment("", "3", "", "","Resource Rejected");
                                            }
                                            $('.AlertclssPopupHead').text('Rejected Message');
                                            document.getElementById('divMsgProposedResourceFirst').style.display = 'none';
                                            document.getElementById('divMsgSaveValidateResource').style.display = "none";
                                            document.getElementById('divMsgAllocateResource').style.display = 'none';
                                            document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                            document.getElementById('divMsgOnApprove').style.display = 'none';
                                            document.getElementById('divMsgOnreject').style.display = 'block';
                                            $('.Alertpopup-bg').show();


                                        },
                                        error: function (error) {
                                            alert(JSON.stringify(error));
                                        }
                                    });
                                } else {
                                    if (pageStatus == "Resource Proposed") {
                                        document.getElementById('RejectMsg').innerHTML = "PM rejected the proposed resource. Check the feedback given and propose another resource.";
                                    } else if (pageStatus == "Resource Selection") {
                                        document.getElementById('RejectMsg').innerHTML = "RMO rejected the resource preferred by PM.";
                                        insertProjectComment("", "3", "", "");
                                    }
                                    $('.AlertclssPopupHead').text('Rejected Message');
                                    document.getElementById('divMsgProposedResourceFirst').style.display = 'none';
                                    document.getElementById('divMsgSaveValidateResource').style.display = "none";
                                    document.getElementById('divMsgAllocateResource').style.display = 'none';
                                    document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                    document.getElementById('divMsgOnApprove').style.display = 'none';
                                    document.getElementById('divMsgOnreject').style.display = 'block';
                                    $('.Alertpopup-bg').show();

                                }

                            },
                            error: function (error) {
                                //alert(JSON.stringify(error));
                            }
                        });
                    }
                },
                error: function (error) {
                    //alert(JSON.stringify(error));
                }
            });
        }
    }
    function ResourcesCommentSubmit() {
        var comment = document.getElementById('TextareaResourceComment').value;
        if (comment.trim() == "") {
            $('#TextareaResourceComment').css({

                "border": "1px solid red",
                "background": "#FFCECE"
            });

            document.getElementById("errorMsgComment").innerHTML = "Please Enter the Comment";
            document.getElementById("TextareaResourceComment").focus();
            return false;
        }
        else {
            var match = (new RegExp('[~#%\&{}+\|<>*]|\'\|\\\\|^\\|\\$')).test(comment);
            if (match) {
                return false;

            } else {

                $('#TextareaResourceComment').css({
                    "border": "",
                    "background": ""
                });
                document.getElementById("errorMsgComment").innerHTML = "";
                var data = document.getElementById('resourceCommentSpan').innerHTML;
                var rrfNumeber = data.split('#')[0];
                var resourceId = data.split('#')[1];
				//resourceId.trim();
				resourceId =resourceId.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                insertProjectComment(comment, "", rrfNumeber, resourceId);
            }
        }
    }
    function validReason() {
        var reason = document.getElementById('ddlRejectionReason').value;
        if (reason != "" || reason != "0") {
            document.getElementById("errorMsgddlReason").innerHTML = "";
            if (reason == "Additional Comments") {
                $('#TextareaResourceReject').prop({
                    'disabled': false
                });
            } else {
                $('#TextareaResourceReject').prop({
                    'disabled': false
                });
            }
        }
    }
    function findProjectCode(index) {
        var last_i = index;
        var strt_i = 0;
        if (last_i == "1") {
            strt_i = 0;
            last_i = parseInt(RRFFormLength);
        } else {
            last_i = parseInt(last_i) * parseInt(RRFFormLength);
            strt_i = last_i - parseInt(RRFFormLength);
        }

        for (var i = strt_i; i < last_i; i++) { //changes by varsha 12-sep
            if (i < RRF_Table.page.info().recordsTotal) {
                if (pageStatus == "allrecord") {
                    if (RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "External Hiring" && RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "Offer" && RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "Review" && RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "Screen" && RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "Assessment" && RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "Interview" && RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "Reference" && RRF_Table.rows().nodes()[i].childNodes[9].innerHTML != "Check") {
                        //var ProjectCode = RRF_Table.rows().nodes()[i].id;
                        // ProjectCode = ProjectCode.split('#')[1];
                        var ParameterVal = indecator_Parameter[i];
                        var PSkill = ParameterVal.split('#')[2];
                        var SSkill = ParameterVal.split('#')[3];
                        var RBand = ParameterVal.split('#')[4];
                        var rrfstartDateval = ParameterVal.split('#')[5];
                        var rrfendDateval = ParameterVal.split('#')[6];
                        if ((PSkill != "null" || SSkill != "null") && RBand != "null") {
                            bindIndicatorsValue(PSkill, SSkill, RBand, i, rrfstartDateval, rrfendDateval);
                        }
                    }
                } else if (pageStatus != "externalhiring") {
                    //var ProjectCode = RRF_Table.rows().nodes()[i].id;
                    //ProjectCode = ProjectCode.split('#')[1];
                    //if (ProjectCode != null && ProjectCode != "0" && ProjectCode != 0 && ProjectCode != "null") {
                    //    bindIndicatorsValue(ProjectCode, i);
                    //}
                    var ParameterVal = indecator_Parameter[i];
                    var PSkill = ParameterVal.split('#')[2];
                    var SSkill = ParameterVal.split('#')[3];
                    var RBand = ParameterVal.split('#')[4];
                    var rrfstartDateval = ParameterVal.split('#')[5];
                    var rrfendDateval = ParameterVal.split('#')[6];
                    if ((PSkill != "null" || SSkill != "null") && RBand != "null") {
                        bindIndicatorsValue(PSkill, SSkill, RBand, i, rrfstartDateval, rrfendDateval);
                    }
                }
            }
        }
    }
    function bindIndicatorsValue(PrimarySkill, SecondarySkill, RoleBand, count, rrfstartDateval, rrfendDateval) {

        var url = EmployeeAvailability(); //"https://ppmdev.bcone.com/api/RMO/EmployeeAvailability";
        //url = "https://ppmdev.bcone.com/api/RMO/EmployeeAvailability";

        requestData = "{\"PrimarySkills\":\"" + PrimarySkill + "\",\"SecondarySkills\":\"" + SecondarySkill + "\",\"RoleBand\":\"" + RoleBand + "\",\"StartDate\":\"" + rrfstartDateval + "\",\"EndDate\":\"" + rrfendDateval + "\"}";
        $.ajax({

            url: url,
            method: "POST",
            data: requestData,
            async: false,
            dataType: "json",
            headers:
            {
                "content-Type": "application/json"
            },
            success: function (data) {
                TotalCount = data.EmployeeAvailability[0].Total;
                BookedCount = data.EmployeeAvailability[2].Booked;
                FreeCount = data.EmployeeAvailability[1].Free;

                var total_id = "Total" + count;
                var booked_id = "Booked" + count;
                var free_id = "Free" + count;

                $('#RRFForm tbody tr td').find("#" + total_id).text(TotalCount);
                $('#RRFForm tbody tr td').find("#" + booked_id).text(BookedCount);
                $('#RRFForm tbody tr td').find("#" + free_id).text(FreeCount);

            }
        });
    }

    function refreshData(element) {
        if (pageStatus != "External Hiring" && pageStatus != "Offer" && pageStatus != "externalhiring" && pageStatus != "externalhiring" && pageStatus != "Review" && pageStatus != "Screen" && pageStatus != "Assessment" && pageStatus != "Interview" && pageStatus != "Reference" && pageStatus != "Check") { //changes by varsha 12-sep
            $(this).addClass('refresh');
            setTimeout(function () {
                var ProjectGUID = element.parentNode.parentNode.parentNode.parentNode.id.split('#')[1];
                var Total = element.parentNode.children[0].id;
                var Free = element.parentNode.children[1].id;
                var Booked = element.parentNode.children[2].id;
                var indexVal = element.parentNode.parentNode.parentNode.id;
                var ParameterVal = indecator_Parameter[indexVal];
                var PSkill = ParameterVal.split('#')[2];
                var SSkill = ParameterVal.split('#')[3];
                var RBand = ParameterVal.split('#')[4];
                var rrfstartDateval = ParameterVal.split('#')[5];
                var rrfendDateval = ParameterVal.split('#')[6];
                var url = EmployeeAvailability(); //"https://ppmdev.bcone.com/api/RMO/EmployeeAvailability";
                if ((PSkill != "null" || SSkill != "null") && RBand != "null") {
                    requestData = "{\"PrimarySkills\":\"" + PSkill + "\",\"SecondarySkills\":\"" + SSkill + "\",\"RoleBand\":\"" + RBand + "\",\"StartDate\":\"" + rrfstartDateval + "\",\"EndDate\":\"" + rrfendDateval + "\"}";
                    //"{\"PrimarySkills\":\"" + PSkill + "\",\"SecondarySkills\":\"" + SSkill + "\",\"RoleBand\":\"" + RBand + "\"}";
                    $.ajax({

                        url: url,
                        method: "POST",
                        data: requestData,
                        async: false,
                        dataType: "json",
                        headers:
                        {
                            "content-Type": "application/json"
                        },
                        success: function (data) {
                            TotalCount = data.EmployeeAvailability[0].Total;
                            BookedCount = data.EmployeeAvailability[2].Booked;
                            FreeCount = data.EmployeeAvailability[1].Free;

                            $('#RRFForm tbody tr td').find("#" + Total).text(TotalCount);
                            $('#RRFForm tbody tr td').find("#" + Booked).text(BookedCount);
                            $('#RRFForm tbody tr td').find("#" + Free).text(FreeCount);
                            jQuery('ul').children().removeClass('refresh');
                        }
                    });
                }
            }, 100);

        }

    }

    //code to find project allocation details based on resource
    function findprojectAllocationDetails(projectCode, EmployeeID) {
        url = GetProjectWiseResourceAllocation(ProjectCode, empId);  //"https://ppmdev.bcone.com/_api/ProjectWiseResourceAllocation?$filter=AllocatedProjectCode eq'" + projectCode + "' and EmployeeID eq'" + EmployeeID + "'";
        var details = "";

        $.ajax({
            url: url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                if (data.d.results.length > 0) {
                    var allocationPercent = data.d.results[0].Allocation;
                    var srtDate = getFormatDate(data.d.results[0].Start);
                    var endDate = getFormatDate(data.d.results[0].Finish);
                    details = allocationPercent + ";" + srtDate + ";" + endDate;
                }
            }
        });
        return details;
    }
    //code to format date
    function getFormatDate(date) {
        if (date != null && date != "") {
            var year = date.toString().substring(0, 4);
            var month = GetMonthName(date.toString().substring(4, 6));
            var date = date.toString().substring(6, 8);
            var formatDate = date + '-' + month + '-' + year;
            return formatDate;
        }
    }


    function GetItemTypeForListName(name) {
        return "SP.Data." + name.charAt(0).toUpperCase() + name.slice(1) + "ListItem";
    }

    //code to bind new Resource information div
    function BindResourceInfoDiv() {

        var divHtml = "<div class='AddResource' id='maindiv" + txtidIndex + "'><div class='col-md-3'><label>Allocation%</label></div><div class='col-md-3'><input type='text' id='txtAllocation" + txtidIndex + "' class='form-control mx-sm-3 classAllocation' onkeyup='removeErrorMsgResourceAssignment()'><div id='errtxtAllocation" + txtidIndex + "' class='error'>Allocation % is required</div></div><div class='col-md-3'><label>Employee Role</label></div><div class='col-md-3'><input id='txtEmployeeRole" + txtidIndex + "' class='form-control mx-sm-3 txtEmployeeRole' readonly='readonly'></input><div id='errddlBillability" + txtidIndex + "' class='error'>Employee Role is required</div></div><div class='clear'></div><div class='col-md-3'><label>Start Date</label></div><div class='col-md-3'><div class='date'><input type='text' id='txtstrtDt" + txtidIndex + "' class='form-control mx-sm-3 strtDt' onselect='removeErrorMsgResourceAssignment()'></div><div id='errtxtstrtDt" + txtidIndex + "' class='error'>Start date is required</div></div><div class='col-md-3'><label>End Date</label></div><div class='col-md-3'><div class='date'><input type='text' id='txtendDt" + txtidIndex + "' class='form-control mx-sm-3 endDt' onselect='removeErrorMsgResourceAssignment()'></div><div id='errtxtendDt" + txtidIndex + "' class='error'>End date is required</div></div><div class='clear'></div><div class='col-md-3'><label>Type Of Assignment</label></div><div class='col-md-4'><select id='selectAssignment" + txtidIndex + "' class='form-control mx-sm-3'><option value='BCONE LOCATION'>BCONE LOCATION</option><option value='CLIENT LOCATION'>CLIENT LOCATION</option><option value='Both'>Both</option></select></div><div class='col-md-5 action'><input type='button' class='btn btn-primary' id='btncheckAvailbility" + txtidIndex + "' value='Check Availability' onclick='checkResourceAvailbility(this);'/><a href='#'><span class='glyphicon glyphicon-ok-sign' id='Availabilitysign' style='display:none'></span><span id='Availabilityvalue" + txtidIndex + "' style='visibility:hidden'></span></a><div id='AvailbilityErrMsg" + txtidIndex + "' class='error' style='font-size: 11px;'>Please check Resource Availbility</div></div><div class='clear'></div></div>"
        if (txtidIndex > 0) {
            var divId = txtidIndex - 1;
            $(divHtml).insertAfter("#maindiv" + divId);
        } else {
            $(divHtml).insertAfter("#ResourceInformation");
        }
        if (txtidIndex >= 0) {
            document.getElementById('removeaddResource').style.display = 'inline-block';
        }
        txtidIndex++;
    }
    //code to remove resource informaition div
    function RemoveResourceInfoDiv() {
        txtidIndex--;
        $('#maindiv' + txtidIndex).remove();
        if (txtidIndex < 1) {
            document.getElementById('removeaddResource').style.display = 'none';
        }
    }

    function convert_date_DDMMYYYY(date_to_convert) {
        var arr_dateandtime = date_to_convert.split('T');
        var arr_dateonly = arr_dateandtime[0].split('-');
        var MonthName = GetMonthName(arr_dateonly[1]);
        converted_date = arr_dateonly[2] + "-" + MonthName + "-" + arr_dateonly[0];
        return converted_date;
    }

    function GetMonthName(monthNumber) {
        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
        'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        return months[monthNumber - 1];
    }


    //code to save RRF Save Resources
    function RRFSaveResource(ResourceEmpID) {
        var isResourceSelect = "";
        if (pageStatus == "RMO Validation") {
            var childCheckboxes = ResourceTable.rows().nodes().to$('#tblResources tbody tr td').find('input[type=checkbox]');
            var no_checked = childCheckboxes.filter(':checked').each(function () { });
            if (no_checked.length <= 0) {
                isResourceSelect = "false";
            }

        }
        if ((pageStatus == "RRF Saved" || pageStatus == "RMO Validation" || pageStatus == "Resource Proposed" || pageStatus == "Resource Selection" || pageStatus == "External Hiring" || pageStatus == "Initiated External Hiring" || pageStatus == "Offer") && isResourceSelect != "false") {
            HiddenFlag = "1";
            var selectedEmployeeID = "";
            var SaveFlag = "";
            var RRFNumber = $('.clssPopupHead')[0].innerText.split(' :')[0];
            //$('#tblResources tbody tr').each(function () {
            //    if ($(this).find('td:eq(0) input').prop('checked') == true) {
            //        selectedEmployeeID = selectedEmployeeID == "" ? $(this).find('td:eq(1)')[0].innerText : selectedEmployeeID + ";" + $(this).find('td:eq(1)')[0].innerText;
            //    }
            //});

            var childCheckboxes = ResourceTable.rows().nodes().to$('#tblResources tbody tr td').find('input[type=checkbox]');
            var no_checked = childCheckboxes.filter(':checked').each(function () { });
            for (var index = 0; index < no_checked.length; index++) {
                if (selectedEmployeeID == "") {
                    selectedEmployeeID = no_checked[index].parentNode.parentNode.firstElementChild.nextSibling.innerText;
					//selectedEmployeeID.trim();
					selectedEmployeeID =selectedEmployeeID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                }
                else {
                    selectedEmployeeID = selectedEmployeeID + ";" + no_checked[index].parentNode.parentNode.firstElementChild.nextSibling.innerText;
					//selectedEmployeeID.trim();
					selectedEmployeeID =selectedEmployeeID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                }
            }
			if(selectedEmployeeID!="")
			{
				selectedEmployeeID =selectedEmployeeID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
			}
            var listName = "RMOResourceAllocation";
            var itemType = GetItemTypeForListName(listName);
            var item = {
                __metadata: { "type": itemType },
                RRFNumber: RRFNumber
            };

            if (pageStatus == "RRF Saved") {
                $.extend(item, { suggestedResource: selectedEmployeeID });
                $.extend(item, { ShortlistedResource: selectedEmployeeID });
            } else if (pageStatus == "RMO Validation") {
                $.extend(item, { ShortlistedResource: selectedEmployeeID });
                //$.extend(item, { AllocatedResource: selectedEmployeeID });
            } else if (pageStatus == "Resource Proposed") {
                if (ResourceAllocationFlag == null || ResourceAllocationFlag == "") {
                    $.extend(item, { ShortlistedResource: selectedEmployeeID });
                    $.extend(item, { Flag: "1" });
                    SaveFlag = "1";
                } else if (ResourceAllocationFlag == "1") {
                    if (ResourceEmpID != "") {
                        selectedEmployeeID = ResourceEmpID;
                    }
                    $.extend(item, { AllocatedResource: selectedEmployeeID });
                    $.extend(item, { Flag: "2" });
                }
            } else if (pageStatus == "Resource Selection") {
                $.extend(item, { AllocatedResource: selectedEmployeeID });
            } else if (pageStatus == "External Hiring" || pageStatus == "Initiated External Hiring" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check") {
                $.extend(item, { ShortlistedResource: selectedEmployeeID });
                $.extend(item, { Flag: "1" });
                SaveFlag = "1";
            }

            if (resourceRRFCount > 0) {
                $.ajax({
                    url: "../_api/Web/Lists/GetByTitle('" + listName + "')/GetItemById('" + resourceListID + "')",
                    type: "POST",
                    async: false,
                    contentType: "application/json;odata=verbose",
                    data: JSON.stringify(item),
                    headers: {
                        "accept": "application/json;odata=verbose",
                        "Content-Type": "application/json;odata=verbose",
                        "X-RequestDigest": jQuery("#__REQUESTDIGEST").val(),
                        "IF-MATCH": "*",
                        "X-Http-Method": "MERGE"
                    },
                    success: function (data) {
                        if (ResourceAllocationFlag == "1") {
                            NewpageStatus = "Resource Selection";
                            var rrfstatus = "";
                            var item = {
                                __metadata: { "type": "SP.Data.RRFItem" }
                            };
                            $.extend(item, { Status: NewpageStatus });
                            $.extend(item, { PendingWithId: -1 });
                            $.extend(item, { TATDateTime: currentDate });
                            $.extend(item, { ResourceProposedFlag: 2 });

                            $.ajax({
                                url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
                                type: "POST",
                                contentType: "application/json;odata=verbose",
                                data: JSON.stringify(item),
                                async: false,
                                headers: {
                                    "Accept": "application/json;odata=verbose",
                                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                    "X-HTTP-Method": "MERGE",
                                    "If-Match": "*"
                                },
                                success: function (data) {

                                    var To = _MailRMOSPOCUserId.toString();
                                    var Cc = _MailNewAuthorId + ";" + "rmo@bcone.com";
                                    var TrackingId = _MailRRFNO.toString();
                                    insertIntoSendEmailData(To, Cc.toString(), "50", "6", TrackingId);

                                    //$('.AlertclssPopupHead').text('Success');
                                    //document.getElementById('divMsgAllocateResource').style.display = 'none';
                                    //document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                    //document.getElementById('divMsgOnreject').style.display = 'none';
                                    //document.getElementById('divMsgSaveValidateResource').style.display = "none";
                                    //document.getElementById('divMsgProposedResourceFirst').style.display = "none";
                                    //document.getElementById('divMsgOnApprove').style.display = 'block';
                                    //$('.Alertpopup-bg').show();
                                },
                                error: function (error) {
                                    alert(JSON.stringify(error));
                                }
                            });
                        }

                        if (pageStatus == "RMO Validation" || pageStatus == "RRF Saved") {
                            $('.AlertclssPopupHead').text('Success');
                            document.getElementById('divMsgOnreject').style.display = 'none';
                            document.getElementById('divMsgOnApprove').style.display = 'none';
                            document.getElementById('divMsgAllocateResource').style.display = 'none';
                            document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                            document.getElementById('divMsgProposedResourceFirst').style.display = "none";
                            document.getElementById('divMsgSaveValidateResource').style.display = 'block';
                            $('.Alertpopup-bg').show();
                        }
                        if (pageStatus == "Resource Proposed") {
                            if (ResourceAllocationFlag == "1") {
                                document.getElementById('propsedMsg').innerHTML = "PM approved the proposed resource. Check the feedback given and allocate as per RRF.";
                                $('.AlertclssPopupHead').text('Success');
                                document.getElementById('divMsgOnreject').style.display = 'none';
                                document.getElementById('divMsgOnApprove').style.display = 'none';
                                document.getElementById('divMsgAllocateResource').style.display = 'none';
                                document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                document.getElementById('divMsgSaveValidateResource').style.display = 'none';
                                document.getElementById('divMsgProposedResourceFirst').style.display = 'block';
                                $('.Toppopup-bg').show();
                                $('.popup-bg').show();
                                $('.Alertpopup-bg').show();
                            } else {
                                document.getElementById('propsedMsg').innerHTML = "RMO softblocked the selected resources successfully";

                                updateRRF("3");
                                insertProjectComment("", "1", "", "", "RMO");
                                //var Cc = _MailRMOSPOCUserId + ";" + "rmo@bcone.com";
                                //var TrackingId = _MailRRFNO.toString();
                                //insertIntoSendEmailData(_MailNewAuthorId.toString(), Cc.toString(), "51", "6", TrackingId);
								var Cc = _MailNewAuthorId.toString() + ";" + "rmo@bcone.com";
                                var TrackingId = _MailRRFNO.toString();
                                insertIntoSendEmailData(_MailRMOSPOCUserId, Cc.toString(), "51", "6", TrackingId);
                                $('.AlertclssPopupHead').text('Success');
                                document.getElementById('divMsgOnreject').style.display = 'none';
                                document.getElementById('divMsgOnApprove').style.display = 'none';
                                document.getElementById('divMsgAllocateResource').style.display = 'none';
                                document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                document.getElementById('divMsgSaveValidateResource').style.display = 'none';
                                document.getElementById('divMsgProposedResourceFirst').style.display = 'block';
                                $('.Toppopup-bg').show();
                                $('.popup-bg').show();
                                $('.Alertpopup-bg').show();
                            }
                           
                        }
                        if (pageStatus == "External Hiring" || pageStatus == "FPNA Approval" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check") {
                            <!-- var Cc = _MailRMOSPOCUserId + ";" + ProjectManagerUserId + ";" + "rmo@bcone.com" + ";" + "kiran.nair@bcone.com" + ";" + "kinnary.desai@bcone.com" + ";" + "aman.gupta@bcone.com"; -->
							<!-- var TrackingId = _MailRRFNO.toString(); -->
							<!-- if(pageStatus == "External Hiring") -->
							<!-- { -->
								<!-- insertIntoSendEmailData(hiringspocmailid, Cc.toString(), "88", "22", TrackingId); -->
							<!-- } -->
							$('.AlertclssPopupHead').text('Success');
                            document.getElementById('divMsgOnreject').style.display = 'none';
                            document.getElementById('divMsgOnApprove').style.display = 'none';
                            document.getElementById('divMsgAllocateResource').style.display = 'none';
                            document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                            document.getElementById('divMsgProposedResourceFirst').style.display = "none";
                            document.getElementById('divMsgSaveValidateResource').style.display = 'block';
                            $('.Toppopup-bg').show();
                            $('.popup-bg').show();
                            $('.Alertpopup-bg').show();
                        }
                    },
                    error: function (error) {
                        //alert(JSON.stringify(error));
                    }
                });

            } else {
                $.ajax({
                    url: "../_api/Web/Lists/GetByTitle('" + listName + "')/items",
                    type: "POST",
                    contentType: "application/json;odata=verbose",
                    data: JSON.stringify(item),
                    headers: {
                        "Accept": "application/json;odata=verbose",
                        "X-RequestDigest": $("#__REQUESTDIGEST").val()
                    },
                    success: function (data) {
                        // if(pageStatus == "External Hiring" || pageStatus == "Offer"){
                        // 
                        // NewpageStatus = "Resource Proposed";
                        //        var rrfstatus = "";
                        //        var item = {
                        //            __metadata: { "type": "SP.Data.RRFItem" }
                        //        };
                        //        $.extend(item, { Status: NewpageStatus });
                        //        $.extend(item, { PendingWithId: -1 });
                        //       
                        //        $.ajax({
                        //            url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
                        //            type: "POST",
                        //            contentType: "application/json;odata=verbose",
                        //            data: JSON.stringify(item),
                        //            async: false,
                        //            headers: {
                        //                "Accept": "application/json;odata=verbose",
                        //                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                        //                "X-HTTP-Method": "MERGE",
                        //                "If-Match": "*"
                        //            },
                        //            success: function (data) {
                        //              
                        //            },
                        //            error: function (error) {
                        //                alert(JSON.stringify(error));
                        //            }
                        //        });
                        // 
                        // }
                        //

                        if (pageStatus == "RMO Validation" || pageStatus == "RRF Saved") {
                            $('.AlertclssPopupHead').text('Success');
                            document.getElementById('divMsgOnreject').style.display = 'none';
                            document.getElementById('divMsgOnApprove').style.display = 'none';
                            document.getElementById('divMsgAllocateResource').style.display = 'none';
                            document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                            document.getElementById('divMsgProposedResourceFirst').style.display = "none";
                            document.getElementById('divMsgSaveValidateResource').style.display = 'block';
                            $('.Alertpopup-bg').show();
                        }
                        if (SaveFlag == "1" && (ResourceAllocationFlag == null || ResourceAllocationFlag == "")) {
                            updateRRF("3");
                            insertProjectComment("", "1", "", "", "RMO");
                        }
                        if (pageStatus == "Resource Proposed") {
                            if (ResourceAllocationFlag == "1") {
                                document.getElementById('propsedMsg').innerHTML = "PM approved the proposed resource. Check the feedback given and allocate as per RRF.";
                                $('.AlertclssPopupHead').text('Success');
                                document.getElementById('divMsgOnreject').style.display = 'none';
                                document.getElementById('divMsgOnApprove').style.display = 'none';
                                document.getElementById('divMsgAllocateResource').style.display = 'none';
                                document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                document.getElementById('divMsgSaveValidateResource').style.display = 'none';
                                document.getElementById('divMsgProposedResourceFirst').style.display = 'block';
                                $('.Toppopup-bg').show();
                                $('.popup-bg').show();
                                $('.Alertpopup-bg').show();
                            } else {
                                document.getElementById('propsedMsg').innerHTML = "RMO softblocked the selected resources successfully";
                                //insertProjectComment("", "1", "", "", "RMO");
                                $('.AlertclssPopupHead').text('Success');
                                document.getElementById('divMsgOnreject').style.display = 'none';
                                document.getElementById('divMsgOnApprove').style.display = 'none';
                                document.getElementById('divMsgAllocateResource').style.display = 'none';
                                document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                                document.getElementById('divMsgSaveValidateResource').style.display = 'none';
                                document.getElementById('divMsgProposedResourceFirst').style.display = 'block';
                                $('.Toppopup-bg').show();
                                $('.popup-bg').show();
                                $('.Alertpopup-bg').show();
                            }
                           
                        }
                        if (pageStatus == "External Hiring" || pageStatus == "FPNA Approval" || pageStatus == "Offer" || pageStatus == "Review" || pageStatus == "Screen" || pageStatus == "Assessment" || pageStatus == "Interview" || pageStatus == "Reference" || pageStatus == "Check") {
                           <!-- var Cc = _MailRMOSPOCUserId + ";" + ProjectManagerUserId + ";" + "rmo@bcone.com" + ";" + "kiran.nair@bcone.com" + ";" + "kinnary.desai@bcone.com" + ";" + "aman.gupta@bcone.com"; -->
							<!-- var TrackingId = _MailRRFNO.toString(); -->
							<!-- if(pageStatus == "External Hiring") -->
							<!-- { -->
								<!-- insertIntoSendEmailData(hiringspocmailid, Cc.toString(), "88", "22", TrackingId); -->
							<!-- } -->
						   $('.AlertclssPopupHead').text('Success');
                            document.getElementById('divMsgOnreject').style.display = 'none';
                            document.getElementById('divMsgOnApprove').style.display = 'none';
                            document.getElementById('divMsgAllocateResource').style.display = 'none';
                            document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
                            document.getElementById('divMsgProposedResourceFirst').style.display = "none";
                            document.getElementById('divMsgSaveValidateResource').style.display = 'block';
                            $('.Toppopup-bg').show();
                            $('.popup-bg').show();
                            $('.Alertpopup-bg').show();
                        }
                        //alert("Insert");
                    },
                    error: function (error) {
                        //alert(JSON.stringify(error));
                    }
                });
            }
        } else {
            $('#errMsgSaveResourcevalidaion').css('display', 'block');
            return false;
            //errMsgSaveResourcevalidaion

        }
    }

    function bindcheckedResources(RRFNumber) {
        $("#slectedResource").empty();
        //code to display Saved record
        var dataurl = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumber + "'";
        $.ajax({
            url: dataurl,
            async: false,
            type: "GET",
            headers: { "Accept": "application/json;odata=verbose" },
            success: function (data) {
                resourceRRFCount = data.d.results.length;
                var SeletedEmployeeID = "";
                if (resourceRRFCount > 0) {
                    var dataset = data.d.results[0];
                    resourceListID = dataset.ID;
                    if (pageStatus == "RRF Saved") {
                        SeletedEmployeeID = (dataset.suggestedResource != "" && dataset.suggestedResource != null) ? dataset.suggestedResource.split(';') : "";
                    } else if (pageStatus == "RMO Validation") {
                        SeletedEmployeeID = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : "";

                    } else if (pageStatus == "Resource Proposed") {
                        SeletedEmployeeID = (dataset.ShortlistedResource != "" && dataset.ShortlistedResource != null) ? dataset.ShortlistedResource.split(';') : ""; // Changes done on 30-8-2017 

                    } else if (pageStatus == "Resource Selection") {
                        SeletedEmployeeID = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";

                    } else if (pageStatus == "Fulfilled" || pageStatus == "Internally Fulfilled") {
                        SeletedEmployeeID = (dataset.AllocatedResource != "" && dataset.AllocatedResource != null) ? dataset.AllocatedResource.split(';') : "";
                    }
                    if (SeletedEmployeeID != "") {
                        $.each(SeletedEmployeeID, function (key, value) {

                            var childCheckboxes = ResourceTable.rows().nodes().to$('#tblResources tbody tr td').find('input[type=checkbox]');
                            if (childCheckboxes.length > 0) {
                                for (var index = 0; index < childCheckboxes.length; index++) {
                                    if (childCheckboxes[index].parentNode.parentNode.firstElementChild.nextSibling.innerText == value) {
                                        childCheckboxes[index].defaultChecked = true;

                                        var name = childCheckboxes[index].parentNode.parentNode.childNodes[2].innerText.split('Project')[0];
                                        var logDeatils = '<li>' + value + ' | ' + name + '</li>';
                                        $("#slectedResource").append(logDeatils);
                                    }

                                }
                            } else {
                                $('#tblResources tbody tr').each(function () {
                                    //var abc = $(this).find('td:eq(1)')[0].innerText;
                                    if ($(this).find('td:eq(1)')[0].innerText == value) {
                                        var name = $(this).find('td:eq(2)')[0].innerText.split('Project')[0];
                                        var logDeatils = '<li>' + value + ' | ' + name + '</li>';
                                        $("#slectedResource").append(logDeatils);
                                    }
                                });

                            }
                        });
                    } else {
                        $('#tblResources tbody tr').each(function () {
                            $(this).find('td:eq(0) input').prop('checked', false);
                        });
                    }
                }


            },
            complete: function () {
                //bind rejected resource indication

                var dataurl = "../_api/web/lists/getbytitle('RMOAssignmentRefusal')/items?$filter=RRFNo eq'" + RRFNumber + "'&$Top=1";
                $.ajax({
                    url: dataurl,
                    async: false,
                    type: "GET",
                    headers: { "Accept": "application/json;odata=verbose" },
                    success: function (data) {
                        var RRFRefuseResourceCount = data.d.results.length;
                        var RRFRefuseResources = data.d.results;
                        var SeletedEmployeeID = "";
                        if (RRFRefuseResourceCount > 0) {
                            $.each(RRFRefuseResources, function (key, value) {
                                $('#tblResources tbody tr').each(function () {
                                    // $('#tblResources tbody tr td:eq(1)')[0].innerHTML
                                    if ($(this).find('td:eq(1)')[0].innerHTML == value.EmployeeID) {
                                        $(this).find('td:eq(9)')[0].innerHTML = $(this).find('td:eq(9)')[0].innerHTML + "  " + "<span class='bgred' title='Rejected'>REJ</span>";
                                    }
                                });

                            });
                        }


                    },
                    error: function (jqXHR, textStatus, errorThrown) {

                    }
                });
            },
            error: function (jqXHR, textStatus, errorThrown) {

            }
        });
    }
    //code to save RRF Selection Proposed
    function ResourceApproveForSelection() {
        var empID = document.getElementById('empIdResourceSelection').innerHTML;
		//empID.trim();
		empID =empID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
        insertProjectComment("", "1", "", "", "PM");
        RRFSaveResource(empID);
    }

    //Code to move RRF to External hiring 
    function ExternalPopUp(element) {
        RRFRowID = element.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[0];
        pageStatus = element.id.split('#;')[5]; // Page Status //element.parentNode.parentNode.parentNode.parentNode.parentNode.cells[9].innerText;
        var RequimentPercentage = element.id.split('#;')[3];
        EmployeeRole = element.id.split('#;')[4];

        _MailFPNAUserId = element.id.split('#;')[6];
        _MailRMOSPOCUserId = element.id.split('#;')[7];
        _MailNewAuthorId = element.id.split('#;')[8];
        _MailNewProjectManagerId = element.id.split('#;')[9];
        _MailRRFNO = element.id.split('#;')[2];
		 HiringsPocmail = element.id.split('#;')[10];
        _MailHiringSpoc = HiringsPocmail.split('#')[15];
        if (RequimentPercentage == "100") {

            $('.loader').show();
            setTimeout(function () {
                $('.popup-bg').show();
                $('.clssPopupHead').text('Ensure to explore all internal availability options, before triggering hiring');
                document.getElementById('divApproveBody').style.display = "none";
                document.getElementById('divstartdatepopup').style.display = "none";
                //$('#divApproveBody').css('display', 'none');
                $('#divExternalMsgApproval').css('display', 'block');
                $('#divExternalMsg').css('display', 'none');
                document.getElementById('divRejectBody').style.display = "none";
                document.getElementById('divComment').style.display = "none";
                document.getElementById('divSearchResource').style.display = "none";
                document.getElementById('divViewLog').style.display = "none";
                $('.loader').hide();
            }, 100);

        }
        else {
            $('.popup-bg').show();
            $('.clssPopupHead').text('Please ensure to have the requirement 100%, to initiate external hiring');
            $('#divExternalMsg').css('display', 'block');
            $('#divExternalMsgApproval').css('display', 'none');
            $('#divApproveBody').css('display', 'none');
            $('#divstartdatepopup').css('display', 'none');
            document.getElementById('divRejectBody').style.display = "none";
            document.getElementById('divComment').style.display = "none";
            document.getElementById('divSearchResource').style.display = "none";
            document.getElementById('divViewLog').style.display = "none";
        }
    }
    //bind selected resource id
    function bindSelectedResourceData() {
        var resourceID = $("#ddlResourceName option:selected").attr('data-value');
		//resourceID.trim();
		resourceID =resourceID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
        document.getElementById('txtResourceID').value = resourceID
    }
    //code to save resource after assigned in RRF
    function SaveResourceassignment() {
        var resourceFlag = 0;
        if (validateResourceAssignementData()) {
            $('.loader').show();
            document.getElementById('btnSaveResource').style.display = 'none';
            HiddenFlag = "1";
            var projectCode = document.getElementById('txtProjectCode').value;
            var projectName = document.getElementById('txtProjectName').value;
            var projecManager = document.getElementById('txtProjectManager').value;
            var clientPartner = document.getElementById('txtclientPertner').value;
            var resourceManager = document.getElementById('txtResourcemanager').value;
            var ProjectLoaction = document.getElementById('txtPLocation').value;
            var resourceAllocation = document.getElementById('txtAllocation').value;
            var EmployeeRole = document.getElementById('txtEmployeeRole').value;
            var startDate = $('#txtstrtDt').datepicker("getDate").format("yyyy-MM-dd");
            startDate = getformateDateForSave(startDate);
            // startDate = startDate.substring(0, 19);
            var endDate = $('#txtendDt').datepicker("getDate").format("yyyy-MM-dd");
            endDate = getformateDateForSave(endDate);
            // endDate = endDate.substring(0, 19);
            var assignmentType = document.getElementById('ddlAssignmentTyp').value;
            var spandata = document.getElementById('rrfnumber').innerHTML;
            var RRFNumber = spandata.split(';')[0];
            var resourceName = spandata.split(';')[1];
			var resource_ID = spandata.split(';')[2];
            //var resourceID = resource_ID.trim();
			var resourceID =resource_ID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
            var designation = spandata.split(';')[3];
            var status = spandata.split(';')[4];
            var employee_email = spandata.split(';')[5];
            var PrimarySkill = spandata.split(';')[6];
			var Res_Roleband = spandata.split(';')[7];
            var emailId = document.getElementById('txtAdditionalEmail').value;
            var Note = document.getElementById('TextareaResourceNote').value;
            var futureAllocationFlag = "";
			
			var ContractType = document.getElementById('txtContractType').value;
			
            //future allocation check
            var allocation_StartDate = $('#txtstrtDt').datepicker("getDate");
            allocation_StartDate = Date.parse(allocation_StartDate);
            var currentDate = new Date();
            currentDate = Date.parse(currentDate);
            if (allocation_StartDate > currentDate) {
                var getactiveflagData = "";
                futureAllocationFlag = 2;
            } else {
                var getactiveflagData = getActiveByResourceWiseProjectAllocation(projectCode, resourceID, LoginUserEmail);
            }

            // var getactiveflagData = getActiveByResourceWiseProjectAllocation(projectCode, resourceID, LoginUserEmail);
            var ResourceAllUrl = ProjectWiseAllocation();
            var flagvalue = "Internal";
            //var result = InserdataProjectwiseResourceallocation(projectCode, projectName, resourceName, resourceID, startDate, endDate, resourceAllocation, ProjectLoaction, resourceManager, projecManager, flagvalue, PrimarySkill, RRFNumber, futureAllocationFlag,Res_Roleband)
            var result = "";
            if (result == "") {
                var listName = "RMOResourceAssignment";
                var itemType = GetItemTypeForListName(listName);
                var item = {
                    __metadata: { "type": itemType },

                    ProjectCode: projectCode,
                    ProjectName: projectName,
                    RRFNumber: RRFNumber,
                };
				$.extend(item, { ErrorLog: result });
                $.extend(item, { ProjectManager: projecManager });
                $.extend(item, { ClientPartner: clientPartner });
                $.extend(item, { ResourceManager: resourceManager });
                $.extend(item, { ProjectLoaction: ProjectLoaction });
                $.extend(item, { ResourceName: resourceName });
                $.extend(item, { ResourceID: resourceID });
                $.extend(item, { AllocationPercent: resourceAllocation });
                $.extend(item, { Billability: EmployeeRole });
                $.extend(item, { StartDate: startDate });
                $.extend(item, { EndDate: endDate });
                $.extend(item, { TypeofAssignment: assignmentType });
                $.extend(item, { AdditionalEmail: emailId });
                $.extend(item, { Note: Note });
                $.extend(item, { Designation: designation });
                $.extend(item, { Employee_status: status });
                $.extend(item, { ResourceEmailID: employee_email });
				$.extend(item, { ContractType: ContractType });
                $.ajax({
                    url: "../_api/Web/Lists/GetByTitle('" + listName + "')/items",
                    type: "POST",
					async: false,
                    contentType: "application/json;odata=verbose",
                    data: JSON.stringify(item),

                    headers: {
                        "Accept": "application/json;odata=verbose",
                        "X-RequestDigest": $("#__REQUESTDIGEST").val()
                    },
                    success: function (data) {
                        //alert('Resource Allocated Successfully');
                        if (txtidIndex == 0) {
                            //var RRFRowID = "1307";
                            var resourcesharepointId = getSharePointUserID(employee_email);
                            resourcesharepointId = parseInt(resourcesharepointId.split('#')[0]);
                            var item = {
                                __metadata: { "type": "SP.Data.RRFItem" }
                            };
                            $.extend(item, { Status: "Internally Fulfilled" });

                            $.extend(item, { ResourceAgainstRRFInWDId: resourcesharepointId });
                            $.extend(item, { TATDateTime: currentDate });
                            if (internallyfulfilledFlag == "External") {
                                $.extend(item, { InternallyFulfilled: "Internally Fulfilled" });
                            }
                            $.ajax({
                                url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
                                type: "POST",
                                contentType: "application/json;odata=verbose",
                                data: JSON.stringify(item),
                                async: false,
                                headers: {
                                    "Accept": "application/json;odata=verbose",
                                    "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                    "X-HTTP-Method": "MERGE",
                                    "If-Match": "*"
                                },
                                success: function (data) {

                                    var To = resourcesharepointId.toString();
                                    var Cc = _MailRMOSPOCUserId + ";" + _MailNewAuthorId + ";" + "rmo@bcone.com";
                                    var TrackingId = _MailRRFNO.toString();
                                    insertIntoSendEmailData(To, Cc.toString(), "54", "5", TrackingId);

                                    insertProjectComment("", "1", "", "");
									var successdata = InserdataProjectwiseResourceallocation(projectCode, projectName, resourceName, resourceID, startDate, endDate, resourceAllocation, ProjectLoaction, resourceManager, projecManager, flagvalue, PrimarySkill, RRFNumber, futureAllocationFlag,Res_Roleband)
                                    if(FPNAFlagMail=="1" || FPNAFlagMail==1)
									{
									   var Cc = _MailRMOSPOCUserId + ";" + ProjectManagerUserId + ";" + "rmo@bcone.com" + ";" + "kiran.nair@bcone.com" + ";" + "kinnary.desai@bcone.com" + ";" + "aman.gupta@bcone.com";
										insertIntoSendEmailData(hiringspocmailid, Cc.toString(), "88", "5", TrackingId);
									}
                                    $('.loader').hide();
									if(successdata=="Inserted")
									{
										$('.AlertclssPopupHead').text('Success');
										document.getElementById('divMsgOnreject').style.display = 'none';
										document.getElementById('divMsgOnApprove').style.display = 'none';
										document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
										document.getElementById('divMsgSaveValidateResource').style.display = "none";
										document.getElementById('divMsgProposedResourceFirst').style.display = "none";
										document.getElementById('divMsgAllocateResource').style.display = 'block';
										$('.Alertpopup-bg').show();

									}
                                },
                                error: function (error) {
                                    alert(JSON.stringify(error));
                                }
                            });
                        }
                        if (txtidIndex > 0) {
                            for (var z = 0; z < txtidIndex; z++) {
                                projectCode = document.getElementById('txtProjectCode').value;
                                projectName = document.getElementById('txtProjectName').value;
                                projecManager = document.getElementById('txtProjectManager').value;
                                clientPartner = document.getElementById('txtclientPertner').value;
                                resourceManager = document.getElementById('txtResourcemanager').value;
                                ProjectLoaction = document.getElementById('txtPLocation').value;

                                resourceAllocation = document.getElementById('txtAllocation' + z).value;
                                EmployeeRole = document.getElementById('txtEmployeeRole' + z).value;
                                startDate = $('#txtstrtDt' + z).datepicker("getDate").format("yyyy-MM-dd");
                                startDate = getformateDateForSave(startDate);
                                //startDate = startDate.substring(0, 19);
                                endDate = $('#txtendDt' + z).datepicker("getDate").format("yyyy-MM-dd");
                                endDate = getformateDateForSave(endDate);
                                // endDate = endDate.substring(0, 19);
                                assignmentType = document.getElementById('selectAssignment' + z).value;

                                emailId = document.getElementById('txtAdditionalEmail').value;
                                Note = document.getElementById('TextareaResourceNote').value;

                                //future allocation check
                                var allocation_StartDate = $('#txtstrtDt' + z).datepicker("getDate");
                                allocation_StartDate = Date.parse(allocation_StartDate);
                                var currentDate = new Date();
                                currentDate = Date.parse(currentDate);
                                if (allocation_StartDate > currentDate) {
                                    var getactiveflagData = "";
                                    futureAllocationFlag = 2;
                                } else {
                                    var getactiveflagData = getActiveByResourceWiseProjectAllocation(projectCode, resourceID, LoginUserEmail);
                                }


                               // var result = InserdataProjectwiseResourceallocation(projectCode, projectName, resourceName, resourceID, startDate, endDate, resourceAllocation, ProjectLoaction, resourceManager, projecManager, flagvalue, PrimarySkill, RRFNumber, futureAllocationFlag,Res_Roleband)
                                var result = "";
                                if (result == "") {
                                    // alert('added successfully');
                                    var listName = "RMOResourceAssignment";
                                    var itemType = GetItemTypeForListName(listName);
                                    var item = {
                                        __metadata: { "type": itemType },

                                        ProjectCode: projectCode,
                                        ProjectName: projectName,
                                        RRFNumber: RRFNumber,
                                    };
									$.extend(item, { ErrorLog: result });
                                    $.extend(item, { ProjectManager: projecManager });
                                    $.extend(item, { ClientPartner: clientPartner });
                                    $.extend(item, { ResourceManager: resourceManager });
                                    $.extend(item, { ProjectLoaction: ProjectLoaction });
                                    $.extend(item, { ResourceName: resourceName });
                                    $.extend(item, { ResourceID: resourceID });
                                    $.extend(item, { AllocationPercent: resourceAllocation });
                                    $.extend(item, { Billability: EmployeeRole });
                                    $.extend(item, { StartDate: startDate });
                                    $.extend(item, { EndDate: endDate });
                                    $.extend(item, { TypeofAssignment: assignmentType });
                                    $.extend(item, { AdditionalEmail: emailId });
                                    $.extend(item, { Note: Note });
                                    $.extend(item, { Designation: designation });
                                    $.extend(item, { Employee_status: status });
									
                                    $.extend(item, { ResourceEmailID: employee_email });
                                    $.ajax({
                                        url: "../_api/Web/Lists/GetByTitle('" + listName + "')/items",
                                        type: "POST",
										async: false,
                                        contentType: "application/json;odata=verbose",
                                        data: JSON.stringify(item),

                                        headers: {
                                            "Accept": "application/json;odata=verbose",
                                            "X-RequestDigest": $("#__REQUESTDIGEST").val()
                                        },
                                        success: function (data) {
                                            resourceFlag++;
                                            if (resourceFlag == txtidIndex) {
                                                //var RRFRowID = "1307";
                                                var resourcesharepointId = getSharePointUserID(employee_email);
                                                resourcesharepointId = parseInt(resourcesharepointId.split('#')[0]);
                                                var item = {
                                                    __metadata: { "type": "SP.Data.RRFItem" }
                                                };
                                                $.extend(item, { Status: "Internally Fulfilled" });

                                                $.extend(item, { ResourceAgainstRRFInWDId: resourcesharepointId });
                                                $.extend(item, { TATDateTime: currentDate });
                                                if (internallyfulfilledFlag == "External") {
                                                    $.extend(item, { InternallyFulfilled: "Internally Fulfilled" });
                                                }
                                                $.ajax({
                                                    url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
                                                    type: "POST",
                                                    contentType: "application/json;odata=verbose",
                                                    data: JSON.stringify(item),
                                                    async: false,
                                                    headers: {
                                                        "Accept": "application/json;odata=verbose",
                                                        "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                                        "X-HTTP-Method": "MERGE",
                                                        "If-Match": "*"
                                                    },
                                                    success: function (data) {

                                                        var To = resourcesharepointId.toString();
                                                        var Cc = _MailRMOSPOCUserId + ";" + _MailNewAuthorId + ";" + "rmo@bcone.com";
                                                        var TrackingId = _MailRRFNO.toString();
                                                        insertIntoSendEmailData(To, Cc.toString(), "54", "5", TrackingId);

                                                        insertProjectComment("", "1", "", "");
														var successdata = InserdataProjectwiseResourceallocation(projectCode, projectName, resourceName, resourceID, startDate, endDate, resourceAllocation, ProjectLoaction, resourceManager, projecManager, flagvalue, PrimarySkill, RRFNumber, futureAllocationFlag,Res_Roleband)
                                                        if(FPNAFlagMail=="1" || FPNAFlagMail==1)
														{
														    var Cc = _MailRMOSPOCUserId + ";" + ProjectManagerUserId + ";" + "rmo@bcone.com" + ";" + "kiran.nair@bcone.com" + ";" + "kinnary.desai@bcone.com" + ";" + "aman.gupta@bcone.com";
															insertIntoSendEmailData(hiringspocmailid, Cc.toString(), "88", "5", TrackingId);
														}
                                                        $('.loader').hide();
														if(successdata=="Inserted")
														{
															$('.AlertclssPopupHead').text('Success');
															document.getElementById('divMsgOnreject').style.display = 'none';
															document.getElementById('divMsgOnApprove').style.display = 'none';
															document.getElementById('divMsgExternalAlloctaion').style.display = 'none';
															document.getElementById('divMsgSaveValidateResource').style.display = "none";
															document.getElementById('divMsgProposedResourceFirst').style.display = "none";
															document.getElementById('divMsgAllocateResource').style.display = 'block';
															$('.Alertpopup-bg').show();
														}
                                                    },
                                                    error: function (error) {
                                                        alert(JSON.stringify(error));
                                                    }
                                                });
                                            }
                                        },
                                        error: function (error) {
                                            alert(JSON.stringify(error));
                                        }
                                    });
                                }
                            }
                        }
                    },
                    error: function (error) {
                        alert(JSON.stringify(error));
                    }
                });
            }
        }
    }

    function checkResourceAvailbility(event) {
        if (removeErrorMsgResourceAssignment()) {
            var Employee_ID = document.getElementById('rrfnumber').innerHTML.split(';')[2];
            //Employee_ID = "10062";
            var projectStartdate = "";
            var projectEnddate = "";
            var Allocationvalue = "";
            if (event.parentNode.parentNode.childNodes.length == 14) {
                var projectStrtdateID = event.parentNode.parentNode.childNodes[6].firstElementChild.firstElementChild.id;
                projectStrtdate = $('#' + projectStrtdateID).datepicker("getDate");
                projectStrtdate.setDate(projectStrtdate.getDate() + 1);
                projectStrtdate = projectStrtdate.toISOString();
                projectStrtdate = projectStrtdate != "" ? projectStrtdate.substring(0, 19) : "";
                var ProjectEnddateID = event.parentNode.parentNode.childNodes[8].firstElementChild.firstElementChild.id;
                projectEnddate = $('#' + ProjectEnddateID).datepicker("getDate");
                projectEnddate.setDate(projectEnddate.getDate() + 1);
                projectEnddate = projectEnddate.toISOString();
                projectEnddate = projectEnddate != "" ? projectEnddate.substring(0, 19) : "";
                Allocationvalue = event.parentNode.parentNode.childNodes[1].firstElementChild.value;
                if (projectStrtdate != "" && Allocationvalue != "" && projectEnddate != "") {
                    var result = searchresourceAllocationPercent(Employee_ID, projectStrtdate, projectEnddate, Allocationvalue);
                    if (result.length > 0) {
                        ResourceAvailbilityCount++;
                        event.parentNode.parentNode.childNodes[12].childNodes[1].lastElementChild.innerHTML = "1";
                        event.parentNode.parentNode.childNodes[12].childNodes[2].style.display = "none"
                        event.parentNode.parentNode.childNodes[12].childNodes[1].firstElementChild.style.display = 'inline-block';
                    } else {
                        event.parentNode.parentNode.childNodes[12].childNodes[1].lastElementChild.innerHTML = "";
                        event.parentNode.parentNode.childNodes[12].childNodes[1].firstElementChild.style.display = 'none';
                        event.parentNode.parentNode.childNodes[12].childNodes[2].innerHTML = "Resource is not Available";
                        event.parentNode.parentNode.childNodes[12].childNodes[2].style.display = "block";
                    }

                } else {
                    event.parentNode.parentNode.childNodes[12].childNodes[1].firstElementChild.style.display = 'none';
                    if (Allocationvalue == "") {
                        event.parentNode.parentNode.childNodes[1].lastElementChild.style.display = 'block';
                        return false;
                    } else if (projectStrtdate == "") {
                        event.parentNode.parentNode.childNodes[6].firstElementChild.nextElementSibling.style.display = 'block'
                        return false;
                    } else if (projectEnddate == "") {
                        event.parentNode.parentNode.childNodes[8].firstElementChild.nextElementSibling.innerHTML = "End date is required";
                        event.parentNode.parentNode.childNodes[8].firstElementChild.nextElementSibling.style.display = 'block'
                        return false;
                    }
                }
            } else {
                var projectStrtdateID = event.parentNode.parentNode.childNodes[13].firstElementChild.firstElementChild.id;
                projectStrtdate = $('#' + projectStrtdateID).datepicker("getDate");
                projectStrtdate.setDate(projectStrtdate.getDate() + 1);
                projectStrtdate = projectStrtdate.toISOString();
                projectStrtdate = projectStrtdate != "" ? projectStrtdate.substring(0, 19) : "";
                var ProjectEnddateID = event.parentNode.parentNode.childNodes[17].firstElementChild.firstElementChild.id;
                projectEnddate = $('#' + ProjectEnddateID).datepicker("getDate");//.toISOString();
                projectEnddate.setDate(projectEnddate.getDate() + 1);
                projectEnddate = projectEnddate.toISOString();
                projectEnddate = projectEnddate != "" ? projectEnddate.substring(0, 19) : "";
                Allocationvalue = event.parentNode.parentNode.childNodes[3].firstElementChild.value;
                if (projectStrtdate != "" && Allocationvalue != "" && projectEnddate != "") {
                    var result = searchresourceAllocationPercent(Employee_ID, projectStrtdate, projectEnddate, Allocationvalue);
                    if (result.length > 0) {
                        ResourceAvailbilityCount++;
                        event.parentNode.parentNode.childNodes[25].childNodes[3].lastElementChild.innerHTML = "1";
                        event.parentNode.parentNode.childNodes[25].childNodes[9].style.display = "none"
                        event.parentNode.parentNode.childNodes[25].childNodes[3].firstElementChild.style.display = "inline-block";
                    } else {
                        event.parentNode.parentNode.childNodes[25].childNodes[3].lastElementChild.innerHTML = "";
                        event.parentNode.parentNode.childNodes[25].childNodes[3].firstElementChild.style.display = "none";
                        event.parentNode.parentNode.childNodes[25].childNodes[9].innerHTML = "Resource is not Available";
                        event.parentNode.parentNode.childNodes[25].childNodes[9].style.display = "block";
                    }
                } else {
                    if (Allocationvalue == "") {
                        event.parentNode.parentNode.childNodes[3].lastElementChild.style.display = 'block';
                        return false;
                    } else if (projectStrtdate == "") {
                        event.parentNode.parentNode.childNodes[13].firstElementChild.nextElementSibling.style.display = 'block'
                        return false;
                    } else if (projectEnddate == "") {
                        event.parentNode.parentNode.childNodes[17].firstElementChild.nextElementSibling.innerHTML = "End date is required"
                        event.parentNode.parentNode.childNodes[17].firstElementChild.nextElementSibling.style.display = 'block'
                        return false;
                    }
                }
            }
        }
    }
    function removeErrorMsgResourceAssignment() {
        var formatedProjectEndDate = convert_date_DDMMYYYY(projectEnddate);
        if (softblockFlag == "1") {
            if (document.getElementById('sftblckstartDt').value != "") {
                $('#errsftblckstartDt').css('display', 'none');
            }
            if (document.getElementById('sftblckendDt').value != "") {
                $('#errsftblckendDt').css('display', 'none');
            }

        } else {
            if (document.getElementById('txtPLocation').value != "") {
                $('#errMsgLocation').css('display', 'none');
                var location_base = document.getElementById('txtPLocation').value;
                var match = (new RegExp('[~#%\&{}+\|<>*]|\'\|\\\\|^\\|\\$')).test(location_base);
                if (match) {
                    document.getElementById("errMsgLocation").innerHTML = "Special characters are invalid";
                    $('#errMsgLocation').css('display', 'block');
                    return false;
                } else {
                    $('#errMsgLocation').css('display', 'none');
                }
            }
            var projectEndDateTemp = Date.parse(projectEnddate);
            if (document.getElementById('txtAllocation').value != "") {

                var allocationVal = document.getElementById('txtAllocation').value;
                allocationVal = parseInt(allocationVal);
                if (allocationVal > 100 || allocationVal == 0) {
                    document.getElementById('errtxtAllocation').innerHTML = 'Allocation % should be between 1-100';
                    $('#errtxtAllocation').css('display', 'block');
                    return false;
                } else {
                    $('#errtxtAllocation').css('display', 'none');
                }
            }
            if (document.getElementById('txtEmployeeRole').value != "") {
                $('#errddlBillability').css('display', 'none');
            }
            if (document.getElementById('txtstrtDt').value != "") {
                $('#errtxtstrtDt').css('display', 'none');
                var strtdate = document.getElementById('txtstrtDt').value;
                strtdate = $('#txtstrtDt').datepicker("getDate");
                strtdate = Date.parse(strtdate);
                var ParseprojectEndDate = Date.parse(formatedProjectEndDate);

                if (document.getElementById('txtendDt').value != "") {
                    var enddate = document.getElementById('txtendDt').value;
                    enddate = $('#txtendDt').datepicker("getDate");
                    enddate = Date.parse(enddate);
                    if (strtdate > enddate) {
                        document.getElementById('txtstrtDt').value = "";
                        document.getElementById('errtxtstrtDt').innerHTML = "it can't be greater-than End date";
                        $('#errtxtstrtDt').css('display', 'block');
                        return false;
                    }
                }
                if (ParseprojectEndDate < strtdate) {
                    document.getElementById('txtstrtDt').value = "";
                    document.getElementById('errtxtstrtDt').innerHTML = "it can't be greater-than Project End date:" + "<br/>" + formatedProjectEndDate + "";
                    $('#errtxtstrtDt').css('display', 'block');
                    return false;
                } else {
                    $('#errtxtstrtDt').css('display', 'none');
                }
            }
            if (document.getElementById('txtendDt').value != "") {
                $('#errtxtendDt').css('display', 'none');
                var enddate = document.getElementById('txtendDt').value;
                enddate = $('#txtendDt').datepicker("getDate");
                enddate = Date.parse(enddate);
                var ParseprojectEndDate = Date.parse(formatedProjectEndDate);
                if (document.getElementById('txtstrtDt').value != "") {
                    var strtdate = document.getElementById('txtstrtDt').value;
                    strtdate = $('#txtstrtDt').datepicker("getDate");
                    strtdate = Date.parse(strtdate);
                    if (strtdate > enddate) {
                        document.getElementById('txtendDt').value = "";
                        document.getElementById('errtxtendDt').innerHTML = "it can't be lesser-than Project start date";
                        $('#errtxtendDt').css('display', 'block');
                        return false;
                    }
                }
                if (ParseprojectEndDate < enddate) {
                    document.getElementById('txtendDt').value = "";
                    document.getElementById('errtxtendDt').innerHTML = "it can't be greater-than Project End date:" + "<br/>" + formatedProjectEndDate + "";
                    $('#errtxtendDt').css('display', 'block');
                    return false;
                } else {
                    $('#errtxtendDt').css('display', 'none');
                }
            }
            if (txtidIndex > 0) {
                for (var z = 0; z < txtidIndex; z++) {
                    if (document.getElementById('txtAllocation' + z).value != "") {
                        // $('#errtxtAllocation' + z).css('display', 'none');
                        var allocationVal = document.getElementById('txtAllocation' + z).value;
                        allocationVal = parseInt(allocationVal);
                        if (allocationVal > 100 || allocationVal == 0) {
                            document.getElementById('#errtxtAllocation' + z).innerHTML = 'Allocation % should be between 1-100';
                            $('#errtxtAllocation' + z).css('display', 'block');
                            return false;
                        } else {
                            $('#errtxtAllocation' + z).css('display', 'none');
                        }
                    }
                    if (document.getElementById('txtEmployeeRole' + z).value != "") {
                        $('#errddlBillability' + z).css('display', 'none');
                    }
                    if (document.getElementById('txtstrtDt' + z).value != "") {
                        $('#errtxtstrtDt' + z).css('display', 'none');
                        var strtdate = document.getElementById('txtstrtDt' + z).value;
                        strtdate = $('#txtstrtDt' + z).datepicker("getDate");
                        strtdate = Date.parse(strtdate);
                        var ParseprojectEndDate = Date.parse(formatedProjectEndDate);
                        if (document.getElementById('txtendDt' + z).value != "") {
                            var enddate = document.getElementById('txtendDt' + z).value;
                            enddate = $('#txtendDt' + z).datepicker("getDate");
                            enddate = Date.parse(enddate);
                            if (strtdate > enddate) {
                                document.getElementById('txtstrtDt' + z).value = "";
                                document.getElementById('errtxtstrtDt' + z).innerHTML = "it can't be greater-than End date:";
                                $('#errtxtstrtDt' + z).css('display', 'block');
                                return false;
                            }
                        }
                        if (ParseprojectEndDate < strtdate) {
                            document.getElementById('txtstrtDt' + z).value = "";
                            document.getElementById('errtxtstrtDt' + z).innerHTML = "it can't be greater-than Project End date:" + "<br/>" + formatedProjectEndDate + "";
                            $('#errtxtstrtDt' + z).css('display', 'block');
                            return false;
                        } else {
                            $('#errtxtstrtDt' + z).css('display', 'none');
                        }



                    }
                    if (document.getElementById('txtendDt' + z).value != "") {
                        var enddate = document.getElementById('txtendDt' + z).value;
                        enddate = $('#txtendDt' + z).datepicker("getDate");
                        enddate = Date.parse(enddate);
                        var ParseprojectEndDate = Date.parse(formatedProjectEndDate);
                        if (document.getElementById('txtstrtDt' + z).value != "") {
                            var strtdate = document.getElementById('txtstrtDt' + z).value;
                            strtdate = $('#txtstrtDt' + z).datepicker("getDate");
                            strtdate = Date.parse(strtdate);
                            if (strtdate > enddate) {
                                document.getElementById('txtendDt' + z).value = "";
                                document.getElementById('errtxtendDt' + z).innerHTML = "it can't be lesser-than Project start date";
                                $('#errtxtendDt' + z).css('display', 'block');
                                return false;
                            }
                        }
                        if (ParseprojectEndDate < enddate) {
                            document.getElementById('txtendDt' + z).value = "";
                            document.getElementById('errtxtendDt' + z).innerHTML = "it can't be greater-than Project End date:" + "<br/>" + formatedProjectEndDate + "";
                            $('#errtxtendDt' + z).css('display', 'block');
                            return false;
                        } else {
                            $('#errtxtendDt' + z).css('display', 'none');
                        }
                    }
                }
            }
            if (document.getElementById('txtAdditionalEmail').value != "") {
                var email = document.getElementById('txtAdditionalEmail').value;
                if (!validateEmail(email)) {
                    $('#errMsgEmail').css('display', 'block');
                    return false;
                } else {
                    $('#errMsgEmail').css('display', 'none');
                }

            }
        }
        return true;
    }
    function validateEmail(email) {
        var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email);
    }
    function validateResourceAssignementData() {
        if (softblockFlag == "1") {
            if (document.getElementById('sftblckstartDt').value == "") {
                $('#errsftblckstartDt').css('display', 'block');
                return false;
            }
            if (document.getElementById('sftblckendDt').value == "") {
                $('#errsftblckendDt').css('display', 'block');
                return false;
            }

        } else {
            if (document.getElementById('txtPLocation').value == "") {
                document.getElementById("errMsgLocation").innerHTML = "Location is required";
                $('#errMsgLocation').css('display', 'block');
                return false;
            }
            if (document.getElementById('txtAllocation').value == "") {
                $('#errtxtAllocation').css('display', 'block');
                return false;
            } else {
                var allocationVal = document.getElementById('txtAllocation').value;
                allocationVal = parseInt(allocationVal);
                if (allocationVal > 100 || allocationVal == 0) {
                    document.getElementById('errtxtAllocation').innerHTML = 'Allocation % should be between 1-100';
                    $('#errtxtAllocation').css('display', 'block');
                    return false;
                } else {
                    $('#errtxtAllocation').css('display', 'none');
                }

            }
            if (document.getElementById('txtEmployeeRole').value == "") {
                $('#errddlBillability').css('display', 'block');
                return false;
            } else {
                $('#errddlBillability').css('display', 'none');
            }
            if (document.getElementById('txtstrtDt').value == "") {
                $('#errtxtstrtDt').css('display', 'block');
                return false;
            } else {
                $('#errtxtstrtDt').css('display', 'none');
            }
            if (document.getElementById('txtendDt').value == "") {
                document.getElementById('txtendDt').innerHTML = "End date is required";
                $('#errtxtendDt').css('display', 'block');

                return false;
            } else {
                $('#errtxtendDt').css('display', 'none');
            }
            if (document.getElementById('Availabilityvalue').innerHTML == "") {
                document.getElementById('AvailbilityErrMsg').innerHTML = "Please check Resource Availbility "
                $('#AvailbilityErrMsg').css('display', 'block');
                return false;
            } else {
                $('#AvailbilityErrMsg').css('display', 'none');
            }
            if (document.getElementById('txtAdditionalEmail').value != "") {
                var email = document.getElementById('txtAdditionalEmail').value;
                if (!validateEmail(email)) {
                    $('#errMsgEmail').css('display', 'block');
                    return false;
                } else {
                    $('#errMsgEmail').css('display', 'none');
                }

            }

            var comment = document.getElementById('TextareaResourceNote').value;
            var match = (new RegExp('[~#%\&{}+\|<>*]|\'\|\\\\|^\\|\\$')).test(comment);
            if (match) {
                return false;
            }

            if (txtidIndex > 0) {
                for (var z = 0; z < txtidIndex; z++) {
                    if (document.getElementById('txtAllocation' + z).value == "") {
                        $('#errtxtAllocation' + z).css('display', 'block');
                        return false;
                    } else {
                        var allocationVal = document.getElementById('txtAllocation' + z).value;
                        allocationVal = parseInt(allocationVal);
                        if (allocationVal > 100 || allocationVal == 0) {
                            document.getElementById('#errtxtAllocation' + z).innerHTML = 'Allocation % should be between 1-100';
                            $('#errtxtAllocation' + z).css('display', 'block');
                            return false;
                        } else {
                            $('#errtxtAllocation' + z).css('display', 'none');
                        }
                    }
                    if (document.getElementById('txtEmployeeRole' + z).value == "") {
                        $('#errddlBillability' + z).css('display', 'block');
                        return false;
                    } else {
                        $('#errddlBillability' + z).css('display', 'none');
                    }
                    if (document.getElementById('txtstrtDt' + z).value == "") {
                        $('#errtxtstrtDt' + z).css('display', 'block');
                        return false;
                    } else {
                        $('#errtxtstrtDt' + z).css('display', 'none');
                    }
                    if (document.getElementById('txtendDt' + z).value == "") {
                        document.getElementById('txtendDt' + z).innerHTML = "End date is required";
                        $('#errtxtendDt' + z).css('display', 'block');
                        return false;
                    } else {
                        $('#errtxtendDt' + z).css('display', 'none');
                    }
                    if (document.getElementById('Availabilityvalue' + z).innerHTML == "") {
                        document.getElementById('AvailbilityErrMsg' + z).innerHTML = "Please check Resource Availbility "
                        $('#AvailbilityErrMsg' + z).css('display', 'block');
                        return false;
                    } else {
                        $('#AvailbilityErrMsg' + z).css('display', 'none');
                    }
                }
            }

        }
        return true;
    }
    function searchresourceAllocationPercent(Employee_ID, ProjectStrtdate, ProjectEnddate, Allocationvalue) {
        var refined_array = [];
        var site_url = searchresourceAllocationPercentResourceNew(ProjectStrtdate, ProjectEnddate, Employee_ID);
        $.ajax({
            url: site_url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                var tdId = "";
                var rejId = "";
                var cmntID = "";
                var resource_Array = [];
                var denieddate_Array = [];
                if (data.d.results.length > 0) {
                    ProjectStrtdate = Date.parse(ProjectStrtdate);
                    ProjectEnddate = Date.parse(ProjectEnddate);
                    $.each(data.d.results, function (key, value) {
                        var allocatedStartdate = value.Startdatetime;
                        allocatedStartdate = Date.parse(allocatedStartdate);
                        var allocatedEnddate = value.Finishdatetime;
                        allocatedEnddate = Date.parse(allocatedEnddate);
                        if ((allocatedStartdate >= ProjectStrtdate && allocatedStartdate <= ProjectEnddate) || (allocatedEnddate >= ProjectStrtdate && allocatedEnddate <= ProjectEnddate) || (ProjectStrtdate >= allocatedStartdate && ProjectStrtdate <= allocatedEnddate) || (ProjectEnddate >= allocatedStartdate && ProjectEnddate <= allocatedEnddate)) {
                            resource_Array.push(value);
                        } else {
                            denieddate_Array.push(value);
                        }
                    });

                    var array2 = [];
                    var array_d1 = [];
                    var array_d2 = [];
                    var Projectdatacount = 0;
                    var Locationdatacount = 0;
                    var allocation = 0;
                    var array_d3 = [];
                    for (var k = 0; k < resource_Array.length; k++) {

                        array2.push(resource_Array[k]);

                        var srtDate = resource_Array[k].Startdatetime;
                        var endDate = resource_Array[k].Finishdatetime;
                        srtDate = Date.parse(srtDate);
                        endDate = Date.parse(endDate);
                        array_d1.push(srtDate);
                        array_d2.push(endDate);

                        allocation = parseInt(allocation) + parseInt(resource_Array[k].Allocation);


                    }
                    var minStartDate = Math.min.apply(Math, array_d1);
                    minStartDate = formateRefinedDate(minStartDate);
                    var maxEndDate = Math.max.apply(Math, array_d2);
                    maxEndDate = formateRefinedDate(maxEndDate);
                    var allocationPer = allocation;  // Math.max.apply(Math, allocation);
                    if (resource_Array.length > 0) {
                        if (Allocationvalue != "" && Allocationvalue != undefined) {
                            if (Allocationvalue <= (100 - parseInt(allocationPer)))
                                refined_array.push({
                                    "EmployeeID": array2[0].EmployeeID,
                                    "ResourceFullName": array2[0].ResourceFullName,
                                    "Designation": array2[0].Designation,
                                    "ProjectName": array2[0].ProjectName,
                                    "Startdatetime": minStartDate,
                                    "Finishdatetime": maxEndDate,
                                    "Allocation": allocationPer,
                                    "Work_Location": array2[0].ProjectLocation
                                })
                        } else {

                            refined_array.push({
                                "EmployeeID": array2[0].EmployeeID,
                                "ResourceFullName": array2[0].ResourceFullName,
                                "Designation": array2[0].Designation,
                                "ProjectName": array2[0].ProjectName,
                                "Startdatetime": minStartDate,
                                "Finishdatetime": maxEndDate,
                                "Allocation": allocationPer,
                                "Work_Location": array2[0].ProjectLocation
                            })
                        }
                    }
                }
                // }
                if (refined_array.length == 0) {
                    if (data.d.results.length > 0) {
                        if (denieddate_Array.length == data.d.results.length && (denieddate_Array.length > 0)) {
                            refined_array.push(denieddate_Array);
                        }
                    } else if (denieddate_Array.length > 0) {
                        refined_array.push(denieddate_Array);
                    }
                    else if (refined_array.length == 0 && denieddate_Array.length == 0) {
                        refined_array.push(denieddate_Array);
                    }
                }
            }
        });

        return refined_array;
    }

    function searchResourceOnSkill() {
        $('.loader').show();


        setTimeout(function () {
            GetSearchResourceSkillData();
            $('.loader').hide();
        }, 100);

    }
    function GetSearchResourceSkillData() {
        var PreSkill = document.getElementById('ddlPrimarySkill').value;
        var SecSkill = document.getElementById('ddlSecondrySkill').value;
        var ROlebandVal = document.getElementById('ddlRoleband').value;

        var Employee_ID = "NA";
        var dattSet = searchResourceWithNewService(Employee_ID, PreSkill, SecSkill, ROlebandVal, projectStrtdate, "");

        if ($.fn.dataTable.isDataTable('#tblResources')) {
            destroyjs('#tblResources');
        }

        var resourceTbl_header = "";
        var resourcetable_element = "";
        resourceTbl_header = "<thead><tr>";
        var ResourceLIHTML = "<tbody>";
        //table binding for resources data
        resourceTbl_header = resourceTbl_header + "<th>Item</th>"
        resourceTbl_header = resourceTbl_header + "<th>Emp ID</th>"
        resourceTbl_header = resourceTbl_header + "<th>Name</th>"
        resourceTbl_header = resourceTbl_header + "<th>Designation</th>"
        resourceTbl_header = resourceTbl_header + "<th>Project Name</th>"
        resourceTbl_header = resourceTbl_header + "<th>Start Date</th>"
        resourceTbl_header = resourceTbl_header + "<th>End Date</th>"
        resourceTbl_header = resourceTbl_header + "<th>Allocation %</th>"
        resourceTbl_header = resourceTbl_header + "<th>Work Location</th>"
        resourceTbl_header = resourceTbl_header + "<th>Action</th>"
        resourceTbl_header = resourceTbl_header + "</tr></thead>";

        //footer menu
        resourceTbl_header = resourceTbl_header + "<tfoot><tr>";
        resourceTbl_header = resourceTbl_header + "<th>Item</th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th></th>"
        resourceTbl_header = resourceTbl_header + "<th>Action</th>"
        resourceTbl_header = resourceTbl_header + " </tr></tfoot>";
        var RRFNumber = RRF_Number;
        var ProjectCode = "";
        $.each(dattSet, function (index, value) {
            var EmpID = "";
            var EmpName = "";
            var Designation = "";
            var projectcode = "";
            var ProjectName = "";
            var ProjectstartDate = "";
            var ProjectEnddate = "";
            var allocationPercent = ""
            var Location = "";
            var status = "";
            if (value.EmployeeID != null) {
                EmpID = value.EmployeeID;
				//EmpID.trim();
				EmpID =EmpID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
            }
            if (value.ResourceFullName != null) {
                EmpName = value.ResourceFullName;
            }
            if (value.Designation != null) {
                Designation = value.Designation;
            }
            if (value.ProjectName != null) {
                ProjectName = value.ProjectName;
            }
            if (value.Startdatetime != null) {
                ProjectstartDate = value.Startdatetime;
            }
            if (value.Finishdatetime != null) {
                ProjectEnddate = value.Finishdatetime;
            }
            if (value.Allocation != null) {
                allocationPercent = value.Allocation;
            }
            if (value.Work_Location != null) {
                Location = value.Work_Location;
            }
            if (value.Employee_status != null) {
                status = value.Employee_status;
            }
            var ProjectNameHTML = "";
            if (ProjectName == "Multiple Assignment")
                ProjectNameHTML = "<a href='#' onclick='ShowMultipleAssignmentProjectsDetails(this)'>" + ProjectName + "</a>";
            else
                ProjectNameHTML = ProjectName;

            tdId = "resourcebtnApprove" + index;
            rejId = "resourcebtnReject" + "#;" + EmpID + "#;" + EmpName + "#;" + ProjectCode + "#;" + projectName + "#;" + ProLocation + "#;" + PrimarySkill + "#;" + RRFNumber;
            cmntID = "resourcebtnComment" + "#;" + EmpID + "#;" + EmpName + "#;" + RRFNumber;
            var assigmntDetails = EmpID + "#;" + projectcode + "#;" + RRFNumber;

            ResourceLIHTML = ResourceLIHTML + "<tr id=" + LogProjectGUID + "><td><input type='checkbox' name='checkResource' value='" + EmpID + "' /></td><td id=" + EmpID + "#;" + EmpName + ">" + EmpID + "</td><td><span href='#' id='show-popup' class='action-b'>" + EmpName + "<div class='action-b-view'><a href='../SitePages/ResourceProjectInformation.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank'>Project Detail</a><a href='../SitePages/MyProfile.aspx?employeeID=" + EmpID + "&employeename=" + EmpName + "' target='_blank' >View Profile</a></div></span></td><td>" + Designation + "</td><td id=" + EmpID + "#" + EmpName + ">" + ProjectNameHTML + "</td><td>" + ProjectstartDate + "</td><td>" + ProjectEnddate + "</td><td>" + allocationPercent + "</td><td>" + Location + "</td><td><span id='" + cmntID + "' class='glyphicon glyphicon-comment icon-weight' aria-hidden='true' title='Comment' onclick='ResourceCommentpopup(this)'></span></td></tr>"

        })
        ResourceLIHTML = ResourceLIHTML + "</tbody>";
        resourcetable_element = resourceTbl_header + ResourceLIHTML;
        $("#tblResources").append(resourcetable_element);

        ResourceTable = $('#tblResources').DataTable({
            "dom": 'Rlfrtip',
            "iDisplayLength": 5,
            "lengthMenu": [[5, 15, 35, -1], [5, 15, 35, "All"]],
            "pagingType": "simple_numbers"
        });

        $('#tblResources tfoot th').each(function () {
            var title = $(this).text();
            if (title != 'Action' && title != 'Indicators') {
                $(this).html('<input type="text" placeholder="Search ' + title + '" />');
            }
        });

        // DataTable
        var table = $('#tblResources').DataTable();

        // Apply the search
        table.columns().every(function () {
            var that = this;

            $('input', this.footer()).on('keyup change', function () {
                if (that.search() !== this.value) {
                    that
                        .search(this.value)
                        .draw();
                }
            });
        });


        if (table.data().any()) {

            bindcheckedResources(RRFNumber);
        }

    }
    function ResourceValidationAlert() {
        $('.Alertpopup-bg').hide();
        $('.Toppopup-bg').hide();
        $('.popup-bg').hide();
    }
    function RejectResourcesalert() {
        $('.Alertpopup-bg').hide();
        $('.Toppopup-bg').hide();
        $('.popup-bg').hide();
        if (pageStatus == "Resource Proposed") {
            refine_status("resourceproposed", "Resource Proposed", "");
        } else if (pageStatus == "RMO Validation") {
            refine_status('rmovalidation', 'RMO Validation', "");
        }
        //else {
        //    refine_status("resourceselection", "Resource Selection", "");
        //}
        
    }
    function SelectionResourceAlert() {

        $('.Alertpopup-bg').hide();
        $('.Toppopup-bg').hide();
        $('.popup-bg').hide();
        if (pageStatus == "Resource Selection" || pageStatus == "resourceselection") {
            refine_status("resourceselection", "Resource Selection", "");
        }

    }
    function ExternalResourceAlert() {
        $('.Alertpopup-bg').hide();
        $('.Toppopup-bg').hide();
        $('.popup-bg').hide();
        refine_status('externalhiring', 'External Hiring', "");

    }

    //code to show multiple assignment projects of resource

    function resourceSoftblock() {
        softblockFlag = "1";
        if (validateResourceAssignementData()) {

            //SaveResourceassignment();
            var ProjectDataset = Projectdetails.split('#;');
            var ProjCode = ProjectDataset[0];
            var ProjName = ProjectDataset[1];
            var AllocationPerc = ProjectDataset[2];
            var ProjectLoaction = ProjectDataset[3];
            var RMOSPOCname = ProjectDataset[4];
            var ProjManager = ProjectDataset[5];
            var PrimarySkill = ProjectDataset[6];
            var RRF_Number = ProjectDataset[7]
            var count = 0;
            startDate = $('#sftblckstartDt').datepicker("getDate").format("yyyy-MM-dd");
            startDate = getformateDateForSave(startDate);
            endDate = $('#sftblckendDt').datepicker("getDate").format("yyyy-MM-dd");
            endDate = getformateDateForSave(endDate);
            flagvalue = "Soft Block";
            var childCheckboxes = ResourceTable.rows().nodes().to$('#tblResources tbody tr td').find('input[type=checkbox]');
            var no_checked = childCheckboxes.filter(':checked').each(function () { });
            if (no_checked.length > 0) {
                $('#errMsgSvaeSoftBlock').css('display', 'none');
                for (var index = 0; index < no_checked.length; index++) {
                    var soft_block_EmployeeID = ""; var soft_block_Employeename = "";
                    soft_block_EmployeeID = no_checked[index].parentNode.parentNode.firstElementChild.nextSibling.innerText;
					//soft_block_EmployeeID.trim();
					soft_block_EmployeeID =soft_block_EmployeeID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
                    soft_block_Employeename = no_checked[index].parentNode.parentNode.childNodes[2].innerText.split('Project')[0];
					soft_block_Employeename.trim();
                    var result = InserdataProjectwiseResourceallocation(ProjCode, ProjName, soft_block_Employeename, soft_block_EmployeeID, startDate, endDate, AllocationPerc, ProjectLoaction, RMOSPOCname, ProjManager, flagvalue, PrimarySkill, RRF_Number);
                    if (result == "Inserted") {
                        count++;
                    }
                }
                if (no_checked.length == count) {
                    softblockFlag = "";
                    document.getElementById('btnSoftblockOK').style.display = 'inline-block';
                }
            } else {
                $('#errMsgSvaeSoftBlock').css('display', 'block');
            }
        }
    }
    function takeenddate() {
        if (pageStatus == "Resource Proposed") {
            var dt = $('#sftblckstartDt').datepicker("getDate");
            //= new Date();
            var SowAssignDate = dt.format("d-MMM-yyyy");
            for (var i = 0; i < 14; i++) {
                dt.setDate(dt.getDate() + 1);

            }
            var NewendDate = dt.format("d-MMM-yyyy");
            document.getElementById('sftblckendDt').value = NewendDate;
        }
    }
    function ResourceExternalApproval(event) {

        var dataset = event.id.split('#;');
        var projectId = dataset[0];
        var resource_ID = dataset[1];
        //var resourceID = resource_ID.trim();
		var resourceID =resource_ID.replace(/(\r\n\s|\n|\r|\s)/gm, '');
        var resourceName = dataset[2];
        var designation = dataset[3];
        var projectName = dataset[4];
        var startDate = dataset[6];
        var endDate = dataset[7];
        var resourceAllocation = dataset[8];
        var status = dataset[9];
        var ProjectLoaction = dataset[10];
        var RRFNumber = dataset[11];
        var EmployeeRole = dataset[12];


        var projectCode = dataset[13];
        var projecManager = dataset[14];
        var clientPartner = dataset[15];
        var resourceManager = dataset[16];
        var assignmentType = "";
        var ResourceAllUrl = ProjectWiseAllocation();
        var flagvalue = "New";
        $.ajax({
            url: ResourceAllUrl,
            async: false,
            method: "POST",
            data: {
                "AllocatedProjectCode": projectCode,
                "ProjectName": projectName,
                "ResourceFullName": resourceName,
                "EmployeeID": resourceID,
                "BookingType": null,
                "Startdatetime": startDate,
                "Finishdatetime": endDate,
                "Allocation": resourceAllocation,
                "ProjectLocation": ProjectLoaction,
                "BillableStatus": null,
                "RMOSPOC": resourceManager,
                "Reporting_Manager": projecManager,
                "Flag": flagvalue,
                "PrimarySkills": null,
                "Active": 1,
                "RRFNO": RRFNumber,
				"RA_created_by": LoginUserEmail,
                "RA_Modify_By": LoginUserEmail

            },
            headers: {
                "Accept": "application/json;odata=verbose"
            },
            success: function (data) {


                var listName = "RMOResourceAssignment";
                var itemType = GetItemTypeForListName(listName);
                var item = {
                    __metadata: { "type": itemType },

                    ProjectCode: projectCode,
                    ProjectName: projectName,
                    RRFNumber: RRFNumber,
                };
                $.extend(item, { ProjectManager: projecManager });
                $.extend(item, { ClientPartner: clientPartner });
                $.extend(item, { ResourceManager: resourceManager });
                $.extend(item, { ProjectLoaction: ProjectLoaction });
                $.extend(item, { ResourceName: resourceName });
                $.extend(item, { ResourceID: resourceID });
                $.extend(item, { AllocationPercent: resourceAllocation });
                $.extend(item, { Billability: EmployeeRole });
                $.extend(item, { StartDate: startDate });
                $.extend(item, { EndDate: endDate });
                $.extend(item, { TypeofAssignment: assignmentType });
                $.extend(item, { Designation: designation });
                $.extend(item, { Employee_status: status });
                $.ajax({
                    url: "../_api/Web/Lists/GetByTitle('" + listName + "')/items",
                    type: "POST",
                    contentType: "application/json;odata=verbose",
                    data: JSON.stringify(item),

                    headers: {
                        "Accept": "application/json;odata=verbose",
                        "X-RequestDigest": $("#__REQUESTDIGEST").val()
                    },
                    success: function (data) {
                        //alert('Resource Allocated Successfully');

                        //var RRFRowID = "1307";
                        var item = {
                            __metadata: { "type": "SP.Data.RRFItem" }
                        };
                        $.extend(item, { Status: "Internally Fulfilled" });
                        $.ajax({
                            url: "../_api/Web/Lists/GetByTitle('RRF')/getItemById(" + RRFRowID + ")",
                            type: "POST",
                            contentType: "application/json;odata=verbose",
                            data: JSON.stringify(item),
                            async: false,
                            headers: {
                                "Accept": "application/json;odata=verbose",
                                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                                "X-HTTP-Method": "MERGE",
                                "If-Match": "*"
                            },
                            success: function (data) {
                                //insertProjectComment("", "1", "", "");
                                //alert('Resource Allocated Successfully');
                                // $('.popup-bg').hide();
                                $('.AlertclssPopupHead').text('Success');
                                document.getElementById('divMsgOnreject').style.display = 'none';
                                document.getElementById('divMsgOnApprove').style.display = 'none';
                                document.getElementById('divMsgAllocateResource').style.display = 'none';
                                document.getElementById('divMsgSaveValidateResource').style.display = "none";
                                document.getElementById('divMsgExternalAlloctaion').style.display = 'block';

                                $('.Alertpopup-bg').show();

                            },
                            error: function (error) {
                                alert(JSON.stringify(error));
                            }
                        });

                    }
                });
            }
        });
    }
    function InserdataProjectwiseResourceallocation(projectCode, projectName, resourceName, resourceID, startDate, endDate, resourceAllocation, ProjectLoaction, RMOSPOCname, projecManager, flagvalue, PrimarySkill, RRF_Number, futureAllocationFlag,Res_Roleband) {
        var ResourceAllUrl = ProjectWiseAllocation();
        var result = "";
        var ActiveFalg = 1;
        if (flagvalue == "Soft Block") {
            ActiveFalg = 0;
        }
        if (futureAllocationFlag == 2 || futureAllocationFlag == "2") {
            ActiveFalg = 2;
        }
        $.ajax({
            url: ResourceAllUrl,
            async: false,
            method: "POST",
            data: {
                "AllocatedProjectCode": projectCode,
                "ProjectName": projectName,
                "ResourceFullName": resourceName,
                "EmployeeID": resourceID,
                "BookingType": null,
                "Startdatetime": startDate,
                "Finishdatetime": endDate,
                "Allocation": resourceAllocation,
                "ProjectLocation": ProjectLoaction,
                "BillableStatus": null,
                "RMOSPOC": RMOSPOCname,
                "Reporting_Manager": projecManager,
                "Flag": flagvalue,
                "PrimarySkills": PrimarySkill,
                "Active": ActiveFalg,
                "RRFNO": RRF_Number,
                "RA_created_by": LoginUserEmail,
                "RA_Modify_By": LoginUserEmail,
				"AllocationRoleBand":Res_Roleband,
				"AllocationBaseLocation":ProjectLoaction
            },
            headers: {
                "Accept": "application/json;odata=verbose",
            },
            success: function (data) {
                result = "Inserted";
            },
            error: function (error) {
                result = "NotInserted";
                alert(JSON.stringify(error));
            }
        });
        return result;
    }
    function getformateDateForSave(date) {
        var newdate = date + "T00:00:00";
        return newdate;
    }

    function ValidatedData(RRFRowID) {
         var rrfvalue = "";
        $.ajax({
            url: "../_api/web/lists/getbytitle('RRF')/items?$filter=ID eq " + RRFRowID + "&$Top=1&$orderby=ID%20desc",
            type: "GET",
            async: false,
            headers: { "Accept": "application/json;odata=verbose" },
            success: function (data) {
                var RRFCount = data.d.results.length;
                if (RRFCount > 0) {
                    var dataset = data.d.results[0];

                    if (dataset.ProjectName == "" || dataset.ProjectName == null|| dataset.ProjectName == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.Entity == "" || dataset.Entity == null|| dataset.Entity == "null" || dataset.Entity == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.SubPractice == "" || dataset.SubPractice == null || dataset.SubPractice == "null" || dataset.SubPractice == "Select") {

                        rrfvalue = "false";
                    }
                    <!-- else if (dataset.Practice == "" || dataset.Practice == null || dataset.Practice == "null") { -->

                        <!-- rrfvalue = "false"; -->
                    <!-- } -->
                    else if (dataset.CostCenter == "" || dataset.CostCenter == null || dataset.CostCenter == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.GBU == "" || dataset.GBU == null || dataset.GBU == "null") {

                        rrfvalue = "false";
                    }
					else if (dataset.GBU == "" || dataset.GBU == null || dataset.GBU == "null") {

                        rrfvalue = "false";
                    }
					
                    <!-- else if (dataset.RequirementType == "" || dataset.RequirementType == null || dataset.RequirementType == "null" || dataset.RequirementType == "Select") { -->

                        <!-- rrfvalue = "false"; -->
                    <!-- } -->
					var value = dataset.ProjectGUID;
					var url = site_url + "_api/Projects?$select=ProjectName,ProjectId,ProjectCode,BenchProjects,ProjectOwnerId,CustomerName,GBU,FinanceTeam,ClientPartner,RMOSPOC,ProjectOwnerName,ProjectStartDate,ProjectFinishDate&$filter=ProjectId eq (guid'" + value + "')";
					var result = resultset(url);
					var BenchProjects = result[0].BenchProjects;
					
                    if((BenchProjects!=true) && (dataset.ClientRate == "" || dataset.ClientRate == null || dataset.ClientRate == "null") && (dataset.EmployeeRole=="Billable Consultant" || dataset.EmployeeRole=="Intern")) {

                        rrfvalue = "false";
                    }
                    else if (dataset.ClientRateCurrancy == "" || dataset.ClientRateCurrancy == null || dataset.ClientRateCurrancy == "null" || dataset.ClientRateCurrancy == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.EmployeeRole == "" || dataset.EmployeeRole == null || dataset.EmployeeRole == "null" || dataset.EmployeeRole == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.Designation == "" || dataset.Designation == null  || dataset.Designation == "null" || dataset.Designation == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.RoleBand == "" || dataset.RoleBand == null || dataset.RoleBand == "null" || dataset.RoleBand == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.EmployeeTypeId == "" || dataset.EmployeeTypeId == null || dataset.EmployeeTypeId == "null" || dataset.EmployeeTypeId == "Select") {
                        rrfvalue = "false";
                    }
                    else if (dataset.PostingTimeTypeId == "" || dataset.PostingTimeTypeId == null || dataset.PostingTimeTypeId == "null" || dataset.PostingTimeTypeId == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.StartDate == "" || dataset.StartDate == null || dataset.StartDate == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.EndDate == "" || dataset.EndDate == null || dataset.EndDate == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.WorkerType == "" || dataset.WorkerType == null || dataset.WorkerType == "Select" || dataset.WorkerType == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.PostingTimeTypeId == "" || dataset.PostingTimeTypeId == null || dataset.PostingTimeTypeId == "Select" || dataset.PostingTimeTypeId == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.RequirementPct == "" || dataset.RequirementPct == null || dataset.RequirementPct == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.PrimarySkill == "" || dataset.PrimarySkill == null || dataset.PrimarySkill == "null" || dataset.PrimarySkill == "Select") {

                        rrfvalue = "false";
                    }
                    else if ((dataset.ClientInterviewRequired == "" || dataset.ClientInterviewRequired == null  || dataset.ClientInterviewRequired == "null") && dataset.RequirementType != "G&A") {

                        rrfvalue = "false";
                    }                  
                    else if (dataset.MinRelevantExp == "" || dataset.MinRelevantExp == null || dataset.MinRelevantExp == "null" || dataset.MinRelevantExp == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.NatureofVacancy == "" || dataset.NatureofVacancy == null || dataset.NatureofVacancy == "null" || dataset.NatureofVacancy == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.SalaryRangeCurrancy == "" || dataset.SalaryRangeCurrancy == null || dataset.SalaryRangeCurrancy == "null" || dataset.SalaryRangeCurrancy == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.SalaryRangeMinAmt == "" || dataset.SalaryRangeMinAmt == null || dataset.SalaryRangeMinAmt == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.SalaryRangeMaxAmt == "" || dataset.SalaryRangeMaxAmt == null || dataset.SalaryRangeMaxAmt == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.WorkLocation == "" || dataset.WorkLocation == null || dataset.WorkLocation == "null") {

                        rrfvalue = "false";
                    }
                    else if (dataset.BaseLocation == "" || dataset.BaseLocation == null || dataset.BaseLocation == "null" || dataset.BaseLocation == "Select") {

                        rrfvalue = "false";
                    }
                    else if (dataset.ReportingToUserId == "" || dataset.ReportingToUserId == null || dataset.ReportingToUserId == "null" || dataset.ReportingToUserId == "Select" || dataset.ReportingToUserId == -1) {

                        rrfvalue = "false";
                    }
					else if(dataset.ProjectStatus=="Existing" && (dataset.ClientPartnerUserId == "" || dataset.ClientPartnerUserId == null || dataset.ClientPartnerUserId == "null" || dataset.ClientPartnerUserId == "Select" || dataset.ClientPartnerUserId == -1))
					{
						

						rrfvalue = "false";
						
					}
					else if (dataset.ProjectManagerUserId == "" || dataset.ProjectManagerUserId == null || dataset.ProjectManagerUserId == "null" || dataset.ProjectManagerUserId == "Select" || dataset.ProjectManagerUserId == -1) {

                        rrfvalue = "false";
                    }
					else if (dataset.RMOSPOCUserId == "" || dataset.RMOSPOCUserId == null || dataset.RMOSPOCUserId == "null" || dataset.RMOSPOCUserId == "Select" || dataset.RMOSPOCUserId == -1) {

                        rrfvalue = "false";
                    }
                    else if (dataset.DescriptionSummary == "" || dataset.WorkLocation == null || dataset.WorkLocation == "null" || dataset.JobDescriptionSummary==null || dataset.JobDescriptionSummary=="null") {

                        rrfvalue = "false";
                    }
					else if (dataset.NatureofVacancy != "New" && dataset.NatureofVacancy !="Proactive" && dataset.NatureofVacancy !="Campus") {

                        if(dataset.ReplacementFor=="Select" || dataset.ReplacementFor=="0" || dataset.ReplacementFor=="" || dataset.ReplacementFor==undefined || dataset.ReplacementFor==null)
						{
							rrfvalue = "false";
						}
                    }
					else if ((dataset.StartDate != "") && (dataset.Status=="RRF Saved" || dataset.Status=="Non Billable"))  
					{
						//if(StartDate_ConfirmationValue == 0)
						//{
							var rstart_date=dataset.StartDate;
							rstart_date=new Date(rstart_date);
							rstart_date=new Date(rstart_date.getFullYear(),rstart_date.getMonth() , rstart_date.getDate()+1);
							//Curr_Date=new Date(new Date().getFullYear(),new Date().getMonth() , new Date().getDate());
							rstart_date=Date.parse(rstart_date);
							var Curr_Date=new Date(new Date().getFullYear(),new Date().getMonth() , new Date().getDate());
							Curr_Date=Date.parse(Curr_Date);
							if(rstart_date < Curr_Date)
							{
								
								rrfvalue = "false";
							}
						//}
						
						//StartDate_ConfirmationValue=0;
                    }
					
					
                    //rrfvalue = "true";
                } else {

                    rrfvalue = "false";
                }
            },
            complete: function () {

            },
            error: function (jqXHR, textStatus, errorThrown) {

            }

        });
        return rrfvalue;
       
    }

    function getWithdrawnComment(rejId) {
        $("#withdrawnrejectdata").empty();
        $('.popup-bg-alert').show();
        $('#withdrawnrejectdata').show();
        $('.alertmessage').text('Withdrawn/Reject Comment');
        $('.alertmessage').show('');
        RRFRowID = rejId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[0];
        var RowProjectID = rejId.parentNode.parentNode.parentNode.parentNode.parentNode.id.split('#')[1];
        LogProjectGUID = RowProjectID;
        //var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=Comment,NewCreatedDate,Name,Flag&$filter=ProjectGUID eq '" + RowProjectID + "'and Flag eq '3' and RRFListItemId eq '" + RRFRowID + "'&$orderby=Created desc";
		var url = "../_api/web/lists/getbytitle('RRFTransactionDetails')/items?$Select=Comment,NewCreatedDate,Name,Flag&$filter=RRFListItemId eq '" + RRFRowID + "' and Flag eq '3'&$orderby=Created desc";
        getRMOTransactionDetails(url, RowProjectID, 'RejCommentlog');
    }
    function getRRFTATdaysbyStatus(status) {
        var status_TATMappingDays = "";
        var restResoruceAllocation = "../_api/web/lists/getbytitle('RRFTATMapping')/items?$select=Status,TATDays,Flag&$filter=Status eq'" + status + "'";
        $.ajax({
            url: restResoruceAllocation,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                status_TATMappingDays = data.d.results;

            }
        });
        return status_TATMappingDays;
    }

    $(window).load(function () {
        //$(".horizontalcontent-3").mCustomScrollbar({
        //    scrollButtons: {
        //        enable: true
        //    },
        //    horizontalScroll: true,
        //    theme: "dark-thick",
        //    autoExpandScrollbar: true,
        //    advanced: { autoExpandHorizontalScroll: true }
        //});
        $("th#sord-disable").off("click").removeClass("sorting");
    });
    function insertIntoSendEmailData(To, Cc, EventId, Flag, TrackingId) {
        var item = {
            __metadata: { "type": "SP.Data.BconeEmailDataListItem" }
        };

        $.extend(item, { To: To });

        $.extend(item, { Cc: Cc });

        $.extend(item, { EventId: EventId });
        $.extend(item, { Flag: Flag });
        $.extend(item, { TrackingId: TrackingId });

        $.ajax({
            url: "../_api/Web/Lists/GetByTitle('BconeEmailData')/items",
            type: "POST",
			async: false,
            contentType: "application/json;odata=verbose",
            data: JSON.stringify(item),
            headers: {
                "Accept": "application/json;odata=verbose",
                "X-RequestDigest": $("#__REQUESTDIGEST").val()
            },
            success: function (data) {
                //alert('success');
            },
            error: function (error) {
                //alert(JSON.stringify(error));
            }
        });
    }


    function formateRefinedProjectDate(date) {
        var resultdate = "";
        var newdate = new Date(date);
        //newdate.setDate(date.getDate());
        var tempDate_array = newdate.toDateString().split(' ');
        var monthName = getmonthNumber(tempDate_array[1]);
        resultdate = tempDate_array[3] + "-" + monthName.toString() + "-" + tempDate_array[2] + "T:00:00:00";
        return resultdate;
    }

    function getmonthNumber(monthName) {
        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
       'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        var monthvalue = months.indexOf(monthName);
        var monthTotalvalue = parseInt(monthvalue + 1);

        if (monthTotalvalue.toString().length == 1) {
            monthTotalvalue = "0" + monthTotalvalue;
            monthTotalvalue = monthTotalvalue;
        }
        else {
            monthTotalvalue;
        }

        return monthTotalvalue;
    }
    function Past15_Days() {
        var ToDay_Date = new Date();
        var Date_year = ToDay_Date.getFullYear();
        var Date_month = ToDay_Date.getMonth() + 1;
        var ToDay_Date_Format = Date_year + "-" + ("0" + Date_month).slice(-2) + "-" + ("0" + ToDay_Date.getDate()).slice(-2);
        var fiteenDays = new Date(ToDay_Date_Format);
        fiteenDays.setDate(fiteenDays.getDate() - 15);
        var Date_year1 = fiteenDays.getFullYear();
        var Date_month1 = fiteenDays.getMonth() + 1;
        var fiteenDays_Format = Date_year1 + "-" + ("0" + Date_month1).slice(-2) + "-" + ("0" + fiteenDays.getDate()).slice(-2);

        return fiteenDays_Format;

    }
	
	function resultset(Url) {
        var result;
        $.ajax({
            url: Url,
            async: false,
            method: "GET",
            headers: {
                "Accept": "application/json; odata=verbose",
                "Content-Type": "application/json; odata=verbose"
            },
            success: function (data) {
                result = data.d.results;
            },
            error: function (error) {
                result = 'error';
            }
        });
        return result;
    }
	
    function DeletefromRmoResourceAllocation(RRFNumID) {
        url = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items?$filter=RRFNumber eq'" + RRFNumID + "'";
        $.ajax({
            url: url,
            method: "GET",
            async: false,
            headers: { "Accept": "application/json; odata=verbose" },
            success: function (data) {
                // alert("done");
                var dataSet = data.d.results;
                if (dataSet.length > 0) {
                    var allocationRowID = dataSet[0].ID;
                    var Nurl = "../_api/web/lists/getbytitle('RMOResourceAllocation')/items('" + allocationRowID + "')";
                    $.ajax({
                        url: Nurl,
                        type: "DELETE",
                        async: false,
                        headers: {
                            Accept: "application/json;odata=verbose",
                            "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                            "IF-MATCH": "*"
                        },
                        success: function (data) {
                            //alert("Deleted");
                        },
                        error: function (error) {
                            if (JSON.stringify(error) == TimedOutPopuperror) {
                                alert("oops! something went wrong. please refresh the page and try again");
                                window.location.href = window.location.href;
                                return false;
                            }
                            else {
                                alert(JSON.stringify(error));
                            }
                        }
                    });
                }
            }
        });

    }
  $('#TxtAria_Comment').keypress(function (e) { 
		 var k = e.keyCode; 
		 if ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 46 || k == 44 || k == 32 || k == 13 || (k >= 48 && k <= 57)) { 

			 $('#errjobdescriptionmsg').css('display', 'none'); 
			  
			 document.getElementById("commentAlert").innerHTML = "";
			 return true; 

		 } else { 
			 $('#errjobdescriptionmsg').css('display', 'block'); 
			 document.getElementById("commentAlert").innerHTML = "";
			 e.preventDefault(); 
			 return false; 
		 } 


	 });
	  $('#Txt_Comment').keypress(function (e) { 
		 var k = e.keyCode; 
		 if ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 46 || k == 44 || k == 32 || k == 13 || (k >= 48 && k <= 57)) { 

			 $('#errjobdescriptionmsg2').css('display', 'none'); 
			 document.getElementById("commentAlert").innerHTML = "";
			 return true; 

		 } else { 
			 $('#errjobdescriptionmsg2').css('display', 'block'); 
			 document.getElementById("commentAlert").innerHTML = "";
			 e.preventDefault(); 
			 return false; 
		 } 


	 }); 
	 $('#TextareaResourceReject').keypress(function (e) { 
		 var k = e.keyCode; 
		 if ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 46 || k == 44 || k == 32 || k == 13 || (k >= 48 && k <= 57)) { 

			 $('#errjobdescriptionmsg1').css('display', 'none'); 
			 $('#ResourceRejecterrormsg').css('display', 'none');
			 document.getElementById("commentAlert").innerHTML = "";
			 return true; 

		 } else { 
			 $('#errjobdescriptionmsg1').css('display', 'block'); 
			 document.getElementById("commentAlert").innerHTML = "";
			 e.preventDefault(); 
			 return false; 
		 } 


	 }); 
	 
	 $('#TextareaResourceComment').keypress(function (e) { 
		 var k = e.keyCode; 
		 if ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 46 || k == 44 || k == 32 || k == 13 || (k >= 48 && k <= 57)) { 

			 $('#errjobdescriptionmsg5').css('display', 'none'); 
			 document.getElementById("commentAlert").innerHTML = "";
			 return true; 

		 } else { 
			 $('#errjobdescriptionmsg5').css('display', 'block'); 
			 document.getElementById("commentAlert").innerHTML = "";
			 e.preventDefault(); 
			 return false; 
		 } 


	 }); 

</script>
<html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><meta name="Robots" content="NOINDEX " /></head><body></body>
                <script type="text/javascript">
                 var gearPage = document.getElementById('GearPage');
                 if(null != gearPage)
                 {
                     gearPage.parentNode.removeChild(gearPage);
                     document.title = "Error";
                 }
                 </script>
                 </html>
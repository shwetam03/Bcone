<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Timesheet</title>
	<link rel="stylesheet" href="../SiteAssets/Timesheet/css/font-awesome.min.css"  />
	<link rel="stylesheet" href="../SiteAssets/Timesheet/css/stylesheet.css" />
	<link rel="stylesheet" type="text/css" href="../SiteAssets/Timesheet/css/jquery.dataTables.css">
	<link rel="stylesheet" href="../SiteAssets/Timesheet/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="../SiteAssets/Timesheet/css/jquery-ui.css"> 
	<link rel="stylesheet" href="../SiteAssets/Timesheet/css/sumoselect.css">
<style>
	#DeltaTopNavigation{	
    display: none;

}
	.table thead tr th {padding: 5px;background: #00b0f0;color: #fff;}	
	tr.otherstyle {background-color: #c4d0d7; color:#fbfbfb;}
	.SumoSelect {width:100% !important;}
	.SumoSelect > .CaptionCont{            border-radius: 0px;            border-color:#ccc !important;        }
	.SumoSelect > .optWrapper > .options  li.opt label{            font-weight: normal;        }
	.SumoSelect .select-all {            padding: 6px 0 4px 35px;            height: auto;        }
	.SumoSelect .select-all label{            font-weight: normal;        }
	.SumoSelect > .CaptionCont > span.placeholder{            font-style: normal;        }
	select[multiple], select[size]{height:30px !important}
	.optWrapper > .options li label { text-align: left !important}
	.CaptionCont > span { text-align: left !important}
	.errMsg { color: red; }
	.btn-group-sm>.btn, .btn-sm{padding: 2px 5px;font-size: 10px;line-height: 1.5;border-radius: 3px;}
	#reourceDivShowHideID{display: none;}
</style>

</head>
<body>
<div class="breadcrumb-main">
	<div class="container-fluid">
		<ul class="pull-left">
			<li>
				<a href="javascript:void(0)" onclick="URLTimesheetHome();" >Home</a>
			</li>
			<li>
				Timesheet Details
			</li>
			<li><span id="CurrentTabName"></span>
					</li>
		</ul>
	</div>
</div>
<div class="pull-left">
	<div style="margin: 15px;display: inline-block;">	
		<table>
		 
			<tr>
				<td style="display:inline-table;padding: 1px 6px 2px 6px;margin-bottom: -10px;">Week<sup style="color: #f00; font-size: 14px;">*</sup> <br>
					<select id="WeekID" class="Search_WeekIdData" multiple="multiple" placeholder="Select Week" style="width: 270px !important;margin-right: 10px;" >
					</select>
				</td>
				<td style="display:inline-table;padding: 1px 6px 2px 6px;margin-bottom: -10px;">Project Name<sup style="color: #f00; font-size: 14px;">*</sup>  <br>
					<select id="projName" class="search_periodNameDataId" multiple="multiple" placeholder="Select Project" style="width: 270px !important;margin-right: 10px;" >
					</select>
				</td>
				<td style="display:inline-table;padding: 1px 6px 2px 6px;margin-bottom: -10px;">Resource Name<sup style="color: #f00; font-size: 14px;">*</sup>  <br>
					<select id="ResName" class="search_ResName" multiple="multiple" placeholder="Select Resource" style="width: 270px !important;margin-right: 10px;" >
					</select>
				</td>
				
			
				<td><br><a href="javascript:void(0)" class="blue-btn" style="margin-left:12px;" id="GoId" onclick="show();" ><i class=""></i>SHOW</a></td>
				<td><br><a href="javascript:void(0)" class="blue-btn" style="margin-left:12px;" id="clr" onclick="clrs();" ><i class=""></i>CLEAR</a>  <span class="errMsg"></span></td>
			</tr>
		</table>
	</div>	
</div>

<div class="container-fluid">
	
</div>
<hr style="margin-top: 16px;margin-bottom: 5px;border: 0;border-top: 1px solid #eee;">
<div class="container-fluid" id="reourceDivShowHideID">
		<div class="mid-block">		
			<div class="mid-top" style="margin-bottom:2px; ">
				
				<div style="margin: 15px 0px 5px 0px;">
					<ul class="top-btns" style="float:left">
						<li>
							<a href="javascript:void(0)" onclick="openAdminUpdatePopup()" id="clickTest">
								<i class="fa fa-rotate-left"></i> RESET - TS STATUS
							</a>
						</li>
						<span id="SelectedItemCount">0</span> item selected
					</ul>
						<ul class="top-btns" style="float:right;margin-right:8px;">
					        <li>
                               <a href="javascript:void(0)" id="btnAllPeriods" onclick="filterData('btnAllPeriods')" > 
							   <i class="fa fa-flag-o"></i> All Records
								<span class="highlight_no">0</span>
								</a>
                            </li>
                            <li>
                                <a href="javascript:void(0)" id="btnOpenPeriods" onclick="filterData('btnOpenPeriods')">
								<i class="fa fa-folder-o"></i> Open
                                    	<span class="highlight_no">0</span>
                                </a>
                            </li>
                    
                            <li>
                                <a href="javascript:void(0)" id="btnSubmitPeriods" onclick="filterData('btnSubmitPeriods')">
								<i class="fa fa-send"></i> Submitted
                                    	<span class="highlight_no">0</span>
                                </a>
                            </li>
                            <li>
                                <a href="javascript:void(0)" id="btnAppovedCount" onclick="filterData('btnAppovedCount')">
								<i class="fa fa-check"></i> Approved
                                    	<span class="highlight_no">0</span>
                                </a>
                            </li>
                            <li>
                                <a href="javascript:void(0)" id="btnRejectCount" onclick="filterData('btnRejectCount')">
								<i class="fa fa-ban"></i> Rejected
                                    	<span class="highlight_no">0</span>
                                </a>
                            </li>
                        </ul>
				</div>
				
						
			</div>	
		</div>
	</div>


<div class="container-fluid" id="tblResNameDiv" >

	<div class="" id="jqxgrid_containertblResName">
	
		<table id="tblResName" class="display example table table-bordered table-new" cellspacing="0">
		</table>
	</div> 
</div>
<div class="black-bg alert-main" style="display:none;" id="OKPopup">
	<div class="popup-main">
		<div class="popup-heading"><span id="okPopupMsg"></span></div>			
		<div class="pop-mid">
			<input type="hidden" id="isPagerefresh" ></span>
			<input type="Button" class="divnewbtn" onclick="okPopupOnOkButton('#OKPopup')" value="OK" />    
		</div>			
	</div>
</div>
	<!-- Log Pop up -->
<div class="allcommentdiv" >
	<div class="allcommentdiv-heading" style="background: rgb(51,122,183);">
		Log
	</div>
	<div class="allcommentdiv-mid">
		<h3><span id="LogId"></span></h3>
		<div class="vertical-scoll">
			<table class="table table-bordered">
				<thead>
					<tr>
						<th style="width: 150px;background: #00b0f0 !important;">Date</th>
						<th style="width: 100px;background: #00b0f0 !important;">Actor</th> 
						<th style="width: 80px;background: #00b0f0 !important;">Action</th>
						<th style="background: #00b0f0 !important;">Note</th>
					</tr>
				</thead>
				<tbody id="bindlog">
				</tbody>
			</table>
		</div>
	</div>
	<div class="allcommentdiv-foot">
		<a href="javascript:void(0)" class="blue-btn" onclick="closeallcomment()">got it</a>
	</div>
</div>
<div class="black-bg alert-main" id="yesNoPopup" style="display:none;">
	<div class="popup-main">
		<div class="popup-heading" style="margin-bottom: 15px;"><span id="yesNoPopupMsg"></span></div>
		<div class="pop-mid">
			<input type="Button" class="divnewbtn" id="btnYes" value="YES"  /> 
			<input type="Button" class="divnewbtn" id="btnNo" onclick="okPopupOnOkButton('#yesNoPopup')"  value="NO" />					
		</div>
	</div>
</div>

<div id="alertmain" class="alert-main" style="display: none">
	<div class="black-bg" id="backcolor">
		<div class="popup-main">
			<div class="popup-heading"><span id="Alert_msg">Saved successfully</span></div>
			<div class="pop-mid">
				<p id="submitValue"></p>
				<input type='Button' class="divnewbtn" value="OK" id="ok_click1" onclick="close_div('')" />
			</div>
		</div>
	</div>
</div>
 <span id="loading-image"></span> 
 <span class="loader"></span>
	<!-- Log Pop up -->
<script src="../SiteAssets/Timesheet/js/jquery.min.js"></script>
<script src="../SiteAssets/Timesheet/js/jquery-ui.js"></script>
<script src="../SiteAssets/Timesheet/js/bootstrap.min.js"></script>
<script type="text/javascript" language="javascript" src="../SiteAssets/Timesheet/js/jquery.dataTables.js"></script>
<script src="../SiteAssets/Timesheet/js/Config.js"></script>
<script type="text/javascript" src="../SiteAssets/Timesheet/js/jquery.sumoselect.min.js"></script>
<script type="text/javascript" src="../SiteAssets/BconeExpenseJs/jquery.sumoselect.js"></script>
<script type="text/javascript">
	$.widget.bridge('uitooltip', $.ui.tooltip);
	$.widget.bridge('uibutton', $.ui.button);
</script>
<script>
$(document).ready(function()
{
	disableRightClick();
	setInterval(function()
	{ 
		$("[data-toggle='tooltip']").tooltip(); 
		$('[data-toggle="tooltip"]').tooltip(); 
	}, 100);
});
var ColumnsData;
$(document).ready(function()
{
	GetCurrentUserGUID("1");
	var resid =GetCurrentUserGUID("1");
	var username = sessionStorage.getItem("CurrentUsername");
	if(username  == "" || username == undefined)
	{
		$("#login_name_contain").text("");
	}
	else
	{
		$("#login_name_contain").text(username);
	}
//	$("#reourceDivShowHideID").hide();
	document.getElementById("projName").disabled = true;
	document.getElementById("ResName").disabled = true;
	
	getALLPerdiosData();
      
});
function checkall() //select all and un select all
{
	if ($('#select_all').is(':checked'))
	{
		$("input[id^=timid]").prop('checked', true);
	}
	else
	{
		$("input[id^=timid]").prop('checked', false);
	}
	onchildcheck();
}
function unchecksingle(object) 
{
	if ($(object).is(':checked'))
	{
		var CheckBoxCount=$("input[id^=timid]").length;
		var CheckCount=0;
		$("input[id^=timid]").each ( function()
		{
			if($(this).is(':checked'))
			{
				CheckCount=CheckCount+1;
			}
			
		});
		if(CheckBoxCount==CheckCount)
		{
			$("#select_all").prop('checked', true);
		}
	}
	else
	{
		$("#select_all").prop('checked', false);
	}
	onchildcheck();
}
var count = 0;
var table ="";
function onchildcheck()
{
	var childCheckboxes = $('#tblResName tbody tr td').find('input[type=checkbox]');
	var  no_checked1 = childCheckboxes.filter(':checked').length;
	var no_checked=0;
	var source = $("#tblResName").DataTable();           
	$("input[type=checkbox]", source.rows().nodes()).each(function ()
	{
		var tuisre = $(this).is(":checked");
		if (tuisre)
		{
			no_checked++;
		}
	});
	if(no_checked>0)
	{
		$('#SelectedItemCount').text(no_checked);
	}
	else
	{
		$('#SelectedItemCount').text(no_checked);
	}
	if(childCheckboxes.length == no_checked1)
	{ 
		$("#select_all").prop('checked',true);
	}
	else
	{
		$("#select_all").prop('checked',false);
	}
}
function show()
{
	temp_count=0;
	var DDLselValue="";
	DDLselValue = $('#ResName option:selected').val();
	var DDLselValueWeek = $('#WeekID option:selected').val();
	var DDLselValueProject = $('#projName option:selected').val();
	if(DDLselValueWeek=="Select_Employee"  || DDLselValueWeek==undefined)
	{
		$('#reourceDivShowHideID').hide();
		$('#tblResNameDiv').hide();
		$('.errMsg').text("");
		$('.errMsg').text("Select Week");
		$('.errMsg').show();
		return false;
	}
	else if(DDLselValueProject=="Select_Employee"|| DDLselValueProject==undefined)
	{
		$('#reourceDivShowHideID').hide();
		$('#tblResNameDiv').hide();
		$('.errMsg').text("");
		$('.errMsg').text("Select Project");
		$('.errMsg').show();
		return false;
	}
	else if(DDLselValue=="Select_Resource"|| DDLselValue==undefined)
	{
		$('#reourceDivShowHideID').hide();
		$('#tblResNameDiv').hide();
		$('.errMsg').text("");
		$('.errMsg').text("Select Resource");
		$('.errMsg').show();
		return false;
	}
	else
	{
		//ClearBackGroundColour();
		$('.errMsg').text("");
		$('.errMsg').hide();
		$('#reourceDivShowHideID').show();
		$('#tblResNameDiv').show();
		GetPeriodMasterData();
	}
}
function clrs()
{
	//ClearBackGroundColour();
	$('.errMsg').text("");
	$('.search_ResName ').css({"border": "","background": ""});
	temp_count=0;
	$('#tblResNameDiv').hide();
	$("#WeekID").prop("selectedIndex",-1); //unselect check box  
	$('#WeekID')[0].sumo.reload();
	document.getElementById("projName").disabled = true;
	document.getElementById("ResName").disabled = true;
	$("#projName").prop("selectedIndex",-1); //unselect check box  
	$('#projName')[0].sumo.reload();
	$("#ResName").prop("selectedIndex",-1); //unselect check box  
	$('#ResName')[0].sumo.reload();	
	$('#reourceDivShowHideID').hide();
	$("#CurrentTabName").text("");
	$("#btnAllPeriods span").text("0");
	$("#btnOpenPeriods span").text("0");
	$("#btnSubmitPeriods span").text("0");
	$("#btnAppovedCount span").text("0");
	$("#btnRejectCount span").text("0");
	cleardata();
}

function getALLPerdiosData()
{
	$(".loader").show();
	$.ajax
	({
		url:"https://ppmprod.bcone.com/api/Timesheet/Admin_GetPeriods",
		method:"POST",
		headers: { "Accept": "application/json; odata=verbose" },
		dataType: 'json',
		success:function(data)
		{
			if(data.Periods.length ==0)
			{
				//$(".loader").hide();
			}
			else
			{
				if($("#WeekID").hasClass("SumoUnder")){$("#WeekID").html('');$("#WeekID")[0].sumo.unload();}
				for(var j=0;j<data.Periods.length;j++)
				{ 
					$("#WeekID").append("<option value="+data.Periods[j].PeriodId+" >"+new Date(data.Periods[j].StartDate).format('dd-MMM-yy')+" - "+new Date(data.Periods[j].EndDate).format('dd-MMM-yy')+"</option>");
				}
				$('.Search_WeekIdData').SumoSelect({search: true, searchText: 'Search Week',selectAll: true});	
				$("#WeekID ").prop("selectedIndex",-1); //unselect check box
				$('#WeekID ')[0].sumo.reload(); 
			}
			$(".loader").hide();
		},
		error:function()
		{
			$('.loader').hide();
			openOKpopup(popUpMessage.ServerError,"false");
		}	
	});	
}

document.getElementById("WeekID").onchange = function() 
{ 
	var SelectedPeriods = [];
	$('#WeekID option:selected').each(function(i) 
	{
		SelectedPeriods.push("'" +$(this).val()+ "'");
	});
	if(SelectedPeriods.length==0)
	{
		$("#projName").prop("selectedIndex",-1); //unselect check box  
		$('#projName')[0].sumo.reload();
		document.getElementById("projName").disabled = true;
		$("#ResName").prop("selectedIndex",-1); //unselect check box  
		$('#ResName')[0].sumo.reload();
		document.getElementById("ResName").disabled = true;
	}
	else
	{
		document.getElementById("projName").disabled = false;
		getALLProjectsData();
		$("#ResName").prop("selectedIndex",-1); //unselect check box  
		//$('#ResName')[0].sumo.reload();
	}
};
function getALLProjectsData()
{
	//$(".loader").show();
	var SelectedPeriods = [];
	$('#WeekID option:selected').each(function(i) 
	{
		SelectedPeriods.push("'" +$(this).val()+ "'");
	});
	var SelectedPeriodsDa = SelectedPeriods.join();
	var Periodsel = SelectedPeriodsDa;
	var Periodselected = Periodsel;
	var requestProjectData = {"Periods": Periodselected};
	//console.log(JSON.stringify(requestProjectData));
	$.ajax
	({
		url:"https://ppmprod.bcone.com/api/Timesheet/Admin_GetProjects_ByPeriod",
		method:"POST",
		headers: { "Accept": "application/json; odata=verbose" },
		dataType: 'json',
		data:requestProjectData,
		success:function(data)
		{
			if(data.Projects.length ==0)
			{
				//$(".loader").hide();
			}
			else
			{
				//remove old appened data
				if($("#projName").hasClass("SumoUnder")){$("#projName").html('');$("#projName")[0].sumo.unload();}
				//$("#projName").append("<option value='Select_Employee' index=0>Select Project</option>");
				for(var i=0;i<data.Projects.length;i++)
				{ 
					$("#projName").append("<option value="+data.Projects[i].PROJ_UID+" >"+data.Projects[i].PROJECT_NAME+"</option>");
				}
				$('.search_periodNameDataId').SumoSelect({search: true, searchText: 'Search Project',selectAll: true});	
			//	$("#projName ")[0].sumo.selectItem($("#projName   option[value='Select_Employee']").index());  
				$("#projName ").prop("selectedIndex",-1); //unselect check box
				$('#projName ')[0].sumo.reload(); 
			}
			//$(".loader").hide();
		},
		error:function()
		{
			
			$('.loader').hide();
			openOKpopup(popUpMessage.ServerError,"false");
		}	
	});	
}
document.getElementById("projName").onchange = function() 
{ 
	var SelectedProj = [];
		$('#projName option:selected').each(function(i) 
		{
			SelectedProj.push("'" +$(this).val()+ "'");
		});
	if(SelectedProj.length==0)
	{
		$("#ResName").prop("selectedIndex",-1); //unselect check box  
		$('#ResName')[0].sumo.reload();
		document.getElementById("ResName").disabled = true;
	}
	else
	{
		document.getElementById("ResName").disabled = false;
		getALLResData();
	}
};
function getALLResData()
{
	var SelectedPeriods = [];
	$('#WeekID option:selected').each(function(i) 
	{
		SelectedPeriods.push("'" +$(this).val()+ "'");
	});
	var SelectedPeriodsDa = SelectedPeriods.join();
	var Periodsel = SelectedPeriodsDa;
	var Periodselected = Periodsel;
	
	var SelectedProjetcs = [];
	$('#projName option:selected').each(function(i) 
	{
		SelectedProjetcs.push("'" +$(this).val()+ "'");
	});
	var SelectedProjectDa = SelectedProjetcs.join();
	var Projectselected = SelectedProjectDa;
	
	var requestData = {"Periods": Periodselected,
						"Projects":Projectselected};
	//console.log(JSON.stringify(requestData));
	$.ajax
	({
		url:"https://ppmprod.bcone.com/api/Timesheet/Admin_GetResources_ByPeriodandProject",
		method:"POST",
		headers: { "Accept": "application/json; odata=verbose" },
		dataType: 'json',
		data:requestData,
		success:function(data)
		{
			if(data.Resources.length > 0)
			{
				//remove old appened data
				if($("#ResName").hasClass("SumoUnder")){$("#ResName").html('');$("#ResName")[0].sumo.unload();}
				//$("#ResName").append("<option value='Select_Resource' index=0>Select Project</option>");
				for(var i=0;i<data.Resources.length;i++)
				{ 
					$("#ResName").append("<option value="+data.Resources[i].Res_uid+" >"+data.Resources[i].ResourceName+"</option>");
				}
				$('.search_ResName').SumoSelect({search: true, searchText: 'Search Resource',selectAll: true});	
				//$("#ResName")[0].sumo.selectItem($("#ResName option[value='Select_Employee']").index());  
				$("#ResName").prop("selectedIndex",-1); //unselect check box
				$('#ResName')[0].sumo.reload(); 
			}
			
		},
		error:function()
		{
			$('.loader').hide();
			openOKpopup(popUpMessage.ServerError,"false");
		}	
	});	
}
var ColumnsData="";
function GetPeriodMasterData()
{	
	$(".loader").show();
	$("#CurrentTabName").text("");
	monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
	cleardata(); 	
	var SelectedPeriods = [];
	$('#WeekID option:selected').each(function(i){ SelectedPeriods.push("'" +$(this).val()+ "'");});
	var SelectedPeriodsDa = SelectedPeriods.join();
	var Periodsel = SelectedPeriodsDa;
	var Periodselected = Periodsel;
	
	var SelectedProjetcs = [];
	$('#projName option:selected').each(function(i) { SelectedProjetcs.push("'" +$(this).val()+ "'"); });
	var SelectedProjectDa = SelectedProjetcs.join();
	var Projectselected = SelectedProjectDa;
	
	var SelectedResource = [];
	$('#ResName option:selected').each(function(i) { SelectedResource.push("'" +$(this).val()+ "'"); });
	var SelectedResDa = SelectedResource.join();
	var ResSelected = SelectedResDa;
	
	var requestALLData = {"Periods": Periodselected, "Projects":Projectselected,"Resources":ResSelected};
	//console.log(JSON.stringify(requestALLData));
	$.ajax
	({
		url: "https://ppmprod.bcone.com/api/Timesheet/Admin_GetTimesheets_ByPeriod_and_Project",
		method: "POST",
		headers: { "Accept": "application/json; odata=verbose" },
		data:requestALLData,
	    success: function (data)
		{	
			ColumnsData=data;
			$("#btnAllPeriods span").text("0");
			$("#btnOpenPeriods span").text("0");
			$("#btnSubmitPeriods span").text("0");
			$("#btnAppovedCount span").text("0");
			$("#btnRejectCount span").text("0");
			filterData('btnAllPeriods');
		},
		error: function (data)
		{
			$('.loader').hide();
			openOKpopup(popUpMessage.ServerError,"false");
		}
	});
}

function filterData(getDataID)
{
	cleardata(); 
	DisplayColumn(getDataID,ColumnsData);
}

function DisplayColumn(getDataID,ColumnsData)
{
	//$(".loader").show();
	var data = ColumnsData;
	if(getDataID=="btnAllPeriods")
	{
		$('#SelectedItemCount').text(0);
		$("#btnAllPeriods").parent("li").addClass("green-btn");
		$("#btnOpenPeriods").parent("li").removeClass("green-btn");
		$("#btnSubmitPeriods").parent("li").removeClass("green-btn");
		$("#btnAppovedCount").parent("li").removeClass("green-btn");
		$("#btnRejectCount").parent("li").removeClass("green-btn");
		$("#CurrentTabName").text("All Records");
		var	table_header="<thead><tr>";
		table_header=table_header +"<th data-orderable='false' style='width: 50px !important; text-align:center;' id='checkRem'><input type='checkbox' id='select_all'  onclick='checkall();' /></th>";
		table_header=table_header +"<th style='width:50px !important;'>S.No</th>";
		table_header=table_header +"<th style='width:150px !important;'>Resource Name</th> ";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th style='width:130px !important;'>Timesheet Period <br> Status</th>";
		table_header=table_header +"<th style='width:95px !important;'>Timesheet <br> Status</th>";
		table_header=table_header +"<th data-orderable='false' id='remLog' style='width:50px !important;'>Log</th>";
		table_header=table_header +"</tr></thead>";
		//footer menu	
		table_header=table_header +"<tfoot><tr>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"<th>S.No</th>";
		table_header=table_header +"<th>Resource Name</th>";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th>Timesheet Period Status</th>";
		table_header=table_header +"<th>Timesheet Status</th>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"</tr></tfoot>";

		table_element="";	
		table_body="<tbody>"; 
		
		if(data.Data.length == 0)
		{
		}
		else
		{
			var openCnt=0;
			var SubmitCnt=0;
			var ApprovedCnt=0;
			var rejectCnt=0;
			var status = "";
			for (var i = 0; i < data.Projects.length; i++) 
			{			
				var slNo = i+1;
				var commment = data.Projects[i].Comment;
				var OpenStatus =data.Projects[i].Open;
				if (OpenStatus == 1) { OpenStatusText = "TS Period Open"; }
				else { OpenStatusText = "TS Period Close"; }
				var AppFlagStaus = data.Projects[i].ApprovalFlag;
				table_body +="<tr>";				
				table_body +="<td style='text-align:center;'><input style='display:inline-block;' class='checkbox' type='checkbox' name='check[]' id='timid"+i+"' value="+data.Projects[i].TimesheetUID+" onclick='unchecksingle(this)' />"; //<input type='hidden' id='commen"+i+"' value="+commment+" />
				table_body +="<input type='hidden' id='projec"+i+"' value="+data.Projects[i].ProjectUID+" /><input type='hidden' id='periodsid"+i+"' value="+data.Projects[i].PeriodId+" /><input type='hidden' id='resourcid"+i+"' value="+data.Projects[i].ResourceId+" /><input type='hidden' id='openActives"+i+"' value="+OpenStatus+" /></td>";
				table_body +="<td >"+slNo+"</td>";
				var PendingForApproval ="";
				if(AppFlagStaus == 1)
				{
				
					//var PendingForApproval="";
					var PendingForApprovalUID="";
					for(var t=0;t<data.Projects[i].Approvers_Comments.length;t++)
					{
						var pebdingLevelSts = data.Projects[i].Approvers_Comments[t].ApproverStatus;
						if(pebdingLevelSts=="1")
						{
							var finalPendingWith = data.Projects[i].Approvers_Comments[t].Approver_Name;
							//	PendingForApprovalUID = data.Projects[i].Approvers_Comments[t].ApproverUID;
						}
					}
					AppFlagStausTxt = "Submitted";
					//PendingForApproval = data.Projects[i].Approvers_Comments[0].Approver_Name;
					PendingForApproval = finalPendingWith;
					SubmitCnt++;
					table_body += "<td><a href='ResourceWiseTimesheetDetails.aspx?PeriodUID="+data.Projects[i].PeriodId+"&StartDate="+data.Projects[i].StartDate+"&EndDate="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&RES_UID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td>"+data.Projects[i].PeriodName+"</td>";
				}
				else if (AppFlagStaus == 0)
				{
					AppFlagStausTxt = "Open";
					PendingForApproval ="";
					openCnt++;
					//table_body+="<td><a href='TimesheetEntryPageAdmin.aspx?PeriodUID="+data.Projects[i].PeriodId+"&Start="+data.Projects[i].StartDate+"&End="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&ProjectUID="+data.Projects[i].ProjectUID+"&ResourceUID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td><a href='TimesheetEntryPageAdmin.aspx?PeriodUID="+data.Projects[i].PeriodId+"&Start="+data.Projects[i].StartDate+"&End="+data.Projects[i].EndDate+"&TimesheetUID=&ProjectUID=&ResourceUID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td><a href='TimesheetEntryPageAdmin.aspx?PeriodUID="+data.Projects[i].PeriodId+"&Start="+data.Projects[i].StartDate+"&End="+data.Projects[i].EndDate+"&TimesheetUID=&ProjectUID=&ResourceUID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].PeriodName+"</a></td>";
				}
				else if(AppFlagStaus == 2)
				{
					AppFlagStausTxt = "Approved";
					PendingForApproval ="";
					ApprovedCnt++;
					table_body += "<td><a href='ResourceWiseTimesheetDetails.aspx?PeriodUID="+data.Projects[i].PeriodId+"&StartDate="+data.Projects[i].StartDate+"&EndDate="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&RES_UID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td>"+data.Projects[i].PeriodName+"</td>";
				}
				else if(AppFlagStaus == 3)
				{
					AppFlagStausTxt = "Rejected";
					PendingForApproval ="";
					rejectCnt++;
					table_body += "<td><a href='ResourceWiseTimesheetDetails.aspx?PeriodUID="+data.Projects[i].PeriodId+"&StartDate="+data.Projects[i].StartDate+"&EndDate="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&RES_UID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td>"+data.Projects[i].PeriodName+"</td>";
				}
				table_body+="<td>"+data.Projects[i].ProjectName+"</td>";
				table_body+="<td>"+data.Projects[i].ProjectOwnerName+"</td>";
				table_body += "<td>"+ OpenStatusText+"</td>";
				table_body+="<td>"+AppFlagStausTxt+ "</td>";
				table_body += '<td class="clsLog"><input type="hidden" class="ts_name" value=\''+data.Projects[i].ProjectName+'\' ><i onclick="openTSLog(\''+data.Projects[i].TimesheetUID+'\',this)" style="cursor: pointer;color: rgb(6, 94, 160);" class="fa fa-exclamation-circle"></i></td>'; 
				table_body += "</tr>";
				$("#btnAllPeriods span").text(data.Projects.length);
				$("#btnOpenPeriods span").text(openCnt);
				$("#btnSubmitPeriods span").text(SubmitCnt);
				$("#btnAppovedCount span").text(ApprovedCnt);
				$("#btnRejectCount span").text(rejectCnt);
			}
		}
		table_body=table_body+"/<tbody>";
		table_element=table_header+table_body;
		$('#tblResName').html(table_element);
		bind_dataTabletblResName();
		$('.loader').hide();
		$("#checkRem").removeClass("sorting");
		$('#remLog').removeClass("sorting");
	}
	else if(getDataID=="btnOpenPeriods")
	{
		//$(".loader").show();
		$("#CurrentTabName").text("Open");
		$('#SelectedItemCount').text(0);
		$("#btnAllPeriods").parent("li").removeClass("green-btn");
		$("#btnOpenPeriods").parent("li").addClass("green-btn");
		$("#btnSubmitPeriods").parent("li").removeClass("green-btn");
		$("#btnAppovedCount").parent("li").removeClass("green-btn");
		$("#btnRejectCount").parent("li").removeClass("green-btn");
		var	table_header="<thead><tr>";
		table_header=table_header +"<th data-orderable='false' style='width: 50px !important; text-align:center;' id='checkRem'><input type='checkbox' id='select_all'  onclick='checkall();' /></th>";
		table_header=table_header +"<th style='width:50px !important;'>S.No</th>";
		table_header=table_header +"<th style:'width: 10%;'>Resource Name</th> ";
		table_header=table_header +"<th style:'width: 20%;'>Timesheet Name</th>";
		table_header=table_header +"<th style:'width: 15%;'>Project Name</th>";
		table_header=table_header +"<th style:'width: 15%;'>Project Manager</th>";
		table_header=table_header +"<th style:'width: 10%;'>Timesheet Created Date </th>";
		table_header=table_header +"<th style:'width: 10%;'>Timesheet  Status</th>";
		table_header=table_header +"<th data-orderable='false' id='remLog' style='width:50px !important;'>Log</th>";
		table_header=table_header +"</tr></thead>";
		//footer menu	
		table_header=table_header +"<tfoot><tr>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"<th>S.No</th>";
		table_header=table_header +"<th>Resource Name</th>";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th>Timesheet Created Date</th>";
		table_header=table_header +"<th>Timesheet Status</th>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"</tr></tfoot>";
		table_element="";	
		table_body="<tbody>"; 	
		if(data.Projects.length == 0)
		{
		}
		else
		{
			var status = "";
			$("#btnAllPeriods span").text(data.Projects.length);
			for (var i = 0; i < data.Projects.length; i++) 
			{		
				var slNo=i+1;
				var CREATED_Dte = new Date(data.Projects[i].CREATED_DATE)
				if(CREATED_Dte=="Invalid Date")
				{
					var Credate ="";
				}
				else
				{
					var Credate = ("0" + CREATED_Dte.getDate()).slice(-2)+  "-" + monthNames[CREATED_Dte.getMonth()] +"-" + CREATED_Dte.getFullYear();
				}
				var commment = data.Projects[i].Comment;
				var OpenStatus =data.Projects[i].Open;
				if (OpenStatus == 1)
				{
					OpenStatusText = "TS Period Open";
				}
				else
				{
					OpenStatusText = "TS Period Close";
				}
				var AppFlagStaus = data.Projects[i].ApprovalFlag;
				if (AppFlagStaus == 0 || AppFlagStaus == "")
				{
					AppFlagStausTxt = "Open";
					PendingForApproval ="";
					table_body += "<tr>";				
					table_body+="<td style='text-align:center;'><input style='display:inline-block;' class='checkbox' type='checkbox' name='check[]' id='timid"+i+"' value="+data.Projects[i].TimesheetUID+" onclick='unchecksingle(this)' />"; //<input type='hidden' id='commen"+i+"' value="+commment+" />
					table_body += "<input type='hidden' id='projec"+i+"' value="+data.Projects[i].ProjectUID+" /><input type='hidden' id='periodsid"+i+"' value="+data.Projects[i].PeriodId+" /><input type='hidden' id='resourcid"+i+"' value="+data.Projects[i].ResourceId+" /><input type='hidden' id='openActives"+i+"' value="+OpenStatus+" /></td>";
					table_body += "<td>"+slNo+"</td>";	
					//table_body+="<td><a href='TimesheetEntryPageAdmin.aspx?PeriodUID="+data.Projects[i].PeriodId+"&StartDate="+data.Projects[i].StartDate+"&EndDate="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&ProjectUID="+data.Projects[i].ProjectUID+"&ResourceUID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td><a href='TimesheetEntryPageAdmin.aspx?PeriodUID="+data.Projects[i].PeriodId+"&Start="+data.Projects[i].StartDate+"&End="+data.Projects[i].EndDate+"&TimesheetUID=&ProjectUID=&ResourceUID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td><a href='TimesheetEntryPageAdmin.aspx?PeriodUID="+data.Projects[i].PeriodId+"&Start="+data.Projects[i].StartDate+"&End="+data.Projects[i].EndDate+"&TimesheetUID=&ProjectUID=&ResourceUID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].PeriodName+"</a></td>";
					table_body+="<td>"+data.Projects[i].ProjectName+"</td>";
					table_body+="<td>"+data.Projects[i].ProjectOwnerName+"</td>";
					table_body += "<td>"+Credate+"</td>";
					table_body+="<td>"+AppFlagStausTxt+ "</td>";
					table_body += '<td class="clsLog"><input type="hidden" class="ts_name" value=\''+data.Projects[i].ProjectName+'\' ><i onclick="openTSLog(\''+data.Projects[i].TimesheetUID+'\',this)" style="cursor: pointer;color: rgb(6, 94, 160);" class="fa fa-exclamation-circle"></i></td>'; 
					table_body += "</tr>";	
				}
			}
		}
		 table_body=table_body+"/<tbody>";
		 table_element=table_header+table_body;
		 $('#tblResName').html(table_element);
		bind_dataTabletblResName();
		$('.loader').hide();
		$("#checkRem").removeClass("sorting");
		$('#remLog').removeClass("sorting");
	}
	else if(getDataID=="btnSubmitPeriods")
	{	
		//$(".loader").show();
		$("#CurrentTabName").text("Submitted");
		$('#SelectedItemCount').text(0);
		$("#btnAllPeriods").parent("li").removeClass("green-btn");
		$("#btnOpenPeriods").parent("li").removeClass("green-btn");
		$("#btnSubmitPeriods").parent("li").addClass("green-btn");
		$("#btnAppovedCount").parent("li").removeClass("green-btn");
		$("#btnRejectCount").parent("li").removeClass("green-btn");
		var	table_header="<thead><tr>";
		table_header=table_header +"<th data-orderable='false' style='width: 50px !important; text-align:center;' id='checkRem'><input type='checkbox' id='select_all'  onclick='checkall();' /></th>";
		table_header=table_header +"<th style='width:50px !important;'>S.No</th>";
		table_header=table_header +"<th style='width:150px !important;'>Resource Name</th> ";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th style='width:120px !important;'>Timesheet <br> Status</th>";
		table_header=table_header +"<th>Submitted Date</th>";
		table_header=table_header +"<th style='width:120px !important;'>Pending <br> With</th>";
		table_header=table_header +"<th data-orderable='false' id='remLog' style='width:50px !important;'>Log</th>";
		table_header=table_header +"</tr></thead>";
		//footer menu	
		table_header=table_header +"<tfoot><tr>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"<th>S.No</th>";
		table_header=table_header +"<th>Resource Name</th>";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th>Timesheet Status</th>";
		table_header=table_header +"<th>Submitted Date</th>";
		table_header=table_header +"<th>Pending with</th>"; 
		table_header=table_header +"<th></th>";
		table_header=table_header +"</tr></tfoot>";
		table_element="";	
		table_body="<tbody>"; 	
		if(data.Projects.length == 0)
		{
			
		}
		else
		{
			var status = "";
			$("#btnAllPeriods span").text(data.Projects.length);
			for (var i = 0; i < data.Projects.length; i++) 
			{	
				var slNo = i+1;
				var commment = data.Projects[i].Comment;
				var OpenStatus =data.Projects[i].Open;
				if (OpenStatus == 1)
				{
					OpenStatusText = "TS Period Open";
				}
				else
				{
					OpenStatusText = "TS Period Close";
				}
				var AppFlagStaus = data.Projects[i].ApprovalFlag;
				if(AppFlagStaus == "1")
				{
					var PendingForApproval="";
					var PendingForApprovalUID="";
					for(var t=0;t<data.Projects[i].Approvers_Comments.length;t++)
					{
						var pebdingLevelSts = data.Projects[i].Approvers_Comments[t].ApproverStatus;
						if(pebdingLevelSts=="1")
						{
							var finalPendingWith = data.Projects[i].Approvers_Comments[t].Approver_Name;
								PendingForApprovalUID = data.Projects[i].Approvers_Comments[t].ApproverUID;
						}
					}
					AppFlagStausTxt = "Submitted";
					table_body += "<tr>";				
					table_body+="<td style='text-align:center;'><input style='display:inline-block;' class='checkbox' type='checkbox' name='check[]' id='timid"+i+"' value="+data.Projects[i].TimesheetUID+" onclick='unchecksingle(this)' />"; //<input type='hidden' id='commen"+i+"' value="+commment+" />
					table_body += "<input type='hidden' id='projec"+i+"' value="+data.Projects[i].ProjectUID+" /><input type='hidden' id='periodsid"+i+"' value="+data.Projects[i].PeriodId+" /><input type='hidden' id='resourcid"+i+"' value="+data.Projects[i].ResourceId+" /><input type='hidden' id='openActives"+i+"' value="+OpenStatus+" /><input type='hidden' id='ApprResUId"+i+"' value="+PendingForApprovalUID+" /></td>";
					table_body+="<td>"+slNo+"</td>";
					table_body += "<td><a href='ResourceWiseTimesheetDetails.aspx?PeriodUID="+data.Projects[i].PeriodId+"&StartDate="+data.Projects[i].StartDate+"&EndDate="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&RES_UID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td>"+data.Projects[i].PeriodName+"</td>";
					table_body+="<td>"+data.Projects[i].ProjectName+"</td>";
					table_body+="<td>"+data.Projects[i].ProjectOwnerName+"</td>";
					table_body+="<td>"+AppFlagStausTxt+ "</td>";
					var sub_Dtes = new Date(data.Projects[i].TS_SUBMITTED_DATE);
					if(sub_Dtes == "Invalid Date")
					{
						var SubmitDateTS = "";
						var subdates = "";
					}
					else
					{
						var SubmitDateTS = ("0" + sub_Dtes.getDate()).slice(-2)+  "-" + monthNames[sub_Dtes.getMonth()] +"-" + sub_Dtes.getFullYear();
						var subdates = dateformat(sub_Dtes);
					}
					table_body+="<td><a style='text-decoration:none; cursor:default;' data-toggle='tooltip' data-placement='top' title='" + subdates + "'>"+SubmitDateTS+ "</a></td>";
					table_body+="<td>"+finalPendingWith+"</td>";
					table_body += '<td class="clsLog"><input type="hidden" class="ts_name" value=\''+data.Projects[i].ProjectName+'\' ><i onclick="openTSLog(\''+data.Projects[i].TimesheetUID+'\',this)" style="cursor: pointer;color: rgb(6, 94, 160);" class="fa fa-exclamation-circle"></i></td>'; 
					table_body += "</tr>";	
				}
			}
		}
		table_body=table_body+"/<tbody>";
		table_element=table_header+table_body;
		$('#tblResName').html(table_element);
		bind_dataTabletblResName();
		$('.loader').hide();
		$("#checkRem").removeClass("sorting");
		$('#remLog').removeClass("sorting");
	}
	else if(getDataID=="btnAppovedCount")
	{
		//$(".loader").show();
		$("#CurrentTabName").text("Approved");
		$('#SelectedItemCount').text(0);
		$("#btnAllPeriods").parent("li").removeClass("green-btn");
		$("#btnOpenPeriods").parent("li").removeClass("green-btn");
		$("#btnSubmitPeriods").parent("li").removeClass("green-btn");
		$("#btnAppovedCount").parent("li").addClass("green-btn");
		$("#btnRejectCount").parent("li").removeClass("green-btn");
		var	table_header="<thead><tr>";
		table_header=table_header +"<th data-orderable='false' style='width: 50px !important; text-align:center;' id='checkRem'><input type='checkbox' id='select_all'  onclick='checkall();' /></th>";
		table_header=table_header +"<th style='width:50px !important;'>S.No</th>";
		table_header=table_header +"<th style='width:150px !important;'>Resource Name</th> ";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th>Submitted Date</th>";
		table_header=table_header +"<th>Approved Date</th>";
		table_header=table_header +"<th>Approved By</th>";
		
		table_header=table_header +"<th>Approver 1</th>";
		table_header=table_header +"<th>Approver 2</th>";
		table_header=table_header +"<th data-orderable='false' id='remLog' style='width:50px !important;'>Log</th>";
		table_header=table_header +"</tr></thead>";
		//footer menu	
		table_header=table_header +"<tfoot><tr>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"<th>S.No</th>";
		table_header=table_header +"<th>Resource Name</th>";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th>Submitted Date</th>";
		table_header=table_header +"<th>Approved Date</th>";
		table_header=table_header +"<th>Approved By</th>";
		table_header=table_header +"<th>Approver 1</th>";
		table_header=table_header +"<th>Approver 2</th>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"</tr></tfoot>";

		table_element="";	
		table_body="<tbody>"; 
		
		if(data.Projects.length == 0)
		{
			
		}
		else
		{
			var status = "";
			for (var i = 0; i < data.Projects.length; i++) 
			{			
				var slNo = i+1;
				var commment = data.Projects[i].Comment;
				var OpenStatus =data.Projects[i].Open;
				if (OpenStatus == 1)
				{
					OpenStatusText = "TS Period Open";
				}
				else
				{
					OpenStatusText = "TS Period Close";
				}
				var AppFlagStaus = data.Projects[i].ApprovalFlag;
				
				if(AppFlagStaus == 2)
				{
					AppFlagStausTxt = "Approved";
					table_body += "<tr>";				
					table_body+="<td style='text-align:center;'><input style='display:inline-block;' class='checkbox' type='checkbox' name='check[]' id='timid"+i+"' value="+data.Projects[i].TimesheetUID+" onclick='unchecksingle(this)' />"; //<input type='hidden' id='commen"+i+"' value="+commment+" />
					table_body += "<input type='hidden' id='projec"+i+"' value="+data.Projects[i].ProjectUID+" /><input type='hidden' id='periodsid"+i+"' value="+data.Projects[i].PeriodId+" /><input type='hidden' id='resourcid"+i+"' value="+data.Projects[i].ResourceId+" /><input type='hidden' id='openActives"+i+"' value="+OpenStatus+" /></td>";
					table_body+="<td>"+slNo+"</td>";
					table_body += "<td><a href='ResourceWiseTimesheetDetails.aspx?PeriodUID="+data.Projects[i].PeriodId+"&StartDate="+data.Projects[i].StartDate+"&EndDate="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&RES_UID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td>"+data.Projects[i].PeriodName+"</td>";
					table_body+="<td>"+data.Projects[i].ProjectName+"</td>";
					table_body+="<td>"+data.Projects[i].ProjectOwnerName+"</td>";
					var subb_Dte = new Date(data.Projects[i].TS_SUBMITTED_DATE);
					if(subb_Dte == "Invalid Date")
					{
						var SubmitDatTS ="";
						var subdatadate = "";
					}
					else
					{
						var SubmitDatTS = ("0" + subb_Dte.getDate()).slice(-2)+  "-" + monthNames[subb_Dte.getMonth()] +"-" + subb_Dte.getFullYear();
						var subdatadate = dateformat(subb_Dte);
					}
					table_body+="<td><a style='text-decoration:none; cursor:default;' data-toggle='tooltip' data-placement='top' title='" + subdatadate + "'>"+SubmitDatTS+ "</a></td>";
					var Appr1 ="";
					var PendingForApprovalUID="";
					var app1Name="";
					var app2Name="";
					var appDate="";	
					var approvedByPerson="";
					var dateApprovd="";
					var dateApprovdate="";
					
					for(var t=0;t<data.Projects[i].Approvers_Comments.length;t++)
					{
						var apprStatus = data.Projects[i].Approvers_Comments[t].ApproverStatus;
						var pebdingLevel = data.Projects[i].Approvers_Comments[t].Approver_Level;
						var dateAppr = new Date(data.Projects[i].Approvers_Comments[t].Appr_Rej_Date);
						if(pebdingLevel=="1")
						{
							app1Name = data.Projects[i].Approvers_Comments[t].Approver_Name;
						}
						if(pebdingLevel=="1" && apprStatus=="2")
						{
							approvedByPerson = data.Projects[i].Approvers_Comments[t].Approver_Name;
							if(dateAppr=="Invalid Date")
							{
								dateApprovd="";
								dateApprovdate="";
							}
							else
							{
								dateApprovd = dateformat(dateAppr);
								dateApprovdate = ("0" + dateAppr.getDate()).slice(-2)+  "-" + monthNames[dateAppr.getMonth()] +"-" + dateAppr.getFullYear();
							}
						}
						if(pebdingLevel=="2")
						{
							app2Name = data.Projects[i].Approvers_Comments[t].Approver_Name;
						}
						if(pebdingLevel=="2" && apprStatus=="2")
						{
							approvedByPerson = data.Projects[i].Approvers_Comments[t].Approver_Name;
							if(dateAppr=="Invalid Date")
							{
								dateApprovd="";
								dateApprovdate="";
							}
							else
							{
								dateApprovd = dateformat(dateAppr);
								dateApprovdate = ("0" + dateAppr.getDate()).slice(-2)+  "-" + monthNames[dateAppr.getMonth()] +"-" + dateAppr.getFullYear();
							}
						}
					}
					table_body+="<td><a style='text-decoration:none; cursor:default;' data-toggle='tooltip' data-placement='top' title='" + dateApprovd + "'>"+dateApprovdate+"</a></td>";
					table_body+="<td>"+approvedByPerson+"</td>";
					table_body+="<td>"+app1Name+"</td>";
					table_body+="<td>"+app2Name+"</td>";
					table_body += '<td class="clsLog"><input type="hidden" class="ts_name" value=\''+data.Projects[i].ProjectName+'\' ><i onclick="openTSLog(\''+data.Projects[i].TimesheetUID+'\',this)" style="cursor: pointer;color: rgb(6, 94, 160);" class="fa fa-exclamation-circle"></i></td>'; 
					table_body += "</tr>";	
				}	
			}
		}
		table_body=table_body+"/<tbody>";
		table_element=table_header+table_body;
		$('#tblResName').html(table_element);
		bind_dataTabletblResName();
		$('.loader').hide();
		$("#checkRem").removeClass("sorting");
		$('#remLog').removeClass("sorting");
	}
	if(getDataID=="btnRejectCount")
	{
		//$(".loader").show();
		$("#CurrentTabName").text("Rejected");
		$('#SelectedItemCount').text(0);
		$("#btnAllPeriods").parent("li").removeClass("green-btn");
		$("#btnOpenPeriods").parent("li").removeClass("green-btn");
		$("#btnSubmitPeriods").parent("li").removeClass("green-btn");
		$("#btnAppovedCount").parent("li").removeClass("green-btn");
		$("#btnRejectCount").parent("li").addClass("green-btn");
		var	table_header="<thead><tr>";
		table_header=table_header +"<th data-orderable='false' style='width: 50px !important; text-align:center;' id='checkRem'><input type='checkbox' id='select_all'  onclick='checkall();' /></th>";
		table_header=table_header +"<th style='width:50px !important;'>S.No</th>";
		table_header=table_header +"<th style='width:150px !important;'>Resource Name</th> ";
		table_header=table_header +"<th>Timesheet <br> Name</th>";
		table_header=table_header +"<th>Project <br> Name</th>";
		table_header=table_header +"<th>Project <br> Manager</th>";
		table_header=table_header +"<th>Submitted Date</th>";
		table_header=table_header +"<th>Rejected Date</th>";
		table_header=table_header +"<th>Rejected By</th>";
		
		table_header=table_header +"<th>Rejection Comment</th>";
		table_header=table_header +"<th data-orderable='false' id='remLog' style='width:50px !important;'>Log</th>";
		table_header=table_header +"</tr></thead>";
		//footer menu	
		table_header=table_header +"<tfoot><tr>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"<th>S.No</th>";
		table_header=table_header +"<th>Resource Name</th>";
		table_header=table_header +"<th>Timesheet Name</th>";
		table_header=table_header +"<th>Project Name</th>";
		table_header=table_header +"<th>Project Manager</th>";
		table_header=table_header +"<th>Submitted Date</th>";
		table_header=table_header +"<th>Rejected Date</th>";
		table_header=table_header +"<th>Rejected By</th>";
		table_header=table_header +"<th>Rejection Comment</th>";
		table_header=table_header +"<th></th>";
		table_header=table_header +"</tr></tfoot>";

		table_element="";	
		table_body="<tbody>"; 
		
		if(data.Projects.length == 0)
		{
		}
		else
		{
			var status = "";
			for (var i = 0; i < data.Projects.length; i++) 
			{			
				var slNo = i+1;
				var commment = data.Projects[i].Comment;
				var OpenStatus =data.Projects[i].Open;
				if (OpenStatus == 1)
				{
					OpenStatusText = "TS Period Open";
				}
				else
				{
					OpenStatusText = "TS Period Close";
				}
				var AppFlagStaus = data.Projects[i].ApprovalFlag;
				
				var PendingForApproval ="";
				if(AppFlagStaus == 3)
				{
					AppFlagStausTxt = "Rejected";
					table_body += "<tr>";				
					table_body+="<td style='text-align:center;'><input style='display:inline-block;' class='checkbox' type='checkbox' name='check[]' id='timid"+i+"' value="+data.Projects[i].TimesheetUID+" onclick='unchecksingle(this)' />"; //<input type='hidden' id='commen"+i+"' value="+commment+" />
					table_body += "<input type='hidden' id='projec"+i+"' value="+data.Projects[i].ProjectUID+" /><input type='hidden' id='periodsid"+i+"' value="+data.Projects[i].PeriodId+" /><input type='hidden' id='resourcid"+i+"' value="+data.Projects[i].ResourceId+" /><input type='hidden' id='openActives"+i+"' value="+OpenStatus+" /></td>";
					table_body+="<td>"+slNo+"</td>";
					table_body += "<td><a href='ResourceWiseTimesheetDetails.aspx?PeriodUID="+data.Projects[i].PeriodId+"&StartDate="+data.Projects[i].StartDate+"&EndDate="+data.Projects[i].EndDate+"&TimesheetUID="+data.Projects[i].TimesheetUID+"&RES_UID="+data.Projects[i].ResourceId+"' target='_blank' >"+data.Projects[i].ResourceName+"</a></td>";
					table_body+="<td>"+data.Projects[i].PeriodName+"</td>";
					table_body+="<td>"+data.Projects[i].ProjectName+"</td>";
					table_body+="<td>"+data.Projects[i].ProjectOwnerName+"</td>";
					var subb_Dte = new Date(data.Projects[i].TS_SUBMITTED_DATE);
					if(subb_Dte == "Invalid Date")
					{
						var SubmitDatTS ="";
						var SUBMitdates = dateformat(sub_Dtes);
					}
					else
					{
						var SubmitDatTS = ("0" + subb_Dte.getDate()).slice(-2)+  "-" + monthNames[subb_Dte.getMonth()] +"-" + subb_Dte.getFullYear();
						var SUBMitdates = dateformat(subb_Dte);
					}
					table_body+="<td><a style='text-decoration:none; cursor:default;' data-toggle='tooltip' data-placement='top' title='" + SUBMitdates + "'>"+SubmitDatTS+ "</a></td>";
					var RejPersonBy ="";
					var RejDate="";
					var Comment_TS="";
					for(var t=0;t<data.Projects[i].Approvers_Comments.length;t++)
					{
						var apprStatus = data.Projects[i].Approvers_Comments[t].ApproverStatus;
						var pebdingLevel = data.Projects[i].Approvers_Comments[t].Approver_Level;
						var dateAppr = new Date(data.Projects[i].Approvers_Comments[t].Appr_Rej_Date);
						if(pebdingLevel=="1" && apprStatus=="3")
						{
							RejPersonBy = data.Projects[i].Approvers_Comments[t].Approver_Name;
							if(dateAppr=="Invalid Date")
							{
								daterejecteds="";
								dateRejdate="";
							}
							else
							{
								daterejecteds = dateformat(dateAppr);
								dateRejdate = ("0" + dateAppr.getDate()).slice(-2)+  "-" + monthNames[dateAppr.getMonth()] +"-" + dateAppr.getFullYear();
							}
							Comment_TS = data.Projects[i].Approvers_Comments[t].Comment;
						}
						if(pebdingLevel=="2" && apprStatus=="3")
						{
							RejPersonBy = data.Projects[i].Approvers_Comments[t].Approver_Name;
							if(dateAppr=="Invalid Date")
							{
								daterejecteds="";
								dateRejdate="";
							}
							else
							{
								daterejecteds = dateformat(dateAppr);
								dateRejdate = ("0" + dateAppr.getDate()).slice(-2)+  "-" + monthNames[dateAppr.getMonth()] +"-" + dateAppr.getFullYear();
							}
							Comment_TS = data.Projects[i].Approvers_Comments[t].Comment;
						}
					}
					table_body+="<td ><a style='text-decoration:none; cursor:default;' data-toggle='tooltip' data-placement='top' title='" + daterejecteds + "'>"+dateRejdate+"</a></td>";
					table_body+="<td>"+RejPersonBy+"</td>";
					var Comment_TSLimitLength = Comment_TS;
					var lessCommentData = Comment_TSLimitLength.length > 12 ? Comment_TSLimitLength.slice(0,15) + "..." :  Comment_TSLimitLength;
					table_body+="<td><span  title='"+Comment_TS+"'  data-toggle='tooltip' data-placement='top'> "+lessCommentData+"</span></td>";
					table_body += '<td class="clsLog"><input type="hidden" class="ts_name" value=\''+data.Projects[i].ProjectName+'\' ><i onclick="openTSLog(\''+data.Projects[i].TimesheetUID+'\',this)" style="cursor: pointer;color: rgb(6, 94, 160);" class="fa fa-exclamation-circle"></i></td>'; 
					table_body += "</tr>";	
				}
			}
		}
		table_body=table_body+"</tbody>";
		table_element=table_header+table_body;
		$('#tblResName').html(table_element);
		bind_dataTabletblResName();
		$('.loader').hide();
		$("#checkRem").removeClass("sorting");
		$('#remLog').removeClass("sorting");
	}
}

function openTSLog(timeUid,currData)
{
	$('.addition-info-block').animate({ width: 'toggle'});
	monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
	$('#loading-image').show();
	var ServiceURL = getURLTimesheet_AuditLog();
	var inputData = new Object();
	inputData.TimesheetUID = timeUid;
	callService(ServiceURL,inputData,openLogTable,"",currData);
}

function openLogTable(data,passData)
{
	var innerLogHTML = "";
	$("#bindlog").text("");
	$("#LogId").text($(passData.parentNode).find(".ts_name").val());
	for(var i=0;i<data.Data.length;i++)
	{	
		innerLogHTML += '<tr>';
		var lofdate = new Date(data.Data[i].Created_Date);
		innerLogHTML += "<td><a style='text-decoration:none; cursor:default;' data-toggle='tooltip' data-placement='top' title='" +dateformat(lofdate)+ "'>"+(new Date(data.Data[i].Created_Date)).format('dd-MMM-yyyy')+"</a></td>";
		innerLogHTML += '<td>'+data.Data[i].Actor+'</td>';
		if(data.Data[i].Remarks.indexOf("Rejected") > -1)
		{
			innerLogHTML += '<td>REJECTED</td>';
		}
		else if(data.Data[i].Remarks.indexOf("Approved") > -1)
		{
			innerLogHTML += '<td>APPROVED</td>';		
		}
		else if(data.Data[i].Remarks.indexOf("SUBMIT") > -1)
		{
			innerLogHTML += '<td>SUBMITTED</td>';		
		}
		else if(data.Data[i].Remarks.indexOf("SAVE") > -1)
		{
			innerLogHTML += '<td>SAVED</td>';		
		}
		else
		{
			innerLogHTML += '<td>'+data.Data[i].Type+'</td>';
		}
		innerLogHTML += '<td>'+data.Data[i].Remarks+'</td>';
		innerLogHTML += '</tr>';
	}
	$("#bindlog").append(innerLogHTML);
	$('.allcommentdiv').show({ width: 'toggle' });
	$('#loading-image').hide();
}
function closeallcomment() 
{
	$('.allcommentdiv').animate({ width: 'toggle' });
}
function cleardata()
{
	$('#jqxgrid_containertblResName').empty();
	$("#jqxgrid_containertblResName").append("<table id='tblResName' class='display example table table-bordered' cellspacing='0' width='100%'></table>");
} 

<!-- function ClearBackGroundColour()  -->
<!-- { -->
	<!-- $('#rateId').css({"border": "","background": ""}); -->
	<!-- $('.CaptionCont ').css({"border": "","background": ""}); -->
<!-- } -->

function openAdminUpdatePopup()
{
	var no_checked=0;
	var childCheckboxes = $('#tblResName tbody tr td').find('input[type=checkbox]');
	var no_checked1 = childCheckboxes.filter(':checked').length;
	var source = $("#tblResName").DataTable();           
    $("input[type=checkbox]", source.rows().nodes()).each(function ()
	{
		var tuisre = $(this).is(":checked");
		if (tuisre)
		{
			no_checked++;
		}
	});
	if(no_checked==0)
	{
		openOKpopup(popUpMessage.AdminAtleastOnePopup,"");		
	}
	else
	{
		$('#TxtTillData').hide();
		$('#TillDateOfOpen').hide();
		openyesNoPopup('AdminUpdateTSstatusReset',popUpMessage.adminResetUpdate);
		
	}
}

function TimesheetAdminUpdateTSstatus()
{	
	var approvedData = new Object();
	approvedData.Data = new Array();	
	var childCheckboxes = $('#tblResName tbody tr td').find('input[type=checkbox]');
	var  no_checked1 = childCheckboxes.filter(':checked').length;
	var source = $("#tblResName").DataTable();           
	$("input[type=checkbox]", source.rows().nodes()).each(function ()
	{
		var tuisre = $(this).is(":checked");
		if (tuisre)
		{
			var tempData = new Object();
			tempData.TimesheetUID = $(this).closest("tr").find("input[id^=timid]").val();
			tempData.PeriodUID = $(this).closest("tr").find("input[id^=periodsid]").val();
			tempData.ProjectUID = $(this).closest("tr").find("input[id^=projec]").val();
			tempData.ResourceUID = $(this).closest("tr").find("input[id^=resourcid]").val();
			//tempData.Comment = $(this).closest("tr").find("input[id^=commen]").val();
			approvedData.Data.push(tempData);
		}
	});
	var ApproveRejectJson = JSON.stringify(approvedData);
	var Admin_UpdateTSstatusUrls = Admin_UpdateTSstatus();
	$.ajax
	({       
		url: Admin_UpdateTSstatusUrls,
		headers: { "Accept": "application/json; odata=verbose" },
		method: "POST",
		data: approvedData,
		dataType: 'json',
		success: function(data)
		{
			//okPopupOnOkButton('#yesNoPopup');
			//openOKpopup(popUpMessage.AdminResetSucessfully,"true");
			$(".alert-main").hide();
			document.getElementById("Alert_msg").innerHTML=popUpMessage.AdminResetSucessfully;	
			$("#alertmain").show();
			GetPeriodMasterData();	
		}
	});
}
function close_div(type)
{
	$("#alertmain").hide();
	document.getElementById("Alert_msg").innerHTML="";
}
function bind_dataTabletblResName() //table srearch and column search
{     
	$('#tblResName').DataTable({ "order": [] });
	var ExpenceDataTableElementtblLongLeave = $('#tblResName').DataTable();
	$('#tblResName tfoot th').each( function ()
	{
		var title = $(this).text();
		if(title == "")
		{ $(this).html(); }
		else { 
			$(this).html( '<input type="text" placeholder="Search"/>' ); 
		}
	});
   	ExpenceDataTableElementtblLongLeave.columns().every( function ()
	{
		var that = this;
		$( 'input', this.footer() ).on( 'keyup change', function ()
		{
			if ( that.search() !== this.value ) 
			{
				that
				.search( this.value )
				.draw();
			}
		});
	});
}
			
function returnDateFormat(input)
{
	var sptdate = String(input).split("-");
	var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
	var myMonth = sptdate[1];
    var myDay = sptdate[0];
    var myYear = sptdate[2];
	return (months.indexOf(myMonth)+1).toString() + "-"+  myDay +"-"+myYear;
}

<!-- function dateformat(myDate) -->
<!-- { -->
	<!-- monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]; -->
	<!-- var hr = myDate.getHours(); -->
	<!-- hr = hr % 12; -->
	<!-- hr = hr ? hr : 12; -->
	<!-- var min = myDate.getMinutes(); -->
	<!-- if (min < 10) -->
	<!-- { -->
		<!-- min = "0" + min; -->
	<!-- } -->
	<!-- var ampm = hr < 12 ? "am" : "pm"; -->
	<!-- return ("0" + myDate.getDate()).slice(-2)+  "-" + monthNames[myDate.getMonth()] +"-" + myDate.getFullYear() +" "+ hr + ":" + min + ":" + myDate.getSeconds() +" "+ampm ; -->
<!-- } -->


	
function dateformat(date) 
{
	var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
	var hours = date.getHours();
	var minutes = date.getMinutes();
	var ampm = hours >= 12 ? 'pm' : 'am';
	hours = hours % 12;
	hours = hours ? hours : 12; // the hour '0' should be '12'
	minutes = minutes < 10 ? '0'+minutes : minutes;
	//var strTime = hours + ':' + minutes + ' ' + ampm;
	return ("0" + date.getDate()).slice(-2)+  "-" + monthNames[date.getMonth()] +"-" + date.getFullYear() +" "+ hours + ":" + minutes + ":" + date.getSeconds() +" "+ampm ;

	//return strTime;
}
</script>
</body>
</html>
